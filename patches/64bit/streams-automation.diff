? unxlngx6.pro
Index: inc/commtypes.hxx
===================================================================
RCS file: /cvs/util/automation/inc/commtypes.hxx,v
retrieving revision 1.3
diff -u -r1.3 commtypes.hxx
--- automation/inc/commtypes.hxx	7 Sep 2005 19:14:26 -0000	1.3
+++ automation/inc/commtypes.hxx	14 Mar 2006 19:05:45 -0000
@@ -84,8 +84,8 @@
 #include <tools/solar.h>
 typedef BYTE comm_BYTE;
 typedef BOOL comm_BOOL;
-typedef ULONG comm_ULONG;
-typedef USHORT comm_USHORT;
+typedef sal_uInt32 comm_ULONG;
+typedef sal_uInt16 comm_USHORT;
 typedef UINT16 comm_UINT16;
 typedef UINT32 comm_UINT32;
 
@@ -99,8 +99,8 @@
 
 #endif
 
-typedef unsigned short      comm_WORD;
-typedef unsigned long       comm_DWORD;
+typedef sal_uInt16      comm_WORD;
+typedef sal_uInt32      comm_DWORD;
 
 class SmartId;
 class String;
Index: source/inc/icommstream.hxx
===================================================================
RCS file: /cvs/util/automation/source/inc/icommstream.hxx,v
retrieving revision 1.2
diff -u -r1.2 icommstream.hxx
--- automation/source/inc/icommstream.hxx	7 Sep 2005 19:17:43 -0000	1.2
+++ automation/source/inc/icommstream.hxx	14 Mar 2006 19:05:45 -0000
@@ -61,11 +61,11 @@
 	virtual ICommStream&	operator<<( comm_ULONG nULong )=0;
 	virtual ICommStream&	operator<<( comm_BOOL nChar )=0;
 
-	virtual comm_ULONG			Read( void* pData, comm_ULONG nSize )=0;
-	virtual comm_ULONG			Write( const void* pData, comm_ULONG nSize )=0;
+	virtual sal_Size		Read( void* pData, sal_Size nSize )=0;
+	virtual sal_Size		Write( const void* pData, sal_Size nSize )=0;
 
 	virtual comm_BOOL		IsEof() const=0;
-	virtual comm_ULONG		SeekRel( long nPos )=0;
+	virtual sal_Size		SeekRel( long nPos )=0;
 
 };
 
Index: source/inc/svcommstream.hxx
===================================================================
RCS file: /cvs/util/automation/source/inc/svcommstream.hxx,v
retrieving revision 1.2
diff -u -r1.2 svcommstream.hxx
--- automation/source/inc/svcommstream.hxx	7 Sep 2005 19:18:13 -0000	1.2
+++ automation/source/inc/svcommstream.hxx	14 Mar 2006 19:05:45 -0000
@@ -48,17 +48,17 @@
 	SvCommStream( SvStream* pIO );
 	~SvCommStream();
 
-	ICommStream&		operator>>( USHORT& rUShort );
-	ICommStream&		operator>>( ULONG& rULong );
+	ICommStream&		operator>>( sal_uInt16& rUShort );
+	ICommStream&		operator>>( sal_uInt32& rULong );
 	ICommStream&		operator>>( unsigned char& rChar );
 
-	ICommStream&		operator<<( USHORT nUShort );
-	ICommStream&		operator<<( ULONG nULong );
+	ICommStream&		operator<<( sal_uInt16 nUShort );
+	ICommStream&		operator<<( sal_uInt32 nULong );
 	ICommStream&		operator<<( unsigned char nChar );
 
-	ULONG			Read( void* pData, ULONG nSize );
-	ULONG			Write( const void* pData, ULONG nSize );
+	sal_Size		Read( void* pData, sal_Size nSize );
+	sal_Size		Write( const void* pData, sal_Size nSize );
 
 	BOOL			IsEof() const;
-	ULONG		    SeekRel( long nPos );
+	sal_Size	    	SeekRel( long nPos );
 };
Index: source/server/XMLParser.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/XMLParser.cxx,v
retrieving revision 1.5
diff -u -r1.5 XMLParser.cxx
--- automation/source/server/XMLParser.cxx	7 Sep 2005 19:22:36 -0000	1.5
+++ automation/source/server/XMLParser.cxx	14 Mar 2006 19:05:46 -0000
@@ -506,7 +506,7 @@
 			break;
 		case RC_SAXGetNodeType:
             {
-   		        pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)pSAXParser->GetCurrentNode()->GetNodeType() );
+   		        pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)pSAXParser->GetCurrentNode()->GetNodeType() );
 			}
 			break;
 		case RC_SAXGetAttributeCount:
@@ -524,13 +524,13 @@
 	                        pRet->GenReturn ( RET_Value, aSmartMethodId, pElementNode->GetNodeName() );
 			                break;
 		                case RC_SAXGetChildCount:
-	                        pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)pElementNode->GetChildCount() );
+	                        pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)pElementNode->GetChildCount() );
 			                break;
 		                case RC_SAXGetAttributeCount:
                             if ( xAttributeList.is() )
-                                pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)xAttributeList->getLength() );
+                                pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)xAttributeList->getLength() );
                             else
-                                pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)0 );
+                                pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)0 );
 			                break;
 		                case RC_SAXGetAttributeName:
                             {
@@ -615,8 +615,8 @@
                     }
                     else if ( aString1.Copy(0,2).EqualsAscii( "*:" ) )
                     {
-                        ULONG nTimestamp = (ULONG)aString1.GetToken( 1, ':' ).ToInt64();
-                        ULONG nPointer = (ULONG)aString1.GetToken( 2, ':' ).ToInt64();
+                        ULONG nTimestamp = (sal_uInt32)aString1.GetToken( 1, ':' ).ToInt64();
+                        ULONG nPointer = (sal_uInt32)aString1.GetToken( 2, ':' ).ToInt64();
                         if ( bCheckOnly )
                             pRet->GenReturn ( RET_Value, aSmartMethodId, (BOOL)(pSAXParser->GetTimestamp() == nTimestamp) );
                         else
Index: source/server/recorder.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/recorder.cxx,v
retrieving revision 1.8
diff -u -r1.8 recorder.cxx
--- automation/source/server/recorder.cxx	7 Sep 2005 19:24:58 -0000	1.8
+++ automation/source/server/recorder.cxx	14 Mar 2006 19:05:47 -0000
@@ -211,7 +211,7 @@
 				switch( nEventID )
 				{
 					case VCLEVENT_WINDOW_ACTIVATE:
-                        StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId(), (USHORT)(M_SetPage|M_RET_NUM_CONTROL), pWin->GetSmartUniqueOrHelpId().GetNum() );
+                        StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId(), (USHORT)(M_SetPage|M_RET_NUM_CONTROL), (sal_uInt32)(pWin->GetSmartUniqueOrHelpId().GetNum()) );
                         bSendData = TRUE;
 						break;
 				}
@@ -271,7 +271,7 @@
 				{
 //                    case VCLEVENT_LISTBOX_DOUBLECLICK:
                     case VCLEVENT_LISTBOX_SELECT:
-                        StatementList::pRet->GenReturn( RET_MacroRecorder, pWin->GetSmartUniqueOrHelpId(), (USHORT)M_Select, ULONG( ((ListBox*)pWin)->GetSelectEntryPos() +1 ) );
+                        StatementList::pRet->GenReturn( RET_MacroRecorder, pWin->GetSmartUniqueOrHelpId(), (USHORT)M_Select, sal_uInt32( ((ListBox*)pWin)->GetSelectEntryPos() +1 ) );
                         bSendData = TRUE;
 						break;
 				}
@@ -299,7 +299,7 @@
                                 Sound::Beep();
 						    else
                             {
-                                StatementList::pRet->GenReturn( RET_MacroRecorder, pWin->GetSmartUniqueOrHelpId(), (USHORT)M_Select, (ULONG) nPos+1 );
+                                StatementList::pRet->GenReturn( RET_MacroRecorder, pWin->GetSmartUniqueOrHelpId(), (USHORT)M_Select, (sal_uInt32) nPos+1 );
                                 bSendData = TRUE;
                             }
                         }
@@ -354,7 +354,7 @@
                                         if ( nMethod != M_Click )
                                             StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId( 0 ), nMethod );
                                         else
-                                            StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId( 0 ), nMethod, (ULONG)nCurrentButtonId );
+                                            StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId( 0 ), nMethod, (sal_uInt32)nCurrentButtonId );
                                         bSendData = TRUE;
                                     }
                                     break;
@@ -477,7 +477,7 @@
                                     StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId( pTB->GetItemCommand( pTB->GetCurItemId() ) ), (USHORT)(M_Click) );
                                 else
                                     // access via Toolbox
-                                    StatementList::pRet->GenReturn( RET_MacroRecorder, pTB->GetSmartUniqueOrHelpId(), (USHORT)(M_Click|M_RET_NUM_CONTROL), pTB->GetHelpId( pTB->GetCurItemId() ) );
+                                    StatementList::pRet->GenReturn( RET_MacroRecorder, pTB->GetSmartUniqueOrHelpId(), (USHORT)(M_Click|M_RET_NUM_CONTROL), sal_uInt32(pTB->GetHelpId( pTB->GetCurItemId() )) );
                                 bSendData = TRUE;
                             }
 						    break;
@@ -495,7 +495,7 @@
                                         StatementList::pRet->GenReturn( RET_MacroRecorder, SmartId( pActionParent->GetHelpId( pActionParent->GetCurItemId() ) ), (USHORT)(M_TearOff) );
                                     else
                                         // access via Toolbox
-                                        StatementList::pRet->GenReturn( RET_MacroRecorder, pActionParent->GetSmartUniqueOrHelpId(), (USHORT)(M_TearOff|M_RET_NUM_CONTROL), pActionParent->GetHelpId( pActionParent->GetCurItemId() ) );
+                                        StatementList::pRet->GenReturn( RET_MacroRecorder, pActionParent->GetSmartUniqueOrHelpId(), (USHORT)(M_TearOff|M_RET_NUM_CONTROL), sal_uInt32(pActionParent->GetHelpId( pActionParent->GetCurItemId() )) );
                                     bSendData = TRUE;
                                 }
                                 pActionParent = NULL;
@@ -865,7 +865,7 @@
 							pRet->GenReturn ( RET_Value, nUId, BOOL( pMB->GetCheckBoxState() == STATE_CHECK) );
 							break;
 						case M_GetState :
-							pRet->GenReturn ( RET_Value, nUId, ULONG( pMB->GetCheckBoxState() ));
+							pRet->GenReturn ( RET_Value, nUId, sal_uInt32( pMB->GetCheckBoxState() ));
 							break;
 						case M_Check :
 							pMB->SetCheckBoxState( STATE_CHECK );
@@ -917,11 +917,11 @@
 								ReportError( nUId, GEN_RES_STR1( S_BUTTONID_REQUIRED, MethodString( nMethodId ) ) );
 							break;
 						case M_GetButtonCount :
-							pRet->GenReturn ( RET_Value, nUId, ULONG(pBD->GetButtonCount()));
+							pRet->GenReturn ( RET_Value, nUId, sal_uInt32(pBD->GetButtonCount()));
 							break;
 						case M_GetButtonId :
 							if ( ValueOK(nUId, MethodString( nMethodId ),nNr1,pBD->GetButtonCount()) )
-								pRet->GenReturn ( RET_Value, nUId, ULONG(pBD->GetButtonId(nNr1-1)));
+								pRet->GenReturn ( RET_Value, nUId, sal_uInt32(pBD->GetButtonId(nNr1-1)));
 							break;
 						default:
 							ReportError( nUId, GEN_RES_STR2c2( S_UNKNOWN_METHOD, MethodString(nMethodId), "MessageBox" ) );
Index: source/server/retstrm.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/retstrm.cxx,v
retrieving revision 1.4
diff -u -r1.4 retstrm.cxx
--- automation/source/server/retstrm.cxx	7 Sep 2005 19:25:12 -0000	1.4
+++ automation/source/server/retstrm.cxx	14 Mar 2006 19:05:47 -0000
@@ -74,7 +74,7 @@
 	Write(aValue);
 }
 
-void RetStream::GenReturn ( USHORT nRet, SmartId aUId, ULONG nNr, String aString, BOOL bBool )
+void RetStream::GenReturn ( USHORT nRet, SmartId aUId, sal_uInt32 nNr, String aString, BOOL bBool )
 {
     CmdBaseStream::GenReturn ( nRet, &aUId, nNr, &aString, bBool );
 }
@@ -110,7 +110,7 @@
         Write( &aTmp );
     }
     else
-        Write( pId->GetNum() );
+        Write( comm_ULONG(pId->GetNum()) );
 }
 
 
Index: source/server/retstrm.hxx
===================================================================
RCS file: /cvs/util/automation/source/server/retstrm.hxx,v
retrieving revision 1.5
diff -u -r1.5 retstrm.hxx
--- automation/source/server/retstrm.hxx	7 Sep 2005 19:25:27 -0000	1.5
+++ automation/source/server/retstrm.hxx	14 Mar 2006 19:05:47 -0000
@@ -73,7 +73,7 @@
 //  new
     void GenReturn( USHORT nRet, SmartId aUId, String aString );
 	void GenReturn( USHORT nRet, SmartId aUId, SbxValue &aValue );
-	void GenReturn( USHORT nRet, SmartId aUId, ULONG nNr, String aString, BOOL bBool );
+	void GenReturn( USHORT nRet, SmartId aUId, sal_uInt32 nNr, String aString, BOOL bBool );
 // MacroRecorder
     void GenReturn( USHORT nRet, SmartId aUId, USHORT nMethod, String aString );
     void GenReturn( USHORT nRet, SmartId aUId, USHORT nMethod, String aString, BOOL bBool );
Index: source/server/scmdstrm.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/scmdstrm.cxx,v
retrieving revision 1.4
diff -u -r1.4 scmdstrm.cxx
--- automation/source/server/scmdstrm.cxx	7 Sep 2005 19:25:40 -0000	1.4
+++ automation/source/server/scmdstrm.cxx	14 Mar 2006 19:05:48 -0000
@@ -115,7 +115,7 @@
 			break;
 		case BinULONG:
 			{
-				ULONG nNr;
+				comm_ULONG nNr;
                 Read (nNr );
 				pItem = new SfxUInt32Item(nId,nNr);
 #if OSL_DEBUG_LEVEL > 1
@@ -186,7 +186,7 @@
 			break;
 		case BinULONG:
 			{
-				ULONG nNr;
+				comm_ULONG nNr;
                 Read (nNr );
                 rItem.Value <<= nNr;
 #if OSL_DEBUG_LEVEL > 1
Index: source/server/sta_list.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/sta_list.cxx,v
retrieving revision 1.16
diff -u -r1.16 sta_list.cxx
--- automation/source/server/sta_list.cxx	7 Sep 2005 19:26:57 -0000	1.16
+++ automation/source/server/sta_list.cxx	14 Mar 2006 19:05:48 -0000
@@ -190,7 +190,7 @@
 				pRet->GenReturn( RET_ProfileInfo, SmartId(), pProfiler->GetProfileLine( aText ) );
 
 			if ( pProfiler->IsPartitioning() )
-				pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileTime ), pProfiler->GetPartitioningTime() );
+				pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileTime ), comm_ULONG(pProfiler->GetPartitioningTime()) );
 		}
 
 		if ( pProfiler->IsAutoProfiling() )
Index: source/server/statemnt.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/statemnt.cxx,v
retrieving revision 1.23
diff -u -r1.23 statemnt.cxx
--- automation/source/server/statemnt.cxx	7 Sep 2005 19:27:16 -0000	1.23
+++ automation/source/server/statemnt.cxx	14 Mar 2006 19:05:54 -0000
@@ -896,7 +896,7 @@
 		return;
 
 	if ( bFirst )
-		pRet->GenReturn ( RET_WinInfo, SmartId(), (ULONG)nConf | DH_MODE_DATA_VALID, UniString(), TRUE );
+		pRet->GenReturn ( RET_WinInfo, SmartId(), (sal_uInt32)nConf | DH_MODE_DATA_VALID, UniString(), TRUE );
 
 	{	// Klammerung, so daß der String nicht während der Rekursion bestehen bleibt
 		String aName;
@@ -981,10 +981,10 @@
 
             SmartId aId = pBase->GetSmartUniqueOrHelpId();
 			if ( aId.HasString() || ( nConf & DH_MODE_ALLWIN ) )
-                pRet->GenReturn ( RET_WinInfo, SmartId( aId.GetStr() ), (ULONG)pBase->GetType(),
+                pRet->GenReturn ( RET_WinInfo, SmartId( aId.GetStr() ), (sal_uInt32)pBase->GetType(),
 				    TypeString(pBase->GetType()).AppendAscii(": ").Append(aName), FALSE );
 			if ( !aId.HasString() || ( nConf & DH_MODE_ALLWIN ) )
-			    pRet->GenReturn ( RET_WinInfo, SmartId( aId.GetNum() ), (ULONG)pBase->GetType(),
+			    pRet->GenReturn ( RET_WinInfo, SmartId( aId.GetNum() ), (sal_uInt32)pBase->GetType(),
 				    TypeString(pBase->GetType()).AppendAscii(": ").Append(aName), FALSE );
 
 
@@ -1007,10 +1007,10 @@
 					if ( pTB->GetItemType( i ) == TOOLBOXITEM_BUTTON && ( !pItemWin || !pItemWin->IsVisible() ) )
 					{
 						if ( pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-                            pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (ULONG)WINDOW_BUTTON,
+                            pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (sal_uInt32)WINDOW_BUTTON,
 							    TypeString(WINDOW_BUTTON).AppendAscii(": ").Append(aName), FALSE );
 						if ( !pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-    						pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (ULONG)WINDOW_BUTTON,
+    						pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (sal_uInt32)WINDOW_BUTTON,
 	    						TypeString(WINDOW_BUTTON).AppendAscii(": ").Append(aName), FALSE );
 					}
 					else
@@ -1018,10 +1018,10 @@
 						if ( pItemWin )
 						{
                             if ( pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-							    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (ULONG)pItemWin->GetType(),
+							    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (sal_uInt32)pItemWin->GetType(),
 								    TypeString(pItemWin->GetType()).AppendAscii(": ").Append(aName), FALSE );
                             if ( !pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-							    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (ULONG)pItemWin->GetType(),
+							    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (sal_uInt32)pItemWin->GetType(),
 								    TypeString(pItemWin->GetType()).AppendAscii(": ").Append(aName), FALSE );
 							for( int i = 0 ; i < pItemWin->GetChildCount(); i++ )
 								WriteControlData( pItemWin->GetChild(i), nConf, FALSE );
@@ -1052,10 +1052,10 @@
 									DBG_ERROR1( "Unknown TOOLBOXITEM %i", pTB->GetItemType( i ) );
 								}
                                 if ( pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-								    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (ULONG)WINDOW_BASE,
+								    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetItemCommand(pTB->GetItemId( i )) ), (sal_uInt32)WINDOW_BASE,
 									    aToolBoxItemType.AppendAscii(": ").Append(aName), FALSE );
                                 if ( !pTB->GetItemCommand(pTB->GetItemId( i )).Len() || ( nConf & DH_MODE_ALLWIN ) )
-								    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (ULONG)WINDOW_BASE,
+								    pRet->GenReturn ( RET_WinInfo, SmartId( pTB->GetHelpId(pTB->GetItemId( i )) ), (sal_uInt32)WINDOW_BASE,
 									    aToolBoxItemType.AppendAscii(": ").Append(aName), FALSE );
 							}
 						}
@@ -1106,7 +1106,7 @@
 							break;
 					}
 
-					pRet->GenReturn ( RET_WinInfo, SmartId( aID ), (ULONG)pBD->GetPushButton( pBD->GetButtonId(i) )->GetType(),	// So daß der Text angezeigt wird!
+					pRet->GenReturn ( RET_WinInfo, SmartId( aID ), (sal_uInt32)pBD->GetPushButton( pBD->GetButtonId(i) )->GetType(),	// So daß der Text angezeigt wird!
 						TypeString(pBD->GetPushButton( pBD->GetButtonId(i) )->GetType()).AppendAscii(": ").Append(aName)
 						.AppendAscii(" ButtonId = ").Append(aID), FALSE );
 				}
@@ -1155,10 +1155,10 @@
 							DBG_ERROR1( "Unknown MENUITEM %i", pMenu->GetItemType( i ) );
 						}
 						if ( pMenu->GetItemCommand(nID).Len() || ( nConf & DH_MODE_ALLWIN ) )
-                            pRet->GenReturn ( RET_WinInfo, SmartId( pMenu->GetItemCommand(nID) ), (ULONG)0,
+                            pRet->GenReturn ( RET_WinInfo, SmartId( pMenu->GetItemCommand(nID) ), (sal_uInt32)0,
                                 aMenuItemType.AppendAscii(": ").Append(aName), FALSE );
 						if ( !pMenu->GetItemCommand(nID).Len() || ( nConf & DH_MODE_ALLWIN ) )
-    						pRet->GenReturn ( RET_WinInfo, SmartId( nID ), (ULONG)0,
+    						pRet->GenReturn ( RET_WinInfo, SmartId( nID ), (sal_uInt32)0,
 	    						aMenuItemType.AppendAscii(": ").Append(aName), FALSE );
 					}
 				}
@@ -2684,7 +2684,7 @@
 				else if ( !IsDialog(pWin) )
 					ReportError( GEN_RES_STR0( S_NO_DIALOG_IN_GETACTIVE ) );
 				else
-					pRet->GenReturn( RET_Value, aSmartMethodId, (ULONG)pWin->GetSmartUniqueOrHelpId().GetNum());
+					pRet->GenReturn( RET_Value, aSmartMethodId, static_cast<sal_uInt32>(pWin->GetSmartUniqueOrHelpId().GetNum()));
 			}
 			break;
 		case RC_UseBindings:
@@ -2721,7 +2721,7 @@
 				}
 				else if ( nParams & PARAM_USHORT_1 )
 				{	// Partitioning initialisieren: Profile true [,nNr][,nNr][,nNr][,nNr]
-					ULONG nAnzahl=0;
+					sal_uInt32 nAnzahl=0;
 					if ( nParams & PARAM_USHORT_1 ) { nAnzahl++; };
 					if ( nParams & PARAM_USHORT_2 ) { nAnzahl++; };
 					if ( nParams & PARAM_USHORT_3 ) { nAnzahl++; };
@@ -2733,10 +2733,10 @@
 					pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileReset ), nAnzahl );
 
 					// Und die einzelnen Grenzen
-					if ( nParams & PARAM_USHORT_1 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder1 ), (ULONG)nNr1 ); };
-					if ( nParams & PARAM_USHORT_2 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder2 ), (ULONG)nNr2 ); };
-					if ( nParams & PARAM_USHORT_3 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder3 ), (ULONG)nNr3 ); };
-					if ( nParams & PARAM_USHORT_4 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder4 ), (ULONG)nNr4 ); };
+					if ( nParams & PARAM_USHORT_1 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder1 ), (sal_uInt32)nNr1 ); };
+					if ( nParams & PARAM_USHORT_2 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder2 ), (sal_uInt32)nNr2 ); };
+					if ( nParams & PARAM_USHORT_3 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder3 ), (sal_uInt32)nNr3 ); };
+					if ( nParams & PARAM_USHORT_4 ) { pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileBorder4 ), (sal_uInt32)nNr4 ); };
 
 					pProfiler->StartPartitioning();
 				}
@@ -2772,7 +2772,7 @@
 
 					if ( pProfiler->IsPartitioning() )
 					{
-						pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileDump ), (ULONG)0 );
+						pRet->GenReturn( RET_ProfileInfo, SmartId( S_ProfileDump ), (sal_uInt32)0 );
 						pProfiler->StopPartitioning();
 					}
 
@@ -2900,13 +2900,13 @@
 				{
 					case RC_MenuGetItemCount:
 						{
-							pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)nItemCount );
+							pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)nItemCount );
 						}
 						break;
 					case RC_MenuGetItemId:
 						{
 							if ( ValueOK(aSmartMethodId, RcString( nMethodId ),nNr1,nItemCount) )
-								pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)pMenu->GetItemId(nPhysicalIndex-1) );
+								pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)pMenu->GetItemId(nPhysicalIndex-1) );
 						}
 						break;
 					case RC_MenuGetItemPos:
@@ -2928,7 +2928,7 @@
 									}
 								}
 							}
-							pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)(nLogicalPos+1) );
+							pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)(nLogicalPos+1) );
 						}
 						break;
 					case RC_MenuIsSeperator:
@@ -3231,7 +3231,7 @@
 							if ( FSYS_ERR_OK == nErrorcode )
 							{
 								FileStat aFS( aFile );
-								pRet->GenReturn ( RET_Value, aSmartMethodId, aFS.GetSize() );
+								pRet->GenReturn ( RET_Value, aSmartMethodId, sal_uInt32(aFS.GetSize()) );
 								nErrorcode = aFS.GetError();
 							}
 						}
@@ -3374,7 +3374,7 @@
 						aPointer = Pointer( POINTER_NULL );
 					}
 				}
-				pRet->GenReturn ( RET_Value, aSmartMethodId, (ULONG)aPointer.GetStyle() );
+				pRet->GenReturn ( RET_Value, aSmartMethodId, (sal_uInt32)aPointer.GetStyle() );
 			}
 			break;
 		case RC_UnpackStorage:
@@ -3581,7 +3581,7 @@
 	QueStatement( NULL );
     if ( nControlType == SIControl )
     {
-        ULONG nId;
+        sal_uInt32 nId;
         pCmdIn->Read( nId );
         aUId = SmartId( nId );
     }
@@ -3860,10 +3860,10 @@
 			{
 				Point aPos = pControl->GetPosPixel();
 				aPos = pControl->GET_REAL_PARENT()->OutputToScreenPixel( aPos );
-				pRet->GenReturn ( RET_Value, aUId, (ULONG)aPos.X() );
+				pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)aPos.X() );
 			}
 			else
-				pRet->GenReturn ( RET_Value, aUId, (ULONG)pControl->GetPosPixel().X() );
+				pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pControl->GetPosPixel().X() );
 			break;
 		case M_GetPosY:
 			if ( pControl->GetType() == WINDOW_DOCKINGWINDOW && pControl->GET_REAL_PARENT() && pControl->GET_REAL_PARENT()->GetType() == WINDOW_FLOATINGWINDOW )
@@ -3879,10 +3879,10 @@
 			{
 				Point aPos = pControl->GetPosPixel();
 				aPos = pControl->GET_REAL_PARENT()->OutputToScreenPixel( aPos );
-				pRet->GenReturn ( RET_Value, aUId, (ULONG)aPos.Y() );
+				pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)aPos.Y() );
 			}
 			else
-				pRet->GenReturn ( RET_Value, aUId, (ULONG)pControl->GetPosPixel().Y() );
+				pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pControl->GetPosPixel().Y() );
 			break;
 		case M_GetSizeX:
 			if ( pControl->GetType() == WINDOW_DOCKINGWINDOW && pControl->GET_REAL_PARENT() && pControl->GET_REAL_PARENT()->GetType() == WINDOW_FLOATINGWINDOW )
@@ -3894,7 +3894,7 @@
             if ( (nParams & PARAM_BOOL_1) && bBool1 )
                 pControl = pControl->GetWindow( WINDOW_OVERLAP );
 
-			pRet->GenReturn ( RET_Value, aUId, (ULONG)pControl->GetSizePixel().Width() );
+			pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pControl->GetSizePixel().Width() );
 			break;
 		case M_GetSizeY:
 			if ( pControl->GetType() == WINDOW_DOCKINGWINDOW && pControl->GET_REAL_PARENT() && pControl->GET_REAL_PARENT()->GetType() == WINDOW_FLOATINGWINDOW )
@@ -3906,7 +3906,7 @@
             if ( (nParams & PARAM_BOOL_1) && bBool1 )
                 pControl = pControl->GetWindow( WINDOW_OVERLAP );
 
-			pRet->GenReturn ( RET_Value, aUId, (ULONG)pControl->GetSizePixel().Height() );
+			pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pControl->GetSizePixel().Height() );
 			break;
 		case M_SnapShot:
 			{
@@ -4004,7 +4004,7 @@
 			break;
 		case M_GetRT:
 			{
-				pRet->GenReturn ( RET_Value, aUId, (ULONG)pControl->GetType() );
+				pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pControl->GetType() );
 			}
 			break;
 		case M_TypeKeys:
@@ -4445,13 +4445,13 @@
 						break;
 					case M_StatusGetItemCount:
 						if ( pStatus->AreItemsVisible() )
-							pRet->GenReturn ( RET_Value, aUId, ULONG(pStatus->GetItemCount()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(pStatus->GetItemCount()));
 						else
-							pRet->GenReturn ( RET_Value, aUId, ULONG(0));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(0));
 						break;
 					case M_StatusGetItemId:
 						if ( ValueOK(aUId, MethodString( nMethodId ),nNr1,pStatus->GetItemCount()) )
-							pRet->GenReturn ( RET_Value, aUId, ULONG(pStatus->GetItemId(nNr1-1)));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(pStatus->GetItemId(nNr1-1)));
 						break;
 				}
 			}
@@ -4716,13 +4716,13 @@
 							if ( (nParams & PARAM_USHORT_1) )
 							{
 								if ( ValueOK(aUId, MethodString( nMethodId ),nNr1,((TabControl*)pControl)->GetPageCount() ) )
-									pRet->GenReturn ( RET_Value, aUId, (ULONG)((TabControl*)pControl)->GetPageId(nNr1-1));
+									pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)((TabControl*)pControl)->GetPageId(nNr1-1));
 							}
 							else
-								pRet->GenReturn ( RET_Value, aUId, (ULONG)((TabControl*)pControl)->GetCurPageId());
+								pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)((TabControl*)pControl)->GetCurPageId());
 							break;
 						case M_GetPageCount:
-							pRet->GenReturn ( RET_Value, aUId, (ULONG)((TabControl*)pControl)->GetPageCount());
+							pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)((TabControl*)pControl)->GetPageCount());
 							break;
 						case M_SetPageId:
 							if (((TabControl*)pControl)->GetCurPageId())
@@ -4740,7 +4740,7 @@
 							}
 							break;
 						case M_GetPage:
-							pRet->GenReturn ( RET_Value, aUId, ((TabControl*)pControl)->GetTabPage(((TabControl*)pControl)->GetCurPageId())->GetSmartUniqueOrHelpId().GetNum());
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((TabControl*)pControl)->GetTabPage(((TabControl*)pControl)->GetCurPageId())->GetSmartUniqueOrHelpId().GetNum()));
 							break;
 						case M_SetPage :
 							{		// Wegen lokaler Variablen
@@ -4812,7 +4812,7 @@
 							pRet->GenReturn ( RET_Value, aUId, BOOL( ((TriStateBox*)pControl)->GetState() == STATE_DONTKNOW) );
 							break;
 						case M_GetState :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((TriStateBox*)pControl)->GetState()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((TriStateBox*)pControl)->GetState()));
 							break;
 						case M_Check :
 							((TriStateBox*)pControl)->SetState( STATE_CHECK );
@@ -4900,20 +4900,20 @@
 							AnimateMouse( pControl, MitteOben);
 							break;
 						case M_GetSelCount :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((ListBox*)pControl)->GetSelectEntryCount()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((ListBox*)pControl)->GetSelectEntryCount()));
 							break;
 						case M_GetSelIndex :
 							if ( ! (nParams & PARAM_USHORT_1) )
 							{
 								if ( ((ListBox*)pControl)->GetSelectEntryCount() == 0 )
 								{
-									pRet->GenReturn ( RET_Value, aUId, ULONG(0));
+									pRet->GenReturn ( RET_Value, aUId, sal_uInt32(0));
 									break;
 								}
 								nNr1 = 1;
 							}
 							ValueOK(aUId, MethodString( nMethodId ),nNr1,((ListBox*)pControl)->GetSelectEntryCount());
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((ListBox*)pControl)->GetSelectEntryPos(nNr1-1)) +1);
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((ListBox*)pControl)->GetSelectEntryPos(nNr1-1)) +1);
 							break;
 						case M_GetSelText :
 							if ( ! (nParams & PARAM_USHORT_1) )
@@ -4921,7 +4921,7 @@
 							pRet->GenReturn ( RET_Value, aUId, ((ListBox*)pControl)->GetSelectEntry(nNr1-1));
 							break;
 						case M_GetItemCount :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((ListBox*)pControl)->GetEntryCount()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((ListBox*)pControl)->GetEntryCount()));
 							break;
 						case M_GetItemText :
 							pRet->GenReturn ( RET_Value, aUId, ((ListBox*)pControl)->GetEntry(nNr1-1));
@@ -5011,11 +5011,11 @@
 									nPos = 0;
 								else
 									nPos++;
-								pRet->GenReturn ( RET_Value, aUId, (ULONG) nPos);
+								pRet->GenReturn ( RET_Value, aUId, (sal_uInt32) nPos);
 							}
 							break;
 						case M_GetItemCount :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((ComboBox*)pControl)->GetEntryCount()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((ComboBox*)pControl)->GetEntryCount()));
 							break;
 						case M_GetItemText :
 							pRet->GenReturn ( RET_Value, aUId, ((ComboBox*)pControl)->GetEntry(nNr1-1));
@@ -5393,19 +5393,19 @@
 								        switch (nNr1)
 								        {
 								        case 0:
-									        pRet->GenReturn ( RET_Value, aUId, (ULONG)pTB->GetHelpId(pTB->GetItemId(nItemPos)));
+									        pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pTB->GetHelpId(pTB->GetItemId(nItemPos)));
 									        break;
 								        case 1:
-									        pRet->GenReturn ( RET_Value, aUId, (ULONG)pTB->GetItemType(nItemPos));
+									        pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pTB->GetItemType(nItemPos));
 									        break;
 								        case 2:
-									        pRet->GenReturn ( RET_Value, aUId, (ULONG)pTB->GetItemState(pTB->GetItemId(nItemPos)));
+									        pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pTB->GetItemState(pTB->GetItemId(nItemPos)));
 									        break;
 								        case 3:
-									        pRet->GenReturn ( RET_Value, aUId, (ULONG)pTB->GetItemId(nItemPos));
+									        pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pTB->GetItemId(nItemPos));
 									        break;
 								        default:
-									        pRet->GenReturn ( RET_Value, aUId, ULONG(0));
+									        pRet->GenReturn ( RET_Value, aUId, sal_uInt32(0));
 									        break;
 								        }
 									}
@@ -5418,7 +5418,7 @@
 								pRet->GenReturn ( RET_Value, aUId, (String)pTB->GetText());
 								break;
 							case M_GetItemCount :
-								pRet->GenReturn ( RET_Value, aUId, (ULONG)pTB->GetItemCount());
+								pRet->GenReturn ( RET_Value, aUId, (sal_uInt32)pTB->GetItemCount());
 								break;
 							case M_SetNextToolBox :
 								if ( (nParams & PARAM_STR_1) )
@@ -5508,7 +5508,7 @@
 							}
 							break;
 						case M_GetSelCount :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((SvLBox*)pControl)->GetSelectionCount()));
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((SvLBox*)pControl)->GetSelectionCount()));
 							break;
 						case M_GetSelIndex :
 							if ( ! (nParams & PARAM_USHORT_1) )
@@ -5517,7 +5517,7 @@
 							{
 								nNr1--;
 								COUNT_LBOX( FirstSelected, NextSelected, nNr1);
-								pRet->GenReturn ( RET_Value, aUId, ULONG( ((SvTreeListBox*)pControl)->GetVisiblePos( pThisEntry )) +1 );
+								pRet->GenReturn ( RET_Value, aUId, sal_uInt32( ((SvTreeListBox*)pControl)->GetVisiblePos( pThisEntry )) +1 );
 							}
 							break;
 						case M_GetSelText :
@@ -5535,7 +5535,7 @@
 							}
 							break;
 						case M_GetItemCount :
-							pRet->GenReturn ( RET_Value, aUId, ULONG(((SvLBox*)pControl)->GetVisibleCount()) );
+							pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((SvLBox*)pControl)->GetVisibleCount()) );
 							break;
 						case M_GetItemText :
 							if ( ValueOK(aUId, MethodString( nMethodId ),nNr1,((SvLBox*)pControl)->GetVisibleCount()) )
@@ -5599,7 +5599,7 @@
 												pRet->GenReturn ( RET_Value, aUId, BOOL( pItem->IsStateTristate() ) );
 												break;
 											case M_GetState :
-												pRet->GenReturn ( RET_Value, aUId, ULONG( pItem->GetButtonFlags() & ~SV_STATE_MASK ));
+												pRet->GenReturn ( RET_Value, aUId, sal_uInt32( pItem->GetButtonFlags() & ~SV_STATE_MASK ));
 												break;
 											case M_Check :
                                                 pTree->SetCheckButtonState( pThisEntry, SV_BUTTON_CHECKED );
@@ -5743,7 +5743,7 @@
 											}
 											break;/*
 										case M_GetSelCount :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
-											pRet->GenReturn ( RET_Value, aUId, ULONG(((SvLBox*)pControl)->GetSelectionCount()));
+											pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((SvLBox*)pControl)->GetSelectionCount()));
 											break;
 										case M_GetSelIndex :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
 											if ( ! (nParams & PARAM_USHORT_1) )
@@ -5752,7 +5752,7 @@
 											{
 												nNr1--;
 												COUNT_LBOX( FirstSelected, NextSelected, nNr1);
-												pRet->GenReturn ( RET_Value, aUId, ULONG( ((SvTreeListBox*)pControl)->GetVisiblePos( pThisEntry )) +1 );
+												pRet->GenReturn ( RET_Value, aUId, sal_uInt32( ((SvTreeListBox*)pControl)->GetVisiblePos( pThisEntry )) +1 );
 											}
 											break;
 										case M_GetSelText :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
@@ -5767,7 +5767,7 @@
 											}
 											break;
 										case M_GetItemCount :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
-											pRet->GenReturn ( RET_Value, aUId, ULONG(((SvLBox*)pControl)->GetVisibleCount()) );
+											pRet->GenReturn ( RET_Value, aUId, sal_uInt32(((SvLBox*)pControl)->GetVisibleCount()) );
 											break;
 										case M_GetItemText :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
 											if ( ValueOK(aUId, MethodString( nMethodId ),nNr1,((SvLBox*)pControl)->GetVisibleCount()) )
@@ -5828,7 +5828,7 @@
 																pRet->GenReturn ( RET_Value, aUId, BOOL( pItem->IsStateTristate() ) );
 																break;
 															case M_GetState :
-																pRet->GenReturn ( RET_Value, aUId, ULONG( pItem->GetButtonFlags() & ~SV_STATE_MASK ));
+																pRet->GenReturn ( RET_Value, aUId, sal_uInt32( pItem->GetButtonFlags() & ~SV_STATE_MASK ));
 																break;
 															case M_Check :	// EditBrowseBox wird angenommen! (Das kann ja nur schief gehen)
 																pItem->SetStateChecked();
@@ -5860,7 +5860,7 @@
 									    switch ( nMethodId )
 									    {
                                         case M_GetItemCount:
-											pRet->GenReturn ( RET_Value, aUId, ULONG( pVS->GetItemCount()));
+											pRet->GenReturn ( RET_Value, aUId, sal_uInt32( pVS->GetItemCount()));
                                             break;
                                         case M_GetItemText:
     										if ( ValueOK( aUId, MethodString( nMethodId ), nNr1, pVS->GetItemCount() ))
@@ -5872,9 +5872,9 @@
                                             break;
 						                case M_GetSelIndex :
 								            if ( pVS->IsNoSelection() )
-									            pRet->GenReturn ( RET_Value, aUId, ULONG(0));
+									            pRet->GenReturn ( RET_Value, aUId, sal_uInt32(0));
                                             else
-        							            pRet->GenReturn ( RET_Value, aUId, ULONG( pVS->GetItemPos( pVS->GetSelectItemId() ) +1));
+        							            pRet->GenReturn ( RET_Value, aUId, sal_uInt32( pVS->GetItemPos( pVS->GetSelectItemId() ) +1));
 							                break;
 						                case M_GetSelText :
 								            if ( pVS->IsNoSelection() )
@@ -6312,11 +6312,11 @@
 									ReportError( aUId, GEN_RES_STR1( S_BUTTONID_REQUIRED, MethodString( nMethodId ) ) );
 								break;
 							case M_GetButtonCount :
-								pRet->GenReturn ( RET_Value, aUId, ULONG(pBD->GetButtonCount()));
+								pRet->GenReturn ( RET_Value, aUId, sal_uInt32(pBD->GetButtonCount()));
 								break;
 							case M_GetButtonId :
 								if ( ValueOK(aUId, MethodString( nMethodId ),nNr1,pBD->GetButtonCount()) )
-									pRet->GenReturn ( RET_Value, aUId, ULONG(pBD->GetButtonId(nNr1-1)));
+									pRet->GenReturn ( RET_Value, aUId, sal_uInt32(pBD->GetButtonId(nNr1-1)));
 								break;
 							default:
 								ReportError( aUId, GEN_RES_STR2c2( S_UNKNOWN_METHOD, MethodString(nMethodId), "MessageBox" ) );
Index: source/server/statemnt.hxx
===================================================================
RCS file: /cvs/util/automation/source/server/statemnt.hxx,v
retrieving revision 1.12
diff -u -r1.12 statemnt.hxx
--- automation/source/server/statemnt.hxx	7 Sep 2005 19:27:32 -0000	1.12
+++ automation/source/server/statemnt.hxx	14 Mar 2006 19:05:55 -0000
@@ -364,7 +364,7 @@
     SmartId aSmartMethodId;
 	USHORT nParams;
 	USHORT nNr1,nNr2,nNr3,nNr4;
-	ULONG nLNr1;
+	sal_uInt32 nLNr1;
 	String aString1,aString2;
 	BOOL bBool1,bBool2;
 
@@ -402,7 +402,7 @@
 	USHORT nMethodId;
 	USHORT nParams;
 	USHORT nNr1,nNr2,nNr3,nNr4;
-	ULONG nLNr1;
+	sal_uInt32 nLNr1;
 	String aString1,aString2;
 	BOOL bBool1,bBool2;
 	BOOL ControlOK( Window *pControl, const sal_Char* aBezeichnung );
@@ -426,7 +426,7 @@
 
 	USHORT nParams;
 	USHORT nSNr1;
-	ULONG nLNr1;
+	sal_uInt32 nLNr1;
 	String aString1;
 	BOOL bBool1;
 
Index: source/server/svcommstream.cxx
===================================================================
RCS file: /cvs/util/automation/source/server/svcommstream.cxx,v
retrieving revision 1.2
diff -u -r1.2 svcommstream.cxx
--- automation/source/server/svcommstream.cxx	7 Sep 2005 19:27:48 -0000	1.2
+++ automation/source/server/svcommstream.cxx	14 Mar 2006 19:05:55 -0000
@@ -38,12 +38,12 @@
 SvCommStream::SvCommStream( SvStream* pIO ) { pStream = pIO; }
 SvCommStream::~SvCommStream() {}
 
-ICommStream& SvCommStream::operator>>( USHORT& rUShort ) { *pStream >> rUShort; return *this; }
-ICommStream& SvCommStream::operator>>( ULONG& rULong ) { *pStream >> rULong; return *this; }
+ICommStream& SvCommStream::operator>>( sal_uInt16& rUShort ) { *pStream >> rUShort; return *this; }
+ICommStream& SvCommStream::operator>>( sal_uInt32& rULong ) { *pStream >> rULong; return *this; }
 ICommStream& SvCommStream::operator>>( unsigned char& rChar ) { *pStream >> rChar; return *this; }
 
-ICommStream& SvCommStream::operator<<( USHORT nUShort ) { *pStream << nUShort; return *this; }
-ICommStream& SvCommStream::operator<<( ULONG nULong ) { *pStream << nULong; return *this; }
+ICommStream& SvCommStream::operator<<( sal_uInt16 nUShort ) { *pStream << nUShort; return *this; }
+ICommStream& SvCommStream::operator<<( sal_uInt32 nULong ) { *pStream << nULong; return *this; }
 ICommStream& SvCommStream::operator<<( unsigned char nChar ) { *pStream << nChar; return *this; }
 
 ULONG SvCommStream::Read( void* pData, ULONG nSize ) { return pStream->Read( pData, nSize ); }
Index: source/testtool/cmdstrm.cxx
===================================================================
RCS file: /cvs/util/automation/source/testtool/cmdstrm.cxx,v
retrieving revision 1.6
diff -u -r1.6 cmdstrm.cxx
--- automation/source/testtool/cmdstrm.cxx	7 Sep 2005 19:30:06 -0000	1.6
+++ automation/source/testtool/cmdstrm.cxx	14 Mar 2006 19:05:56 -0000
@@ -172,8 +172,8 @@
 void CmdStream::WriteSortedParams( SbxArray* rPar, BOOL IsKeyString )
 {
 	USHORT nParams = PARAM_NONE;
-	USHORT nNr1,nNr2,nNr3,nNr4;
-	ULONG nLNr1;
+	comm_USHORT nNr1,nNr2,nNr3,nNr4;
+	comm_ULONG nLNr1;
 	String aString1,aString2;
 	BOOL bBool1,bBool2;
 
@@ -398,7 +398,7 @@
     Write( aURL );			// Die UNO URL eben
 }
 
-void CmdStream::GenCmdControl( ULONG nUId, USHORT nMethodId, SbxArray* rPar )
+void CmdStream::GenCmdControl( comm_ULONG nUId, USHORT nMethodId, SbxArray* rPar )
 {
 	Write(USHORT(SIControl));
 	Write(nUId);
@@ -429,7 +429,7 @@
 	Write(nNr1);
 }
 
-void CmdStream::GenCmdFlow( USHORT nArt, ULONG nNr1 )
+void CmdStream::GenCmdFlow( USHORT nArt, comm_ULONG nNr1 )
 {
 	Write(USHORT(SIFlow));
 	Write(nArt);
@@ -458,7 +458,7 @@
 	return pSammel;
 }
 
-void CmdStream::Reset( ULONG nSequence )
+void CmdStream::Reset( comm_ULONG nSequence )
 {
 	delete pCommStream;
 	delete pSammel;
Index: source/testtool/cmdstrm.hxx
===================================================================
RCS file: /cvs/util/automation/source/testtool/cmdstrm.hxx,v
retrieving revision 1.2
diff -u -r1.2 cmdstrm.hxx
--- automation/source/testtool/cmdstrm.hxx	7 Sep 2005 19:30:21 -0000	1.2
+++ automation/source/testtool/cmdstrm.hxx	14 Mar 2006 19:05:56 -0000
@@ -53,7 +53,7 @@
 
 	void GenCmdUNOSlot( const String &aURL );
 
-	void GenCmdControl( ULONG nUId, USHORT nMethodId, SbxArray* rPar );
+	void GenCmdControl( comm_ULONG nUId, USHORT nMethodId, SbxArray* rPar );
     void GenCmdControl( String aUId, USHORT nMethodId, SbxArray* rPar ); 
 
 /*	void GenCmdControl (ULONG nUId, USHORT nMethodId = 0);
@@ -63,15 +63,15 @@
 	void GenCmdControl (ULONG nUId, USHORT nMethodId, USHORT nNr);
 	void GenCmdControl (ULONG nUId, USHORT nMethodId, USHORT nNr1, USHORT nNr2);
 	void GenCmdControl (ULONG nUId, USHORT nMethodId, USHORT nNr, BOOL bBool);
-	void GenCmdControl (ULONG nUId, USHORT nMethodId, ULONG nNr);
+	void GenCmdControl (ULONG nUId, USHORT nMethodId, comm_ULONG nNr);
 	void GenCmdControl (ULONG nUId, USHORT nMethodId, BOOL bBool);*/
 
 	void GenCmdFlow( USHORT nArt );
 	void GenCmdFlow( USHORT nArt, USHORT nNr1 );
-	void GenCmdFlow( USHORT nArt, ULONG nNr1 );
+	void GenCmdFlow( USHORT nArt, comm_ULONG nNr1 );
 	void GenCmdFlow( USHORT nArt, String aString1 );
 
-	void Reset(ULONG nSequence);
+	void Reset(comm_ULONG nSequence);
 
 	SvMemoryStream* GetStream();
 
Index: source/testtool/objtest.cxx
===================================================================
RCS file: /cvs/util/automation/source/testtool/objtest.cxx,v
retrieving revision 1.20
diff -u -r1.20 objtest.cxx
--- automation/source/testtool/objtest.cxx	6 Oct 2005 12:37:43 -0000	1.20
+++ automation/source/testtool/objtest.cxx	14 Mar 2006 19:06:00 -0000
@@ -256,7 +256,7 @@
 	if ( pData->aUId.HasString() )
     	aStream.WriteByteString( pData->aUId.GetStr(), RTL_TEXTENCODING_UTF8 );
 	else
-    	aStream << pData->aUId.GetNum();
+    	aStream << static_cast<sal_uInt32>(pData->aUId.GetNum());
 	if ( pSons )
         for ( int i = 0 ; pSons->Count() > i ; i++ )
     		((ControlDef*)(*pSons)[i])->Write(aStream);
@@ -1466,7 +1466,7 @@
         }
 	    else
         {
-        	ULONG nUId;
+        	sal_uInt32 nUId;
     	    aStream >> nUId;
             aUId = SmartId( nUId );
         }
@@ -3259,14 +3259,14 @@
             }
             else
             {
-        		ULONG nUId;
+        		sal_uInt32 nUId;
     		    pRetStream->Read( nUId );         // bei Sequence einfach die Sequence
                 aUId = SmartId( nUId );
             }
     		pRetStream->Read(nParams);
 
     		USHORT nNr1 = 0;
-    		ULONG nLNr1 = 0;
+    		sal_uInt32 nLNr1 = 0;
     		String aString1;
     		BOOL bBool1 = FALSE;
     		SbxValueRef xValue1 = new SbxValue;
@@ -3856,7 +3856,7 @@
             }
             else
             {
-        		ULONG nUId;
+        		sal_uInt32 nUId;
     		    pRetStream->Read( nUId );         // bei Sequence einfach die Sequence
                 aUId = SmartId( nUId );
             }
