cvs server: Diffing svx
cvs server: Diffing svx/inc
Index: svx/inc/dialogs.hrc
===================================================================
RCS file: /cvs/graphics/svx/inc/dialogs.hrc,v
retrieving revision 1.48
diff -u -r1.48 dialogs.hrc
--- svx/inc/dialogs.hrc	17 Apr 2003 17:39:50 -0000	1.48
+++ svx/inc/dialogs.hrc	17 Aug 2003 16:31:10 -0000
@@ -248,6 +248,8 @@
 
 // fuer ToolboxControl-Style
 #define RID_SVXTBX_STYLE                    (RID_SVX_START + 120)
+// for Zoom Toolbox Control
+#define RID_SVXTBX_ZOOM						(RID_SVX_START + 121)
 
 #define RID_SVXDLG_HYPERLINK                (RID_SVX_START + 140)
 #define RID_SVXDLG_PASSWORD					(RID_SVX_START + 141)
Index: svx/inc/helpid.hrc
===================================================================
RCS file: /cvs/graphics/svx/inc/helpid.hrc,v
retrieving revision 1.38
diff -u -r1.38 helpid.hrc
--- svx/inc/helpid.hrc	30 Apr 2003 08:23:57 -0000	1.38
+++ svx/inc/helpid.hrc	17 Aug 2003 16:31:26 -0000
@@ -526,6 +526,7 @@
 #define HID_HANGULDLG_BUTTON_CHANGEALL          (HID_SVX_EXT0_START + 25)
 #define HID_SPLDLG_EDIT_NEWWORD                 (HID_SVX_EXT0_START + 26)
 #define HID_HANGULDLG_EDIT_NEWWORD              (HID_SVX_EXT0_START + 27)
+#define HID_ZOOM_COMBOBOX						(HID_SVX_EXT0_START + 28)
 
 
 // -----------------------------------------------------------------------
@@ -540,7 +541,7 @@
 
 // overrun check 2
 
-#define ACT_SVX_HID_END2 HID_OPTIONS_CTL
+#define ACT_SVX_HID_END2 HID_ZOOM_COMBOBOX
 
 #if ACT_SVX_HID2_END > HID_SVX_EXT0_END
 #error resource overrun in #line, #file
Index: svx/source/tbxctrls/makefile.mk
===================================================================
RCS file: /cvs/graphics/svx/source/tbxctrls/makefile.mk,v
retrieving revision 1.4
diff -u -r1.4 makefile.mk
--- svx/source/tbxctrls/makefile.mk	2 May 2001 12:17:05 -0000	1.4
+++ svx/source/tbxctrls/makefile.mk	17 Aug 2003 16:31:32 -0000
@@ -102,7 +102,8 @@
 		$(SLO)$/tbxalign.obj	\
 		$(SLO)$/tbxdraw.obj		\
         $(SLO)$/tbxdrctl.obj    \
-        $(SLO)$/verttexttbxctrl.obj
+		$(SLO)$/verttexttbxctrl.obj	\
+		$(SLO)$/zoomtbxctrl.obj
 
 SRCFILES = \
 		colrctrl.src			\
Index: svx/source/tbxctrls/tbcontrl.src
===================================================================
RCS file: /cvs/graphics/svx/source/tbxctrls/tbcontrl.src,v
retrieving revision 1.35
diff -u -r1.35 tbcontrl.src
--- svx/source/tbxctrls/tbcontrl.src	17 Jul 2003 11:33:35 -0000	1.35
+++ svx/source/tbxctrls/tbcontrl.src	17 Aug 2003 16:31:38 -0000
@@ -263,6 +263,16 @@
 	Border = TRUE ;
 	Hide = TRUE ;
 };
+ComboBox RID_SVXTBX_ZOOM
+{
+	HelpId = HID_ZOOM_COMBOBOX ;
+	Size = MAP_APPFONT ( 30 , 86 ) ;
+	DropDown = TRUE ;
+	AutoHScroll = TRUE ;
+	DDExtraWidth = TRUE ;
+	Border = TRUE ;
+	Hide = TRUE ;
+};
 String RID_SVXSTR_EXTRAS_CHARBACKGROUND
 {
 	Text = "Zeichenhintergrund" ;

--- /dev/null	2003-02-11 15:36:20.000000000 +0100
+++ svx/inc/zoomtbxctrl.hxx	2003-08-17 18:25:11.000000000 +0200
@@ -0,0 +1,83 @@
+/*************************************************************************
+ *
+ *	$RCSfile: zoom-combobox.diff,v $
+ *
+ *	$Revision: 1.3 $
+ *
+ *	last change: $Author: mkretzschmar $ $Date: 2003/08/17 17:45:54 $
+ *
+ *	The Contents of this file are made available subject to the terms of
+ *	either of the following licenses
+ *
+ *		   - GNU Lesser General Public License Version 2.1
+ *		   - Sun Industry Standards Source License Version 1.1
+ *
+ *	Sun Microsystems Inc., October, 2000
+ *
+ *	GNU Lesser General Public License Version 2.1
+ *	=============================================
+ *	Copyright 2000 by Sun Microsystems, Inc.
+ *	901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *	This library is free software; you can redistribute it and/or
+ *	modify it under the terms of the GNU Lesser General Public
+ *	License version 2.1, as published by the Free Software Foundation.
+ *
+ *	This library is distributed in the hope that it will be useful,
+ *	but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *	Lesser General Public License for more details.
+ *
+ *	You should have received a copy of the GNU Lesser General Public
+ *	License along with this library; if not, write to the Free Software
+ *	Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *	MA	02111-1307	USA
+ *
+ *
+ *	Sun Industry Standards Source License Version 1.1
+ *	=================================================
+ *	The contents of this file are subject to the Sun Industry Standards
+ *	Source License Version 1.1 (the "License"); You may not use this file
+ *	except in compliance with the License. You may obtain a copy of the
+ *	License at http://www.openoffice.org/license.html.
+ *
+ *	Software provided under this License is provided on an "AS IS" basis,
+ *	WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *	WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *	MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *	See the License for the specific provisions governing your rights and
+ *	obligations concerning the Software.
+ *
+ *	The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *	Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *	All Rights Reserved.
+ *
+ *	Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+#ifndef _SVX_ZOOMTBXCTRL_HXX
+#define _SVX_ZOOMTBXCTRL_HXX
+
+#ifndef _SFXTBXCTRL_HXX
+#include <sfx2/tbxctrl.hxx>
+#endif
+
+class SvxZoomToolBoxControl : public SfxToolBoxControl
+{
+public:
+	SFX_DECL_TOOLBOX_CONTROL();
+
+	SvxZoomToolBoxControl( USHORT nId, ToolBox& rTbx, SfxBindings& rBindings );
+	~SvxZoomToolBoxControl();
+
+	virtual void	StateChanged( USHORT nSID,
+								  SfxItemState eState,
+								  const SfxPoolItem* pState );
+
+	virtual Window*	CreateItemWindow( Window *pParent );
+};
+
+#endif // _SVX_ZOOMTBXCTRL_HXX

--- /dev/null	2003-02-11 15:36:20.000000000 +0100
+++ svx/source/tbxctrls/zoomtbxctrl.cxx	2003-08-17 18:27:29.000000000 +0200
@@ -0,0 +1,236 @@
+/*************************************************************************
+ *
+ *  $RCSfile: zoom-combobox.diff,v $
+ *
+ *  $Revision: 1.3 $
+ *
+ *  last change: $Author: mkretzschmar $ $Date: 2003/08/17 17:45:54 $
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include <string> // HACK: prevent conflict between STLPORT and Workshop headers
+
+#ifndef _SV_TOOLBOX_HXX
+#include <vcl/toolbox.hxx>
+#endif
+#ifndef _SFXAPP_HXX
+#include <sfx2/app.hxx>
+#endif
+#ifndef _SFXDISPATCH_HXX
+#include <sfx2/dispatch.hxx>
+#endif
+#ifndef _SFXVIEWSH_HXX
+#include <sfx2/viewsh.hxx>
+#endif
+#ifndef _SV_COMBOBOX_HXX
+#include <vcl/combobox.hxx>
+#endif
+
+#include "dialogs.hrc"
+
+#include "zoomtbxctrl.hxx"
+#include "zoomitem.hxx"
+#include "dialmgr.hxx"
+
+#define MINZOOM 20
+#define MAXZOOM 600
+
+SFX_IMPL_TOOLBOX_CONTROL( SvxZoomToolBoxControl, SvxZoomItem);
+
+class SvxZoomBox_Impl : public ComboBox
+{
+	USHORT			nSlotId;
+	SfxBindings&	rBindings;
+	BOOL			bRelease;
+public:
+	SvxZoomBox_Impl( Window* pParent, USHORT nSlot, SfxBindings& rBind );
+	~SvxZoomBox_Impl();
+
+protected:
+	virtual void	Select();
+	virtual long	Notify( NotifyEvent& rNEvt );
+
+	void ReleaseFocus();
+
+};
+
+SvxZoomBox_Impl::SvxZoomBox_Impl( Window* pParent, USHORT nSlot, SfxBindings& rBind ):
+	ComboBox(pParent, SVX_RES(RID_SVXTBX_ZOOM)),
+	nSlotId(nSlot),
+	rBindings(rBind),
+	bRelease(TRUE)
+{
+	EnableAutocomplete( FALSE );
+	USHORT aZoomValues[] =
+	{	25, 50, 75, 100, 150, 200 };
+	for(USHORT i = 0; i < sizeof(aZoomValues)/sizeof(USHORT); i++)
+	{
+	String sEntry = String::CreateFromInt32(aZoomValues[i]);
+	sEntry += '%';
+	InsertEntry(sEntry);
+	}
+}
+
+SvxZoomBox_Impl::~SvxZoomBox_Impl()
+{}
+
+void SvxZoomBox_Impl::Select()
+{
+	if ( !IsTravelSelect() )
+	{
+	String sEntry( GetText() );
+	sEntry.EraseAllChars( '%' );
+	USHORT nZoom = (USHORT)sEntry.ToInt32();
+
+	if( nZoom < MINZOOM )
+		nZoom = MINZOOM;
+	if( nZoom > MAXZOOM )
+		nZoom = MAXZOOM;
+
+	SvxZoomItem aItem( SVX_ZOOM_PERCENT, nZoom, nSlotId );
+	rBindings.GetDispatcher()->Execute(
+		nSlotId, SFX_CALLMODE_SYNCHRON | SFX_CALLMODE_RECORD, &aItem, 0L );
+
+	ReleaseFocus();
+	}
+}
+
+long SvxZoomBox_Impl::Notify( NotifyEvent& rNEvt )
+{
+	long nHandled = 0;
+
+	if ( rNEvt.GetType() == EVENT_KEYINPUT )
+	{
+	USHORT nCode = rNEvt.GetKeyEvent()->GetKeyCode().GetCode();
+
+	switch ( nCode )
+	{
+		case KEY_RETURN:
+		case KEY_TAB:
+		{
+		if ( KEY_TAB == nCode )
+			bRelease = FALSE;
+		else
+			nHandled = 1;
+		Select();
+		break;
+		}
+
+		case KEY_ESCAPE:
+		SetText( GetSavedValue() );
+		ReleaseFocus();
+		break;
+	}
+	}
+	else if ( EVENT_LOSEFOCUS == rNEvt.GetType() )
+	{
+	Window* pFocusWin = Application::GetFocusWindow();
+	if ( !HasFocus() && GetSubEdit() != pFocusWin )
+		SetText( GetSavedValue() );
+	}
+
+	return nHandled ? nHandled : ComboBox::Notify( rNEvt );
+}
+
+void SvxZoomBox_Impl::ReleaseFocus()
+{
+	if ( !bRelease )
+	{
+	bRelease = TRUE;
+	return;
+	}
+	SfxViewShell* pCurSh = SfxViewShell::Current();
+
+	if ( pCurSh )
+	{
+	Window* pShellWnd = pCurSh->GetWindow();
+
+	if ( pShellWnd )
+		pShellWnd->GrabFocus();
+	}
+}
+
+SvxZoomToolBoxControl::SvxZoomToolBoxControl( USHORT nId,
+											  ToolBox& rTbx,
+											  SfxBindings& rBind ) :
+	SfxToolBoxControl( nId, rTbx, rBind )
+{
+}
+
+SvxZoomToolBoxControl::~SvxZoomToolBoxControl()
+{
+}
+
+void SvxZoomToolBoxControl::StateChanged( USHORT nSID,
+										  SfxItemState eState,
+										  const SfxPoolItem* pState )
+{
+	USHORT nId = GetId();
+	GetToolBox().EnableItem( nId, (GetItemState( pState ) != SFX_ITEM_DISABLED) );
+	SvxZoomBox_Impl* pBox = (SvxZoomBox_Impl*)GetToolBox().GetItemWindow( GetId() );
+
+	if( SFX_ITEM_AVAILABLE <= eState )
+	{
+	String sZoom( String::CreateFromInt32( ((const SfxUInt16Item*)pState)->GetValue() ) );
+	sZoom += '%';
+	pBox->SetText( sZoom );
+	pBox->SaveValue();
+	}
+}
+
+Window* SvxZoomToolBoxControl::CreateItemWindow( Window *pParent )
+{
+	SvxZoomBox_Impl* pRet = new SvxZoomBox_Impl( pParent, GetId(), GetBindings() );
+	return pRet;
+}
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/inc/cmdid.h sw/inc/cmdid.h
--- sw/inc/cmdid.h	2003-06-03 19:04:09.000000000 +0200
+++ sw/inc/cmdid.h	2003-08-13 22:46:10.000000000 +0200
@@ -352,6 +352,8 @@
 #define FN_HSCROLL_METRIC        (FN_VIEW + 53) /* Metric horizontal scrollbar */
 #define FN_VSCROLL_METRIC        (FN_VIEW + 54) /* Metric vertical scrollbar */
 
+#define FN_WRITER_ZOOM		(FN_VIEW + 55)
+
 /*--------------------------------------------------------------------
 	Bereich: Einfuegen
  --------------------------------------------------------------------*/
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/sdi/swriter.sdi sw/sdi/swriter.sdi
--- sw/sdi/swriter.sdi	2003-06-03 19:04:12.000000000 +0200
+++ sw/sdi/swriter.sdi	2003-08-13 22:47:37.000000000 +0200
@@ -6622,6 +6622,34 @@
 ]
 
 //--------------------------------------------------------------------------
+SfxVoidItem WriterZoom FN_WRITER_ZOOM
+()
+[
+	/* flags: */
+	AutoUpdate = FALSE,
+	Cachable = Cachable,
+	FastCall = TRUE,
+	HasCoreId = FALSE,
+	HasDialog = TRUE,
+	ReadOnlyDoc = TRUE,
+	Toggle = FALSE,
+	Container = FALSE,
+	RecordAbsolute = FALSE,
+	RecordPerSet;
+	Synchron;
+
+	/* status: */
+	SlotType = SvxZoomItem
+
+	/* config: */
+	AccelConfig = FALSE,
+	MenuConfig = FALSE,
+	StatusBarConfig = FALSE,
+	ToolBoxConfig = TRUE,
+	GroupId = GID_VIEW;
+]
+
+//--------------------------------------------------------------------------
 SfxBoolItem PrintLayout FN_PRINT_LAYOUT
 
 [
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/sdi/swslots.src sw/sdi/swslots.src
--- sw/sdi/swslots.src	2003-07-21 16:50:16.000000000 +0200
+++ sw/sdi/swslots.src	2003-08-14 20:57:32.000000000 +0200
@@ -7339,6 +7339,21 @@
 	SlotName[ hebrew ] = "â€®×–×•× ×ª×¦×•×’×” ×ž×§×“×™×ž×”â€¬";
 	SlotName[ hindi ] = "à¤ªà¥‚à¤°à¥à¤µà¤¦à¥ƒà¤¶à¥à¤¯ à¤à¥‚à¤®";
 	SlotName[ slovak ] = "MerÃ­tko NÃ¡hÄ¾adu";
+};
+SfxSlotInfo FN_WRITER_ZOOM
+{
+	SlotName = "Maßstab";
+	SlotName [ english ] =	"Zoom";
+	SlotName[ english_us ] = "Zoom";
+	SlotName[ portuguese ] = "Zoom";
+	SlotName[ dutch ] = "Zoom";
+	SlotName[ french ] = "Échelle";
+	SlotName[ spanish ] = "Escala";
+	SlotName[ italian ] = "Zoom";
+	SlotName[ danish ] = "Målestok";
+	SlotName[ swedish ] = "Skala";
+	SlotName[ portuguese_brazilian ] = "Zoom";
+	SlotName[ catalan ] = "Escala";
 };
 SfxSlotInfo FN_PRINT_LAYOUT
 {
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/sdi/_viewsh.sdi sw/sdi/_viewsh.sdi
--- sw/sdi/_viewsh.sdi	2003-04-17 19:49:05.000000000 +0200
+++ sw/sdi/_viewsh.sdi	2003-08-13 22:51:21.000000000 +0200
@@ -555,6 +555,11 @@
         ExecMethod = Execute ;
         DisableFlags="SW_DISABLE_ON_MAILBOX_EDITOR";
     ]
+	FN_WRITER_ZOOM
+	[
+		ExecMethod = Execute ;
+		StateMethod = GetState ;
+	]
 }
 
 interface GlobalContents : Collection
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/source/ui/app/swmodule.cxx sw/source/ui/app/swmodule.cxx
--- sw/source/ui/app/swmodule.cxx	2003-07-07 18:10:23.000000000 +0200
+++ sw/source/ui/app/swmodule.cxx	2003-08-13 22:52:29.000000000 +0200
@@ -577,6 +577,7 @@
 
 	SwZoomControl::RegisterControl(SID_ATTR_ZOOM, pMod );
     SwPreviewZoomControl::RegisterControl(FN_PREVIEW_ZOOM, pMod);
+	SvxZoomToolBoxControl::RegisterControl(FN_WRITER_ZOOM, pMod);
 	SwHyperlinkControl::RegisterControl(FN_STAT_HYPERLINKS, pMod );
 	SvxPosSizeStatusBarControl::RegisterControl(0, pMod );
 	SvxInsertStatusBarControl::RegisterControl(0, pMod );
Index: sw/source/ui/inc/toolbox.hrc
This ugly hack (zoom as part of text background buttons) will go away soon
===================================================================
RCS file: /cvs/sw/sw/source/ui/inc/toolbox.hrc,v
retrieving revision 1.33
diff -u -r1.33 toolbox.hrc
--- sw/source/ui/inc/toolbox.hrc	17 Jul 2003 11:58:21 -0000	1.33
+++ sw/source/ui/inc/toolbox.hrc	15 Aug 2003 10:07:36 -0000
@@ -347,6 +347,11 @@
 		Text[ hebrew ] = "Absatzhintergrund";\
 		Text[ hindi ] = "à¤ªà¤°à¤¿à¤šà¥à¤›à¥‡à¤¦ à¤ªà¥ƒà¤·à¥à¤ à¤­à¤¾à¤—";\
 		Text[ slovak ] = "Pozadie odstavca";\
+	};\
+	ToolBoxItem\
+	{\
+		Identifier = FN_WRITER_ZOOM ; \
+		HelpID = FN_WRITER_ZOOM ; \
 	};
 
 #define MN_TEXT_DIALOGS(HIDE)\
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/source/ui/uiview/view2.cxx sw/source/ui/uiview/view2.cxx
--- sw/source/ui/uiview/view2.cxx	2003-04-17 17:50:02.000000000 +0200
+++ sw/source/ui/uiview/view2.cxx	2003-08-14 19:28:35.000000000 +0200
@@ -840,6 +840,17 @@
             GenerateFormLetter(bUseCurrentDocument);
         }
         break;
+		case FN_WRITER_ZOOM:
+		{
+			if( pArgs &&
+				SFX_ITEM_SET == pArgs->GetItemState(FN_WRITER_ZOOM, TRUE, &pItem) )
+			{
+				USHORT nZoomFactor = ((const SfxUInt16Item *)pItem)->GetValue();
+
+				SetZoom(SVX_ZOOM_PERCENT, nZoomFactor);
+			}
+		}
+		break;
         default:
 			ASSERT(!this, falscher Dispatcher);
 			return;
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/source/ui/uiview/viewport.cxx sw/source/ui/uiview/viewport.cxx
--- sw/source/ui/uiview/viewport.cxx	2003-04-17 17:51:29.000000000 +0200
+++ sw/source/ui/uiview/viewport.cxx	2003-08-14 19:50:57.000000000 +0200
@@ -908,6 +908,7 @@
 	}
 	SetVisArea( aRect );
 	GetViewFrame()->GetBindings().Invalidate( SID_ATTR_ZOOM );
+	GetViewFrame()->GetBindings().Invalidate( FN_WRITER_ZOOM );
 }
 
 /*--------------------------------------------------------------------
diff -Nur -x CVS -x unxlngi4.pro -x '*.bmp' -x ooo-convert-stamp sw/source/ui/uiview/viewstat.cxx sw/source/ui/uiview/viewstat.cxx
--- sw/source/ui/uiview/viewstat.cxx	2003-04-17 19:51:41.000000000 +0200
+++ sw/source/ui/uiview/viewstat.cxx	2003-08-14 20:23:40.000000000 +0200
@@ -457,6 +457,12 @@
                 if(!bInMailMerge && !GetViewFrame()->HasChildWindow(nWhich))
                     rSet.DisableItem(nWhich);
             break;
+			case FN_WRITER_ZOOM :
+			{
+				const SwViewOption* pVOpt = pWrtShell->GetViewOptions();
+				rSet.Put(SfxUInt16Item(nWhich, pVOpt->GetZoom()));
+			}
+			break;
         }
         nWhich = aIter.NextWhich();
 	}


