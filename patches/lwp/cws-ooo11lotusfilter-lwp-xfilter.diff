diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfattrlist.hxx lotuswordpro/source/filter/xfilter/ixfattrlist.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfattrlist.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfattrlist.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,90 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interface for the attibute list of a xml element.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23  create this file.
+ ************************************************************************/
+#ifndef		_IXFATTRLIST_HXX
+#define		_IXFATTRLIST_HXX
+
+#include	<rtl/ustring.hxx>
+
+/**
+ * @brief
+ * Attribute list interface for sax writer.
+ * Implemente this interface for different sax writer. For OOo,i use the XDocumentHandler stream;
+ * for ouputting the local file system,It's just a vector container.
+ */
+class	IXFAttrList
+{
+public:
+	virtual ~IXFAttrList(){}
+	/**
+	 * @descr:	Add a attribute to the attribute list.
+	 */
+	virtual void	AddAttribute(const rtl::OUString& name, const rtl::OUString& value) = 0;
+
+	/**
+	 * @descr:	Clear all the attributes in the attribute list.
+	 */
+	virtual void	Clear() = 0;
+};
+
+#endif	//_IXFATTRLIST_HXX
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfcontent.hxx lotuswordpro/source/filter/xfilter/ixfcontent.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfcontent.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfcontent.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,102 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interface for the all content object,ie. text,paragraph,picture,and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ * 2005-04-08 add clone function.
+ ************************************************************************/
+#ifndef		_IXFCONTENT_HXX
+#define		_IXFCONTENT_HXX
+
+#include	"xfglobal.hxx"
+
+class IXFStyle;
+
+/**
+ * @brief Base interface for all content object.Implementation classes include text span,paragraph,
+	Drawing obejcts, image, ole and so on.
+ */
+class IXFContent : public IXFObject
+{
+public:
+	virtual ~IXFContent(){}
+	/**
+	 * @descr	Fetch the content type,not quite useful.
+	 */
+	virtual enumXFContent	GetContentType() = 0;
+
+	/**
+	 * @descr	Set style to apply. You can get the style name by use XFStyleManager::AddStyle(pStyle),
+	 *			or just set a fixed style name.
+	 */
+	virtual void			SetStyleName(rtl::OUString style) = 0;
+
+	/**
+	 * @descr	return the style name.
+	 */
+	virtual rtl::OUString	GetStyleName() = 0;
+
+	/**
+	 * @descr	Deep copy.
+	 */
+	virtual IXFContent*		Clone() = 0;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfobject.hxx lotuswordpro/source/filter/xfilter/ixfobject.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfobject.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfobject.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,91 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interfer face for all object that will responsible for xml element output
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		IXFOBJECT_INC
+#define		IXFOBJECT_INC
+
+class IXFStream;
+/*************************************************************************
+ * @descr
+ * This is the root interface for all object which will ouput something to
+ * the Sax Stream.
+ * I'll add reference management code later.
+ ************************************************************************/
+class IXFObject 
+{ 	  	
+public:
+	/**
+	 * Virtual destructure function for all class,This makes the XFilter module
+	 * a single-root framework.
+	 */
+	virtual ~IXFObject(){}
+
+	/**
+	 * The funciton to serial the object to the sax stream.
+	 * The objects that must implements ToXml is divided into two types:
+	 *			1.	IXFStyle objects that has something to do with styles.
+	 *			2.	IXFContent objects that contents text or picture.
+	 */
+	virtual void	ToXml(IXFStream		*pSaxStream) = 0;
+};
+
+#endif //IXFOBJECT_INC
diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfproperty.hxx lotuswordpro/source/filter/xfilter/ixfproperty.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfproperty.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfproperty.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,76 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Property for styles. ie. Margins,shadow,columns and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ ************************************************************************/
+#ifndef		_IXFPROPERTY_HXX
+#define		_IXFPROPERTY_HXX
+
+#include	"ixfobject.hxx"
+
+class IXFStream;
+
+class IXFProperty : public IXFObject
+{
+public:
+
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfstream.hxx lotuswordpro/source/filter/xfilter/ixfstream.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfstream.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfstream.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,114 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Sax stream to export xml to SODC.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_IXFSTREAM_INC
+#define		_IXFSTREAM_INC
+
+
+#include	<rtl/ustring.hxx>
+
+class IXFAttrList;
+
+/**
+ * @brief 
+ * Stream wrapper for sax writer.
+ */
+class IXFStream
+{
+public:
+	virtual ~IXFStream(){}
+	/**
+	 * @descr	Called when start write.Usually you can output document type info and xml encoding info.
+	 */
+	virtual void	StartDocument() = 0;
+
+	/**
+	 * @descr	called when end output.
+	 */
+	virtual void	EndDocument() = 0;
+
+	/**
+	 * @descr	Wrap XDocumentHandler::startElement()
+	 * @param	oustr element tag name.
+	 */
+	virtual void	StartElement(const rtl::OUString& oustr) = 0;
+
+	/**
+	 * @descr	Wrap XDocumentHandler::endElement()
+	 * @param	oustr element tag name.
+	 */
+	virtual void	EndElement(const rtl::OUString& oustr) = 0;
+
+	/**
+	 * @descr	output text node.
+	 * @param	oustr text content.
+	 */
+	virtual void	Characters(const rtl::OUString& oustr) = 0;
+
+	/**
+	 * @descr	return the Attribute list interface.
+	 * @return	attribute list.
+	 */
+	virtual IXFAttrList*	GetAttrList() = 0;
+};
+
+#endif //_IXFSTREAM_INC
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/ixfstyle.hxx lotuswordpro/source/filter/xfilter/ixfstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/ixfstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/ixfstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,114 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interfer for all style object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+
+#ifndef		_IXFSTYLE_HXX
+#define		_IXFSTYLE_HXX
+
+#include	"xfglobal.hxx"
+/**
+ * @descr
+ * Interface for all style object.
+ */
+class IXFStyle : public IXFObject
+{
+public:	
+	virtual ~IXFStyle(){}
+	/**
+	 * @descr:	return the style name.
+	 */
+	virtual rtl::OUString	GetStyleName() = 0;
+	
+	/**
+	 * @descr:	set the name of the style.
+	 */
+	virtual void	SetStyleName(const rtl::OUString& styleName) = 0;
+
+	/**
+	 * @descr	return the parent style name. 
+	 */
+	virtual rtl::OUString	GetParentStyleName() = 0;
+	/**
+	 * @descr:	Parant paragraph style. 
+	 */
+	virtual void	SetParentStyleName(const rtl::OUString& parent) = 0;
+	/**
+	 * @descr:	return the style family. You can reference to enumXFStyle.
+	 */
+	virtual enumXFStyle	GetStyleFamily() = 0;
+
+	/**
+	 * @descr:	Set the style family,not quite useful.
+	 */
+	virtual void	SetStyleFamily(enumXFStyle family) = 0;
+
+	/**
+	 * @descr:	Compare wheather two style object are the same.Used only by XFStyleManager.
+	 * @param:	pStyle the style to be compared.
+	 * @return:	return sal_True if equals,else sal_False.
+	 */
+	virtual sal_Bool	Equal(IXFStyle *pStyle) = 0;
+
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/makefile.mk lotuswordpro/source/filter/xfilter/makefile.mk
--- lotuswordpro.bak/source/filter/xfilter/makefile.mk	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/makefile.mk	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,148 @@
+#*************************************************************************
+#
+#   The Contents of this file are made available subject to the terms of
+#   either of the following licenses
+#
+#          - GNU Lesser General Public License Version 2.1
+#          - Sun Industry Standards Source License Version 1.1
+#
+#   Sun Microsystems Inc., October, 2000
+#
+#   GNU Lesser General Public License Version 2.1
+#   =============================================
+#   Copyright 2000 by Sun Microsystems, Inc.
+#   901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#   This library is free software; you can redistribute it and/or
+#   modify it under the terms of the GNU Lesser General Public
+#   License version 2.1, as published by the Free Software Foundation.
+#
+#   This library is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#   Lesser General Public License for more details.
+#
+#   You should have received a copy of the GNU Lesser General Public
+#   License along with this library; if not, write to the Free Software
+#   Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#   MA  02111-1307  USA
+#
+#
+#   Sun Industry Standards Source License Version 1.1
+#   =================================================
+#   The contents of this file are subject to the Sun Industry Standards
+#   Source License Version 1.1 (the "License"); You may not use this file
+#   except in compliance with the License. You may obtain a copy of the
+#   License at http://www.openoffice.org/license.html.
+#
+#   Software provided under this License is provided on an "AS IS" basis,
+#   WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+#   WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+#   MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+#   See the License for the specific provisions governing your rights and
+#   obligations concerning the Software.
+#
+#   The Initial Developer of the Original Code is: IBM Corporation
+#
+#   Copyright: 2008 by IBM Corporation
+#
+#   All Rights Reserved.
+#
+#   Contributor(s): _______________________________________
+#
+#
+#
+#*************************************************************************
+
+PRJ=..$/..$/..
+
+PRJNAME=lwpfilter
+TARGET=xfilter
+
+
+#ENABLE_EXCEPTIONS=TRUE
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  settings.mk
+
+				
+SLOFILES=	\
+		$(SLO)$/xfsaxattrlist.obj	\
+		$(SLO)$/xfsaxstream.obj	\
+		$(SLO)$/xffilestream.obj	\
+		$(SLO)$/xffileattrlist.obj	\
+		$(SLO)$/xfstylemanager.obj	\
+		$(SLO)$/xfstyle.obj		\
+		$(SLO)$/xftextstyle.obj	\
+		$(SLO)$/xffont.obj		\
+		$(SLO)$/xffontdecl.obj	\
+		$(SLO)$/xfstylecont.obj	\
+		$(SLO)$/xfcontentcontainer.obj	\
+		$(SLO)$/xfutil.obj			\
+		$(SLO)$/xfparastyle.obj		\
+		$(SLO)$/xffontfactory.obj	\
+		$(SLO)$/xftextcontent.obj	\
+		$(SLO)$/xfparagraph.obj	\
+		$(SLO)$/xftextspan.obj	\
+		$(SLO)$/xfofficemeta.obj	\
+		$(SLO)$/xfglobal.obj		\
+		$(SLO)$/xflist.obj		\
+		$(SLO)$/xftextheading.obj	\
+		$(SLO)$/xfpagemaster.obj	\
+		$(SLO)$/xfmasterpage.obj	\
+		$(SLO)$/xfheaderstyle.obj	\
+		$(SLO)$/xfsectionstyle.obj	\
+		$(SLO)$/xfsection.obj	\
+		$(SLO)$/xfliststyle.obj	\
+		$(SLO)$/xfborders.obj	\
+		$(SLO)$/xfshadow.obj		\
+		$(SLO)$/xfcolor.obj		\
+		$(SLO)$/xfcolumns.obj	\
+		$(SLO)$/xfmargins.obj	\
+		$(SLO)$/xfdatestyle.obj	\
+		$(SLO)$/xftimestyle.obj	\
+		$(SLO)$/xftime.obj		\
+		$(SLO)$/xfdate.obj		\
+		$(SLO)$/xfframe.obj		\
+		$(SLO)$/xfframestyle.obj	\
+		$(SLO)$/xftable.obj		\
+		$(SLO)$/xfrow.obj		\
+		$(SLO)$/xfcell.obj		\
+		$(SLO)$/xfcolstyle.obj	\
+		$(SLO)$/xfcellstyle.obj	\
+		$(SLO)$/xfrowstyle.obj	\
+		$(SLO)$/xftablestyle.obj	\
+		$(SLO)$/xftabstyle.obj	\
+		$(SLO)$/xfoutlinestyle.obj	\
+		$(SLO)$/xfindex.obj		\
+		$(SLO)$/xfbookmarkref.obj	\
+		$(SLO)$/xfdrawobj.obj	\
+		$(SLO)$/xfdrawline.obj	\
+		$(SLO)$/xfdrawrect.obj	\
+		$(SLO)$/xfdrawcircle.obj	\
+		$(SLO)$/xfdrawellipse.obj	\
+		$(SLO)$/xfdrawpolyline.obj	\
+		$(SLO)$/xfdrawpolygon.obj	\
+		$(SLO)$/xfdrawpath.obj	\
+		$(SLO)$/xfdrawstyle.obj	\
+		$(SLO)$/xfdrawlinestyle.obj	\
+		$(SLO)$/xfdrawareastyle.obj	\
+		$(SLO)$/xfimage.obj		\
+		$(SLO)$/xfimagestyle.obj	\
+		$(SLO)$/xfbase64.obj		\
+		$(SLO)$/xfoleobj.obj		\
+		$(SLO)$/xfbgimage.obj	\
+		$(SLO)$/xfconfigmanager.obj	\
+		$(SLO)$/xfnumberstyle.obj	\
+		$(SLO)$/xffloatframe.obj	\
+		$(SLO)$/xfentry.obj	\
+		$(SLO)$/xfcrossref.obj	\
+		$(SLO)$/xfdocfield.obj	\
+		$(SLO)$/xfchange.obj	\
+		$(SLO)$/xftextboxstyle.obj
+			
+
+# --- Targets ------------------------------------------------------
+
+.INCLUDE :  target.mk
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfannotation.hxx lotuswordpro/source/filter/xfilter/xfannotation.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfannotation.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfannotation.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,119 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Annotation object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-31 create this file.
+ ************************************************************************/
+#ifndef		_XFANNOTATION_HXX
+#define		_XFANNOTATION_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfcontentcontainer.hxx"
+
+class XFAnnotation : public XFContentContainer
+{
+public:
+	void	SetDate(rtl::OUString date);
+
+	void SetAuthor(rtl::OUString author);
+
+	//void	Add(IXFContent *pContent);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString	m_strDate;
+	rtl::OUString	m_strAuthor;
+	//XFContentContainer	m_aContents;	
+};
+
+inline void XFAnnotation::SetDate(rtl::OUString date)
+{
+	m_strDate = date;
+}
+
+inline void XFAnnotation::SetAuthor(rtl::OUString author)
+{
+	m_strAuthor = author;
+}
+/*	
+inline void	XFAnnotation::Add(IXFContent *pContent)
+{
+	m_aContents.Add(pContent);
+}
+*/
+inline void	XFAnnotation::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_strDate.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("office:create-date"), m_strDate );
+	if( m_strAuthor.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("office:author"), m_strAuthor);
+	pStrm->StartElement( A2OUSTR("office:annotation") );
+
+	//m_aContents.ToXml(pStrm);
+	XFContentContainer::ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("office:annotation") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfarrowstyle.hxx lotuswordpro/source/filter/xfilter/xfarrowstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfarrowstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfarrowstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,130 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line Arrow.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-04-06 create this file.
+ ************************************************************************/
+#ifndef		_XFARROWSTYLE_HXX
+#define		_XFARROWSTYLE_HXX
+
+#include	"xfstyle.hxx"
+
+class XFArrowStyle : public XFStyle
+{
+public:
+	XFArrowStyle();
+
+public:
+	void	SetArrowName(rtl::OUString name);
+
+	void	SetViewbox(rtl::OUString viewBox);
+
+	void	SetSVGPath(rtl::OUString path);	
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString	m_strName;
+	rtl::OUString	m_strViewBox;
+	rtl::OUString	m_strPath;
+};
+
+inline XFArrowStyle::XFArrowStyle()
+{
+}
+
+inline void	XFArrowStyle::SetArrowName(rtl::OUString name)
+{
+	m_strName = name;
+}
+
+inline void XFArrowStyle::SetViewbox(rtl::OUString viewBox)
+{
+	m_strViewBox = viewBox;
+}
+
+inline void	XFArrowStyle::SetSVGPath(rtl::OUString path)
+{
+	m_strPath = path;
+}
+
+inline enumXFStyle	XFArrowStyle::GetStyleFamily()
+{
+	return enumXFStyleArrow;
+}
+
+inline void	XFArrowStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_strName.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	else
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), GetStyleName() );
+
+	pAttrList->AddAttribute( A2OUSTR("svg:viewBox"), m_strViewBox );
+	pAttrList->AddAttribute( A2OUSTR("svg:d"), m_strPath );
+	pStrm->StartElement(A2OUSTR("draw:marker"));
+	pStrm->EndElement(A2OUSTR("draw:marker"));
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbase64.cxx lotuswordpro/source/filter/xfilter/xfbase64.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfbase64.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbase64.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,136 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base64 tool.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-02 create this file.
+ * 2005-02-28 make Encode_(...) to be inline for speed.
+ ************************************************************************/
+#include	"xfbase64.hxx"
+
+const  sal_Char aBase64EncodeTable[] =
+{ 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
+'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',
+'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm',
+'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
+'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/' };
+
+/**
+ * @descr	Encode 3 byte to 4 byte.
+ *			Please refer to RFC to get the base64 algorithm.
+ */
+inline void	Encode_(sal_uInt8 *src, sal_Char* dest)
+{
+	sal_Int32 nBinaer = (((sal_uInt8)src[ 0]) << 16) +
+		(((sal_uInt8)src[1]) <<  8) +
+		((sal_uInt8)src[2]);
+	
+	sal_uInt8 nIndex = ((nBinaer & 0xFC0000) >> 18);
+	dest[0] = aBase64EncodeTable [nIndex];
+	
+	nIndex = (nBinaer & 0x3F000) >> 12;
+	dest[1] =aBase64EncodeTable [nIndex];
+	
+	nIndex = (nBinaer & 0xFC0) >> 6;
+	dest[2] = aBase64EncodeTable [nIndex];
+	
+	nIndex = (nBinaer & 0x3F);
+	dest[3] = aBase64EncodeTable [nIndex];
+}
+
+/**
+ * @descr	Base64 encode.
+ */
+rtl::OUString XFBase64::Encode(sal_uInt8 *buf, sal_Int32 len)
+{
+	sal_Char	*buffer;
+	sal_Int32	nNeeded;
+	sal_Int32	cycles = len/3;
+	sal_Int32	remain = len%3;
+	
+	if( remain == 0 )
+		nNeeded = cycles*4;
+	else
+		nNeeded = (cycles+1)*4;
+	buffer = new sal_Char[nNeeded+1];
+	
+	rtl_zeroMemory(buffer,nNeeded+1);
+
+	for( sal_Int32 i=0; i<cycles; i++ )
+		Encode_(buf+i*3,buffer+i*4);
+	
+	sal_uInt8 last[3];
+	if( remain == 1 )
+	{
+		last[0] = buf[len-1];
+		last[1] = last[2] = 0;
+		Encode_(last,buffer+nNeeded+1-5);
+	}
+	else if( remain == 2 )
+	{
+		last[0] = buf[len-2];
+		last[1] = buf[len-1];
+		last[2] = 0;
+		Encode_(last,buffer+nNeeded+1-5);
+	}
+
+	rtl::OUString str = rtl::OUString::createFromAscii(buffer);
+	delete[] buffer;
+	
+	return str;
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbase64.hxx lotuswordpro/source/filter/xfilter/xfbase64.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfbase64.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbase64.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,84 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base64 tool.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-02 create this file.
+ ************************************************************************/
+#ifndef		_XFBASE64_HXX
+#define		_XFBASE64_HXX
+
+#include	"xfglobal.hxx"
+
+/**
+ * @brief
+ * Base64 algorithm implemetation.
+ * I only implements encode funtion now,i'll add decode if needed later.
+ * http://www.faqs.org/rfcs/rfc3548.html.
+ */
+
+class XFBase64
+{
+public:
+	/**
+	 * @descr	Encode binary buffer to base64 encoding. 
+	 */
+	static rtl::OUString	Encode(sal_uInt8 *buf, sal_Int32 len);
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbgimage.cxx lotuswordpro/source/filter/xfilter/xfbgimage.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfbgimage.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbgimage.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,165 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Background image.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-01	created.
+ ************************************************************************/
+#include	"xfbgimage.hxx"
+#include	"xfbase64.hxx"
+
+XFBGImage::XFBGImage()
+{
+	m_bUserFileLink = sal_False;
+	m_bRepeate = sal_False;
+	m_bStretch = sal_False;
+	m_bPosition = sal_True;	
+	m_eHoriAlign = enumXFAlignCenter;
+	m_eVertAlign = enumXFAlignCenter;
+}
+
+void XFBGImage::SetImageData(sal_uInt8 *buf, int len)
+{
+	m_strData = XFBase64::Encode(buf,len);
+	m_bUserFileLink = sal_False;
+}
+
+sal_Bool	XFBGImage::Equal(IXFStyle *pStyle)
+{
+	return sal_False;
+}
+
+void	XFBGImage::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_bUserFileLink )
+	{
+		pAttrList->AddAttribute( A2OUSTR("xlink:href"), m_strFileName);
+	}
+
+	pAttrList->AddAttribute( A2OUSTR("xlink:type"), A2OUSTR("simple") );
+	pAttrList->AddAttribute( A2OUSTR("xlink:actuate"), A2OUSTR("onLoad"));
+
+	if( m_bPosition )
+	{
+		rtl::OUString str = GetAlignName(m_eVertAlign) + A2OUSTR(" ");
+		if( m_eHoriAlign == enumXFAlignStart )
+			str += A2OUSTR("left");
+		else if( m_eHoriAlign == enumXFAlignCenter )
+			str += A2OUSTR("center");
+		else if( m_eHoriAlign == enumXFAlignEnd )
+			str += A2OUSTR("right");
+
+		pAttrList->AddAttribute( A2OUSTR("style:position"), str );
+		pAttrList->AddAttribute( A2OUSTR("style:repeat"), A2OUSTR("no-repeat") );
+	}
+	else if( m_bRepeate )
+		pAttrList->AddAttribute( A2OUSTR("style:repeat"), A2OUSTR("repeat") );
+	else if( m_bStretch )
+		pAttrList->AddAttribute( A2OUSTR("style:repeat"), A2OUSTR("stretch") );
+
+	pStrm->StartElement( A2OUSTR("style:background-image") );
+
+	if( !m_bUserFileLink )
+	{
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("office:binary-data") );
+		pStrm->Characters(m_strData);
+		pStrm->EndElement( A2OUSTR("office:binary-data") );
+	}
+
+	pStrm->EndElement( A2OUSTR("style:background-image") );
+}
+
+bool operator==(XFBGImage& img1, XFBGImage& img2)
+{
+	if( img1.m_bUserFileLink != img2.m_bUserFileLink )
+		return false;
+	if( img1.m_bUserFileLink )
+	{
+		if( img1.m_strFileName != img2.m_strFileName )
+			return false;
+	}
+	else
+	{
+		//I'll not compare the content of the two buffer,it's time comsuming.
+		return sal_False;
+	}
+	if( img1.m_bPosition != img2.m_bPosition )
+		return false;
+	if( img1.m_bRepeate != img2.m_bRepeate )
+		return false;
+	if( img1.m_bStretch != img2.m_bStretch )
+		return false;
+	if( img1.m_bPosition )
+	{
+		if( (img1.m_eHoriAlign != img2.m_eHoriAlign) || (img1.m_eVertAlign != img2.m_eVertAlign) )
+			return false;
+	}
+	return true;
+}
+
+bool operator!=(XFBGImage& img1, XFBGImage& img2)
+{
+	return !(img1==img2);
+}
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbgimage.hxx lotuswordpro/source/filter/xfilter/xfbgimage.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfbgimage.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbgimage.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,155 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Background image.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-01	created.
+ ************************************************************************/
+#ifndef		_XFBGIMAGE_HXX
+#define		_XFBGIMAGE_HXX
+
+#include	"xfstyle.hxx"
+
+/**
+ * @brief
+ * Background image object.
+ */
+class XFBGImage : public XFStyle
+{
+public:
+	XFBGImage();
+
+public:
+	/**
+	 * @descr	Use file link as image source. 
+	 */
+	void	SetFileLink(rtl::OUString fileName);
+
+	/**
+	 * @descr	Use base64 stream as image source. 
+	 */
+	void	SetImageData(sal_uInt8 *buf, int len);
+
+	/**
+	 * @descr	Set the iamge position type. 
+	 */
+	void	SetPosition(enumXFAlignType horiAlign = enumXFAlignCenter, enumXFAlignType vertAlign = enumXFAlignCenter);
+
+	/**
+	 * @descr	Set background image repeat style. 
+	 */
+	void	SetRepeate();
+
+	/**
+	 * @descr	Set whether the image should be streatched to fill the owner object. 
+	 */
+	void	SetStretch();
+
+	/**
+	 * @descr	decide whether there has been a style that is the same as this object.
+	 *			If it use base64 stream, i'll simply return sal_False because it's too slow to compare two base64 stream.
+	 */
+	virtual sal_Bool Equal(IXFStyle *pStyle);
+
+	virtual void ToXml(IXFStream *pStrm);
+	
+	friend bool operator==(XFBGImage& img1, XFBGImage& img2);
+	friend bool operator!=(XFBGImage& img1, XFBGImage& img2);
+private:
+	rtl::OUString	m_strFileName;
+	rtl::OUString	m_strData;
+	sal_Bool	m_bUserFileLink;
+	sal_Bool	m_bRepeate;
+	sal_Bool	m_bStretch;
+	sal_Bool	m_bPosition;
+	enumXFAlignType m_eHoriAlign;
+	enumXFAlignType	m_eVertAlign;
+};
+
+inline void XFBGImage::SetFileLink(rtl::OUString fileName)
+{
+	m_strFileName = fileName;
+	m_bUserFileLink = sal_True;
+}
+
+inline void XFBGImage::SetPosition(enumXFAlignType horiAlign, enumXFAlignType vertAlign)
+{
+	m_bPosition = sal_True;
+	m_eHoriAlign = horiAlign;
+	m_eVertAlign = vertAlign;
+	
+	m_bStretch = sal_False;
+	m_bRepeate = sal_False;
+}
+
+inline void XFBGImage::SetRepeate()
+{
+	m_bRepeate = sal_True;
+	m_bStretch = sal_False;
+	m_bPosition = sal_False;
+}
+
+inline void XFBGImage::SetStretch()
+{
+	m_bStretch = sal_True;
+	m_bRepeate = sal_False;
+	m_bPosition = sal_False;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbookmark.hxx lotuswordpro/source/filter/xfilter/xfbookmark.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfbookmark.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbookmark.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,130 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Bookmark ref.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-03 create this file.
+ ************************************************************************/
+#ifndef		_XFBOOKMARK_HXX
+#define		_XFBOOKMARK_HXX
+
+#include	"xfcontent.hxx"
+
+/**
+ * @brief
+ * Bookmark object.
+ */
+class XFBookmark : public XFContent
+{
+public:
+	XFBookmark(sal_Bool isStart)
+	{
+		m_bStart = isStart;
+	}
+	
+	rtl::OUString GetDivision(){return m_strDivision;}
+	void SetDivision(rtl::OUString sDivName){m_strDivision = sDivName;}
+	rtl::OUString GetName(){return m_strName;}	
+
+public:
+	/**
+	 * @descr	Set bookmark name, which will be used in bookmark-ref or formula. 
+	 */
+	void	SetName(rtl::OUString name)
+	{
+		m_strName = name;
+	}
+
+	virtual void ToXml(IXFStream *pStrm)
+	{
+		IXFAttrList	*pAttrList = pStrm->GetAttrList();
+		pAttrList->Clear();
+
+		pAttrList->AddAttribute( A2OUSTR("text:name"), m_strName );
+		if( m_bStart )
+		{
+			pStrm->StartElement( A2OUSTR("text:bookmark-start") );
+			pStrm->EndElement( A2OUSTR("text:bookmark-start") );
+		}
+		else
+		{
+			pStrm->StartElement( A2OUSTR("text:bookmark-end") );
+			pStrm->EndElement( A2OUSTR("text:bookmark-end") );
+		}
+	}
+
+private:
+	sal_Bool	m_bStart;
+	rtl::OUString m_strName;
+	rtl::OUString m_strDivision;
+};
+
+class XFBookmarkStart : public XFBookmark
+{
+public:
+	XFBookmarkStart():XFBookmark(sal_True){}
+};
+
+class XFBookmarkEnd : public XFBookmark
+{
+public:
+	XFBookmarkEnd():XFBookmark(sal_False){}
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbookmarkref.cxx lotuswordpro/source/filter/xfilter/xfbookmarkref.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfbookmarkref.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbookmarkref.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,107 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Bookmark reference.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-03 create this file.
+ ************************************************************************/
+#include	"xfbookmarkref.hxx"
+
+XFBookmarkRef::XFBookmarkRef()
+{
+	m_eRefType = enumXFBookmarkNone;
+}
+
+void XFBookmarkRef::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	assert(m_strBookmark.getLength() > 0 );
+	if( m_eRefType == enumXFBookmarkNone )
+		return;
+	else if( m_eRefType == enumXFBookmarkPage )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("page") );
+		pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strBookmark );
+	}
+	else if( m_eRefType == enumXFBookmarkChapter )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("chapter") );
+		pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strBookmark );
+	}
+	else if( m_eRefType == enumXFBookmarkPage )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("text") );
+		pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strBookmark );
+		
+	}
+	else if( m_eRefType == enumXFBookmarkDir )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("direction") );
+		pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strBookmark );
+	}
+	else if( m_eRefType == enumXFBookmarkDef )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strBookmark );
+	}
+	pStrm->StartElement( A2OUSTR("text:bookmark-ref") );
+	if( m_strText.getLength() )
+		pStrm->Characters(m_strBookmark);
+	pStrm->EndElement( A2OUSTR("text:bookmark-ref") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbookmarkref.hxx lotuswordpro/source/filter/xfilter/xfbookmarkref.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfbookmarkref.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbookmarkref.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,103 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Bookmark ref.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-03 create this file.
+ ************************************************************************/
+#ifndef		_XFBOOKMARKREF_HXX
+#define		_XFBOOKMARKREF_HXX
+
+#include	"xfcontent.hxx"
+
+class XFBookmarkRef : public XFContent
+{
+public:
+	XFBookmarkRef();
+
+public:
+	void	SetRefType(enumXFBookmarkRef type);
+
+	void	SetBookmark(rtl::OUString name);
+
+	void	SetText(rtl::OUString text);
+	
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	enumXFBookmarkRef	m_eRefType;
+	rtl::OUString	m_strBookmark;
+	rtl::OUString	m_strText;
+};
+
+inline void	XFBookmarkRef::SetRefType(enumXFBookmarkRef ref)
+{
+	m_eRefType = ref;
+}
+
+inline void XFBookmarkRef::SetBookmark(rtl::OUString name)
+{
+	m_strBookmark = name;
+}
+
+inline void XFBookmarkRef::SetText(rtl::OUString text)
+{
+	m_strText = text;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfborders.cxx lotuswordpro/source/filter/xfilter/xfborders.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfborders.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfborders.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,361 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Border object,now only used by paragraph object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-14 create this file.
+ * 2005-01-17 change for the XFColor object.
+ ************************************************************************/
+#include	"xfborders.hxx"
+
+XFBorder::XFBorder()
+{
+	m_fOffset = 0;
+	m_bDouble = sal_False;
+	m_bSameWidth = sal_False;	
+	m_fWidthInner = 0;
+	m_fWidthSpace = 0;
+	m_fWidthOutter = 0;
+}
+
+void	XFBorder::SetColor(XFColor& color)
+{
+	m_aColor = color;
+}
+
+void	XFBorder::SetWidth(double width)
+{
+	if( !m_bDouble )
+	{
+		m_fWidthInner = width;
+		m_bSameWidth = sal_True;
+	}	
+	else if( m_bDouble && m_bSameWidth )
+	{
+		m_fWidthInner = width;
+		m_fWidthOutter = width;
+		m_fWidthSpace = width;
+	}
+}
+
+void	XFBorder::SetDoubleLine(sal_Bool dual,sal_Bool bSameWidth)
+{
+	m_bDouble = dual;
+	m_bSameWidth = bSameWidth;
+}
+
+void	XFBorder::SetWidthInner(double inner)
+{
+	assert(m_bDouble);
+	m_fWidthInner = inner;
+}
+
+void	XFBorder::SetWidthSpace(double space)
+{
+	assert(m_bDouble);
+	m_fWidthSpace = space;
+}
+
+void	XFBorder::SetWidthOutter(double outer)
+{
+	assert(m_bDouble);
+	m_fWidthOutter = outer;
+}
+
+rtl::OUString	XFBorder::GetLineWidth()
+{
+	rtl::OUString	str;
+
+	if( m_bDouble )
+	{
+		str = FloatToOUString(m_fWidthInner);
+		str += A2OUSTR("cm ") + DoubleToOUString(m_fWidthSpace);
+		str += A2OUSTR("cm ") + DoubleToOUString(m_fWidthOutter) + A2OUSTR("cm");
+	}
+	return str;
+}
+
+rtl::OUString	XFBorder::ToString()
+{
+	rtl::OUString str;
+
+	if( m_bDouble )
+	{
+		double width = m_fWidthInner + m_fWidthSpace + m_fWidthOutter;
+		if( width<FLOAT_MIN )
+		{
+			return str;
+		}
+
+		str = DoubleToOUString(width) + A2OUSTR("cm");
+		str += A2OUSTR(" double ") + m_aColor.ToString();
+	}
+	else
+	{
+		double width = m_fWidthInner;
+		if( width<FLOAT_MIN )
+		{
+			return str;
+		}
+		str = DoubleToOUString(width) + A2OUSTR("cm");
+		str += A2OUSTR(" solid ") + m_aColor.ToString();
+	}
+	return str;
+}
+
+bool operator==(XFBorder& b1, XFBorder& b2)
+{
+	if( b1.m_fOffset != b2.m_fOffset )
+		return false;
+	if( b1.m_bDouble != b2.m_bDouble )
+		return false;
+	if( !b1.m_bDouble )
+	{
+		if( b1.m_fWidthInner != b2.m_fWidthInner )
+			return false;
+	}
+	else
+	{
+		if( b1.m_bSameWidth != b2.m_bSameWidth )
+			return true;
+		if( b1.m_fWidthInner != b2.m_fWidthInner ||
+			b1.m_fWidthSpace != b2.m_fWidthSpace ||
+			b1.m_fWidthOutter != b2.m_fWidthOutter			
+			)
+			return false;
+	}
+	if( b1.m_aColor != b2.m_aColor )
+		return sal_False;
+	return true;
+}
+
+bool operator!=(XFBorder& b1, XFBorder& b2)
+{
+	return !(b1 == b2);
+}
+
+//
+//XFBorders:
+//
+void	XFBorders::SetColor(enumXFBorder side, XFColor& color)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetColor(color);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetColor(color);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetColor(color);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetColor(color);
+		break;
+	}
+}
+
+void	XFBorders::SetWidth(enumXFBorder side, double width)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetWidth(width);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetWidth(width);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetWidth(width);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetWidth(width);
+		break;
+	}
+}
+
+void	XFBorders::SetDoubleLine(enumXFBorder side, sal_Bool dual,sal_Bool bSameWidth)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetDoubleLine(dual,bSameWidth);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetDoubleLine(dual,bSameWidth);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetDoubleLine(dual,bSameWidth);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetDoubleLine(dual,bSameWidth);
+		break;
+	}
+}
+
+void	XFBorders::SetWidthInner(enumXFBorder side, double inner)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetWidthInner(inner);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetWidthInner(inner);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetWidthInner(inner);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetWidthInner(inner);
+		break;
+	}
+}
+
+void	XFBorders::SetWidthSpace(enumXFBorder side, double space)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetWidthSpace(space);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetWidthSpace(space);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetWidthSpace(space);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetWidthSpace(space);
+		break;
+	}
+}
+
+void	XFBorders::SetWidthOutter(enumXFBorder side, double outer)
+{
+	switch(side)
+	{
+	case enumXFBorderLeft:
+		m_aBorderLeft.SetWidthOutter(outer);
+		break;
+	case enumXFBorderRight:
+		m_aBorderRight.SetWidthOutter(outer);
+		break;
+	case enumXFBorderTop:
+		m_aBorderTop.SetWidthOutter(outer);
+		break;
+	case enumXFBorderBottom:
+		m_aBorderBottom.SetWidthOutter(outer);
+		break;
+	}
+}
+
+bool	operator ==(XFBorders& b1, XFBorders& b2)
+{
+	if( b1.m_aBorderLeft != b2.m_aBorderLeft )
+		return false;
+	if( b1.m_aBorderRight != b2.m_aBorderRight )
+		return false;
+	if( b1.m_aBorderTop != b2.m_aBorderTop )
+		return false;
+	if( b1.m_aBorderBottom != b2.m_aBorderBottom )
+		return false;
+	return true;
+}
+
+bool operator!=(XFBorders& b1, XFBorders& b2)
+{
+	return !(b1 == b2);
+}
+
+void	XFBorders::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( m_aBorderLeft.GetLineWidth().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("style:border-line-width-left"), m_aBorderLeft.GetLineWidth() );
+	if( m_aBorderRight.GetLineWidth().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("style:border-line-width-right"), m_aBorderRight.GetLineWidth() );
+	if( m_aBorderTop.GetLineWidth().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("style:border-line-width-top"), m_aBorderTop.GetLineWidth() );
+	if( m_aBorderBottom.GetLineWidth().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("style:border-line-width-bottom"), m_aBorderBottom.GetLineWidth() );
+
+	if( m_aBorderLeft.ToString().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("fo:border-left"), m_aBorderLeft.ToString() );
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:border-left"), A2OUSTR("none") );
+
+	if( m_aBorderRight.ToString().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("fo:border-right"), m_aBorderRight.ToString() );
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:border-right"), A2OUSTR("none") );
+
+	if( m_aBorderTop.ToString().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("fo:border-top"), m_aBorderTop.ToString() );
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:border-top"), A2OUSTR("none") );
+	
+	if( m_aBorderBottom.ToString().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("fo:border-bottom"), m_aBorderBottom.ToString() );
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:border-bottom"), A2OUSTR("none") );
+
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfborders.hxx lotuswordpro/source/filter/xfilter/xfborders.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfborders.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfborders.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,195 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Border object,now only used by paragraph object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-14 create this file.
+ * 2005-01-17 changed for the XFColor object.
+ ************************************************************************/
+#ifndef		_XFBORDERS_HXX
+#define		_XFBORDERS_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcolor.hxx"
+
+/**
+ * @brief
+ * Single border obejct for all objects with borders.
+ */
+class XFBorder
+{
+public:
+	XFBorder();
+
+public:
+	/**
+	 * @descr	Set border color. 
+	 */
+	void		SetColor(XFColor& color);
+
+	/**
+	 * @descr	Set border width in cm. 
+	 */
+	void		SetWidth(double width);
+
+	/**
+	 * @descr	Set whether the border has double line. 
+	 */
+	void		SetDoubleLine(sal_Bool dual,sal_Bool bSameWidth);
+
+	/**
+	 * @descr	Set inner line width for border with double line. 
+	 */
+	void		SetWidthInner(double inner);
+
+	/**
+	 * @descr	Set space between double lines fo border. 
+	 */
+	void		SetWidthSpace(double space);
+
+	/**
+	 * @descr	Set outter line width for border with double line. 
+	 */
+	void		SetWidthOutter(double outer);
+
+private:
+	/**
+	 * @descr	Forst line width to OOo border width format. 
+	 */
+	rtl::OUString	GetLineWidth();
+
+	rtl::OUString	ToString();
+
+	friend bool operator==(XFBorder& b1, XFBorder& b2);
+	friend bool operator!=(XFBorder& b1, XFBorder& b2);
+	friend class XFBorders;
+
+private:
+	double		m_fOffset;
+	XFColor		m_aColor;	
+	sal_Bool	m_bDouble;
+	sal_Bool	m_bSameWidth;
+	double		m_fWidthInner;
+	double		m_fWidthSpace;
+	double		m_fWidthOutter;
+};
+
+/**
+ * @brief
+ * Borders for object with borders.
+ * Borders may include (right,left,top,bottom) borders.
+ */
+class XFBorders
+{
+public:
+	XFBorders(){}
+
+public:
+	/**
+	 * @descr	Set color of border side. 
+	 */
+	void	SetColor(enumXFBorder side, XFColor& color);
+
+	/**
+	 * @descr	Set width or border side. 
+	 */
+	void	SetWidth(enumXFBorder side, double width);
+
+	/**
+	 * @descr	Set border side as doubel line.
+	 * @param	bSameWidth whether two borders are same width.
+	 */
+	void	SetDoubleLine(enumXFBorder side, sal_Bool dual,sal_Bool bSameWidth);
+
+	/**
+	 * @descr	Set inner border with of border side. 
+	 */
+	void	SetWidthInner(enumXFBorder side, double inner);
+
+	/**
+	 * @descr	Set space between two borders fo border side. 
+	 */
+	void	SetWidthSpace(enumXFBorder side, double space);
+
+	/**
+	 * @descr	Set outter border width of border side. 
+	 */
+	void	SetWidthOutter(enumXFBorder side, double outer);
+
+	XFBorder * GetLeft() {return &m_aBorderLeft;};
+
+	XFBorder * GetRight() {return &m_aBorderRight;};
+
+	XFBorder * GetTop() {return &m_aBorderTop;};
+
+	XFBorder * GetBottom() {return &m_aBorderBottom;};	
+	
+	void	ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFBorders& b1, XFBorders& b2);
+	friend bool operator!=(XFBorders& b1, XFBorders& b2);
+	
+private:
+	XFBorder	m_aBorderLeft;
+	XFBorder	m_aBorderRight;
+	XFBorder	m_aBorderTop;
+	XFBorder	m_aBorderBottom;
+};
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfbreaks.hxx lotuswordpro/source/filter/xfilter/xfbreaks.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfbreaks.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfbreaks.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,146 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Breaks of paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-27 create this file.
+ ************************************************************************/
+#ifndef		_XFBREAKS_HXX
+#define		_XFBREAKS_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+
+/**
+ * @descr	Page|Column break object. 
+ */
+class XFBreaks : public IXFProperty
+{
+public:
+	XFBreaks();
+
+	XFBreaks(enumXFBreaks breaks);	
+
+public:
+	/**
+	 * @descr	Set break type, pls refer to enumXFBreaks. 
+	 */
+	void	SetBreakType(enumXFBreaks breaks);
+
+	/**
+	 * @descr	Output breaks object. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	friend bool operator==(XFBreaks& b1, XFBreaks& b2);
+	friend bool operator!=(XFBreaks& b1, XFBreaks& b2);
+
+private:
+	enumXFBreaks	m_eBreaks;
+};
+
+inline XFBreaks::XFBreaks()
+{
+	m_eBreaks = enumXFBreakAuto;
+}
+
+inline XFBreaks::XFBreaks(enumXFBreaks breaks):m_eBreaks(breaks)
+{
+}
+
+inline void	XFBreaks::SetBreakType(enumXFBreaks breaks)
+{
+	m_eBreaks = breaks;
+}
+
+inline void	XFBreaks::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	switch(m_eBreaks)
+	{
+	case enumXFBreakAuto:
+		break;
+	case enumXFBreakBefPage:
+		pAttrList->AddAttribute( A2OUSTR("fo:break-before"), A2OUSTR("page") );
+		break;
+	case enumXFBreakBefColumn:
+		pAttrList->AddAttribute( A2OUSTR("fo:break-before"), A2OUSTR("column") );
+		break;
+	case enumXFBreakAftPage:
+		pAttrList->AddAttribute( A2OUSTR("fo:break-after"), A2OUSTR("page") );
+		break;
+	case enumXFBreakAftColumn:
+		pAttrList->AddAttribute( A2OUSTR("fo:break-after"), A2OUSTR("column") );
+		break;
+	case enumXFBreakKeepWithNext:
+		pAttrList->AddAttribute( A2OUSTR("fo:keep-with-next"), A2OUSTR("true") );
+		break;
+	}
+}
+
+inline bool operator==(XFBreaks& b1, XFBreaks& b2)
+{
+	return b1.m_eBreaks == b2.m_eBreaks;
+}
+
+inline bool operator!=(XFBreaks& b1, XFBreaks& b2)
+{
+	return !(b1==b2);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcell.cxx lotuswordpro/source/filter/xfilter/xfcell.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcell.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcell.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,304 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table cell.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xfcell.hxx"
+#include	"xfparagraph.hxx"
+#include	"xftable.hxx"
+#include	"xfrow.hxx"
+
+XFCell::XFCell()
+{	
+	m_pSubTable = NULL;
+	m_nCol = 0;
+	m_nColSpaned = 1;
+	m_nRepeated = 0;
+	m_eValueType = enumXFValueTypeNone;
+	m_bProtect = sal_False;
+}
+
+XFCell::XFCell(const XFCell& other)
+{
+	if( other.m_pSubTable )
+		m_pSubTable = new XFTable(*other.m_pSubTable);
+	else
+		m_pSubTable = NULL;
+	m_pOwnerRow = NULL;
+	m_nCol = other.m_nCol;
+	m_nColSpaned = other.m_nColSpaned;
+	m_nRepeated = other.m_nRepeated;
+	m_eValueType = other.m_eValueType;
+	m_bProtect = other.m_bProtect;
+	m_strValue = other.m_strValue;
+	m_strDisplay = other.m_strDisplay;
+	m_strFormula = other.m_strFormula;
+}
+
+XFCell&	XFCell::operator=(const XFCell& other)
+{
+	if( m_pSubTable )
+		delete m_pSubTable;
+	
+	if( other.m_pSubTable )
+		m_pSubTable = new XFTable(*other.m_pSubTable);
+	else
+		m_pSubTable = NULL;
+	m_pOwnerRow = NULL;
+	m_nCol = other.m_nCol;
+	m_nColSpaned = other.m_nColSpaned;
+	m_nRepeated = other.m_nRepeated;
+	m_eValueType = other.m_eValueType;
+	m_bProtect = other.m_bProtect;
+	m_strValue = other.m_strValue;
+	m_strDisplay = other.m_strDisplay;
+	m_strFormula = other.m_strFormula;
+	
+	return *this;	
+}
+
+XFCell::~XFCell()
+{
+	if( m_pSubTable )
+		delete m_pSubTable;
+}
+
+void	XFCell::Add(IXFContent *pContent)
+{
+	if( m_eValueType != enumXFValueTypeNone )
+	{
+		Reset();
+		m_eValueType = enumXFValueTypeNone;
+	}
+	if( m_pSubTable )
+	{
+		assert(false);
+		return;
+	}
+	if( pContent->GetContentType() == enumXFContentTable )
+	{
+		XFTable	*pTable = static_cast<XFTable*>(pContent);
+		if( !pTable )
+			return;
+		//the sub table will fill all the cell, there can't be other contents.
+		pTable->SetOwnerCell(this);		
+		m_pSubTable = pTable;
+	}
+	else if( pContent->GetContentType() == enumXFContentText )
+	{
+		XFParagraph	*pPara = new XFParagraph();
+		pPara->Add(pContent);
+		XFContentContainer::Add(pPara);
+	}
+	else if( pContent->GetContentType() == enumXFContentFrame )
+	{
+		XFParagraph	*pPara = new XFParagraph();
+		pPara->Add(pContent);
+		XFContentContainer::Add(pPara);
+	}
+	else
+	{
+		XFContentContainer::Add(pContent);
+	}
+}
+
+
+void	XFCell::SetValue(double value)
+{
+	SetValue(DoubleToOUString(value,18));
+}
+
+void	XFCell::SetValue(rtl::OUString value)
+{
+	m_eValueType = enumXFValueTypeFloat;	
+	m_strValue = value;
+	
+	//Reset();
+	//XFParagraph	*pPara = new XFParagraph();
+	//pPara->Add(m_strValue);
+	//XFContentContainer::Add(pPara);
+}
+
+void XFCell::SetString(rtl::OUString str)
+{
+	m_eValueType = enumXFValueTypeString;	
+	m_strValue = str;
+	
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strValue);
+	XFContentContainer::Add(pPara);
+}
+
+void	XFCell::SetPercent(double percent)
+{
+	SetPercent(DoubleToOUString(percent));
+}
+
+void	XFCell::SetPercent(rtl::OUString percent)
+{
+	m_eValueType = enumXFValueTypePercentage;	
+	m_strValue = percent;
+	
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strValue);
+	XFContentContainer::Add(pPara);
+}
+
+void	XFCell::SetDate(rtl::OUString date)
+{
+	m_eValueType = enumXFValueTypeDate;	
+	m_strValue = date;
+	
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strValue);
+	XFContentContainer::Add(pPara);
+}
+
+void	XFCell::SetTime(rtl::OUString time)
+{
+	m_eValueType = enumXFValueTypeTime;	
+	m_strValue = time;
+	
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strValue);
+	XFContentContainer::Add(pPara);
+}
+
+void	XFCell::SetCurrency(rtl::OUString currency)
+{
+	m_eValueType = enumXFValueTypeCurrency;	
+	m_strValue = currency;
+	
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strValue);
+	XFContentContainer::Add(pPara);
+}
+
+void	XFCell::SetDisplay(rtl::OUString display)
+{
+	m_strDisplay = display;
+
+	Reset();
+	XFParagraph	*pPara = new XFParagraph();
+	pPara->Add(m_strDisplay);
+	XFContentContainer::Add(pPara);
+}
+
+rtl::OUString	XFCell::GetCellName()
+{
+	rtl::OUString	name;
+	XFRow	*pRow = m_pOwnerRow;
+	XFTable	*pTable = pRow->GetOwnerTable();
+
+	if( !pRow || !pTable )
+		return A2OUSTR("");
+	if( pTable->IsSubTable() )
+	{
+		name = pTable->GetTableName() + A2OUSTR(".") + Int32ToOUString(m_nCol) + A2OUSTR(".") + Int32ToOUString(pRow->GetRow());
+	}
+	else
+	{
+		name = GetTableColName(m_nCol) + Int32ToOUString(pRow->GetRow());
+	}
+	return name;
+}
+
+void	XFCell::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("table:style-name"), GetStyleName() );
+	if( m_nColSpaned>1 )
+		pAttrList->AddAttribute( A2OUSTR("table:number-columns-spanned"), Int32ToOUString(m_nColSpaned) );
+	if( m_nRepeated )
+		pAttrList->AddAttribute( A2OUSTR("table:number-columns-repeated"), Int32ToOUString(m_nRepeated) );
+	if( m_eValueType != enumXFValueTypeNone )
+	{
+		pAttrList->AddAttribute( A2OUSTR("table:value-type"), GetValueType(m_eValueType) );
+		pAttrList->AddAttribute( A2OUSTR("table:value"), m_strValue );
+	}
+	if( m_strFormula.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("table:formula"), m_strFormula );
+
+	if( m_bProtect )
+		pAttrList->AddAttribute( A2OUSTR("table:protected"), A2OUSTR("true") );
+
+	//for test only.
+//	pAttrList->AddAttribute( A2OUSTR("table:cell-name"), GetCellName() );
+
+	pStrm->StartElement( A2OUSTR("table:table-cell") );
+	
+	if( m_pSubTable )
+		m_pSubTable->ToXml(pStrm);
+	else
+	{
+		XFContentContainer::ToXml(pStrm);
+	}
+	
+	pStrm->EndElement( A2OUSTR("table:table-cell") );
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcell.hxx lotuswordpro/source/filter/xfilter/xfcell.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcell.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcell.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,261 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table cell.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#ifndef		_XFCell_HXX
+#define		_XFCell_HXX
+
+#include	"xfcontent.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	<vector>
+
+class XFTable;
+class XFRow;
+
+/**
+ * @descr	Table cell object. 
+ */
+class XFCell : public XFContentContainer
+{
+public:
+	XFCell();
+
+	XFCell(const XFCell& other);
+
+	XFCell&	operator=(const XFCell& other);
+
+	virtual ~XFCell();
+
+public:
+	/**
+	 * @descr	Add content for table cell. 
+	 */
+	void	Add(IXFContent *pContent);
+	
+	/**
+	 * @descr	If cell spans more the one column, then set column span. 
+	 */
+	void	SetColumnSpaned(sal_Int32 num);
+
+	/**
+	 * @descr	Set whether the following cells use the same style and content. 
+	 */
+	void	SetRepeated(sal_Int32 num);
+
+	/**
+	 * @descr	Set cell number value. 
+	 */
+	void	SetValue(double value);
+
+	/**
+	 * @descr	Set cell number value. 
+	 */
+	void	SetValue(rtl::OUString value);
+
+	/**
+	 * @descr	Set cell string value. 
+	 */
+	void	SetString(rtl::OUString str);
+
+	/**
+	 * @descr	Set cell as a percent value with value percent. 
+	 */
+	void	SetPercent(double percent);
+
+	/**
+	 * @descr	Set cell as a percent value with value percent. 
+	 */
+	void	SetPercent(rtl::OUString percent);
+
+	/**
+	 * @descr	Set cell as a date value. 
+	 */
+	void	SetDate(rtl::OUString date);
+
+	/**
+	 * @descr	Set cell as a time value. 
+	 */
+	void	SetTime(rtl::OUString time);
+
+	/**
+	 * @descr	Set cell as a currency value. 
+	 */
+	void	SetCurrency(rtl::OUString currency);
+
+	/**
+	 * @descr	Set cell display string. 
+	 */
+	void	SetDisplay(rtl::OUString display);
+
+	/**
+	 * @descr	Set cell formula. 
+	 */
+	void	SetFormula(rtl::OUString formula);
+
+	/**
+	 * @descr	Set cell protected. 
+	 */
+	void	SetProtect(sal_Bool protect=sal_True);
+
+	/**
+	 * @descr	Set cell column id. 
+	 */
+	void	SetCol(sal_Int32 col);
+
+	/**
+	 * @descr	Set cell owner row. 
+	 */
+	void	SetOwnerRow(XFRow *pRow);
+
+	/**
+	 * @descr	Return cell name. It's a tool function for formula. 
+	 */
+	rtl::OUString	GetCellName();
+
+	/**
+	 * @descr	Return cell column id. 
+	 */
+	sal_Int32	GetCol();
+
+	/**
+	 * @descr	return cell'owner row. 
+	 */
+	XFRow*		GetOwnerRow();
+
+	/**
+	 * @descr	If cell has a sub-table, return it, else return NULL. 
+	 */
+	XFTable*	GetSubTable();
+
+	/**
+	 * @descr	return cell column span property. 
+	 */
+	sal_Int32	GetColSpaned();
+
+	/**
+	 * @descr	Output cell as xml element. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFRow		*m_pOwnerRow;
+	XFTable		*m_pSubTable;
+	sal_Int32	m_nCol;
+	sal_Int32	m_nColSpaned;
+	sal_Int32	m_nRepeated;
+	enumXFValueType	m_eValueType;
+	rtl::OUString	m_strValue;
+	rtl::OUString	m_strDisplay;
+	rtl::OUString	m_strFormula;
+	sal_Bool	m_bProtect;
+};
+
+inline void	XFCell::SetColumnSpaned(sal_Int32 num)
+{
+	m_nColSpaned = num;
+}
+
+inline void	XFCell::SetRepeated(sal_Int32 repeated)
+{
+	m_nRepeated = repeated;
+}
+
+inline void XFCell::SetFormula(rtl::OUString formula)
+{
+	m_strFormula = formula;
+}
+
+inline void XFCell::SetProtect(sal_Bool protect/* =sal_True */)
+{
+	m_bProtect = protect;
+}
+
+inline void XFCell::SetCol(sal_Int32 col)
+{
+	m_nCol = col;
+}
+
+inline void	XFCell::SetOwnerRow(XFRow *pRow)
+{
+	m_pOwnerRow = pRow;
+}
+
+inline sal_Int32	XFCell::GetCol()
+{
+	return m_nCol;
+}
+
+inline XFRow*	XFCell::GetOwnerRow()
+{
+	return m_pOwnerRow;
+}
+
+inline XFTable*	XFCell::GetSubTable()
+{
+	return m_pSubTable;
+}
+
+inline sal_Int32 XFCell::GetColSpaned()
+{
+	return m_nColSpaned;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcellstyle.cxx lotuswordpro/source/filter/xfilter/xfcellstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcellstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcellstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,308 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table cell style. Number format, string value, and so on...
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create this file.
+ ************************************************************************/
+#include	"xfcellstyle.hxx"
+#include	"xfborders.hxx"
+#include	"xffont.hxx"
+#include	"xfbgimage.hxx"
+
+
+XFCellStyle::XFCellStyle()
+{
+	m_eHoriAlign = enumXFAlignNone;
+	m_eVertAlign = enumXFAlignNone;
+	m_fTextIndent = 0;
+	m_pBorders = NULL;
+	m_pFont = NULL;
+	m_pBackImage = NULL;
+	m_bWrapText = sal_False;
+}
+
+XFCellStyle::~XFCellStyle()
+{
+	if( m_pBorders )
+		delete m_pBorders;
+}
+
+
+void	XFCellStyle::SetParentStyle(rtl::OUString parent)
+{
+	m_strParentStyleName = parent;
+}
+
+void	XFCellStyle::SetFont(XFFont *pFont)
+{
+	m_pFont = pFont;
+}
+
+void	XFCellStyle::SetIndent(double indent )
+{
+	m_fTextIndent = indent;	
+}
+
+void	XFCellStyle::SetMargins(double left, double right, double top, double bottom)
+{
+	if( left != -1 )
+		m_aMargin.SetLeft(left);
+	if( right != -1 )
+		m_aMargin.SetRight(right);
+	if( top != -1 )
+		m_aMargin.SetTop(top);
+	if( bottom != -1 )
+		m_aMargin.SetBottom( bottom );	
+}
+
+void XFCellStyle::SetPadding(double left, double right,double top, double bottom)
+{
+	if( left != -1 )
+		m_aPadding.SetLeft(left);
+	if( right != -1 )
+		m_aPadding.SetRight(right);
+	if( top != -1 )
+		m_aPadding.SetTop(top);
+	if( bottom != -1 )
+		m_aPadding.SetBottom( bottom );	
+}
+
+void	XFCellStyle::SetShadow(enumXFShadowPos pos, double offset, XFColor& color)
+{
+	m_aShadow.SetPosition(pos);
+	m_aShadow.SetOffset(offset);
+	m_aShadow.SetColor(color);
+}
+
+void	XFCellStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+}
+
+void	XFCellStyle::SetBackImage(XFBGImage *pImage)
+{
+	if( m_pBackImage )
+		delete m_pBackImage;
+	m_pBackImage = pImage;
+}
+
+void	XFCellStyle::SetBorders(XFBorders *pBorders)
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	m_pBorders = pBorders;
+}
+
+enumXFStyle	XFCellStyle::GetStyleFamily()
+{
+	return enumXFStyleTableCell;
+}
+
+/**
+ *Affirm whether two XFCellStyle objects are equal.
+ */
+sal_Bool	XFCellStyle::Equal(IXFStyle *pStyle)
+{
+	if( this == pStyle )
+		return sal_True;
+	if( !pStyle || pStyle->GetStyleFamily() != enumXFStyleTableCell )
+		return sal_False;
+		
+	XFCellStyle	*pOther = static_cast<XFCellStyle*>(pStyle);
+	if( !pOther )
+		return sal_False;
+
+	if( m_strDataStyle != pOther->m_strDataStyle )
+		return sal_False;
+
+	if( m_strParentStyleName != pOther->m_strParentStyleName )
+		return sal_False;	
+	if( m_fTextIndent != pOther->m_fTextIndent )
+		return sal_False;
+
+	//align:
+	if( m_eHoriAlign != pOther->m_eHoriAlign )
+		return sal_False;
+	if( m_eVertAlign != pOther->m_eVertAlign )
+		return sal_False;
+
+	if( m_aBackColor != pOther->m_aBackColor )
+		return sal_False;
+	//shadow:
+	if( m_aShadow != pOther->m_aShadow )
+		return sal_False;
+	//margin:
+	if( m_aMargin != pOther->m_aMargin )
+		return sal_False;
+	//padding:
+	if( m_aPadding != pOther->m_aPadding )
+		return sal_False;
+
+	//wrap:
+	if( m_bWrapText != pOther->m_bWrapText )
+		return sal_False;
+
+	//font:
+	if( m_pFont )
+	{
+		if( !pOther->m_pFont )
+			return sal_False;
+		if(*m_pFont != *pOther->m_pFont )
+			return sal_False;
+	}
+	else if( pOther->m_pFont )
+		return sal_False;
+
+	//border:
+	if( m_pBorders )
+	{
+		if( !pOther->m_pBorders )
+			return sal_False;
+		if( *m_pBorders != *pOther->m_pBorders )
+			return sal_False;
+	}
+	else if( pOther->m_pBorders )
+		return sal_False;
+
+	//if there is backimage
+	if( m_pBackImage )
+	{
+		if( !pOther->m_pBackImage )
+			return sal_False;
+		if( !m_pBackImage->Equal(pOther) )
+			return sal_False;
+	}
+	else
+	{
+		if( pOther->m_pBackImage )
+			return sal_False;
+	}
+	
+	return sal_True;
+}
+
+void XFCellStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	rtl::OUString style = GetStyleName();	
+	
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute(A2OUSTR("style:name"),GetStyleName());
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	
+	pAttrList->AddAttribute(A2OUSTR("style:family"), A2OUSTR("table-cell"));
+	if( m_strParentStyleName.getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),m_strParentStyleName);	
+	if( m_strDataStyle.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strDataStyle );
+
+	pStrm->StartElement(A2OUSTR("style:style"));	
+	
+	//Paragraph properties:
+	pAttrList->Clear();
+	
+	//text indent:
+	if( m_fTextIndent>FLOAT_MIN )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:text-indent"), DoubleToOUString(m_fTextIndent) + A2OUSTR("cm") );
+	}
+	//padding:
+	m_aPadding.ToXml(pStrm);
+	//margin:
+	m_aMargin.ToXml(pStrm);
+	
+	//text horizontal align:
+	if( m_eHoriAlign != enumXFAlignNone )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:text-align"), GetAlignName(m_eHoriAlign) );
+	}
+	//text vertical align
+	if( m_eVertAlign != enumXFAlignNone )
+		pAttrList->AddAttribute( A2OUSTR("fo:vertical-align"), GetAlignName(m_eVertAlign) );
+	
+	//wrap text:
+	if( m_bWrapText )
+		pAttrList->AddAttribute( A2OUSTR("fo:wrap-option"), A2OUSTR("wrap") );
+
+	//shadow:
+	m_aShadow.ToXml(pStrm);
+	//borders:
+	if( m_pBorders )
+		m_pBorders->ToXml(pStrm);
+	
+	//background color:
+	if( m_aBackColor.IsValid() && !m_pBackImage )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	}
+	//Font properties:
+	if( m_pFont )
+		m_pFont->ToXml(pStrm);
+
+	pStrm->StartElement(A2OUSTR("style:properties"));	
+
+	if( m_pBackImage )
+		m_pBackImage->ToXml(pStrm);
+	
+	pStrm->EndElement(A2OUSTR("style:properties"));
+
+	pStrm->EndElement(A2OUSTR("style:style"));
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcellstyle.hxx lotuswordpro/source/filter/xfilter/xfcellstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcellstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcellstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,204 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table cell style. Number format, string value, and so on...
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create this file.
+ ************************************************************************/
+#ifndef		_XFCELLSTYLE_HXX
+#define		_XFCELLSTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+#include	"xfmargins.hxx"
+#include	"xfpadding.hxx"
+#include	"xfshadow.hxx"
+
+class XFBorders;
+class XFFont;
+class XFBorders;
+class XFMargins;
+class XFBGImage;
+
+/**
+ * @descr	Style obejct for cell. 
+ */
+class XFCellStyle : public XFStyle
+{
+public:
+	XFCellStyle();
+
+	virtual ~XFCellStyle();
+	
+public:	
+	/**
+	 * @descr	Set cell data format style name. 
+	 */
+	void	SetDataStyle(rtl::OUString style);
+
+	/**
+	 * @descr:	Parant paragraph style. 
+	 */
+	void	SetParentStyle(rtl::OUString parent);
+
+	/**
+	 * @descr:	set the paragraph defaut font.
+	 * @param:	font font obejct to be setted.Font object are deleted by font-factory,so
+	 *			dont't delete it in the destructure function of para style.
+	 */
+	void	SetFont(XFFont *font);	
+
+	/**
+	 * @descr:	Set the indent of the paragraph.This is the indent for
+				the first line.
+	 * @param:	indent value of the first-line indent.
+	 */
+	void	SetIndent(double indent );
+
+	/**
+	 * @descr:	Set the pading of the paragraph.This is the distance 
+				between the border and the top of the text.
+	 * @param:	indent value of the padding.
+	 */
+	void	SetPadding(double left, double right = -1, double top = -1, double bottom = -1);
+
+	/**
+	 * @descr:	Set the Margins of the paragraph.
+	 * @param:	-1:		don't change.
+				other:	set value.					
+	 */
+	void	SetMargins(double left, double right=-1,double top=-1, double bottom=-1);
+
+	/**
+	 * @descr:	Set alignment property of the cell.
+	 * @param:	eAlign alignment type,left,right,center or justify.					
+	 */
+	void	SetAlignType(enumXFAlignType hori=enumXFAlignNone, enumXFAlignType vert = enumXFAlignBottom);
+
+	/**
+	 * @descr:	Set the shadow of the paragraph.there is 4 postions, you
+				can find it in the definition of enumShadowPos.
+	 * @param:	pos
+	 * @param:	offset the distance between the paragraph border and the shadow.
+	 * @param:	color color to fill the shadow.
+	 */
+	void	SetShadow(enumXFShadowPos pos, double offset, XFColor& color);
+
+	/**
+	 * @descr:	The borders is complex,so you have to create one before use.
+				Very few paragraphs will readly have borders property,this way
+				we can save much memory.
+	 * @param:	pBorders borders of the paragraph,please reference the XFBorders.
+	 */
+	void	SetBorders(XFBorders *pBorders);
+
+	/**
+	 * @descr:	Set background color of the cell.
+	 * @param:	color value of the back color.	 
+	 */
+	void	SetBackColor(XFColor& color);
+
+	/**
+	 * descr:	set cell background image.
+	 */
+	void	SetBackImage(XFBGImage *pImage);
+
+	/**
+	 * @descr	Set cell value to warp if it's content is too long to be placed in an single cell. 
+	 */
+	void	SetWrapText(sal_Bool wrap);
+
+	virtual enumXFStyle GetStyleFamily();
+
+	virtual sal_Bool Equal(IXFStyle *pStyle);
+
+	virtual void ToXml(IXFStream *pStrm);
+
+private:	
+	rtl::OUString	m_strDataStyle;	
+	rtl::OUString	m_strParentStyleName;	
+	enumXFAlignType	m_eHoriAlign;
+	enumXFAlignType	m_eVertAlign;
+	
+	double		m_fTextIndent;	
+	XFColor		m_aBackColor;
+	XFBGImage	*m_pBackImage;
+	XFMargins	m_aMargin;
+	XFPadding	m_aPadding;
+	XFFont		*m_pFont;		
+	XFShadow	m_aShadow;
+	XFBorders	*m_pBorders;
+	sal_Bool	m_bWrapText;
+};
+
+inline void	XFCellStyle::SetAlignType(enumXFAlignType hori, enumXFAlignType vert)
+{
+	m_eHoriAlign = hori;
+	m_eVertAlign = vert;
+}
+
+inline void XFCellStyle::SetDataStyle(rtl::OUString style)
+{
+	m_strDataStyle = style;
+}
+
+inline void XFCellStyle::SetWrapText(sal_Bool wrap)
+{
+	m_bWrapText = wrap;
+}
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchange.cxx lotuswordpro/source/filter/xfilter/xfchange.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfchange.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchange.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,166 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ *  For LWP filter architecture prototype
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ Jun 2005			Created
+ ************************************************************************/
+#include "xfchange.hxx"
+
+void XFChangeList::ToXml(IXFStream *pStrm)
+{
+	if (XFContentContainer::GetCount() == 0)
+			return;
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+//Add by ,for disable change tracking,2005/11/21
+	pAttrList->AddAttribute( A2OUSTR("text:track-changes"),A2OUSTR("false"));
+//Add end	
+	pStrm->StartElement( A2OUSTR("text:tracked-changes") );
+	XFContentContainer::ToXml(pStrm);
+	pStrm->EndElement(A2OUSTR("text:tracked-changes"));	
+}
+
+void XFChangeRegion::ToXml(IXFStream *pStrm)
+{
+}
+
+void XFChangeInsert::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if(m_sID.getLength() == 0)
+		return;
+	pAttrList->AddAttribute( A2OUSTR("text:id"),m_sID);
+	
+	pStrm->StartElement( A2OUSTR("text:changed-region") );
+	pStrm->StartElement( A2OUSTR("text:insertion") );
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("office:chg-author"),m_sEditor);
+	pAttrList->AddAttribute( A2OUSTR("office:chg-date-time"),A2OUSTR("0000-00-00T00:00:00"));
+	pStrm->StartElement( A2OUSTR("office:change-info") );	
+	pStrm->EndElement( A2OUSTR("office:change-info") );					
+	pStrm->EndElement( A2OUSTR("text:insertion") );	
+	pStrm->EndElement( A2OUSTR("text:changed-region") );		
+}
+
+void XFChangeDelete::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if(m_sID.getLength() == 0)
+		return;
+	pAttrList->AddAttribute( A2OUSTR("text:id"),m_sID);
+	
+	pStrm->StartElement( A2OUSTR("text:changed-region") );
+	pStrm->StartElement( A2OUSTR("text:deletion") );
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("office:chg-author"),m_sEditor);
+	pAttrList->AddAttribute( A2OUSTR("office:chg-date-time"),A2OUSTR("0000-00-00T00:00:00"));
+	pStrm->StartElement( A2OUSTR("office:change-info") );	
+	pStrm->EndElement( A2OUSTR("office:change-info") );
+	
+///	XFContentContainer::ToXml(pStrm);//delete , note by ,2005/7/1
+						
+	pStrm->EndElement( A2OUSTR("text:deletion") );	
+	pStrm->EndElement( A2OUSTR("text:changed-region") );				
+}
+ 
+void XFChange::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if(m_sID.getLength() == 0)
+		return;
+	pAttrList->AddAttribute( A2OUSTR("text:change-id"),m_sID);
+	
+	pStrm->StartElement( A2OUSTR("text:change") );	
+	pStrm->EndElement( A2OUSTR("text:change") );		
+}
+
+void XFChangeStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if(m_sID.getLength() == 0)
+		return;
+	pAttrList->AddAttribute( A2OUSTR("text:change-id"),m_sID);
+	
+	pStrm->StartElement( A2OUSTR("text:change-start") );	
+	pStrm->EndElement( A2OUSTR("text:change-start") );		
+}
+
+void XFChangeEnd::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if(m_sID.getLength() == 0)
+		return;
+	pAttrList->AddAttribute( A2OUSTR("text:change-id"),m_sID);
+	
+	pStrm->StartElement( A2OUSTR("text:change-end") );	
+	pStrm->EndElement( A2OUSTR("text:change-end") );		
+}
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchange.hxx lotuswordpro/source/filter/xfilter/xfchange.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfchange.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchange.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,146 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ *  For LWP filter architecture prototype
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ Jun 2005			Created
+ ************************************************************************/
+#ifndef _XFCHANGE_HXX_
+#define _XFCHANGE_HXX_
+
+#include "xfglobal.hxx"
+#include "ixfstream.hxx"
+#include "xfcontent.hxx"
+#include "xfcontentcontainer.hxx"
+#include <rtl/ustring.hxx>
+
+class XFChangeList : public XFContentContainer
+{
+public:
+	XFChangeList(){};
+	~XFChangeList(){};
+	virtual void ToXml(IXFStream *pStrm);
+};
+
+class XFChangeRegion : public XFContentContainer
+{
+public:
+	XFChangeRegion(){};
+	~XFChangeRegion(){};
+	virtual void ToXml(IXFStream *pStrm);
+	void SetChangeID(rtl::OUString sID){m_sID=sID;}
+	rtl::OUString GetChangeID(){return m_sID;}
+	void SetEditor(rtl::OUString sEditor){m_sEditor=sEditor;}	
+protected:
+	rtl::OUString m_sID;
+	rtl::OUString m_sEditor;
+};
+
+class XFChangeInsert : public XFChangeRegion
+{
+public:
+	XFChangeInsert(){};
+	~XFChangeInsert(){};
+	void ToXml(IXFStream *pStrm);
+};
+
+class XFChangeDelete : public XFChangeRegion
+{
+public:
+	XFChangeDelete(){};
+	~XFChangeDelete(){};
+	void ToXml(IXFStream *pStrm);
+};
+
+class XFChange : public XFContent
+{
+public:
+	XFChange(){};
+	~XFChange(){};
+	void ToXml(IXFStream *pStrm);
+	void SetChangeID(rtl::OUString sID){m_sID=sID;}
+	rtl::OUString GetChangeID(){return m_sID;}
+private:
+	rtl::OUString m_sID;
+};
+
+class XFChangeStart : public XFContent
+{
+public:
+	XFChangeStart(){};
+	~XFChangeStart(){};
+	void ToXml(IXFStream *pStrm);
+	void SetChangeID(rtl::OUString sID){m_sID=sID;}
+	rtl::OUString GetChangeID(){return m_sID;}
+private:
+	rtl::OUString m_sID;
+};
+
+class XFChangeEnd : public XFContent
+{
+public:
+	XFChangeEnd(){};
+	~XFChangeEnd(){};
+	void ToXml(IXFStream *pStrm);
+	void SetChangeID(rtl::OUString sID){m_sID=sID;}
+	rtl::OUString GetChangeID(){return m_sID;}
+private:
+	rtl::OUString m_sID;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchartstreamtools.cxx lotuswordpro/source/filter/xfilter/xfchartstreamtools.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfchartstreamtools.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchartstreamtools.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,117 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*****************************************************************************
+* Change History
+* <<Date>> <<Name of editor>> <<Description>>
+2005/2		draft code for implementation of chart stream helpers
+****************************************************************************/
+
+/**
+ * @file 
+ *  For LWP filter architecture prototype
+*/
+
+#include "xfchartstreamtools.hxx"
+#include "xfdrawchart.hxx"
+#include "xfparagraph.hxx"
+
+#include <com/sun/star/xml/sax/SAXParseException.hpp>
+#include <com/sun/star/lang/XMultiServiceFactory.hpp>
+
+/**
+* @short   Parse the xml stream
+* @param  rInpStream the xml stream
+* @param   aHandler	xml handler
+*/
+void XFChartStreamTools::ParseStream(SvStorageStreamRef rInpStream, Reference<XDocumentHandler> aHandler)
+{
+	//Create parser
+	uno::Reference< xml::sax::XParser > xParser;
+	{
+		uno::Reference< lang::XMultiServiceFactory>
+			xServiceFactory( ::comphelper::getProcessServiceFactory() );
+		if( !xServiceFactory.is() )
+		{
+			assert(false);
+			return;
+		}
+		xParser = uno::Reference< xml::sax::XParser > (
+			xServiceFactory->createInstance( ::rtl::OUString::createFromAscii( "com.sun.star.xml.sax.Parser" )),
+			uno::UNO_QUERY );
+
+		if( ! xParser.is() )
+		{
+			assert(false);
+			return;
+		}
+	}
+
+	xParser->setDocumentHandler( aHandler );
+	xml::sax::InputSource aParserInput;
+	aParserInput.aInputStream = rInpStream->GetXInputStream();		
+	xParser->parseStream( aParserInput );
+}
+
+/**
+* @short	Parse the xml stream, content.xml & styles.xml for chart
+* @param	rStyleStream	styles xml stream
+* @param	rCntStream	the content xml stream
+* @param   pOutputStream the output stream
+*/
+void XFChartStreamTools::ParseStream(SvStorageStreamRef rCntStream,IXFStream* pOutputStream)
+{
+	Reference<XDocumentHandler> pHandler( new XFChartXMLHandler(pOutputStream) );
+	ParseStream(rCntStream,pHandler);
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchartstreamtools.hxx lotuswordpro/source/filter/xfilter/xfchartstreamtools.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfchartstreamtools.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchartstreamtools.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,112 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*****************************************************************************
+* Change History
+* <<Date>> <<Name of editor>> <<Description>>
+2005/2		draft code for chart stream helpers
+****************************************************************************/
+
+/**
+ * @file 
+ *  For LWP filter architecture prototype
+*/
+
+#ifndef LWPCHARTSTREAMTOOLS_HXX_
+#define LWPCHARTSTREAMTOOLS_HXX_
+
+#include <tools/stream.hxx>
+#include <tools/gen.hxx>
+
+//For sax parser
+#ifndef _COM_SUN_STAR_XML_SAX_INPUTSOURCE_HPP_
+#include <com/sun/star/xml/sax/InputSource.hpp>
+#endif
+
+#ifndef _COM_SUN_STAR_XML_SAX_XDTDHANDLER_HPP_
+#include <com/sun/star/xml/sax/XDTDHandler.hpp>
+#endif
+
+#ifndef _COM_SUN_STAR_XML_SAX_XPARSER_HPP_
+#include <com/sun/star/xml/sax/XParser.hpp>
+#endif
+
+#ifndef _COMPHELPER_PROCESSFACTORY_HXX_
+#include <comphelper/processfactory.hxx>
+#endif
+
+using namespace ::com::sun::star;
+using namespace ::rtl;
+using namespace comphelper;
+
+#include "xfchartxmlhandler.hxx"
+#include "xfrect.hxx"
+class IXFContent;
+
+/**
+* @brief
+* tools class for chart stream process
+*/
+
+class XFChartStreamTools
+{
+public:
+	static void ParseStream(SvStorageStreamRef rInpStream, Reference<XDocumentHandler> aHandler);
+
+	static void ParseStream(	SvStorageStreamRef rCntStream,
+								IXFStream* pOutputStream);
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchartxmlhandler.cxx lotuswordpro/source/filter/xfilter/xfchartxmlhandler.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfchartxmlhandler.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchartxmlhandler.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,125 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*****************************************************************************
+* Change History
+* <<Date>> <<Name of editor>> <<Description>>
+	2005/2		draft code for Implementation of chart xml hander
+****************************************************************************/
+/**
+* @file 
+*  For LWP filter architecture prototype
+*/
+
+#include "xfchartxmlhandler.hxx"
+
+Any SAL_CALL XFChartXMLHandler::queryInterface( const Type & rType ) throw( RuntimeException )
+{
+	Any a = ::cppu::queryInterface( rType ,SAL_STATIC_CAST( XDocumentHandler*, this ));
+	if ( a.hasValue() )
+		return a;
+	else
+		return OWeakObject::queryInterface( rType );
+}
+
+/**
+* @short   constructor of chart xml handler
+* @descr   
+* @param   pOutputStream the output stream
+*/
+XFChartXMLHandler::XFChartXMLHandler(IXFStream* pOutputStream)
+{
+	m_pOutputStream = pOutputStream;
+}
+
+/**
+* @short   handle the start element
+* @descr   ignore some elements here 
+* @param   aName	element name
+* @param   xAttribs the attribute list 
+*/
+void SAL_CALL XFChartXMLHandler::startElement( const ::rtl::OUString& aName, const Reference< XAttributeList >& xAttribs )
+throw (SAXException, RuntimeException)
+{
+	IXFAttrList* pList = m_pOutputStream->GetAttrList();
+	pList->Clear();
+	{
+		INT16 nLen = xAttribs->getLength(); 
+		for( INT16 nC=0;nC<nLen;nC++)
+		{
+			OUString aName = xAttribs->getNameByIndex(nC);
+			OUString aVal = xAttribs->getValueByIndex(nC);
+			pList->AddAttribute(aName, aVal);
+		}
+	}
+
+	m_pOutputStream->StartElement(aName);
+}
+
+/**
+* @short   handle the end element
+* @descr   ignore some elements here 
+* @param   aName	element name
+*/
+void SAL_CALL XFChartXMLHandler::endElement( const ::rtl::OUString& aName ) 
+throw (SAXException, RuntimeException)
+{
+	m_pOutputStream->EndElement(aName);
+}
+
+void SAL_CALL XFChartXMLHandler::characters( const ::rtl::OUString& aChars ) 
+throw (SAXException, RuntimeException)
+{
+	m_pOutputStream->Characters(aChars);
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfchartxmlhandler.hxx lotuswordpro/source/filter/xfilter/xfchartxmlhandler.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfchartxmlhandler.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfchartxmlhandler.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,129 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*****************************************************************************
+* Change History
+* <<Date>> <<Name of editor>> <<Description>>
+*	2005/2		draft code for XML handler of chart xml.
+****************************************************************************/
+
+/*************************************************************************
+ * @file 
+ *  For LWP filter architecture prototype
+ ************************************************************************/
+
+#ifndef XFCHARTXMLHANDLER_HXX_
+#define XFCHARTXMLHANDLER_HXX_
+
+#include <cppuhelper/weak.hxx>
+#include <com/sun/star/xml/sax/XAttributeList.hpp>
+#include <com/sun/star/xml/sax/XDocumentHandler.hpp>
+#include <com/sun/star/xml/sax/SAXParseException.hpp>
+#include <com/sun/star/uno/RuntimeException.hpp>
+
+#include <so3/svstor.hxx>
+#include "ixfstream.hxx"
+#include "ixfattrlist.hxx"
+#include <rtl/ustring.hxx>
+using namespace rtl;
+using namespace ::com::sun::star::xml::sax;
+using namespace ::com::sun::star::uno;
+
+/**
+* @brief
+* Chart xml handler
+*/
+
+class XFChartXMLHandler: public XDocumentHandler,public ::cppu::OWeakObject
+{
+public:
+	XFChartXMLHandler(IXFStream* pOutputStream);
+
+	// XInterface
+	virtual void SAL_CALL acquire() throw()
+	{ OWeakObject::acquire(); }
+	virtual void SAL_CALL release() throw()
+	{ OWeakObject::release(); }
+	virtual ::com::sun::star::uno::Any SAL_CALL queryInterface( 
+		const ::com::sun::star::uno::Type & rType ) throw( ::com::sun::star::uno::RuntimeException );
+
+	virtual void SAL_CALL startDocument(  ) 
+		throw (SAXException, RuntimeException) {}
+
+		virtual void SAL_CALL endDocument(  ) 
+			throw (SAXException, RuntimeException) {}
+
+	virtual void SAL_CALL startElement( const ::rtl::OUString& aName, const Reference< XAttributeList >& xAttribs )
+		throw (SAXException, RuntimeException);
+
+	virtual void SAL_CALL endElement( const ::rtl::OUString& aName ) 
+		throw (SAXException, RuntimeException);
+
+	virtual void SAL_CALL characters( const ::rtl::OUString& aChars ) 
+		throw (SAXException, RuntimeException);
+
+	virtual void SAL_CALL ignorableWhitespace( const ::rtl::OUString& aWhitespaces )
+		throw (SAXException, RuntimeException){}
+
+	virtual void SAL_CALL processingInstruction( const ::rtl::OUString& aTarget, const ::rtl::OUString& aData )
+		throw (SAXException, RuntimeException){}
+
+	virtual void SAL_CALL setDocumentLocator( const Reference< XLocator >& xLocator )
+		throw (SAXException, RuntimeException){}
+protected:
+	IXFStream* m_pOutputStream;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolor.cxx lotuswordpro/source/filter/xfilter/xfcolor.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolor.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolor.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,92 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Color object to serial to xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#include <stdio.h>
+#include	"xfcolor.hxx"
+
+rtl::OUString XFColor::ToString() const
+{
+	char	buf[8];
+	
+	rtl_zeroMemory(buf,8);
+	sprintf(buf,"#%2x%2x%2x",m_nRed, m_nGreen, m_nBlue);
+	for( int i=1; i<7;i++ )
+	{
+		if( buf[i] == ' ' )
+			buf[i] = '0';
+	}
+	return rtl::OUString::createFromAscii(buf);
+}
+
+bool operator==(XFColor& c1, XFColor& c2)
+{
+	return (
+		(c1.m_nRed==c2.m_nRed)&&
+		(c1.m_nGreen==c2.m_nGreen)&&
+		(c1.m_nBlue==c2.m_nBlue)
+		);
+}
+
+bool operator!=(XFColor& c1, XFColor& c2)
+{
+	return !(c1==c2);
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolor.hxx lotuswordpro/source/filter/xfilter/xfcolor.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolor.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolor.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,133 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Color object to serial to xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#ifndef		_XFCOLOR_HXX
+#define		_XFCOLOR_HXX
+
+#include	"xfglobal.hxx"
+
+/**
+ * @brief
+ * Color object.
+ */
+class XFColor
+{
+public:
+	XFColor():m_nRed((sal_Int8)0),m_nGreen((sal_Int8)0),m_nBlue((sal_Int8)0)
+	{
+		m_bValid = sal_False;
+	}
+	XFColor(sal_Int32 red, sal_Int32 green, sal_Int32 blue)
+		:m_nRed((sal_Int8)red),m_nGreen((sal_Int8)green),m_nBlue((sal_Int8)blue)
+	{	
+		m_bValid = sal_True;
+	}
+	XFColor(sal_uInt32 color)
+	{
+		unsigned int	c = color&0x00ffffff;
+		unsigned int	temp = c;
+		m_nRed = temp&0x000000ff;
+		
+		temp = c;
+		m_nGreen = (temp&0x0000ff00)>>8;
+		
+		temp = c;
+		m_nBlue = (temp&0x00ff0000)>>16;
+
+		m_bValid = sal_True;
+	}
+
+	/**
+	 * @descr	return red part of the color. 
+	 */
+	sal_uInt8	GetRed() const{ return m_nRed; }
+
+	/**
+	 * @descr	return green part of the color. 
+	 */
+	sal_uInt8	GetGreen() const{ return m_nGreen; }
+
+	/**
+	 * @descr	return blue part of the color. 
+	 */
+	sal_uInt8	GetBlue() const{ return m_nBlue; }
+
+	/**
+	 * @descr	helper function to assert whether a color is valid. 
+	 */
+	sal_Bool	IsValid() const{ return m_bValid;};
+
+	rtl::OUString	ToString ()const;
+
+	friend bool operator==(XFColor& c1, XFColor& c2);
+	friend bool operator!=(XFColor& c1, XFColor& c2);
+private:
+	sal_uInt8	m_nRed;
+	sal_uInt8	m_nGreen;
+	sal_uInt8	m_nBlue;
+	sal_Bool	m_bValid;
+};
+
+#endif
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolstyle.cxx lotuswordpro/source/filter/xfilter/xfcolstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,95 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Column style object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-17 create this file.
+ ************************************************************************/
+#include	"xfcolstyle.hxx"
+
+XFColStyle::XFColStyle()
+{
+	m_fWidth = 0;
+}
+
+XFColStyle::~XFColStyle()
+{
+}
+
+enumXFStyle	XFColStyle::GetStyleFamily()
+{
+	return enumXFStyleTableCol;
+}
+
+void	XFColStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("table-column") );
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:column-width"), DoubleToOUString(m_fWidth) + A2OUSTR("cm") );
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolstyle.hxx lotuswordpro/source/filter/xfilter/xfcolstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,112 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Column style object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-17 create this file.
+ ************************************************************************/
+#ifndef		_XFCOLSTYLE_HXX
+#define		_XFCOLSTYLE_HXX
+
+#include	"xfstyle.hxx"
+
+/**
+ * @brief
+ * Column style, it has only one property-the column width.
+ */
+class	XFColStyle : public XFStyle
+{
+public:
+	XFColStyle();
+
+	virtual ~XFColStyle();
+
+public:
+	/**
+	 * @descr	Set column width. 
+	 */
+	void	SetWidth(double width);
+
+	/**
+	 * @descr	return column width. 
+	 */
+	double	GetWidth();
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	/**
+	 * @descr	output column style as an xml node. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:	
+	double		m_fWidth;
+};
+
+inline void	XFColStyle::SetWidth(double width)
+{
+	m_fWidth = width;
+}
+
+inline double XFColStyle::GetWidth()
+{
+	return m_fWidth;
+}
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolumns.cxx lotuswordpro/source/filter/xfilter/xfcolumns.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolumns.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolumns.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,213 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Columns styles for section, or paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+
+#include	"xfcolumns.hxx"
+
+void	XFColumn::SetRelWidth(sal_Int32 width)
+{
+	m_nRelWidth = width;
+}
+
+sal_Int32 XFColumn::GetRelWidth()
+{
+	return m_nRelWidth;
+}
+
+void	XFColumn::SetMargins(double left, double right)
+{
+	m_fMarginLeft = left;
+	m_fMarginRight = right;
+}
+
+double	XFColumn::GetMarginLeft()
+{
+	return m_fMarginLeft;
+}
+double	XFColumn::GetMarginRight()
+{
+	return m_fMarginRight;
+}
+
+void	XFColumn::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	pAttrList->AddAttribute( A2OUSTR("style:rel-width"), Int32ToOUString(m_nRelWidth) + A2OUSTR("*") );
+	pAttrList->AddAttribute( A2OUSTR("fo:margin-left"), DoubleToOUString(m_fMarginLeft) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("fo:margin-right"), DoubleToOUString(m_fMarginRight) + A2OUSTR("cm") );
+	
+	pStrm->StartElement( A2OUSTR("style:column") );
+	pStrm->EndElement( A2OUSTR("style:column") );
+}
+
+void	XFColumnSep::SetRelHeight(sal_Int32 height)
+{
+	assert(height>=0&&height<=100);
+	m_nRelHeight = height;
+}
+void	XFColumnSep::SetWidth(double width)
+{
+	m_fWidth = width;
+}
+void	XFColumnSep::SetColor(XFColor& color)
+{
+	m_aColor = color;
+}
+void	XFColumnSep::SetVerticalAlign(enumXFAlignType align)
+{
+	m_eVertAlign = align;
+}
+
+void	XFColumnSep::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:width"), DoubleToOUString(m_fWidth) + A2OUSTR("cm") );
+	if( m_aColor.IsValid() )
+		pAttrList->AddAttribute( A2OUSTR("style:color"), m_aColor.ToString() );
+	pAttrList->AddAttribute( A2OUSTR("style:height"), Int32ToOUString(m_nRelHeight) + A2OUSTR("%") );
+	//text align:
+	if( m_eVertAlign == enumXFAlignTop )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:vertical-align"),A2OUSTR("top"));
+	}
+	else if( m_eVertAlign == enumXFAlignMiddle )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:vertical-align"),A2OUSTR("middle"));
+	}
+	else if( m_eVertAlign == enumXFAlignBottom )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:vertical-align"),A2OUSTR("bottom"));
+	}
+	
+	pStrm->StartElement( A2OUSTR("style:column-sep") );
+	pStrm->EndElement( A2OUSTR("style:column-sep") );
+}
+
+void	XFColumns::SetSeperator(sal_Int32 height, double width, XFColor color,enumXFAlignType align)
+{
+	m_aSeperator.SetRelHeight(height);
+	m_aSeperator.SetWidth(0.1);
+	m_aSeperator.SetColor(color);
+	m_aSeperator.SetVerticalAlign(align);
+	m_nFlag |= XFCOLUMNS_FLAG_SEPERATOR;
+}
+
+void	XFColumns::SetSeperator(XFColumnSep& aSeperator)
+{
+	m_aSeperator = aSeperator;
+	m_nFlag |= XFCOLUMNS_FLAG_SEPERATOR;
+}
+
+void	XFColumns::AddColumn(XFColumn& column)
+{
+	m_aColumns.push_back(column);
+}
+
+sal_Int32	XFColumns::GetCount()
+{	 
+	return m_aColumns.size();;
+}
+
+void	XFColumns::SetGap(double fGap)
+{
+	m_fGap = fGap;
+	m_nFlag |= XFCOLUMNS_FLAG_GAP;
+}
+
+void	XFColumns::SetCount(sal_uInt16 nCount)
+{
+	m_nCount = nCount;
+}
+
+void	XFColumns::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	//pAttrList->AddAttribute( A2OUSTR("fo:column-count"), Int32ToOUString(GetCount()) );
+	pAttrList->AddAttribute( A2OUSTR("fo:column-count"), Int32ToOUString(m_nCount));
+	if( m_nFlag&XFCOLUMNS_FLAG_GAP )	
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:column-gap"), DoubleToOUString(m_fGap)+A2OUSTR("cm") );
+	}
+
+	pStrm->StartElement( A2OUSTR("style:columns") );
+	
+	if( m_nFlag&XFCOLUMNS_FLAG_SEPERATOR )	//column-sep:
+	{
+		m_aSeperator.ToXml(pStrm);
+	}
+
+	if(!(m_nFlag&XFCOLUMNS_FLAG_GAP) )
+	{
+		std::vector<XFColumn>::iterator it;
+		for( it = m_aColumns.begin(); it != m_aColumns.end(); it++ )
+		{
+			(*it).ToXml(pStrm);
+		}
+	}
+	pStrm->EndElement( A2OUSTR("style:columns") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcolumns.hxx lotuswordpro/source/filter/xfilter/xfcolumns.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcolumns.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcolumns.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,180 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Columns styles for section, or paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#ifndef		_XFCOLUMNS_HXX
+#define		_XFCOLUMNS_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcolor.hxx"
+#include	<vector>
+
+#define		XFCOLUMNS_FLAG_SEPERATOR	0X00000001
+#define		XFCOLUMNS_FLAG_GAP			0X00000010
+
+/**
+ * @descr	Columns object for page or section. 
+ */
+class XFColumn : public IXFObject
+{
+public:
+	XFColumn()
+	{
+		m_nRelWidth = 0;
+		m_fMarginLeft = 0;
+		m_fMarginRight = 0;
+	}
+
+public:
+	/**
+	 * @descr	Set column relative width. 
+	 */
+	void	SetRelWidth(sal_Int32 width);
+
+	/**
+	 * @descr	return column relative width. 
+	 */
+	sal_Int32 GetRelWidth();	
+
+	/**
+	 * @descr	Set column margin left and margin right. 
+	 */
+	void	SetMargins(double left, double right);
+
+	/**
+	 * @descr	return column left margin. 
+	 */
+	double	GetMarginLeft();
+
+	/**
+	 * @descr	return column right margin. 
+	 */
+	double	GetMarginRight();
+
+	/**
+	 * @descr	output column style as an xml node. 
+	 */
+	virtual void ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFColumn& c1, XFColumn& c2);
+	friend bool operator!=(XFColumn& c1, XFColumn& c2);
+	friend class XFColumns;
+
+private:
+	sal_Int32	m_nRelWidth;
+	double		m_fMarginLeft;
+	double		m_fMarginRight;
+};
+
+class XFColumnSep : public IXFObject
+{
+public:
+	XFColumnSep()
+	{
+		m_nRelHeight = 100;
+		m_fWidth = 0;
+		m_eVertAlign = enumXFAlignMiddle;
+	}
+public:
+	void	SetRelHeight(sal_Int32 height);
+	void	SetWidth(double width);
+	void	SetColor(XFColor& color);
+	void	SetVerticalAlign(enumXFAlignType align);
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFColumnSep& sep1, XFColumnSep& sep2);
+	friend bool operator!=(XFColumnSep& sep1, XFColumnSep& sep2);
+	friend class XFColumns;
+private:
+	sal_Int32	m_nRelHeight;
+	double		m_fWidth;
+	XFColor		m_aColor;
+	enumXFAlignType	m_eVertAlign;
+};
+
+class XFColumns
+{
+public:
+	XFColumns()
+	{
+		m_nFlag = 0;
+		m_fGap = 0;
+	}
+public:
+	void	SetSeperator(sal_Int32 height, double width, XFColor color = XFColor(0,0,0),enumXFAlignType align = enumXFAlignMiddle);
+	void	SetSeperator(XFColumnSep& aSeperator);	
+	void	SetGap(double fGap);
+	void	SetCount(sal_uInt16 nCount);
+	void	AddColumn(XFColumn& column);
+	sal_Int32	GetCount();
+	
+	void	ToXml(IXFStream *pStrm);
+private:
+	sal_Int32	m_nFlag;
+	sal_uInt16  m_nCount;
+	double		m_fGap;
+	std::vector<XFColumn>	m_aColumns;
+	XFColumnSep m_aSeperator;
+
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfconditionformat.hxx lotuswordpro/source/filter/xfilter/xfconditionformat.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfconditionformat.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfconditionformat.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,70 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+#ifndef		_XFCONDITIONFORMAT_HXX
+#define		_XFCONDITIONFORMAT_HXX
+
+class XFConditionFormat
+{
+public:
+	XFConditionFormat();
+
+public:
+	void	SetCondition();
+
+private:
+	
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfconfigmanager.cxx lotuswordpro/source/filter/xfilter/xfconfigmanager.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfconfigmanager.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfconfigmanager.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,108 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Manager for all config object,include line number config.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-23 create this file.
+ ************************************************************************/
+#include	"xfconfigmanager.hxx"
+
+XFConfigManager::XFConfigManager()
+{
+	m_pLineNumberConfig = NULL;
+	m_pFootnoteConfig = NULL;
+	m_pEndnoteConfig = NULL;
+}
+
+void	XFConfigManager::SetLineNumberConfig(XFLineNumberConfig *pLNConfig)
+{
+	if( m_pLineNumberConfig )
+		delete m_pLineNumberConfig;
+	m_pLineNumberConfig = pLNConfig;
+}
+
+void	XFConfigManager::SetFootnoteConfig(XFFootnoteConfig *pFNConfig)
+{
+	if( m_pFootnoteConfig )
+		delete m_pFootnoteConfig;
+	m_pFootnoteConfig = pFNConfig;
+}
+
+void	XFConfigManager::SetEndnoteConfig(XFEndnoteConfig *pENConfig)
+{
+	if( m_pEndnoteConfig )
+		delete m_pEndnoteConfig;
+	m_pEndnoteConfig = pENConfig;
+}
+
+void	XFConfigManager::ToXml(IXFStream *pStrm)
+{
+	if( m_pLineNumberConfig )
+		AddStyle(m_pLineNumberConfig);
+	if( m_pFootnoteConfig )
+		AddStyle(m_pFootnoteConfig);
+	if( m_pEndnoteConfig )
+		AddStyle(m_pEndnoteConfig);
+
+	XFStyleContainer::ToXml(pStrm);
+	XFStyleContainer::Reset();
+	m_pLineNumberConfig = NULL;
+	m_pFootnoteConfig = NULL;
+	m_pEndnoteConfig = NULL;
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfconfigmanager.hxx lotuswordpro/source/filter/xfilter/xfconfigmanager.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfconfigmanager.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfconfigmanager.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,110 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Manager for all config object,include line number config.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-23 create this file.
+ ************************************************************************/
+#ifndef		_XFCONFIGMANAGER_HXX
+#define		_XFCONFIGMANAGER_HXX
+
+#include	"xfstylecont.hxx"
+#include	"xflinenumberconfig.hxx"
+#include	"xffootnoteconfig.hxx"
+#include	"xfendnoteconfig.hxx"
+#include	"xfdefs.hxx"
+
+/**
+ * @brief
+ * Config infomation for OOo document, ie, line count config, endnote and footnote config.
+ * This object should only exist one instance.
+ * Don't make this obejct an singleton because it's managed by XFStyleManager.
+ */
+class XFConfigManager : public XFStyleContainer
+{
+public:
+	XFConfigManager();
+
+public:
+	/**
+	 * @descr	Set line number config. 
+	 */
+	void	SetLineNumberConfig(XFLineNumberConfig *pLNConfig);
+
+	/**
+	 * @descr	Set footnote config. 
+	 */
+	void	SetFootnoteConfig(XFFootnoteConfig *pFNConfig);
+
+	/**
+	 * @descr	Set endnote config. 
+	 */
+	void	SetEndnoteConfig(XFEndnoteConfig *pFNConfig);
+
+	/**
+	 * @descr	Output config information. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+	
+private:
+	XFLineNumberConfig	*m_pLineNumberConfig;
+	XFFootnoteConfig	*m_pFootnoteConfig;
+	XFEndnoteConfig		*m_pEndnoteConfig;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcontentcontainer.cxx lotuswordpro/source/filter/xfilter/xfcontentcontainer.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcontentcontainer.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcontentcontainer.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,218 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Container for content.It will destroy all children when destroy.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-27 create this file.
+ * 2005-04-08 add copy constructure.
+ ************************************************************************/
+#include	"xfcontentcontainer.hxx"
+#include	"xftextcontent.hxx"
+
+XFContentContainer::XFContentContainer()
+{
+}
+
+XFContentContainer::XFContentContainer(const XFContentContainer& other)
+{
+	std::vector<IXFContent*>::const_iterator it;
+	
+	for( it = other.m_aContents.begin(); it != other.m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+		{
+			IXFContent *pClone = pContent->Clone();
+			if( pClone )
+				Add(pClone);
+		}
+	}
+}
+
+XFContentContainer& XFContentContainer::operator=(const XFContentContainer& other)
+{
+	std::vector<IXFContent*>::const_iterator it;
+	
+	for( it = other.m_aContents.begin(); it != other.m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+		{
+			IXFContent *pClone = pContent->Clone();
+			if( pClone )
+				Add(pClone);
+		}
+	}
+	return *this;
+}
+
+XFContentContainer::~XFContentContainer()
+{
+	std::vector<IXFContent*>::iterator it;
+
+	for( it = m_aContents.begin(); it != m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			delete pContent;
+	}
+}
+
+void	XFContentContainer::Add(IXFContent *pContent)
+{
+	m_aContents.push_back(pContent);
+}
+
+void XFContentContainer::InsertAtBegin(IXFContent * pContent)
+{
+	m_aContents.insert(m_aContents.begin(), pContent);
+}
+void XFContentContainer::RemoveAt(sal_uInt32 nPos)
+{
+	m_aContents.erase(m_aContents.begin()+nPos);
+}
+void	XFContentContainer::Add(const rtl::OUString& text)
+{
+	XFTextContent *pTC = new XFTextContent();
+	pTC->SetText(text);
+	Add(pTC);
+}
+
+int		XFContentContainer::GetCount() const
+{
+	return m_aContents.size();
+}
+
+void	XFContentContainer::Reset()
+{
+	std::vector<IXFContent*>::iterator it;
+	
+	for( it = m_aContents.begin(); it != m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			delete pContent;
+	}
+	m_aContents.clear();
+}
+
+
+IXFContent*	XFContentContainer::FindFirstContent(enumXFContent type)
+{
+	IXFContent *pRet = NULL;
+	IXFContent	*pContent = NULL;
+	
+	for( int i=0; i<GetCount(); i++ )
+	{
+		pContent = GetContent(i);
+		if( !pContent )
+			continue;
+		
+		enumXFContent eType = pContent->GetContentType();
+		if( eType == type )
+			return pContent;
+		else
+		{
+			XFContentContainer *pChildCont = static_cast<XFContentContainer*>(pContent);
+			if( pChildCont )
+			{
+				pRet = pChildCont->FindFirstContent(type);
+				if( pRet )
+					return pRet;
+			}
+		}
+	}
+	return pRet;
+}
+
+enumXFContent	XFContentContainer::GetContentType()
+{
+	return enumXFContentContainer;
+}
+
+void	XFContentContainer::ToXml(IXFStream *pStrm)
+{
+	std::vector<IXFContent*>::iterator it;
+	
+	for( it = m_aContents.begin(); it != m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			pContent->ToXml(pStrm);
+	}
+}
+
+IXFContent* XFContentContainer::GetLastContent()
+{
+	sal_uInt32 index = m_aContents.size()-1;
+	if(index >0)
+	{
+		return m_aContents[index];
+	}
+
+	return NULL;
+}
+
+void XFContentContainer::RemoveLastContent()
+{
+	sal_uInt32 index = m_aContents.size()-1;
+	if(index >0)
+	{
+		m_aContents.erase(m_aContents.begin() + index);
+	}
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcontentcontainer.hxx lotuswordpro/source/filter/xfilter/xfcontentcontainer.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcontentcontainer.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcontentcontainer.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,143 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Container for content.It will destroy all children when destroy.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-27 create this file.
+ * 2005-04-20 change add to virtual.
+ ************************************************************************/
+#ifndef		_XFCONTENTCONTAINER_HXX
+#define		_XFCONTENTCONTAINER_HXX
+
+#include	"xfcontent.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * A container for content.
+ * The contents will be deleted when delete container.
+ */
+class XFContentContainer : public XFContent
+{
+public:
+	XFContentContainer();
+
+	XFContentContainer(const XFContentContainer& other);
+
+	XFContentContainer& operator=(const XFContentContainer& other);
+
+	/**
+	 * @descr	Destructure, all contents will be deleted too. 
+	 */
+	virtual ~XFContentContainer();
+
+public:
+	/**
+	 * @descr	Add conent. 
+	 */
+	virtual void	Add(IXFContent *pContent);	
+
+	virtual void 	InsertAtBegin(IXFContent *pContent);
+	virtual void 	RemoveAt(sal_uInt32 nPos);
+	virtual IXFContent* GetLastContent();
+	virtual void	RemoveLastContent();
+	/**
+	 * @descr	convience function for add text content. 
+	 */
+	virtual void	Add(const rtl::OUString& text);	
+
+	/**
+	 * @descr	return the number of contents in the container. 
+	 */
+	int		GetCount() const;
+
+	/**
+	 * @descr	get content by index. 
+	 */
+	IXFContent* GetContent(sal_uInt32 index) const;
+
+	/**
+	 * @descr	clear all contents in the container. 
+	 */
+	void	Reset();
+
+	/**
+	 * @descr	helper function, find first content by type.
+	 */
+	IXFContent*	FindFirstContent(enumXFContent type);
+
+	/**
+	 * @descr	return the content type. 
+	 */
+	virtual enumXFContent	GetContentType();
+	/**
+	 * @descr	Output to OOo model or local file. 
+	 */
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	std::vector<IXFContent*>	m_aContents;
+};
+
+inline IXFContent* XFContentContainer::GetContent(sal_uInt32 index) const
+{
+	if( index<0 || index>m_aContents.size()-1 )
+		return NULL;
+	return m_aContents[index];
+}
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcontent.hxx lotuswordpro/source/filter/xfilter/xfcontent.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcontent.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcontent.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,100 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base class for the all content object,ie. text,paragraph,picture,and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFCONTENT_HXX
+#define		_XFCONTENT_HXX
+
+#include	"ixfcontent.hxx"
+
+/**
+ * @descr
+ * Base class for all content object.
+ * There is only two properties:style name and content type in this class.
+ */
+class XFContent : public IXFContent
+{
+public:
+	/**
+	 * @short:	return the content type.
+	 */
+	virtual enumXFContent	GetContentType(){ return enumXFContentUnknown; }
+
+	/**
+	 * @short:	All content except XFTextContent can have a style.
+	 */
+	virtual void	SetStyleName(rtl::OUString style){m_strStyleName = style;}
+
+	/**
+	 * @short:	return the style name.
+	 */
+	virtual rtl::OUString	GetStyleName(){return m_strStyleName;}
+
+	/**
+	 */
+	virtual IXFContent*		Clone(){return NULL;}
+	
+protected:
+	rtl::OUString	m_strStyleName;		
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcrossref.cxx lotuswordpro/source/filter/xfilter/xfcrossref.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfcrossref.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcrossref.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,105 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * index entry object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-17  create this file.
+ ************************************************************************/
+#include "xfcrossref.hxx"
+
+XFCrossRefStart::XFCrossRefStart()
+{	
+}
+
+XFCrossRefStart::~XFCrossRefStart()
+{
+}
+
+void XFCrossRefStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_nType == CROSSREF_TEXT)
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"),A2OUSTR("text") );
+	}
+	else if( m_nType == CROSSREF_PAGE )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("page") );	
+	}
+	else if( m_nType == CROSSREF_PARANUMBER )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:reference-format"), A2OUSTR("chapter") );
+	}
+	pAttrList->AddAttribute( A2OUSTR("text:ref-name"), m_strMarkName);
+	pStrm->StartElement( A2OUSTR("text:bookmark-ref") );		
+}
+
+XFCrossRefEnd::XFCrossRefEnd()
+{		
+}
+
+XFCrossRefEnd::~XFCrossRefEnd()
+{	
+}
+
+void XFCrossRefEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:bookmark-ref") );	
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfcrossref.hxx lotuswordpro/source/filter/xfilter/xfcrossref.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfcrossref.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfcrossref.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,109 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * cross reference object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-17  create this file.
+ ************************************************************************/
+#ifndef		_XFCROSSREF_HXX
+#define		_XFCROSSREF_HXX
+
+#include	"xfcontent.hxx"
+
+/**
+ * @brief
+ * Index entry obejct.
+ */
+class XFCrossRefStart : public XFContent
+{
+public:
+	XFCrossRefStart();
+	~XFCrossRefStart();
+	void SetRefType(sal_uInt8 nType);
+	void SetMarkName(rtl::OUString sName);
+	void ToXml(IXFStream *pStrm);
+private:
+	enum{
+		CROSSREF_INVALID = 0,
+		CROSSREF_TEXT = 1,
+		CROSSREF_PAGE = 2,
+		CROSSREF_PARANUMBER = 3
+	};
+	sal_uInt8 m_nType;
+	rtl::OUString m_strMarkName;
+};
+
+inline void XFCrossRefStart::SetRefType(sal_uInt8 nType)
+{
+	m_nType = nType;
+}
+
+inline void XFCrossRefStart::SetMarkName(rtl::OUString sName)
+{
+	m_strMarkName = sName;
+}
+
+class XFCrossRefEnd : public XFContent
+{
+public:
+	XFCrossRefEnd();
+	~XFCrossRefEnd();
+	void ToXml(IXFStream *pStrm);
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdate.cxx lotuswordpro/source/filter/xfilter/xfdate.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdate.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdate.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,118 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Date field with date style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xfdate.hxx"
+
+XFDate::XFDate()
+{
+	m_bFixed = 0;
+	rtl_zeroMemory(&m_aDateTime,sizeof(m_aDateTime));
+	m_bValued = sal_False;
+}
+
+XFDate::~XFDate()
+{
+	
+}
+
+void	XFDate::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), GetStyleName() );
+	if (m_bValued)
+		pAttrList->AddAttribute( A2OUSTR("text:date-value"), m_strDate );
+
+	if( m_bFixed )
+		pAttrList->AddAttribute( A2OUSTR("text:fixed"), A2OUSTR("true") );
+	
+	pStrm->StartElement( A2OUSTR("text:date") );
+	if (m_strText.getLength()>0)
+		pStrm->Characters(m_strText);
+	pStrm->EndElement( A2OUSTR("text:date") );
+}
+
+void XFDateStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), GetStyleName() );
+/*	if (m_bValued)
+		pAttrList->AddAttribute( A2OUSTR("text:date-value"), DateTimeToOUString(m_aDateTime) );
+	if( m_bFixed )
+		pAttrList->AddAttribute( A2OUSTR("text:fixed"), A2OUSTR("true") );
+	
+	pStrm->StartElement( A2OUSTR("text:date") );
+	if (m_strText.getLength()>0)
+		pStrm->Characters(m_strText);	
+*/
+	pStrm->StartElement( A2OUSTR("text:date") );
+}
+
+void XFDateEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:date") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdate.hxx lotuswordpro/source/filter/xfilter/xfdate.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdate.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdate.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,135 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Date field with date style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDATE_HXX
+#define		_XFDATE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+/**
+ * @descr	Date obejct. 
+ */
+class XFDate : public XFContent
+{
+public:
+	XFDate();
+	
+	virtual ~XFDate();
+	
+public:
+	void	SetDate(XFDateTime& dt);
+
+	void	SetDate(const rtl::OUString& date);
+	
+	void	SetText(rtl::OUString& text);
+	
+	void	SetFixed(sal_Bool fixed = sal_True);
+	
+	virtual	void	ToXml(IXFStream *pStrm);
+	
+private:
+	sal_Bool	m_bFixed;	
+	rtl::OUString m_strText;	
+	XFDateTime	m_aDateTime;
+	rtl::OUString	m_strDate;
+	sal_Bool	m_bValued;
+};
+
+inline	void XFDate::SetDate(XFDateTime& dt)
+{
+	m_aDateTime = dt;
+	m_strDate = DateTimeToOUString(m_aDateTime);
+	m_bValued = sal_True;	
+}
+
+inline void	XFDate::SetDate(const rtl::OUString& date)
+{
+	m_strDate = date;
+	m_bValued = sal_True;
+}
+
+inline	void XFDate::SetText(rtl::OUString& text)
+{
+	m_strText = text;
+}
+
+inline	void XFDate::SetFixed(sal_Bool fixed)
+{
+	m_bFixed = fixed;
+}
+
+class XFDateStart : public XFDate
+{
+public:
+	virtual	void	ToXml(IXFStream *pStrm);
+};
+
+class XFDateEnd : public XFContent
+{
+public:
+	virtual	void	ToXml(IXFStream *pStrm);
+};
+
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdatestyle.cxx lotuswordpro/source/filter/xfilter/xfdatestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdatestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdatestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,192 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Date style. The date format for date field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-20 create this file.
+ ************************************************************************/
+#include	"xfdatestyle.hxx"
+
+XFDatePart::XFDatePart()
+{
+	m_bTexture = sal_False;
+}
+
+void	XFDatePart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	switch(m_ePart)
+	{
+	case enumXFDateUnknown:
+		break;
+	case enumXFDateYear:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:year") );
+		pStrm->EndElement( A2OUSTR("number:year") );
+		break;
+	case enumXFDateMonth:
+		pAttrList->Clear();
+		if( m_bTexture )
+			pAttrList->AddAttribute( A2OUSTR("number:textual"), A2OUSTR("true") );
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:month") );
+		pStrm->EndElement( A2OUSTR("number:month") );
+		break;
+	case enumXFDateMonthDay:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:day") );
+		pStrm->EndElement( A2OUSTR("number:day") );
+		break;
+	case enumXFDateWeekDay:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:day-of-week") );
+		pStrm->EndElement( A2OUSTR("number:day-of-week") );	
+		break;
+	case enumXFDateYearWeek:
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("number:week-of-year") );
+		pStrm->EndElement( A2OUSTR("number:week-of-year") );	
+		break;
+	case enumXFDateEra:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:era") );
+		pStrm->EndElement( A2OUSTR("number:era") );
+		break;
+	case enumXFDateQuarter:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:quarter") );
+		pStrm->EndElement( A2OUSTR("number:quarter") );	
+		break;	
+	case enumXFDateHour:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:hours") );
+		pStrm->EndElement( A2OUSTR("number:hours") );	
+		break;	
+	case enumXFDateMinute:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:minutes") );
+		pStrm->EndElement( A2OUSTR("number:minutes") );	
+		break;	
+	case enumXFDateSecond:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		if( m_nDecimalPos )
+			pAttrList->AddAttribute( A2OUSTR("number:decimal-places"), Int32ToOUString(m_nDecimalPos) );
+		pStrm->StartElement( A2OUSTR("number:seconds") );
+		pStrm->EndElement( A2OUSTR("number:seconds") );			
+		break;
+	case enumXFDateAmPm:
+		pStrm->StartElement( A2OUSTR("number:am-pm") );
+		pStrm->EndElement( A2OUSTR("number:am-pm") );	
+		break;
+	case enumXFDateText:
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("number:text") );
+		pStrm->Characters( m_strText );
+		pStrm->EndElement( A2OUSTR("number:text") );	
+		break;
+	}
+}
+
+XFDateStyle::XFDateStyle()
+{
+	m_bFixed = sal_False;	
+	m_bAutoOrder = sal_False;	
+}
+
+XFDateStyle::~XFDateStyle()
+{
+}
+
+enumXFStyle XFDateStyle::GetStyleFamily()
+{
+	return enumXFStyleDate;
+}
+
+void	XFDateStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("data-style") );
+
+	pStrm->StartElement( A2OUSTR("number:date-style") );
+
+	m_aParts.ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("number:date-style") );
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdatestyle.hxx lotuswordpro/source/filter/xfilter/xfdatestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdatestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdatestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,260 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Date style. The date format for date field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-20 create this file.
+ ************************************************************************/
+#ifndef		_XFDATESTYLE_HXX
+#define		_XFDATESTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"ixfproperty.hxx"
+#include	"xftimestyle.hxx"
+#include	"xfstylecont.hxx"
+#include	<vector>
+
+class XFDatePart : public XFTimePart
+{
+public:
+	XFDatePart();
+public:
+	void	SetTexture(sal_Bool bTexture);
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+private:
+	sal_Bool		m_bTexture;
+};
+
+class XFDateStyle : public XFStyle
+{
+public:
+	XFDateStyle();
+
+	virtual ~XFDateStyle();
+
+public:
+
+	void	SetFixed(sal_Bool fixed);
+
+	void	SetLanguage(rtl::OUString lang);
+
+	void	SetCountry(rtl::OUString country);
+
+	void	SetAutoOrder(sal_Bool bAutoOrder);
+
+	void	AddYear( sal_Bool bLongFmt = sal_True );
+
+	void	AddMonth( sal_Bool bLongFmt = sal_True, sal_Bool bTexture = sal_False  );
+
+	void	AddMonthDay( sal_Bool bLongFmt = sal_True );
+
+	void	AddWeekDay( sal_Bool bLongFmt = sal_True );
+
+	void	AddYearWeek();
+
+	void	AddEra(sal_Bool bLongFmt = sal_False);
+
+	void	AddQuarter(sal_Bool bLongFmt = sal_False);
+
+	void	AddHour( sal_Bool bLongFmt = sal_True );
+	
+	void	AddMinute( sal_Bool bLongFmt = sal_True );
+	
+	void	AddSecond( sal_Bool bLongFmt = sal_True, sal_Int16 nDecimalPos = 2);
+	
+	void	AddAmPm(sal_Bool bAmPm);
+		
+	void	AddText( rtl::OUString part );
+
+	virtual enumXFStyle GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	sal_Bool	m_bFixed;
+	sal_Bool	m_bAutoOrder;
+	rtl::OUString	m_strLanguage;
+	rtl::OUString	m_strCountry;
+	XFStyleContainer	m_aParts;
+};
+
+inline void	XFDatePart::SetTexture(sal_Bool bTexture)
+{
+	m_bTexture = bTexture;
+}
+
+inline void	XFDateStyle::SetFixed(sal_Bool fixed)
+{
+	m_bFixed = fixed;
+}
+
+inline void	XFDateStyle::SetLanguage(rtl::OUString lang)
+{
+	m_strLanguage = lang;
+}
+
+inline void	XFDateStyle::SetCountry(rtl::OUString country)
+{
+	m_strCountry = country;
+}
+
+inline void	XFDateStyle::SetAutoOrder(sal_Bool bAutoOrder)
+{
+	m_bAutoOrder = bAutoOrder;
+}
+
+inline void	XFDateStyle::AddYear( sal_Bool bLongFmt )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateYear);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddMonth( sal_Bool bLongFmt, sal_Bool bTexture  )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateMonth);
+	part->SetLongFmt(bLongFmt);
+	part->SetTexture(bTexture);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddMonthDay( sal_Bool bLongFmt )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateMonthDay);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddWeekDay( sal_Bool bLongFmt )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateWeekDay);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddYearWeek()
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateYearWeek);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddEra(sal_Bool bLongFmt)
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateEra);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddQuarter(sal_Bool bLongFmt)
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateQuarter);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddText( rtl::OUString text )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateText);
+	part->SetText(text);
+	m_aParts.AddStyle(part);	
+}
+
+inline void	XFDateStyle::AddHour( sal_Bool bLongFmt )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateHour);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddMinute( sal_Bool bLongFmt )
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateMinute);
+	part->SetLongFmt(bLongFmt);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddSecond( sal_Bool bLongFmt, sal_Int16 pos)
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateSecond);
+	part->SetLongFmt(bLongFmt);
+	part->SetDecimalPos(pos);
+	m_aParts.AddStyle(part);
+}
+
+inline void	XFDateStyle::AddAmPm(sal_Bool bAmPm)
+{
+	XFDatePart	*part = new XFDatePart();
+	part->SetPartType(enumXFDateAmPm);
+	m_aParts.AddStyle(part);	
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdefs.hxx lotuswordpro/source/filter/xfilter/xfdefs.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdefs.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdefs.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,514 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * enum const defines.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDEFS_HXX
+#define		_XFDEFS_HXX
+
+#include	"sal/types.h"
+
+enum	enumXFContent
+{
+	enumXFContentUnknown,
+	enumXFContentText,
+	enumXFContentSpan,
+	enumXFContentPara,
+	enumXFContentHeading,
+	enumXFContentTable,
+	enumXFContentTableCell,
+	enumXFContentTableRow,
+	enumXFContentTableCol,
+	enumXFContentGraphics,
+	enumXFContentFrame,
+	enumXFContentContainer,
+};
+
+enum	enumXFStyle
+{
+	enumXFStyleUnknown,
+	enumXFStyleText,
+	enumXFStylePara,
+	enumXFStyleList,
+	enumXFStyleSection,
+	enumXFStyleGraphics,
+	enumXFStylePageMaster,
+	enumXFStyleMasterPage,
+	enumXFStyleDate,
+	enumXFStyleTime,
+	enumXFStylePercent,
+	enumXFStyleNumber,
+	enumXFStyleCurrency,
+	enumXFStyleTable,
+	enumXFStyleTableCell,
+	enumXFStyleTableRow,
+	enumXFStyleTableCol,
+	enumXFStyleOutline,
+	enumXFStyleStrokeDash,
+	enumXFStyleArea,
+	enumXFStyleArrow,
+	enumXFStyleRuby,
+	enumXFStyleDefaultPara,
+};
+
+enum enumXFFrameType
+{
+	enumXFFrameUnknown,
+	enumXFFrameDrawing,
+	enumXFFrameImage,
+	enumXFFrameTextbox,
+};
+
+enum enumXFUnderline
+{
+	enumXFUnderlineNone = 0,
+	enumXFUnderlineSingle,
+	enumXFUnderlineDouble,
+	enumXFUnderlineDotted,
+	enumXFUnderlineDash,
+	enumXFUnderlineLongDash,
+	enumXFUnderlineDotDash,
+	enumXFUnderlineDotDotDash,
+	enumXFUnderlineWave,
+	enumXFUnderlineBold,
+	enumXFUnderlineBoldDotted,
+	enumXFUnderlineBoldDash,
+	enumXFUnderlineBoldLongDash,
+	enumXFUnderlineBoldDotDash,
+	enumXFUnderlineBoldDotDotDash,
+	enumXFUnderlineBoldWave,
+	enumXFUnderlineDoubleWave,
+	enumXFUnderlineSmallWave
+};	
+
+enum enumXFRelief
+{
+	enumXFReliefNone = 0,
+	enumXFReliefEngraved,
+	enumXFReliefEmbossed,
+};
+
+enum enumXFCrossout
+{
+	enumXFCrossoutNone = 0,
+	enumXFCrossoutSignel,
+	enumXFCrossoutDouble,
+	enumXFCrossoutThick,
+	enumXFCrossoutSlash,
+	enumXFCrossoutX
+};
+
+enum enumXFTransform
+{
+	enumXFTransformNone = 0,
+	enumXFTransformUpper,
+	enumXFTransformLower,
+	enumXFTransformCapitalize,
+	enumXFTransformSmallCaps
+};
+
+enum enumXFEmphasize
+{
+	enumXFEmphasizeNone = 0,
+	enumXFEmphasizeDot,
+	enumXFEmphasizeCircle,
+	enumXFEmphasizeDisc,
+	enumXFEmphasizeAccent
+};
+
+
+enum enumXFAlignType
+{
+	enumXFAlignNone = 0,
+	enumXFAlignStart,
+	enumXFAlignCenter,
+	enumXFAlignEnd,
+	enumXFAlignJustify,
+	enumXFAlignTop,
+	enumXFAlignMiddle,
+	enumXFAlignBottom,
+	enumXFALignMargins,
+};
+
+enum enumXFShadowPos
+{
+	enumXFShadowNone,
+	enumXFShadowRightBottom,
+	enumXFShadowRightTop,
+	enumXFShadowLeftBottom,
+	enumXFShadowLeftTop
+};
+
+enum enumXFBorder
+{
+	enumXFBorderNone,
+	enumXFBorderLeft,
+	enumXFBorderRight,
+	enumXFBorderTop,	
+	enumXFBorderBottom,
+};
+
+/**************************************************************************
+ * @descr
+ * Line height type.
+ * enumLHHeight: height of the line,in "cm".
+ * enumLHLeast: the height may be adjusted,but has a min value.
+ * enumLHPercent: the height is a centain times of the normal height.
+ * enumLHSpace: space between lines.
+ *************************************************************************/
+enum enumLHType
+{
+	enumLHNone,
+	enumLHHeight,
+	enumLHLeast,
+	enumLHPercent,
+	enumLHSpace,
+};
+
+enum enumXFBreaks
+{
+	enumXFBreakAuto,
+	enumXFBreakBefPage,
+	enumXFBreakBefColumn,
+	enumXFBreakAftPage,
+	enumXFBreakAftColumn,
+	enumXFBreakKeepWithNext,
+};
+
+enum enumXFTab
+{
+	enumXFTabNone,
+	enumXFTabLeft,
+	enumXFTabCenter,
+	enumXFTabRight,
+	enumXFTabChar,
+};
+
+enum enumXFDatePart
+{	
+	enumXFDateUnknown,
+	enumXFDateYear,
+	enumXFDateMonth,
+	enumXFDateMonthDay,
+	enumXFDateWeekDay,
+	enumXFDateYearWeek,
+	enumXFDateEra,
+	enumXFDateQuarter,
+	enumXFDateHour,
+	enumXFDateMinute,
+	enumXFDateSecond,
+	enumXFDateAmPm,
+	enumXFDateText
+};
+
+enum enumXFAnchor
+{
+	enumXFAnchorNone,
+	enumXFAnchorPara,
+	enumXFAnchorPage,
+	enumXFAnchorChar,
+	enumXFAnchorAsChar,
+	enumXFAnchorFrame
+};
+
+enum enumXFWrap
+{
+	enumXFWrapNone,
+	enumXFWrapLeft,
+	enumXFWrapRight,
+	enumXFWrapParallel,
+	enumXFWrapRunThrough,
+	enumXFWrapBest,
+	enumXFWrapBackground
+};
+
+enum enumXFTextDir
+{
+	enumXFTextDirNone,
+	enumXFTextDirLR,
+	enumXFTextDirLR_TB,
+	enumXFTextDirPage,
+	enumXFTextDirRL,
+	enumXFTextDirRL_TB,
+	enumXFTextDirTB,
+	enumXFTextDirTB_LR,
+	enumXFTextDirTB_RL
+};
+
+enum enumXFFrameXRel
+{
+	enumXFFrameXRelPage,
+	enumXFFrameXRelPageContent,
+	enumXFFrameXRelPageEndMargin,
+	enumXFFrameXRelPageStartMargin,
+	enumXFFrameXRelPara,
+	enumXFFrameXRelParaContent,
+	enumXFFrameXRelParaEndMargin,
+	enumXFFrameXRelParaStartMargin,
+	enumXFFrameXRelChar,
+	enumXFFrameXRelFrame,
+	enumXFFrameXRelFrameContent,
+	enumXFFrameXRelFrameEndMargin,
+	enumXFFrameXRelFrameStartMargin	
+};
+
+enum enumXFFrameXPos
+{
+	enumXFFrameXPosLeft,
+	enumXFFrameXPosRight,
+	enumXFFrameXPosCenter,
+	enumXFFrameXPosFromLeft
+};
+
+enum enumXFFrameYRel
+{
+	enumXFFrameYRelBaseLine,
+	enumXFFrameYRelChar,
+	enumXFFrameYRelFrame,
+	enumXFFrameYRelFrameContent,
+	enumXFFrameYRelLine,
+	enumXFFrameYRelPage,
+	enumXFFrameYRelPageContent,
+	enumXFFrameYRelPara,
+	enumXFFrameYRelParaContent,
+	enumXFFrameYRelText
+};
+
+enum enumXFFrameYPos
+{	
+	enumXFFrameYPosTop,
+	enumXFFrameYPosMiddle,
+	enumXFFrameYPosBottom,
+	enumXFFrameYPosFromTop,
+	enumXFFrameYPosBelow,
+};
+
+enum enumXFTableColVisible
+{
+	enumXFTableColVisibleYes,
+	enumXFTableColVisibleCollapse,
+	enumXFTableColVisibleFilter,
+};
+
+enum enumXFBookmarkRef
+{
+	enumXFBookmarkNone,
+	enumXFBookmarkPage,
+	enumXFBookmarkChapter,
+	enumXFBookmarkDir,
+	enumXFBookmarkDef
+};
+
+enum enumXFDrawKind
+{
+	enumXFDrawKindFull,
+	enumXFDrawKindSection,
+	enumXFDrawKindCut,
+	enumXFDrawKindArc
+};
+
+enum enumXFLineStyle
+{
+	enumXFLineNone,
+	enumXFLineSolid,
+	enumXFLineDot,
+	enumXFLineDash,
+	enumXFLineDotDash,
+	enumXFLineDashDot
+};
+
+enum enumXFAreaStyle
+{
+	enumXFAreaNone,
+	enumXFAreaSolid,
+	enumXFAreaGradient,
+	enumXFAreaBitmap,
+	enumXFAreaHatch
+};
+
+enum enumXFAreaLineStyle
+{
+	enumXFAreaLineSingle,
+	enumXFAreaLineCrossed,
+	enumXFAreaLineTriple
+};
+
+enum enumXFColorMode
+{
+	enumXFColorStandard,
+	enumXFColorGreyscale,
+	enumXFColorMono,
+	enumXFColorWatermark	
+};
+
+enum enumXFPageUsage
+{
+	enumXFPageUsageNone,
+	enumXFPageUsageAll,
+	enumXFPageUsageLeft,
+	enumXFPageUsageRight,
+	enumXFPageUsageMirror
+};
+
+enum enumXFValueType
+{
+	enumXFValueTypeNone,
+	enumXFValueTypeBoolean,	
+	enumXFValueTypeCurrency,
+	enumXFValueTypeDate,
+	enumXFValueTypeFloat,
+	enumXFValueTypePercentage,
+	enumXFValueTypeString,
+	enumXFValueTypeTime,
+};
+
+enum enumXFNumberType
+{
+	enumXFNumberNumber,
+	enumXFNumberPercent,
+	enuMXFNumberCurrency,
+	enumXFNumberScientific,
+	enumXFText,
+};
+
+enum enumXFLineNumberPos
+{
+	enumXFLineNumberLeft,
+	enumXFLineNumberRight,
+	enumXFLineNumberInner,
+	enumXFLineNumberOutter,
+};
+
+enum enumXFEntry
+{
+	enumXFEntryTOC,
+	enumXFEntryAlphabetical,
+	enumXFEntryUserIndex,
+};
+
+enum enumXFIndex
+{
+	enumXFIndexTOC,
+	enumXFIndexAlphabetical,
+	enumXFIndexUserIndex,
+	enumXFIndexObject,
+	enumXFIndexIllustration,
+	enumXFIndexTableIndex,
+};
+
+enum enumXFIndexTemplate
+{
+	enumXFIndexTemplateUnknown,
+	enumXFIndexTemplateChapter,
+	enumXFIndexTemplateText,
+	enumXFIndexTemplateTab,
+	enumXFIndexTemplatePage,
+	enumXFIndexTemplateLinkStart,
+	enumXFIndexTemplateLinkEnd,
+	enumXFIndexTemplateSpan,
+	enumXFIndexTemplateBibliography,
+};
+
+struct XFDateTime
+{
+	sal_Int32 nYear;
+	sal_Int32 nMonth;
+	sal_Int32 nDay;
+	sal_Int32 nHour;
+	sal_Int32 nMinute;
+	sal_Int32 nSecond;
+	sal_Int32 nMillSecond;
+};
+
+enum enumXFRubyPosition
+{
+	enumXFRubyLeft = 4,
+	enumXFRubyRight = 5,
+	enumXFRubyCenter = 2,
+	enumXFRubyTop = 1,
+	enumXFRubyBottom = 3,
+};
+enum enumXFFWStyle
+{
+	enumXFFWOff,
+	enumXFFWRotate,
+	enumXFFWUpright,
+	enumXFFWSlantX,//slant-x
+	enumXFFWSlantY//slant-y
+};
+
+enum enumXFFWAdjust
+{
+	enumXFFWAdjustAutosize,//autosize
+	enumXFFWAdjustLeft,
+	enumXFFWAdjustCenter,//center
+	enumXFFWAdustRight//right
+};
+
+enum enumXFFWShadow
+{
+	enumXFFWShadowNone,
+	enumXFFWShadowNormal,
+	enumXFFWShadowVertical,
+	enumXFFWShadowSlant
+};
+
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdocfield.cxx lotuswordpro/source/filter/xfilter/xfdocfield.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdocfield.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdocfield.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,234 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * doc field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-27  create this file.
+ ************************************************************************/
+#include "xfdocfield.hxx"
+
+void XFFileName::SetType(rtl::OUString sType)
+{
+	m_strType = sType;
+}
+
+void XFFileName::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strType.equals(A2OUSTR("FileName")))
+		pAttrList->AddAttribute( A2OUSTR("text:display"), A2OUSTR("name-and-extension") );
+	else if (m_strType.equals(A2OUSTR("Path")))
+		pAttrList->AddAttribute( A2OUSTR("text:display"), A2OUSTR("path") );
+	pStrm->StartElement( A2OUSTR("text:file-name") );
+	pStrm->EndElement( A2OUSTR("text:file-name") );
+}
+
+void XFWordCount::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:word-count") );
+	pStrm->EndElement( A2OUSTR("text:word-count") );
+}
+
+void XFCharCount::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:character-count") );
+	pStrm->EndElement( A2OUSTR("text:character-count") );
+}
+
+void XFDescription::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:description") );
+	pStrm->EndElement( A2OUSTR("text:description") );
+}
+
+void XFPageCountStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:page-count") );	
+}
+void XFPageCountEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:page-count") );
+}	
+
+void XFWordCountStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:word-count") );
+}
+
+void XFCharCountStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:character-count") );
+}
+
+void XFDescriptionStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:description") );
+}
+
+void XFWordCountEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:word-count") );
+}
+
+void XFCharCountEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:character-count") );
+}
+
+void XFDescriptionEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:description") );
+}
+
+void XFKeywords::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:keywords") );
+	pStrm->EndElement( A2OUSTR("text:keywords") );
+}
+
+void XFTotalEditTime::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:editing-duration" ) );
+	pStrm->EndElement( A2OUSTR("text:editing-duration") );	
+}
+void XFTotalEditTimeStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:editing-duration" ) );
+}
+void XFTotalEditTimeEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:editing-duration") );	
+}
+void XFCreateTime::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:creation-time") );
+	pStrm->EndElement( A2OUSTR("text:creation-time") );
+}
+void XFLastEditTime::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:modification-time") );
+	pStrm->EndElement( A2OUSTR("text:modification-time") );	
+}
+
+void XFCreateTimeStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:creation-time") );
+}
+
+void XFLastEditTimeStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if (m_strStyleName.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("text:modification-time") );
+}
+void XFCreateTimeEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:creation-time") );
+}
+
+void XFLastEditTimeEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:modification-time") );
+}
+
+void XFInitialCreator::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:initial-creator") );
+	pStrm->EndElement( A2OUSTR("text:initial-creator") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdocfield.hxx lotuswordpro/source/filter/xfilter/xfdocfield.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdocfield.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdocfield.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,200 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * doc field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-27  create this file.
+ ************************************************************************/
+#ifndef		_XFDOCFIELD_HXX
+#define		_XFDOCFIELD_HXX
+
+#include "xfcontent.hxx"
+#include "xfpagecount.hxx"
+
+class XFFileName : public XFContent
+{
+public:
+	void SetType(rtl::OUString sType);
+	virtual void	ToXml(IXFStream *pStrm);
+private:
+	rtl::OUString m_strType;
+};
+class XFWordCount : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFWordCountStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFWordCountEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFPageCountStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFPageCountEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFCharCount : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+}; 
+class XFCharCountStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+}; 
+
+class XFCharCountEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFDescription : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFDescriptionStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFDescriptionEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFKeywords : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFTotalEditTime : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFTotalEditTimeEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFTotalEditTimeStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFCreateTime : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFCreateTimeStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFCreateTimeEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFLastEditTime : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFLastEditTimeStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFLastEditTimeEnd : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFInitialCreator : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawareastyle.cxx lotuswordpro/source/filter/xfilter/xfdrawareastyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawareastyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawareastyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,99 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Area style of Drawing object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-02-21 create this file.
+ ************************************************************************/
+#include	"xfdrawareastyle.hxx"
+
+XFDrawAreaStyle::XFDrawAreaStyle()
+{
+	m_eAreaStyle = enumXFAreaSolid;
+	m_eLineStyle = enumXFAreaLineSingle;
+	m_nAngle = 0;
+	m_fSpace = 0.18;
+}
+
+enumXFStyle	XFDrawAreaStyle::GetStyleFamily()
+{
+	return enumXFStyleArea;
+}
+
+void	XFDrawAreaStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("draw:name"), GetStyleName() );
+		
+	if( m_eLineStyle == enumXFAreaLineSingle )
+		pAttrList->AddAttribute( A2OUSTR("draw:style"), A2OUSTR("single") );
+	else if( m_eLineStyle == enumXFAreaLineCrossed )
+		pAttrList->AddAttribute( A2OUSTR("draw:style"), A2OUSTR("double") );
+	else if( m_eLineStyle == enumXFAreaLineTriple )
+		pAttrList->AddAttribute( A2OUSTR("draw:style"), A2OUSTR("triple") );
+	
+	pAttrList->AddAttribute( A2OUSTR("draw:color"), m_aLineColor.ToString() );
+	pAttrList->AddAttribute( A2OUSTR("draw:rotation"), Int32ToOUString(m_nAngle*10) );
+	pAttrList->AddAttribute( A2OUSTR("draw:distance"), DoubleToOUString(m_fSpace)+A2OUSTR("cm") );
+	
+	pStrm->StartElement( A2OUSTR("draw:hatch") );
+	pStrm->EndElement( A2OUSTR("draw:hatch") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawareastyle.hxx lotuswordpro/source/filter/xfilter/xfdrawareastyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawareastyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawareastyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,145 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Area style of Drawing object.
+ * Only support fill color and fill pattern now.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-02-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWAREASTYLE_HXX
+#define		_XFDRAWAREASTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+
+class XFDrawAreaStyle : public XFStyle
+{
+public:
+	XFDrawAreaStyle();
+
+public:
+	void	SetAreaStyle(enumXFAreaStyle style);
+
+	void	SetLineStyle(enumXFAreaLineStyle style);
+
+	void	SetBackColor(XFColor& color);
+
+	void	SetLineColor(XFColor& color);
+
+	void	SetLineAngle(sal_Int32 angle);	
+
+	void	SetLineSpace(double space);
+
+	enumXFAreaStyle	GetAreaStyle();
+
+	XFColor	GetBackColor();
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+private:
+	enumXFAreaStyle		m_eAreaStyle;
+	enumXFAreaLineStyle	m_eLineStyle;
+	XFColor		m_aBackColor;
+	XFColor		m_aLineColor;
+	sal_Int32	m_nAngle;
+	double		m_fSpace;
+};
+
+inline void XFDrawAreaStyle::SetAreaStyle(enumXFAreaStyle style)
+{
+	m_eAreaStyle = style;
+}
+
+inline void XFDrawAreaStyle::SetLineStyle(enumXFAreaLineStyle style)
+{
+	m_eLineStyle = style;
+}
+
+inline void	XFDrawAreaStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+}
+
+inline void XFDrawAreaStyle::SetLineColor(XFColor& color)
+{
+	m_aLineColor = color;
+}
+
+inline void XFDrawAreaStyle::SetLineAngle(sal_Int32 angle)
+{
+	m_nAngle = angle;
+}
+
+inline void XFDrawAreaStyle::SetLineSpace(double space)
+{
+	m_fSpace = space;
+}
+
+inline enumXFAreaStyle	XFDrawAreaStyle::GetAreaStyle()
+{
+	return m_eAreaStyle;
+}
+
+inline XFColor XFDrawAreaStyle::GetBackColor()
+{
+	return m_aBackColor;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawchart.cxx lotuswordpro/source/filter/xfilter/xfdrawchart.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawchart.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawchart.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,96 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * chart object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-25 	draft code for draw chart in XML.
+ ************************************************************************/
+
+#include	"xfdrawchart.hxx"
+
+#include "xfchartstreamtools.hxx"
+
+XFDrawChart::XFDrawChart()
+{
+	m_strName=XFGlobal::GenObjName();
+}
+
+void XFDrawChart::Add(IXFContent* pXFChartStream)
+{
+	m_pXFChartStream = pXFChartStream;
+}
+
+void XFDrawChart::ToXml(IXFStream *pStrm)
+{
+	XFDrawObject::ToXml(pStrm);	
+
+	pStrm->StartElement( A2OUSTR("draw:object") );
+	ContentToXml(pStrm);
+	m_pXFChartStream->ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:object") );
+}
+
+void XFChartStream::SetChartStream(SvStorageStreamRef rCntStream)
+{
+	m_rCntStream = rCntStream;
+}
+
+void XFChartStream::ToXml(IXFStream *pSaxStream)
+{
+	XFChartStreamTools::ParseStream(m_rCntStream,pSaxStream);
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawchart.hxx lotuswordpro/source/filter/xfilter/xfdrawchart.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawchart.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawchart.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,98 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Chart object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-25 	create this file,draft code for chart xml.
+ ************************************************************************/
+#ifndef		_XFDRAWECLIPSE_HXX
+#define		_XFDRAWECLIPSE_HXX
+
+#include	"xfdrawobj.hxx"
+#include <so3/svstor.hxx>
+/**
+* @brief
+* draw chart object in XML
+*/
+class XFDrawChart : public XFDrawObject
+{
+public:
+	XFDrawChart();
+
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+	virtual void Add(IXFContent* pXFChartStream);
+
+private:
+	IXFContent* m_pXFChartStream;
+
+};
+/**
+* @brief
+* draw chart stream in XML
+*/
+class XFChartStream:public XFContent
+{
+public:
+	virtual void ToXml(IXFStream *pSaxStream);
+	void SetChartStream(SvStorageStreamRef rCntStream);
+protected:
+	SvStorageStreamRef m_rCntStream;
+};
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawcircle.cxx lotuswordpro/source/filter/xfilter/xfdrawcircle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawcircle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawcircle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,134 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Circle object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#include	"xfdrawcircle.hxx"
+#include	<math.h>
+#include	<cstdlib>
+
+XFDrawCircle::XFDrawCircle()
+{
+	m_fRadius = 0;
+	m_fStartAngle = 0;
+	m_fEndAngle = 360;
+	m_eDrawKind = enumXFDrawKindFull;
+	m_bUseAngle = sal_False;
+}
+
+XFDrawCircle::XFDrawCircle(XFPoint pt, double radius)
+{
+	m_aCenterPoint = pt;
+	m_fRadius = radius;
+	m_fStartAngle = 0;
+	m_fEndAngle = 360;
+	m_eDrawKind = enumXFDrawKindFull;
+	m_bUseAngle = sal_False;
+}
+
+void XFDrawCircle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	if( m_bUseAngle )
+	{
+		double	x1 = m_aCenterPoint.GetX() + m_fRadius*cos(m_fStartAngle*2*PI/360);
+		double  x2 = m_aCenterPoint.GetX() + m_fRadius*cos(m_fEndAngle*2*PI/360);
+		double  y1 = m_aCenterPoint.GetY() + m_fRadius*sin(m_fStartAngle*2*PI/360);
+		double  y2 = m_aCenterPoint.GetY() + m_fRadius*sin(m_fEndAngle*2*PI/360);
+		double	width;
+		double	height;	
+		
+		double x11 = MIN3(m_aCenterPoint.GetX()-m_fRadius,x1,x2);
+		double x12 = MAX3(m_aCenterPoint.GetX()+m_fRadius,x1,x2);
+		double y11 = MIN3(m_aCenterPoint.GetY()-m_fRadius,y1,y2);
+		double y12 = MAX3(m_aCenterPoint.GetY()+m_fRadius,y1,y2);
+		width = x12-x11;
+		height = y12-y11;
+
+		if (width > FLOAT_MIN || height > FLOAT_MIN)
+		{
+			SetPosition(x11,y11,width,height);
+		}
+
+		//
+		pAttrList->AddAttribute( A2OUSTR("draw:kind"), GetDrawKind(m_eDrawKind) );
+		pAttrList->AddAttribute( A2OUSTR("draw:start-angle"), DoubleToOUString(m_fStartAngle) );
+		pAttrList->AddAttribute( A2OUSTR("draw:end-angle"), DoubleToOUString(m_fEndAngle) );
+	}
+	else
+	{
+		double	x = m_aCenterPoint.GetX() - m_fRadius;
+		double  y = m_aCenterPoint.GetY() - m_fRadius;
+		double	width = m_fRadius*2;
+		double	height = m_fRadius*2;
+		if (width > FLOAT_MIN || height > FLOAT_MIN)
+		{
+			SetPosition(x,y,width,height);
+		}
+	}
+		
+	XFDrawObject::ToXml(pStrm);
+	
+	pStrm->StartElement( A2OUSTR("draw:circle") );
+	ContentToXml(pStrm);	
+	pStrm->EndElement( A2OUSTR("draw:circle") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawcircle.hxx lotuswordpro/source/filter/xfilter/xfdrawcircle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawcircle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawcircle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,143 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Circle object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWCIRCLE_HXX
+#define		_XFDRAWCIRCLE_HXX
+
+#include	"xfdrawobj.hxx"
+
+/**
+ * @brief
+ * Circle object.
+ */
+class XFDrawCircle : public XFDrawObject
+{
+public:
+	XFDrawCircle();
+
+	XFDrawCircle(XFPoint pt, double radius);
+
+public:
+	/**
+	 * @descr	Set the center point for the circle. 
+	 */
+	void	SetCenterPoint(double x, double y);
+
+	/**
+	 * @descr	Set the center point for the circle 
+	 */
+	void	SetCenterPoint(XFPoint pt);
+
+	/**
+	 * @descr	 
+	 */
+	void	SetRadius(double radius);
+	
+	void	SetAngle(double start, double end);
+
+	void	SetDrawKind(enumXFDrawKind kind);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFPoint	m_aCenterPoint;		
+	double	m_fRadius;
+	double	m_fStartAngle;
+	double	m_fEndAngle;
+	enumXFDrawKind	m_eDrawKind;
+	sal_Bool	m_bUseAngle;
+};
+
+inline void XFDrawCircle::SetCenterPoint(double x, double y)
+{
+	m_aCenterPoint = XFPoint(x,y);
+}
+
+inline void XFDrawCircle::SetCenterPoint(XFPoint pt)
+{
+	m_aCenterPoint = pt;
+}
+
+inline void XFDrawCircle::SetRadius(double radius)
+{
+	m_fRadius = radius;
+}
+
+inline void XFDrawCircle::SetAngle(double start, double end)
+{
+	assert(start>=0&&start<=360);
+	assert(end>=0&&end<=360);
+	m_fStartAngle = start;
+	m_fEndAngle = end;
+
+	m_bUseAngle = sal_True;
+	m_eDrawKind = enumXFDrawKindCut;
+}
+
+inline void	XFDrawCircle::SetDrawKind(enumXFDrawKind kind)
+{
+	m_eDrawKind = kind;
+}
+
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawellipse.cxx lotuswordpro/source/filter/xfilter/xfdrawellipse.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawellipse.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawellipse.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,118 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Eclipse object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#include	"xfdrawellipse.hxx"
+#include	<cmath>
+
+XFDrawEllipse::XFDrawEllipse()
+{
+	m_fRadiusX = 0;
+	m_fRadiusY = 0;
+	m_fStartAngle = 0;
+	m_fEndAngle = 360;
+	m_eDrawKind = enumXFDrawKindFull;
+	m_bUseAngle = sal_False;
+}
+
+void XFDrawEllipse::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	//not support yet.
+	if( m_bUseAngle )
+	{
+		double	x1 = m_aCenterPoint.GetX() + m_fRadiusX*cos(m_fStartAngle*2*PI/360);
+		double  x2 = m_aCenterPoint.GetX() + m_fRadiusX*cos(m_fEndAngle*2*PI/360);
+		double  y1 = m_aCenterPoint.GetY() + m_fRadiusY*sin(m_fStartAngle*2*PI/360);
+		double  y2 = m_aCenterPoint.GetY() + m_fRadiusY*sin(m_fEndAngle*2*PI/360);
+		double	width;
+		double	height;	
+		
+		double x11 = MIN3(m_aCenterPoint.GetX()-m_fRadiusX,x1,x2);
+		double x12 = MAX3(m_aCenterPoint.GetX()+m_fRadiusX,x1,x2);
+		double y11 = MIN3(m_aCenterPoint.GetY()-m_fRadiusY,y1,y2);
+		double y12 = MAX3(m_aCenterPoint.GetY()+m_fRadiusY,y1,y2);
+		width = x12-x11;
+		height = y12-y11;
+		SetPosition(x11,y11,width,height);
+		
+		//
+		pAttrList->AddAttribute( A2OUSTR("draw:kind"), GetDrawKind(m_eDrawKind) );
+		pAttrList->AddAttribute( A2OUSTR("draw:start-angle"), DoubleToOUString(m_fStartAngle) );
+		pAttrList->AddAttribute( A2OUSTR("draw:end-angle"), DoubleToOUString(m_fEndAngle) );
+	}
+	else
+	{
+		double	x = m_aCenterPoint.GetX() - m_fRadiusX;
+		double  y = m_aCenterPoint.GetY() - m_fRadiusY;
+		double	width = m_fRadiusX*2;
+		double	height = m_fRadiusY*2;
+		SetPosition(x,y,width,height);
+	}	
+	
+	XFDrawObject::ToXml(pStrm);	
+	
+	pStrm->StartElement( A2OUSTR("draw:ellipse") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:ellipse") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawellipse.hxx lotuswordpro/source/filter/xfilter/xfdrawellipse.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawellipse.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawellipse.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,157 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Eclipse object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWELLIPSE_HXX
+#define		_XFDRAWELLIPSE_HXX
+
+#include	"xfdrawobj.hxx"
+
+/**
+ * @brief
+ * Ellipse obejct for drawing layer.
+ * You can set Ellipse position by setting it's center point and radius or calling XFDrawEllipse::SetPosition function.
+ * If you using the first method,i'll calc the real position.
+ *
+ * You can draw part of an ellipse by using SetAngle(), for example, use SetaAngle(0,180) to draw half a ellipse.
+ * When draw part of an ellipse, you can use SetDrawKind() to decide which kind of object to draw, an arch, a section,
+ * or a cut.
+ */
+class XFDrawEllipse : public XFDrawObject
+{
+public:
+	XFDrawEllipse();
+
+public:
+	/**
+	 * @descr	Set ellipse center point. 
+	 */
+	void	SetCenterPoint(double x, double y);
+	
+	/**
+	 * @descr	Set ellipse center point. 
+	 */
+	void	SetCenterPoint(XFPoint pt);
+
+	/**
+	 * @descr	Set ellipse radius. 
+	 */
+	void	SetRadius(double radiusX, double radiusY);
+
+	/**
+	 * @descr	If only draw part of the ellipse, set the start angle and end angle. 
+	 */
+	void	SetAngle(double start, double end);
+
+	/**
+	 * @descr	Set ellipse draw type,please refer to enumXFDrawKind. 
+	 */
+	void	SetDrawKind(enumXFDrawKind kind);
+
+	/**
+	 * @descr	Output ellipse obejct. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFPoint	m_aCenterPoint;		
+	double	m_fRadiusX;
+	double	m_fRadiusY;
+	double	m_fStartAngle;
+	double	m_fEndAngle;
+	enumXFDrawKind	m_eDrawKind;
+	sal_Bool m_bUseAngle;
+};
+
+inline void XFDrawEllipse::SetCenterPoint(double x, double y)
+{
+	m_aCenterPoint = XFPoint(x,y);
+}
+
+inline void XFDrawEllipse::SetCenterPoint(XFPoint pt)
+{
+	m_aCenterPoint = pt;
+}
+
+inline void XFDrawEllipse::SetRadius(double radiusX, double radiusY)
+{
+	m_fRadiusX = radiusX;
+	m_fRadiusY = radiusY;
+}
+
+inline void XFDrawEllipse::SetAngle(double start, double end)
+{
+	assert(start>=0&&start<=360);
+	assert(end>=0&&end<=360);
+
+	m_fStartAngle = start;
+	m_fEndAngle = end;
+	m_bUseAngle = sal_True;
+	m_eDrawKind = enumXFDrawKindCut;
+}
+
+inline void XFDrawEllipse::SetDrawKind(enumXFDrawKind kind)
+{
+	m_eDrawKind = kind;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawgroup.hxx lotuswordpro/source/filter/xfilter/xfdrawgroup.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawgroup.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawgroup.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,115 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Group of drawing objects.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWGROUP_HXX
+#define		_XFDRAWGROUP_HXX
+
+#include	"xfdrawobj.hxx"
+#include	"xfframe.hxx"
+#include	"xfcontentcontainer.hxx"
+
+/**
+ * @brief
+ * Group obejct for drawing.
+ */
+class XFDrawGroup : public XFDrawObject
+{
+public:
+	XFDrawGroup(){}
+
+public:
+	/**
+	 * @descr	Add a drawing object to the group. 
+	 */
+	void	Add(XFFrame *pFrame);
+	
+	/**
+	 * @descr	Output group obejct and all it's children. 
+	 */
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	XFContentContainer	m_aChildren;
+};
+
+inline void XFDrawGroup::Add(XFFrame *pFrame)
+{
+	if( pFrame )
+		m_aChildren.Add(pFrame);
+}
+
+inline void XFDrawGroup::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	XFDrawObject::ToXml(pStrm);
+
+	pStrm->StartElement( A2OUSTR("draw:g") );
+
+	m_aChildren.ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("draw:g") );
+
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawline.cxx lotuswordpro/source/filter/xfilter/xfdrawline.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawline.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawline.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,123 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#include	"xfdrawline.hxx"
+
+XFDrawLine::XFDrawLine()
+{
+}
+
+void XFDrawLine::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:style-name"), GetStyleName() );
+	
+	assert(m_strName.getLength()>0);	//name should not be null.
+	if( m_strName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	//anchor type:
+	switch( m_eAnchor )
+	{
+	case enumXFAnchorPara:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("paragraph") );
+		break;
+	case enumXFAnchorPage:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("page") );
+		break;
+	case enumXFAnchorChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("char") );
+		break;
+	case enumXFAnchorAsChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("as-char") );
+		break;
+	case enumXFAnchorFrame:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("frame") );
+		break;
+	}
+	pAttrList->AddAttribute( A2OUSTR("draw:z-index"), Int32ToOUString(m_nZIndex) );		
+	
+	pAttrList->AddAttribute( A2OUSTR("svg:x1"), DoubleToOUString(m_aPoint1.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y1"), DoubleToOUString(m_aPoint1.GetY()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:x2"), DoubleToOUString(m_aPoint2.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y2"), DoubleToOUString(m_aPoint2.GetY()) + A2OUSTR("cm") );	
+	
+	//transform
+	rtl::OUString	strTransform;
+	if( m_nFlag&XFDRAWOBJECT_FLAG_ROTATE )
+		strTransform = A2OUSTR("rotate (") + DoubleToOUString(m_fRotate) + A2OUSTR(") ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_TRANLATE )
+		strTransform += A2OUSTR("translate (") + DoubleToOUString(m_aRotatePoint.GetX()) + A2OUSTR("cm ") + DoubleToOUString(m_aRotatePoint.GetY()) + A2OUSTR("cm) ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_SKEWX )
+		strTransform += A2OUSTR("skewX (") + DoubleToOUString(m_fSkewX) + A2OUSTR(" ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_SKEWY )	
+		strTransform += A2OUSTR("skewY (") + DoubleToOUString(m_fSkewY) + A2OUSTR(" ");
+	strTransform = strTransform.trim();
+	
+	if( strTransform.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("draw:transform"), strTransform );
+	
+	pStrm->StartElement( A2OUSTR("draw:line") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:line") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawline.hxx lotuswordpro/source/filter/xfilter/xfdrawline.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawline.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawline.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,112 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWLINE_HXX
+#define		_XFDRAWLINE_HXX
+
+#include	"xfdrawobj.hxx"
+#include	"xfpoint.hxx"
+
+/**
+ * @brief
+ * Line obejct of drawing layer.
+ */
+class XFDrawLine : public XFDrawObject
+{
+public:
+	XFDrawLine();
+
+public:
+	/**
+	 * @descr	Set line start point. 
+	 */
+	void	SetStartPoint(double x, double y);
+
+	/**
+	 * @descr	Set line end point. 
+	 */
+	void	SetEndPoint(double x, double y);
+
+	/**
+	 * @descr	Output line object. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFPoint	m_aPoint1;
+	XFPoint	m_aPoint2;	
+};
+
+inline void	XFDrawLine::SetStartPoint(double x, double y)
+{
+	m_aPoint1.SetX(x);
+	m_aPoint1.SetY(y);
+}
+
+inline void XFDrawLine::SetEndPoint(double x, double y)
+{
+	m_aPoint2.SetX(x);
+	m_aPoint2.SetY(y);
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawlinestyle.cxx lotuswordpro/source/filter/xfilter/xfdrawlinestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawlinestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawlinestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,123 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line style of Drawing object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-02-21 create this file.
+ ************************************************************************/
+#include	"xfdrawlinestyle.hxx"
+
+XFDrawLineStyle::XFDrawLineStyle()
+{
+	m_eLineStyle = enumXFLineSolid;
+
+	m_fWidth = 0;
+	m_nTransparency = 0;
+	m_nNumber1 = 1;
+	m_nNumber2 = 1;
+	m_fSpace = 0;
+	m_fLength1 = 0;
+	m_fLength2 = 0;
+}
+
+enumXFStyle	XFDrawLineStyle::GetStyleFamily()
+{
+	return enumXFStyleStrokeDash;
+}
+
+void	XFDrawLineStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("draw:name"), GetStyleName());
+	//simple place here:
+	pAttrList->AddAttribute( A2OUSTR("draw:style"), A2OUSTR("rect"));
+
+	if( m_eLineStyle == enumXFLineDot )
+	{
+		
+	}
+	else if( m_eLineStyle == enumXFLineDash )
+	{
+		pAttrList->AddAttribute( A2OUSTR("draw:dots1"), Int32ToOUString(m_nNumber1));
+		pAttrList->AddAttribute( A2OUSTR(" draw:dots1-length"), DoubleToOUString(m_fLength1) + A2OUSTR("cm"));
+
+		pAttrList->AddAttribute( A2OUSTR("draw:dots2"), Int32ToOUString(m_nNumber2));
+		pAttrList->AddAttribute( A2OUSTR(" draw:dots2-length"), DoubleToOUString(m_fLength2) + A2OUSTR("cm"));
+	}
+	else if( m_eLineStyle == enumXFLineDotDash )
+	{
+		pAttrList->AddAttribute( A2OUSTR("draw:dots1"), Int32ToOUString(m_nNumber1));
+		
+		pAttrList->AddAttribute( A2OUSTR("draw:dots2"), Int32ToOUString(m_nNumber2));
+		pAttrList->AddAttribute( A2OUSTR(" draw:dots2-length"), DoubleToOUString(m_fLength2) + A2OUSTR("cm"));
+	}
+	else if( m_eLineStyle == enumXFLineDashDot )
+	{
+		pAttrList->AddAttribute( A2OUSTR("draw:dots1"), Int32ToOUString(m_nNumber1));
+		pAttrList->AddAttribute( A2OUSTR(" draw:dots1-length"), DoubleToOUString(m_fLength1) + A2OUSTR("cm"));
+		
+		pAttrList->AddAttribute( A2OUSTR("draw:dots2"), Int32ToOUString(m_nNumber2));
+	}
+
+	pAttrList->AddAttribute( A2OUSTR("draw:distance"), DoubleToOUString(m_fSpace) + A2OUSTR("cm") );
+
+	pStrm->StartElement( A2OUSTR("draw:stroke-dash") );
+	pStrm->EndElement( A2OUSTR("draw:stroke-dash") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawlinestyle.hxx lotuswordpro/source/filter/xfilter/xfdrawlinestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawlinestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawlinestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,217 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line style of Drawing object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-02-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWLINESTYLE_HXX
+#define		_XFDRAWLINESTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+
+/**
+ * @brief
+ * Border line style for drawing obejct.
+ */
+class XFDrawLineStyle : public XFStyle
+{
+public:
+	XFDrawLineStyle();
+	
+public:
+	/**
+	 * @descr	Set line width. 
+	 */
+	void	SetWidth(double width);
+
+	/**
+	 * @descr	Set line color. 
+	 */
+	void	SetColor(const XFColor& color);
+
+	/**
+	 * @descr	Set line transparency. 
+	 */
+	void	SetTransparency(sal_Int32 transparency);
+
+	/**
+	 * @descr	Set line type, solid,dash,dot?
+	 */
+	void	SetLineStyle(enumXFLineStyle style);
+
+	/**
+	 * @descr	Set first dot number of dash line. 
+	 */
+	void	SetDot1Number(sal_Int32 number);
+
+	/**
+	 * @descr	Set second dot number of dash line. 
+	 */
+	void	SetDot2Number(sal_Int32 number);
+
+	/**
+	 * @descr	Set first dot length. 
+	 */
+	void	SetDot1Length(double length);
+
+	/**
+	 * @descr	Set second dot length. 
+	 */
+	void	SetDot2Length(double length);
+	
+	/**
+	 * @descr	Set space between dash dot. 
+	 */
+	void	SetSpace(double space);
+
+	/**
+	 * @descr	decide whether it's a solid line. 
+	 */
+	sal_Bool	IsSolid();	
+
+	double	GetWidth();
+
+	XFColor	GetColor();
+
+	sal_Int32	GetTransparency();
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	enumXFLineStyle	m_eLineStyle;	
+	XFColor	m_aColor;
+	double	m_fWidth;
+	sal_Int32	m_nTransparency;
+	sal_Int32	m_nNumber1;
+	sal_Int32	m_nNumber2;
+	double	m_fSpace;
+	double	m_fLength1;
+	double	m_fLength2;
+};
+
+inline void XFDrawLineStyle::SetWidth(double width)
+{
+	m_fWidth = width;
+}
+
+inline void XFDrawLineStyle::SetColor(const XFColor& color)
+{
+	m_aColor = color;
+}
+
+inline void XFDrawLineStyle::SetTransparency(sal_Int32 transparency)
+{
+	m_nTransparency = transparency;
+}
+
+inline void	XFDrawLineStyle::SetLineStyle(enumXFLineStyle style)
+{
+	m_eLineStyle = style;
+}
+
+inline void	XFDrawLineStyle::SetDot1Number(sal_Int32 number)
+{
+	m_nNumber1 = number;
+}
+
+inline void	XFDrawLineStyle::SetDot2Number(sal_Int32 number)
+{
+	m_nNumber2 = number;
+}
+
+inline void	XFDrawLineStyle::SetDot1Length(double length)
+{
+	m_fLength1 = length;
+}
+
+inline void	XFDrawLineStyle::SetDot2Length(double length)
+{
+	m_fLength2 = length;
+}
+
+inline void XFDrawLineStyle::SetSpace(double space)
+{
+	m_fSpace = space;
+}
+
+inline sal_Bool	XFDrawLineStyle::IsSolid()
+{
+	return (m_eLineStyle==enumXFLineSolid);
+}
+
+inline double XFDrawLineStyle::GetWidth()
+{
+	return m_fWidth;
+}
+
+inline XFColor XFDrawLineStyle::GetColor()
+{
+	return m_aColor;
+}
+
+inline sal_Int32 XFDrawLineStyle::GetTransparency()
+{
+	return m_nTransparency;
+}
+
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawobj.cxx lotuswordpro/source/filter/xfilter/xfdrawobj.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawobj.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawobj.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,134 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interfer for all Drawing object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ * 2005-4-1	revise for rotate.
+ ************************************************************************/
+#include	"xfdrawobj.hxx"
+
+XFDrawObject::XFDrawObject()
+{
+	m_fRotate = 0;
+	m_fScaleX = 0;
+	m_fScaleY = 0;
+	m_fSkewX = 0;
+	m_fSkewY = 0;
+	m_nFlag = 0;
+	m_eType = enumXFFrameDrawing;
+}
+
+void XFDrawObject::ContentToXml(IXFStream *pStrm)
+{
+	XFContentContainer::ToXml(pStrm);
+}
+
+void XFDrawObject::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:style-name"), GetStyleName() );
+	
+	assert(m_strName.getLength()>0);	//name should not be null.
+	if( m_strName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	//anchor type:
+	switch( m_eAnchor )
+	{
+	case enumXFAnchorPara:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("paragraph") );
+		break;
+	case enumXFAnchorPage:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("page") );
+		break;
+	case enumXFAnchorChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("char") );
+		break;
+	case enumXFAnchorAsChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("as-char") );
+		break;
+	case enumXFAnchorFrame:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("frame") );
+		break;
+	}
+	pAttrList->AddAttribute( A2OUSTR("draw:z-index"), Int32ToOUString(m_nZIndex) );		
+
+	pAttrList->AddAttribute( A2OUSTR("svg:x"), DoubleToOUString(m_aRect.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y"), DoubleToOUString(m_aRect.GetY()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:width"), DoubleToOUString(m_aRect.GetWidth()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:height"), DoubleToOUString(m_aRect.GetHeight()) + A2OUSTR("cm") );	
+
+	//transform
+	rtl::OUString	strTransform;
+	if( m_nFlag&XFDRAWOBJECT_FLAG_ROTATE )
+		strTransform = A2OUSTR("rotate (") + DoubleToOUString(m_fRotate) + A2OUSTR(") ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_TRANLATE )
+		strTransform += A2OUSTR("translate (") + DoubleToOUString(m_aRotatePoint.GetX()) + A2OUSTR("cm ") + DoubleToOUString(m_aRotatePoint.GetY()) + A2OUSTR("cm) ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_SCALE )
+		strTransform += A2OUSTR("scale (") + DoubleToOUString(m_fScaleX) + A2OUSTR("cm ") + DoubleToOUString(m_fScaleY) + A2OUSTR("cm) ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_SKEWX )
+		strTransform += A2OUSTR("skewX (") + DoubleToOUString(m_fSkewX) + A2OUSTR(" ");
+	if( m_nFlag&XFDRAWOBJECT_FLAG_SKEWY )	
+		strTransform += A2OUSTR("skewY (") + DoubleToOUString(m_fSkewY) + A2OUSTR(" ");
+	strTransform = strTransform.trim();
+	
+	if( strTransform.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("draw:transform"), strTransform );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawobj.hxx lotuswordpro/source/filter/xfilter/xfdrawobj.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawobj.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawobj.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,179 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interfer for all Drawing object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWOBJ_HXX
+#define		_XFDRAWOBJ_HXX
+
+#include	"xfframe.hxx"
+#include	"xfrect.hxx"
+
+#define		XFDRAWOBJECT_FLAG_ROTATE	0X00000001
+#define		XFDRAWOBJECT_FLAG_TRANLATE	0X00000002
+#define		XFDRAWOBJECT_FLAG_SKEWX		0X00000004
+#define		XFDRAWOBJECT_FLAG_SKEWY		0X00000008
+#define		XFDRAWOBJECT_FLAG_SCALE		0X00000010
+
+/**
+ * @brief
+ * Base class for all drawing object(ellipse,rect,circle,...).
+ * I can set Postions,anchor,rotate,text style name here.
+ *
+ * Drawing obejcts can be rotated,scaled and skewed, drawing objects must have positions setted,
+ * you can use SetPosition(...).
+ */
+class XFDrawObject : public XFFrame
+{
+public:
+	XFDrawObject();
+
+public:
+	/**
+	 * @descr	Set style name for drawing text. 
+	 */
+	void	SetTextStyleName(rtl::OUString style);
+	
+	/**
+	 * @descr	Set drawing obejct rotate. 
+	 */
+	void	SetRotate(double degree, XFPoint aRotatePoint=XFPoint(0,0));
+
+	/**
+	 * @descr	Set drawing object scale. 
+	 */
+	void	SetScale(double cx, double cy);
+
+	/**
+	 * @descr	Set drawing object skew. 
+	 */
+	void	SetSkewX(double cx);
+
+	/**
+	 * @descr	Set drawing obejct y skew. 
+	 */
+	void	SetSkewY(double cy);
+	
+	void	ContentToXml(IXFStream *pStrm);
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+protected:
+	XFContentContainer	m_aContents;
+	rtl::OUString	m_strTextStyle;	
+	double	m_fRotate;
+	XFPoint	m_aRotatePoint;
+	double	m_fScaleX;
+	double	m_fScaleY;
+	double	m_fSkewX;
+	double	m_fSkewY;
+	
+	unsigned int	m_nFlag;
+};
+
+inline void XFDrawObject::SetTextStyleName(rtl::OUString style)
+{
+	m_strTextStyle = style;
+}
+/*
+inline void XFDrawObject::SetPosition(double x, double y, double width, double height)
+{
+	SetX(x);
+	SetY(y);
+	SetWidth(width);
+	SetHeight(height);
+}
+
+inline void XFDrawObject::SetPosition(XFRect rect)
+{
+	SetX(rect.GetX());
+	SetY(rect.GetY());
+	SetWidth(rect.GetWidth());
+	SetHeight(rect.GetHeight());
+}
+*/
+inline void XFDrawObject::SetRotate(double degree, XFPoint aRotatePoint)
+{
+	m_nFlag |= XFDRAWOBJECT_FLAG_ROTATE;
+	m_fRotate = degree*2*PI/360;
+	m_aRotatePoint = aRotatePoint;
+}
+
+inline void XFDrawObject::SetScale(double cx, double cy)
+{
+	m_nFlag |= XFDRAWOBJECT_FLAG_SCALE;
+	m_fScaleX = cx;
+	m_fScaleY = cy;
+}
+
+inline void XFDrawObject::SetSkewX(double cx)
+{
+	m_nFlag |= XFDRAWOBJECT_FLAG_SKEWX;
+	m_fSkewX = cx*2*PI/360;
+}
+
+inline void XFDrawObject::SetSkewY(double cy)
+{
+	m_nFlag |= XFDRAWOBJECT_FLAG_SKEWY;
+	m_fSkewY = cy*2*PI/360;
+}
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpath.cxx lotuswordpro/source/filter/xfilter/xfdrawpath.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpath.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpath.cxx	2008-10-22 12:57:19.000000000 +0800
@@ -0,0 +1,222 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Draw path object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#include	"xfdrawpath.hxx"
+
+XFSvgPathEntry::XFSvgPathEntry()
+{	
+}
+
+XFSvgPathEntry::XFSvgPathEntry(rtl::OUString cmd)
+{
+	m_strCommand = cmd;
+}
+
+rtl::OUString XFSvgPathEntry::ToString()
+{
+	assert(m_strCommand.getLength()>0);
+	rtl::OUString str = m_strCommand;
+	std::vector<XFPoint>::iterator it;
+
+	for( it = m_aPoints.begin(); it != m_aPoints.end(); it++ )
+	{
+		XFPoint aPt= *it;
+		str += DoubleToOUString(aPt.GetX()*1000) + A2OUSTR(" ") + DoubleToOUString(aPt.GetY()*1000) + A2OUSTR(" ");
+	}
+	return str.trim();	
+}
+
+XFDrawPath::XFDrawPath()
+{
+}
+
+void	XFDrawPath::MoveTo(XFPoint pt, sal_Bool absPosition)
+{
+	XFSvgPathEntry	entry;
+	
+	if( absPosition )
+		entry.SetCommand(A2OUSTR("M"));
+	else
+		entry.SetCommand(A2OUSTR("m"));
+	entry.AddPoint(pt);
+	m_aPaths.push_back(entry);
+}
+
+void	XFDrawPath::LineTo(XFPoint pt, sal_Bool absPosition)
+{
+	XFSvgPathEntry	entry;
+	
+	if( absPosition )
+		entry.SetCommand(A2OUSTR("L"));
+	else
+		entry.SetCommand(A2OUSTR("l"));
+	entry.AddPoint(pt);
+	m_aPaths.push_back(entry);
+}
+
+void	XFDrawPath::CurveTo(XFPoint dest, XFPoint ctrl1, XFPoint ctrl2, sal_Bool absPosition)
+{
+	XFSvgPathEntry	entry;
+	
+	if( absPosition )
+		entry.SetCommand(A2OUSTR("C"));
+	else
+		entry.SetCommand(A2OUSTR("c"));
+	entry.AddPoint(ctrl1);
+	entry.AddPoint(ctrl2);
+	entry.AddPoint(dest);
+
+	m_aPaths.push_back(entry);
+}
+
+void	XFDrawPath::SmoothCurveTo(XFPoint dest, XFPoint ctrl, sal_Bool absPosition)
+{
+	XFSvgPathEntry	entry;
+	
+	if( absPosition )
+		entry.SetCommand(A2OUSTR("C"));
+	else
+		entry.SetCommand(A2OUSTR("c"));
+	entry.AddPoint(ctrl);
+	entry.AddPoint(dest);
+	
+	m_aPaths.push_back(entry);
+}
+
+void	XFDrawPath::ClosePath(sal_Bool absPosition)
+{
+	XFSvgPathEntry	entry;
+	
+	if( absPosition )
+		entry.SetCommand(A2OUSTR("Z"));
+	else
+		entry.SetCommand(A2OUSTR("z"));
+	
+	m_aPaths.push_back(entry);
+}
+
+void	XFDrawPath::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	//view-box:
+	XFRect	rect = m_aRect;
+	
+	rtl::OUString strViewBox = A2OUSTR("0 0 ");
+	strViewBox += DoubleToOUString(rect.GetWidth()*1000) + A2OUSTR(" ");
+	strViewBox += DoubleToOUString(rect.GetHeight()*1000);
+	pAttrList->AddAttribute( A2OUSTR("svg:viewBox"), strViewBox);
+	
+	//points
+	rtl::OUString	strPath;
+	std::vector<XFSvgPathEntry>::iterator it;
+	for( it = m_aPaths.begin(); it != m_aPaths.end(); it++ )
+	{
+		XFSvgPathEntry	aSvg = *it;
+		strPath += aSvg.ToString();
+	}	
+	strPath = strPath.trim();
+	pAttrList->AddAttribute( A2OUSTR("svg:d"), strPath);
+
+	SetPosition(rect);
+	XFDrawObject::ToXml(pStrm);
+
+	pStrm->StartElement( A2OUSTR("draw:path") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:path") );
+}
+
+
+XFRect	XFDrawPath::CalcViewBox()
+{
+	double	x1 = 65536;
+	double	y1 = 65536;
+	double	x2 = -1;	//not quite safe.()
+	double	y2 = -1;
+	XFSvgPathEntry	aPath;
+	XFPoint	aPoint;
+	std::vector<XFSvgPathEntry>::iterator itPath = m_aPaths.begin();
+	std::vector<XFPoint> points;
+	std::vector<XFPoint>::iterator itPoint;
+	do{
+		aPath = *itPath;
+		points = aPath.m_aPoints;
+
+		for( itPoint = points.begin(); itPoint != points.end(); itPoint++ )
+		{
+			aPoint = *itPoint;
+			if( x1>aPoint.GetX() )
+				x1 = aPoint.GetX();
+			if( x2<aPoint.GetX() )
+				x2 = aPoint.GetX();
+			
+			if( y1>aPoint.GetY() )
+				y1 = aPoint.GetY();
+			if( y2<aPoint.GetY() )
+				y2 = aPoint.GetY();		
+		}	
+		itPath++;
+	}while(itPath!=m_aPaths.end());
+
+	return XFRect(x1,y1,x2-x1,y2-y1);
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpath.hxx lotuswordpro/source/filter/xfilter/xfdrawpath.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpath.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpath.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,154 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Draw path object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWPATH_HXX
+#define		_XFDRAWPATH_HXX
+
+#include	"xfdrawobj.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * SVG path segment wrapper.
+ */
+class XFSvgPathEntry
+{
+public:
+	XFSvgPathEntry();
+
+	XFSvgPathEntry(rtl::OUString cmd);
+
+public:
+	/**
+	 * @descr	Set svg path command,L for line,M for move,... 
+	 */
+	void	SetCommand(rtl::OUString cmd);
+
+	/**
+	 * @descr	Set svg path point. 
+	 */
+	void	AddPoint(XFPoint pt);
+
+	rtl::OUString ToString();
+
+	friend class XFDrawPath;
+private:	
+	rtl::OUString	m_strCommand;
+	std::vector<XFPoint>	m_aPoints;
+};
+
+/**
+ * @brief
+ * For svg path wrapper.
+ */
+class XFDrawPath : public XFDrawObject
+{
+public:
+	XFDrawPath();
+
+public:
+	/**
+	 * @descr	Move command. 
+	 */
+	void	MoveTo(XFPoint pt, sal_Bool absPosition = sal_True);
+
+	/**
+	 * @descr	Line command. 
+	 */
+	void	LineTo(XFPoint pt, sal_Bool absPosition = sal_True);
+
+	/**
+	 * @descr	Curve command. 
+	 */
+	void	CurveTo(XFPoint dest, XFPoint ctrl1, XFPoint ctrl2, sal_Bool absPosition = sal_True);
+
+	/**
+	 * @descr	Smooth curve command. 
+	 */
+	void	SmoothCurveTo(XFPoint dest, XFPoint ctrl, sal_Bool absPosition = sal_True);
+
+	/**
+	 * @descr	Close path command. 
+	 */
+	void	ClosePath(sal_Bool absPosition = sal_True);
+
+	XFRect	CalcViewBox();
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+private:
+	std::vector<XFSvgPathEntry>	m_aPaths;
+};
+
+inline void XFSvgPathEntry::SetCommand(rtl::OUString cmd)
+{
+	m_strCommand = cmd;
+}
+
+inline void	XFSvgPathEntry::AddPoint(XFPoint pt)
+{
+	m_aPoints.push_back(pt);
+}
+
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpolygon.cxx lotuswordpro/source/filter/xfilter/xfdrawpolygon.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpolygon.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpolygon.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,101 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Polylon object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#include	"xfdrawpolygon.hxx"
+
+XFDrawPolygon::XFDrawPolygon()
+{
+}
+
+void XFDrawPolygon::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	std::vector<XFPoint>::iterator it;
+	
+	pAttrList->Clear();
+	//view-box:
+	XFRect	rect = CalcViewBox();
+	rtl::OUString strViewBox = A2OUSTR("0 0 ");
+	strViewBox += DoubleToOUString(rect.GetWidth()*1000) + A2OUSTR(" ");
+	strViewBox += DoubleToOUString(rect.GetHeight()*1000);
+	pAttrList->AddAttribute( A2OUSTR("svg:viewBox"), strViewBox);
+	
+	//points
+	rtl::OUString	strPoints;
+	for( it = m_aPoints.begin(); it != m_aPoints.end(); it++ )
+	{
+		XFPoint pt = *it;
+		double	x = (pt.GetX()-rect.GetX())*1000;
+		double	y = (pt.GetY()-rect.GetY())*1000;
+		strPoints += DoubleToOUString(x) + A2OUSTR(" ") + DoubleToOUString(y) + A2OUSTR(" ");
+	}	
+	strPoints = strPoints.trim();
+	pAttrList->AddAttribute( A2OUSTR("draw:points"), strPoints);
+	
+	//
+	SetPosition(rect.GetX(),rect.GetY(),rect.GetWidth(),rect.GetHeight());
+	XFDrawObject::ToXml(pStrm);
+
+	pStrm->StartElement( A2OUSTR("draw:polygon") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:polygon") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpolygon.hxx lotuswordpro/source/filter/xfilter/xfdrawpolygon.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpolygon.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpolygon.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,82 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Polygon object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFPOLYGON_HXX
+#define		_XFPOLYGON_HXX
+
+#include	"xfdrawpolyline.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * Polygon object.
+ */
+class XFDrawPolygon : public XFDrawPolyline
+{
+public:
+	XFDrawPolygon();
+
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpolyline.cxx lotuswordpro/source/filter/xfilter/xfdrawpolyline.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpolyline.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpolyline.cxx	2008-10-22 12:05:47.000000000 +0800
@@ -0,0 +1,133 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Polyline.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#include	"xfdrawpolyline.hxx"
+
+XFDrawPolyline::XFDrawPolyline()
+{
+}
+
+void XFDrawPolyline::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	std::vector<XFPoint>::iterator it;
+	
+	pAttrList->Clear();
+	//view-box:
+	XFRect	rect = CalcViewBox();
+	rtl::OUString strViewBox = A2OUSTR("0 0 ");
+	strViewBox += DoubleToOUString(rect.GetWidth()*1000) + A2OUSTR(" ");
+	strViewBox += DoubleToOUString(rect.GetHeight()*1000);
+	pAttrList->AddAttribute( A2OUSTR("svg:viewBox"), strViewBox);
+
+	//points
+	rtl::OUString	strPoints;
+	for( it = m_aPoints.begin(); it != m_aPoints.end(); it++ )
+	{
+		XFPoint pt = *it;
+		double	x = (pt.GetX()-rect.GetX())*1000;
+		double	y = (pt.GetY()-rect.GetY())*1000;
+		strPoints += DoubleToOUString(x) + A2OUSTR(",") + DoubleToOUString(y) + A2OUSTR(" ");
+	}	
+	strPoints = strPoints.trim();
+	pAttrList->AddAttribute( A2OUSTR("draw:points"), strPoints);
+
+	//
+	SetPosition(rect.GetX(),rect.GetY(),rect.GetWidth(),rect.GetHeight());
+	XFDrawObject::ToXml(pStrm);
+
+	pStrm->StartElement( A2OUSTR("draw:polyline") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:polyline") );
+}
+
+XFRect	XFDrawPolyline::CalcViewBox()
+{
+	double	x1 = 0;
+	double	y1 = 0;
+	double	x2 = 0;
+	double	y2 = 0;
+	XFPoint	aPoint;
+	std::vector<XFPoint>::iterator it = m_aPoints.begin();
+	
+	assert(m_aPoints.size()>0);
+
+	aPoint = *it;
+	x1 = aPoint.GetX();
+	x2 = aPoint.GetX();
+	y1 = aPoint.GetY();
+	y2 = aPoint.GetY();
+	for( ; it != m_aPoints.end(); it++ )
+	{
+		aPoint = *it;
+		if( x1>aPoint.GetX() )
+			x1 = aPoint.GetX();
+		if( x2<aPoint.GetX() )
+			x2 = aPoint.GetX();
+
+		if( y1>aPoint.GetY() )
+			y1 = aPoint.GetY();
+		if( y2<aPoint.GetY() )
+			y2 = aPoint.GetY();		
+	}	
+	return XFRect(x1,y1,x2-x1,y2-y1);
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawpolyline.hxx lotuswordpro/source/filter/xfilter/xfdrawpolyline.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawpolyline.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawpolyline.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,99 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Polyline.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFPOLYLINE_HXX
+#define		_XFPOLYLINE_HXX
+
+#include	"xfdrawobj.hxx"
+#include	<vector>
+
+class XFDrawPolyline : public XFDrawObject
+{
+public:
+	XFDrawPolyline();
+
+public:
+	void	AddPoint(double x, double y);
+
+	void	AddPoint(XFPoint pt);
+
+	XFRect	CalcViewBox();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+protected:
+	std::vector<XFPoint>	m_aPoints;
+};
+
+inline void XFDrawPolyline::AddPoint(double x, double y)
+{
+	assert(x>=0&&y>=0);
+	m_aPoints.push_back( XFPoint(x,y) );
+}
+
+inline void XFDrawPolyline::AddPoint(XFPoint pt)
+{
+	assert(pt.GetX()>=0&&pt.GetY()>=0);
+	m_aPoints.push_back(pt);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawrect.cxx lotuswordpro/source/filter/xfilter/xfdrawrect.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawrect.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawrect.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,83 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Rect object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#include	"xfdrawrect.hxx"
+
+XFDrawRect::XFDrawRect()
+{
+	m_fCornerRadius = 0;
+}
+
+void XFDrawRect::ToXml(IXFStream *pStrm)
+{	
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+
+	if( 0 != m_fCornerRadius )
+		pAttrList->AddAttribute( A2OUSTR("draw:corner-radius"), DoubleToOUString(m_fCornerRadius) + A2OUSTR("cm") );
+	XFDrawObject::ToXml(pStrm);
+	
+	pStrm->StartElement( A2OUSTR("draw:rect") );
+	ContentToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("draw:rect") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawrect.hxx lotuswordpro/source/filter/xfilter/xfdrawrect.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawrect.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawrect.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,116 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Rect object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-17 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWRECT_HXX
+#define		_XFDRAWRECT_HXX
+
+#include	"xfdrawobj.hxx"
+
+class XFDrawRect : public XFDrawObject
+{
+public:
+	XFDrawRect();
+
+public:
+	void	SetStartPoint(XFPoint pt);
+
+	void	SetSize(double width, double height);
+
+	void	SetWidth(double width);
+
+	void	SetHeight(double height);
+
+	void	SetCornerRadius(double fCornerRadius);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	double	m_fCornerRadius;
+};
+
+inline void	XFDrawRect::SetStartPoint(XFPoint pt)
+{
+	m_aRect.SetStartPoint(pt);
+}
+
+inline void XFDrawRect::SetSize(double width, double height)
+{
+	m_aRect.SetSize(width,height);
+}
+
+inline void XFDrawRect::SetWidth(double width)
+{
+	m_aRect.SetWidth(width);
+}
+
+inline void XFDrawRect::SetHeight(double height)
+{
+	m_aRect.SetHeight(height);
+}
+
+inline void XFDrawRect::SetCornerRadius(double fCornerRadius)
+{
+	m_fCornerRadius = fCornerRadius;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawstyle.cxx lotuswordpro/source/filter/xfilter/xfdrawstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,349 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style for all draw object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-21 create this file.
+ ************************************************************************/
+#include	"xfdrawstyle.hxx"
+#include	"xfdrawlinestyle.hxx"
+#include	"xfdrawareastyle.hxx"
+#include	"xfstylemanager.hxx"
+#include "xffontworkstyle.hxx"
+#include "../lwpglobalmgr.hxx"
+XFDrawStyle::XFDrawStyle()
+{
+	m_eWrap = enumXFWrapNone;
+	m_nWrapLines = 0;	//not limited.
+	
+	m_pLineStyle = NULL;
+	m_pAreaStyle = NULL;
+
+	m_pFontWorkStyle = NULL;
+	
+	m_fArrowStartSize = 0.3;
+	m_fArrowEndSize = 0.3;
+	m_bArrowStartCenter = sal_False;
+	m_bArrowStartCenter = sal_False;
+}
+
+XFDrawStyle::~XFDrawStyle()
+{
+	//don't delete m_pLineStyle, it was managed by XFStyleManager.
+	if (m_pFontWorkStyle)
+	{
+		delete m_pFontWorkStyle;
+		m_pFontWorkStyle = NULL;
+	}
+}
+
+void	XFDrawStyle::SetLineStyle(double width, XFColor color, sal_Int32 transparency)
+{
+	if( !m_pLineStyle )
+	{
+		m_pLineStyle = new XFDrawLineStyle();
+		m_pLineStyle->SetStyleName( XFGlobal::GenStrokeDashName());
+	}
+	m_pLineStyle->SetWidth(width);
+	m_pLineStyle->SetColor(color);
+	m_pLineStyle->SetTransparency(transparency);
+}
+
+void	XFDrawStyle::SetLineDashStyle(enumXFLineStyle style, int num1, int num2, double len1, double len2, double space )
+{
+	if( !m_pLineStyle )
+	{
+		m_pLineStyle = new XFDrawLineStyle();
+		m_pLineStyle->SetStyleName( XFGlobal::GenStrokeDashName());
+	}
+	m_pLineStyle->SetLineStyle(style);
+	m_pLineStyle->SetDot1Number(num1);
+	m_pLineStyle->SetDot1Length(len1);
+	m_pLineStyle->SetDot2Number(num2);
+	m_pLineStyle->SetDot2Length(len2);
+	m_pLineStyle->SetSpace(space);
+	XFStyleManager* pXFStyleManager = LwpGlobalMgr::GetInstance()->GetXFStyleManager(); 
+	pXFStyleManager->AddStyle(m_pLineStyle);
+}
+
+void XFDrawStyle::SetFontWorkStyle(sal_Int8 nForm, enumXFFWStyle eStyle, enumXFFWAdjust eAdjust)
+{
+	if (!m_pFontWorkStyle)
+	{
+		m_pFontWorkStyle = new XFFontWorkStyle();
+	}
+
+	m_pFontWorkStyle->SetButtonForm(nForm);
+	m_pFontWorkStyle->SetFWStyleType(eStyle);
+	m_pFontWorkStyle->SetFWAdjustType(eAdjust);
+}
+
+void	XFDrawStyle::SetAreaColor(XFColor& color)
+{
+	if( !m_pAreaStyle )
+	{
+		m_pAreaStyle = new XFDrawAreaStyle();
+		m_pAreaStyle->SetStyleName( XFGlobal::GenAreaName());
+	}
+	m_pAreaStyle->SetBackColor(color);
+}
+
+void	XFDrawStyle::SetAreaLineStyle(enumXFAreaLineStyle style, sal_Int32 angle, double space, XFColor lineColor)
+{
+	if( !m_pAreaStyle )
+	{
+		m_pAreaStyle = new XFDrawAreaStyle();
+		m_pAreaStyle->SetStyleName( XFGlobal::GenAreaName());		
+	}
+	m_pAreaStyle->SetAreaStyle(enumXFAreaHatch);
+
+	m_pAreaStyle->SetLineStyle(style);
+	m_pAreaStyle->SetLineAngle(angle);
+	m_pAreaStyle->SetLineSpace(space);
+	m_pAreaStyle->SetLineColor(lineColor);
+	XFStyleManager* pXFStyleManager = LwpGlobalMgr::GetInstance()->GetXFStyleManager(); 
+	pXFStyleManager->AddStyle(m_pAreaStyle);
+}
+
+enumXFStyle	XFDrawStyle::GetStyleFamily()
+{
+	return enumXFStyleGraphics;
+}
+
+/**************************************************************************
+ *************************************************************************/
+void	XFDrawStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("graphics") );
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	pAttrList->Clear();
+
+	if( m_eWrap == enumXFWrapBackground )
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("background") );
+	}
+	else
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("foreground") );
+		
+		if( m_eWrap == enumXFWrapNone )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("none") );
+		else if( m_eWrap == enumXFWrapLeft )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("left") );
+		else if( m_eWrap == enumXFWrapRight )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("right") );
+		else if( m_eWrap == enumXFWrapParallel )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("parallel") );
+		else if( m_eWrap == enumXFWrapRunThrough )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("run-through") );
+		else if( m_eWrap == enumXFWrapBest )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("dynamic") );
+	}
+
+	//line style:
+	if( m_pLineStyle )
+	{
+		//1. if is a dash style, register the stroke-dash style first.
+		if( !m_pLineStyle->IsSolid() )
+		{			
+//			pAttrList->Clear();
+			pAttrList->AddAttribute( A2OUSTR("draw:stroke"), A2OUSTR("dash") );
+			pAttrList->AddAttribute( A2OUSTR("draw:stroke-dash"), m_pLineStyle->GetStyleName() );
+		}
+		else
+		{
+			pAttrList->AddAttribute( A2OUSTR("draw:stroke"), A2OUSTR("solid") );			
+		}
+		
+		if( m_pLineStyle->GetWidth() > 0 )
+			pAttrList->AddAttribute( A2OUSTR("svg:stroke-width"), DoubleToOUString(m_pLineStyle->GetWidth()) + A2OUSTR("cm") );
+		
+		XFColor color = m_pLineStyle->GetColor();
+		if( color.IsValid() )
+			pAttrList->AddAttribute( A2OUSTR("svg:stroke-color"), color.ToString() );
+
+		if( m_pLineStyle->GetTransparency()>0 )
+			pAttrList->AddAttribute( A2OUSTR("svg:stroke-opacity"), Int32ToOUString(m_pLineStyle->GetTransparency()) + A2OUSTR("%") );
+	}
+	else
+		pAttrList->AddAttribute( A2OUSTR("draw:stroke"), A2OUSTR("none") );
+	//area style:
+	if( m_pAreaStyle )
+	{
+		if( enumXFAreaSolid == m_pAreaStyle->GetAreaStyle() )
+		{
+			pAttrList->AddAttribute( A2OUSTR("draw:fill"), A2OUSTR("solid") );
+			XFColor	color = m_pAreaStyle->GetBackColor();
+			if( color.IsValid() )
+				pAttrList->AddAttribute( A2OUSTR("draw:fill-color"), color.ToString() );
+		}
+		else if( enumXFAreaHatch == m_pAreaStyle->GetAreaStyle() )
+		{
+			pAttrList->AddAttribute( A2OUSTR("draw:fill"), A2OUSTR("hatch") );
+			pAttrList->AddAttribute( A2OUSTR("draw:fill-hatch-name"), m_pAreaStyle->GetStyleName() );
+			XFColor	color = m_pAreaStyle->GetBackColor();
+			if( color.IsValid() )
+			{
+				pAttrList->AddAttribute( A2OUSTR("draw:fill-hatch-solid"), A2OUSTR("true") );
+				pAttrList->AddAttribute( A2OUSTR("draw:fill-color"), color.ToString() );
+			}
+		}		
+	}	
+	else
+		pAttrList->AddAttribute( A2OUSTR("draw:fill"), A2OUSTR("none") );
+
+	if( m_strArrowStart.getLength()>0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("draw:marker-start"), m_strArrowStart );
+		pAttrList->AddAttribute( A2OUSTR("draw:marker-start-width"), DoubleToOUString(m_fArrowStartSize)+A2OUSTR("cm") );
+		if( m_bArrowStartCenter )
+			pAttrList->AddAttribute( A2OUSTR("draw:draw:marker-start-center"), A2OUSTR("true")  );
+	}
+	if( m_strArrowEnd.getLength()>0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("draw:marker-end"), m_strArrowEnd );
+		pAttrList->AddAttribute( A2OUSTR("draw:marker-end-width"), DoubleToOUString(m_fArrowEndSize)+A2OUSTR("cm") );
+		if( m_bArrowEndCenter )
+			pAttrList->AddAttribute( A2OUSTR("draw:draw:marker-end-center"), A2OUSTR("true")  );
+	}
+	if (m_pFontWorkStyle)
+	{
+		// style
+		rtl::OUString aStr = A2OUSTR("");
+		switch (m_pFontWorkStyle->GetStyleType())
+		{
+		default: // fall through!
+		case enumXFFWOff:
+			break;
+		case enumXFFWRotate:
+			aStr = A2OUSTR("rotate");
+			break;
+		case enumXFFWUpright:
+			aStr = A2OUSTR("upright");			
+			break;
+		case enumXFFWSlantX:
+			aStr = A2OUSTR("slant-x");			
+			break;
+		case enumXFFWSlantY:
+			aStr = A2OUSTR("slant-y");			
+			break;
+		}
+		if (aStr.getLength() > 0)
+		{
+			pAttrList->AddAttribute(A2OUSTR("draw:fontwork-style"), aStr);
+		}
+
+		//adjust
+		aStr = A2OUSTR("");
+		switch (m_pFontWorkStyle->GetAdjustType())
+		{
+		default: // fall througth
+		case enumXFFWAdjustAutosize:
+			aStr = A2OUSTR("autosize");
+			break;
+		case enumXFFWAdjustLeft:
+			aStr = A2OUSTR("left");
+			break;
+		case enumXFFWAdjustCenter:
+			aStr = A2OUSTR("center");
+			break;
+		case enumXFFWAdustRight:
+			aStr = A2OUSTR("right");
+			break;
+		}
+		if (aStr.getLength() > 0)
+		{
+			pAttrList->AddAttribute(A2OUSTR("draw:fontwork-adjust"), aStr);
+		}
+
+		//form
+		aStr = A2OUSTR("");
+		switch (m_pFontWorkStyle->GetButtonForm())
+		{
+		default: // fall through!
+		case -1:
+			break;
+		case 4:
+			aStr = A2OUSTR("top-arc");
+			break;
+		case 5:
+			aStr = A2OUSTR("bottom-arc");
+			break;
+		}
+		if (aStr.getLength() > 0)
+		{
+			pAttrList->AddAttribute(A2OUSTR("draw:fontwork-form"), aStr);
+		}
+
+		// distance
+		//pAttrList->AddAttribute(A2OUSTR("draw:fontwork-distance"), 
+		//	DoubleToOUString(m_pFontWorkStyle->GetFWDistance())+A2OUSTR("cm"));
+	}
+
+	pStrm->StartElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdrawstyle.hxx lotuswordpro/source/filter/xfilter/xfdrawstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdrawstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdrawstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,167 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style for all draw object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-21 create this file.
+ ************************************************************************/
+#ifndef		_XFDRAWSTYLE_HXX
+#define		_XFDRAWSTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+#include	<cassert>
+
+class XFDrawLineStyle;
+class XFDrawAreaStyle;
+class XFFontWorkStyle;
+
+/**
+ * @brief
+ * Style for all drawing object, which can includes line style, area style, wrap style.
+ * Line style includes line type, line width and line color.
+ * Area style can be divided into 5 kinds, color fill, hatch, bitmap, gradient.I only support
+ * color fill and hatch now.
+ */
+class XFDrawStyle : public XFStyle
+{
+public:
+	XFDrawStyle();
+	
+	virtual ~XFDrawStyle();
+	
+public:
+	/**
+	 * @descr	Set drawing wrap type. 
+	 */
+	void	SetWrapType(enumXFWrap wrap, sal_Int32 nParagraphs = 0);
+	
+	/**
+	 * @descr	Set drawing object border line. 
+	 */
+	void	SetLineStyle(double width, XFColor color = XFColor(0,0,0), sal_Int32 transparency = 0);
+
+	/**
+	 * @descr	Set drawing obejct dash border style. 
+	 */
+	void	SetLineDashStyle(enumXFLineStyle style, int num1, int num2, double len1, double len2, double space );
+
+	/**
+	 * @descr	Set drawing object area fill color. 
+	 */
+	void	SetAreaColor(XFColor& color);
+
+	/**
+	 * @descr	Set drawing obejct area grid style. 
+	 */
+	void	SetAreaLineStyle(enumXFAreaLineStyle style, sal_Int32 angle = 0, double space = 0.102, XFColor lineColor = XFColor(0,0,0));
+
+	/**
+	 * @descr	Set drawing object arrow start style,only lines can have arrows. 
+	 */
+	void	SetArrowStart(rtl::OUString start, double size=0.3, sal_Bool center = sal_False);
+	
+	/**
+	 * @descr	Set drawing obejct arrow end style,only lines can have arrows. 
+	 */
+	void	SetArrowEnd(rtl::OUString end, double size=0.3, sal_Bool center = sal_False);
+
+	void SetFontWorkStyle(sal_Int8 nForm, enumXFFWStyle eStyle, enumXFFWAdjust eAdjust);
+	
+	virtual enumXFStyle	GetStyleFamily();
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFFontWorkStyle* m_pFontWorkStyle;
+	enumXFWrap	m_eWrap;
+	sal_Int32	m_nWrapLines;
+	XFDrawLineStyle	*m_pLineStyle;
+	XFDrawAreaStyle	*m_pAreaStyle;
+	rtl::OUString	m_strArrowStart;
+	rtl::OUString	m_strArrowEnd;
+	double	m_fArrowStartSize;
+	double	m_fArrowEndSize;
+	sal_Bool m_bArrowStartCenter;
+	sal_Bool m_bArrowEndCenter;
+};
+
+inline void XFDrawStyle::SetWrapType(enumXFWrap wrap, sal_Int32 nParagraphs)
+{
+	m_eWrap = wrap;
+	m_nWrapLines = nParagraphs;
+}
+
+
+inline void XFDrawStyle::SetArrowStart(rtl::OUString start, double size, sal_Bool center)
+{
+	assert(size>0);
+	m_strArrowStart = start;
+	m_fArrowStartSize = size;
+	m_bArrowStartCenter = center;
+}
+
+inline void XFDrawStyle::SetArrowEnd(rtl::OUString end, double size, sal_Bool center)
+{
+	assert(size>0);
+	m_strArrowEnd = end;
+	m_fArrowEndSize = size;
+	m_bArrowEndCenter = center;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfdropcap.hxx lotuswordpro/source/filter/xfilter/xfdropcap.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfdropcap.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfdropcap.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,152 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Drop cap of a paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create this file.
+ ************************************************************************/
+#ifndef		_XFDROPCAP_HXX
+#define		_XFDROPCAP_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+
+class XFDropcap : public IXFProperty
+{
+public:
+	XFDropcap()
+	{
+		Reset();
+	}
+
+public:
+	void	SetCharCount(sal_Int32 count);
+
+	void	SetLines(sal_Int32 lines);
+
+	void	SetDistance(double distance);	
+
+	void	Reset();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFDropcap& dc1, XFDropcap& dc2);
+	friend bool operator!=(XFDropcap& dc1, XFDropcap& dc2);
+	friend class XFParaStyle;
+private:	
+	sal_Int32		m_nCharCount;
+	sal_Int32		m_nLines;
+	double			m_fDistance;
+	rtl::OUString	m_strStyleName;	
+};
+
+inline void	XFDropcap::SetCharCount(sal_Int32 count)
+{
+	m_nCharCount = count;
+}
+
+inline void	XFDropcap::SetLines(sal_Int32 lines)
+{
+	m_nLines = lines;
+}
+
+inline void	XFDropcap::SetDistance(double distance)
+{
+	m_fDistance = distance;
+}
+
+inline void	XFDropcap::Reset()
+{
+	m_nCharCount = 0;
+	m_nLines = 0;
+	m_fDistance = 0;
+	m_strStyleName = A2OUSTR("");
+}
+
+inline void XFDropcap::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_nCharCount < 1 || m_nLines < 2 )
+		return;
+	pAttrList->AddAttribute(A2OUSTR("style:length"), Int32ToOUString(m_nCharCount) );
+	pAttrList->AddAttribute(A2OUSTR("style:lines"), Int32ToOUString(m_nLines) );
+	pAttrList->AddAttribute(A2OUSTR("style:distance"), DoubleToOUString(m_fDistance) + A2OUSTR("cm") );
+	if( m_strStyleName.getLength() )
+		pAttrList->AddAttribute(A2OUSTR("style:style-name"), m_strStyleName );
+	pStrm->StartElement( A2OUSTR("style:drop-cap") ); 
+	pStrm->EndElement( A2OUSTR("style:drop-cap") );
+}
+
+inline bool operator==(XFDropcap& dc1, XFDropcap& dc2)
+{
+	return (
+		(dc1.m_nCharCount == dc2.m_nCharCount)&&
+		(dc1.m_nLines == dc2.m_nLines)&&
+		(dc1.m_fDistance == dc2.m_fDistance)&&
+		(dc1.m_strStyleName == dc2.m_strStyleName)
+		);
+}
+
+inline bool operator!=(XFDropcap& dc1, XFDropcap& dc2)
+{
+	return !(dc1==dc2);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfendnoteconfig.hxx lotuswordpro/source/filter/xfilter/xfendnoteconfig.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfendnoteconfig.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfendnoteconfig.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,82 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Endnote config.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-29 create this file.
+ ************************************************************************/
+#ifndef		_XFENDNOTECONFIG_HXX
+#define		_XFENDNOTECONFIG_HXX
+
+#include	"xfendnoteconfig.hxx"
+
+class XFEndnoteConfig : public XFFootnoteConfig
+{
+public:
+	XFEndnoteConfig() : XFFootnoteConfig()
+	{
+		m_bIsFootnote = sal_False;
+		m_bInsertInPage = sal_False;
+		m_strDefaultStyle = A2OUSTR("Endnote");
+		m_strMasterPage = A2OUSTR("Endnote");
+		m_strCitationStyle = A2OUSTR("Endnote Symbol");
+		m_strBodyStyle = A2OUSTR("Endnote anchor");		
+	}
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfendnote.hxx lotuswordpro/source/filter/xfilter/xfendnote.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfendnote.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfendnote.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,128 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * End note object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-1-31 create this file.
+ ************************************************************************/
+#ifndef		_XFENDNOTE_HXX
+#define		_XFENDNOTE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfcontentcontainer.hxx"
+
+/**
+ * @brief
+ * End note obejct.
+ */
+class XFEndNote : public XFContentContainer
+{
+public:
+	XFEndNote();
+
+public:
+	void	SetLabel(sal_Unicode label);	
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+private:
+	rtl::OUString	m_strID;	
+	rtl::OUString	m_strLabel;
+	XFContentContainer	m_aContents;
+};
+
+inline XFEndNote::XFEndNote()
+{
+	m_strID = XFGlobal::GenNoteName();
+}
+
+inline void	XFEndNote::SetLabel(sal_Unicode label)
+{
+	sal_Unicode		chs[2];
+	chs[0] = label;
+	chs[1] = 0;
+	
+	m_strLabel = rtl::OUString(chs);
+}
+
+inline void	XFEndNote::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("text:id"), m_strID );
+	pStrm->StartElement( A2OUSTR("text:endnote") );
+
+	pAttrList->Clear();
+	if( m_strLabel.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:label"), m_strLabel );
+	pStrm->StartElement( A2OUSTR("text:endnote-citation") );
+	if( m_strLabel.getLength())
+		pStrm->Characters(m_strLabel);
+	pStrm->EndElement( A2OUSTR("text:endnote-citation") );
+
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:endnote-body") );
+	XFContentContainer::ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("text:endnote-body") );
+
+	pStrm->EndElement( A2OUSTR("text:endnote") );
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfentry.cxx lotuswordpro/source/filter/xfilter/xfentry.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfentry.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfentry.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,108 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * index entry object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-04-26 create this file.
+ ************************************************************************/
+#include	"xfentry.hxx"
+
+XFEntry::XFEntry()
+{
+	m_eType = enumXFEntryTOC;
+	m_bMainEntry = sal_False;
+	m_nOutlineLevel = 1;
+}
+
+void	XFEntry::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("text:string-value"), m_strValue );
+	
+	if( m_eType == enumXFEntryTOC )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:outline-level"), Int32ToOUString(m_nOutlineLevel) );
+		pStrm->StartElement( A2OUSTR("text:toc-mark") );
+//		pStrm->Characters(m_strDisplay);
+		pStrm->EndElement( A2OUSTR("text:toc-mark") );		
+	}
+	else if( m_eType == enumXFEntryAlphabetical )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:key1"), m_strKey1 );
+		if( m_strKey2.getLength()>0 )
+			pAttrList->AddAttribute( A2OUSTR("text:key2"), m_strKey2 );
+
+		if( m_bMainEntry )
+			pAttrList->AddAttribute( A2OUSTR("text:main-etry"), A2OUSTR("true") );
+		
+		pStrm->StartElement( A2OUSTR("text:alphabetical-index-mark") );
+//		pStrm->Characters(m_strDisplay);
+		pStrm->EndElement( A2OUSTR("text:alphabetical-index-mark") );	
+	}
+	else if( m_eType == enumXFEntryUserIndex )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:outline-level"), Int32ToOUString(m_nOutlineLevel) );
+		pAttrList->AddAttribute( A2OUSTR("text:index-name"), m_strName );
+		
+		pStrm->StartElement( A2OUSTR("text:user-index-mark") );
+//		pStrm->Characters(m_strDisplay);
+		pStrm->EndElement( A2OUSTR("text:user-index-mark") );	
+	}	
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfentry.hxx lotuswordpro/source/filter/xfilter/xfentry.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfentry.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfentry.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,162 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * index entry object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-04-26 create this file.
+ ************************************************************************/
+#ifndef		_XFENTRY_HXX
+#define		_XFENTRY_HXX
+
+#include	"xfcontent.hxx"
+
+/**
+ * @brief
+ * Index entry obejct.
+ */
+class XFEntry : public XFContent
+{
+public:
+	XFEntry();
+
+public:
+	/**
+	 * @descr	Set entry type. 
+	 */
+	void	SetEntryType(enumXFEntry type);
+
+	/**
+	 * @descr	Set entry string value. 
+	 */
+	void	SetStringValue(const rtl::OUString& value);
+
+	/**
+	 * @descr	Set display string. 
+	 */
+	void	SetStringDisplay(const rtl::OUString& display);
+
+	/**
+	 * @descr	Set entry name. 
+	 */
+	void	SetEntryName(const rtl::OUString& name);
+
+	/**
+	 * @descr	Set entry key. The keys is available only for enumXFEntryAlphabetical. 
+	 */
+	void	SetKey(const rtl::OUString& key1, const rtl::OUString& key2=A2OUSTR(""));
+
+	/**
+	 * @descr	Set whether it's a main entry. This is available only for enumXFEntryAlphabetical. 
+	 */
+	void	SetMainEntry(sal_Bool main);
+
+	/**
+	 * @descr	Set outline level. This is available for enumXFEntryTOC and enumXFEntryUserIndex. 
+	 */
+	void	SetOutlineLevel(sal_Int32 level);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	enumXFEntry		m_eType;
+	rtl::OUString	m_strValue;
+	rtl::OUString	m_strDisplay;
+	rtl::OUString	m_strKey1;
+	rtl::OUString	m_strKey2;
+	rtl::OUString	m_strName;
+	sal_Bool		m_bMainEntry;
+	sal_Int32		m_nOutlineLevel;
+};
+
+inline void	XFEntry::SetEntryType(enumXFEntry type)
+{
+	m_eType = type;
+}
+
+inline void XFEntry::SetStringValue(const rtl::OUString& value)
+{
+	m_strValue = value;
+}
+
+inline void XFEntry::SetStringDisplay(const rtl::OUString& display)
+{
+	m_strDisplay = display;
+}
+
+inline void XFEntry::SetEntryName(const rtl::OUString& name)
+{
+	m_strName = name;
+}
+
+inline void	XFEntry::SetKey(const rtl::OUString& key1, const rtl::OUString& key2/* =A2OUSTR */)
+{
+	m_strKey1 = key1;
+	m_strKey2 = key2;
+}
+
+inline void	XFEntry::SetMainEntry(sal_Bool main)
+{
+	m_bMainEntry = main;
+}
+
+inline void XFEntry::SetOutlineLevel(sal_Int32 level)
+{
+	m_nOutlineLevel = level;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffileattrlist.cxx lotuswordpro/source/filter/xfilter/xffileattrlist.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffileattrlist.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffileattrlist.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,82 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Attribute list for sax element,this is a help class to write xml to
+ * local file.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xffileattrlist.hxx"
+
+XFFileAttrList::XFFileAttrList()
+{
+}
+
+XFFileAttrList::~XFFileAttrList()
+{
+}
+
+void	XFFileAttrList::AddAttribute(const rtl::OUString& name, const rtl::OUString& value)
+{
+	m_aAttrList.push_back( std::pair<rtl::OUString,rtl::OUString>(name,value) );
+}
+
+void	XFFileAttrList::Clear()
+{
+	m_aAttrList.clear();
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffileattrlist.hxx lotuswordpro/source/filter/xfilter/xffileattrlist.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffileattrlist.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffileattrlist.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,89 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Wrapper the sax interface for xml output.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+
+#ifndef		_XFFILEATTRLIST_HXX
+#define		_XFFILEATTRLIST_HXX
+
+#include	"ixfattrlist.hxx"
+#include	"rtl/ustring.hxx"
+#include	<vector>
+#include	<utility>
+
+class	XFFileAttrList : public IXFAttrList
+{
+public:
+
+	XFFileAttrList();
+	virtual ~XFFileAttrList();
+	//Interface ISaxAttributeList:
+
+	virtual void	AddAttribute(const rtl::OUString& name, const rtl::OUString& value);	
+	virtual void	Clear();
+
+	friend class XFFileStream;
+private:
+	std::vector<std::pair<rtl::OUString,rtl::OUString> > m_aAttrList;
+
+};
+
+#endif //XFFILEATTRLIST
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffilestream.cxx lotuswordpro/source/filter/xfilter/xffilestream.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffilestream.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffilestream.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,208 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Interface for the all content object,ie. text,paragraph,picture,and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xffilestream.hxx"
+#include	"xffileattrlist.hxx"
+#include	"ixfattrlist.hxx"
+
+void	WriteStartTag(std::ofstream& ofs, const char *pStr, int len);
+void	WriteEndTag(std::ofstream& ofs, const char *pStr, int len);
+void	WriteString(std::ofstream& ofs, const char *pStr, int len);
+void	WriteXmlString(std::ofstream& ofs, const char *pStr, int len);
+void	WriteOUString(std::ofstream& ofs, const rtl::OUString& oustr);
+
+XFFileStream::XFFileStream(std::string strFileName):m_aFile(strFileName.c_str())
+{
+	m_pAttrList = new XFFileAttrList();
+}
+
+XFFileStream::~XFFileStream()
+{
+	if( m_pAttrList )
+		delete m_pAttrList;
+}
+
+void		XFFileStream::StartDocument()
+{
+	std::string	strXmlDecl = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";
+	WriteString(m_aFile, strXmlDecl.c_str(),strXmlDecl.length());
+}
+
+void		XFFileStream::EndDocument()
+{
+	m_aFile.close();
+}
+
+
+void		XFFileStream::StartElement(const rtl::OUString& oustr)
+{
+	WriteString(m_aFile, "\n<",2);
+	WriteOUString(m_aFile, oustr);
+	
+	//write attributes:
+	std::vector<std::pair<rtl::OUString,rtl::OUString> >::iterator	it;
+	for( it = m_pAttrList->m_aAttrList.begin(); it != m_pAttrList->m_aAttrList.end(); it++ )
+	{
+		std::pair<rtl::OUString,rtl::OUString>	pair = *it;
+		rtl::OUString	name = pair.first;
+		rtl::OUString	value = pair.second;
+
+		WriteString(m_aFile," ",1);
+		WriteOUString(m_aFile, name);
+		WriteString(m_aFile, "=\"",2);
+		WriteOUString(m_aFile, value);
+		WriteString(m_aFile, "\"",1);
+
+	}
+
+	WriteString(m_aFile, ">",1);
+	m_pAttrList->Clear();
+}
+
+void		XFFileStream::EndElement(const rtl::OUString& oustr)
+{
+	rtl::OString	ostr;
+	
+	ostr = rtl::OUStringToOString(oustr,RTL_TEXTENCODING_UTF8);
+	WriteEndTag(m_aFile, ostr.getStr(), ostr.getLength());
+}
+
+void		XFFileStream::Characters(const rtl::OUString& oustr)
+{
+	WriteOUString(m_aFile, oustr);
+}
+
+IXFAttrList*	XFFileStream::GetAttrList()
+{
+	return m_pAttrList;
+}
+
+//------------------------------------------------------------------------------
+
+void	WriteStartTag(std::ofstream& ofs, const char *pStr, int len)
+{
+	ofs.write("\n<",2);
+	ofs.write(pStr,len);
+}
+
+void	WriteEndTag(std::ofstream& ofs, const char *pStr, int len)
+{
+	ofs.write("</",2);
+	ofs.write(pStr,len);
+	ofs.write(">\n",2);
+}
+
+void	WriteString(std::ofstream& ofs, const char *pStr, int len)
+{
+	ofs.write(pStr,len);
+}
+
+/**
+ * @descr:	Replace some reserved characters of xml character into xml entity.Please refer to w3c xml spec.
+ */
+void	WriteXmlString(std::ofstream& ofs, const char *pStr, int len)
+{
+	std::string	 str;
+
+	for( int i=0; i<len; i++ )
+	{
+		switch(pStr[i])
+		{
+		case '&':
+			str += "&amp;";
+			break;
+		case '<':
+			str += "&lt;";
+			break;
+		case '>':
+			str += "&gt;";
+			break;
+		case '\'':
+			str += "&apos;";
+			break;
+		case '\"':
+			str += "&quot;";
+			break;
+		case 13:
+			str += "&#x0d;";
+			break;
+		case 10:
+			str += "&#x0a;";
+			break;
+		case 9:
+			str += "&#x09;";
+			break;
+		default:
+			str += pStr[i];
+		}
+	}
+	ofs.write(str.c_str(),str.length());
+}
+
+void	WriteOUString(std::ofstream& ofs, const rtl::OUString& oustr)
+{
+	rtl::OString	ostr;
+	
+	ostr = rtl::OUStringToOString(oustr,RTL_TEXTENCODING_UTF8);
+	
+	WriteXmlString(ofs, ostr.getStr(),ostr.getLength());
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffilestream.hxx lotuswordpro/source/filter/xfilter/xffilestream.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffilestream.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffilestream.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,92 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Wrapper for sax stream to write to local file.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFFILESTREAM_HXX
+#define		_XFFILESTREAM_HXX
+
+#include	"ixfstream.hxx"
+#include	<fstream>
+#include	<rtl/ustring.hxx>
+
+class XFFileAttrList;
+
+class XFFileStream : public IXFStream
+{
+public:
+	XFFileStream(std::string strFileName);
+	virtual ~XFFileStream();
+	
+	//interface IXFSaxStream
+	virtual void			StartDocument();
+	virtual void			EndDocument();
+	virtual void			StartElement(const rtl::OUString& oustr);
+	virtual void			EndElement(const rtl::OUString& oustr);
+	virtual void			Characters(const rtl::OUString& oustr);
+	virtual IXFAttrList*	GetAttrList();
+	
+private:
+	std::ofstream				m_aFile;
+	XFFileAttrList				*m_pAttrList;
+};
+
+#endif //XFFILESTREAM_INC
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffloatframe.cxx lotuswordpro/source/filter/xfilter/xffloatframe.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffloatframe.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffloatframe.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,91 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Float frame whose anchor is page.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xffloatframe.hxx"
+
+XFFloatFrame::XFFloatFrame(sal_Int32 page)
+{
+	m_nStart = page;
+	m_nEnd = page;
+}
+
+XFFloatFrame::XFFloatFrame(sal_Int32 start, sal_Int32 end, sal_Bool all)
+{
+	m_nStart = start;
+	m_nEnd = end;
+	m_bAll = all;
+	SetAnchorType(enumXFAnchorPage);
+}
+
+void	XFFloatFrame::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	for( int i=m_nStart; i<=m_nEnd; i++ )
+	{
+		XFFrame::SetAnchorPage(i);
+		XFFrame::ToXml(pStrm);
+		if( !m_bAll )
+			i++;
+	}
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffloatframe.hxx lotuswordpro/source/filter/xfilter/xffloatframe.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffloatframe.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffloatframe.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,94 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Float frame whose anchor is page.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#ifndef		_XFFLOATFRAME_HXX
+#define		_XFFLOATFRAME_HXX
+
+#include	"xfframe.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * Floating frame on any page.
+ * You can specify it to be on all pages, on odd pages, or on even pages.
+ */
+class XFFloatFrame : public XFFrame
+{
+public:
+	XFFloatFrame(sal_Int32 page);
+
+	/**
+	 * @descr	output range: [start,end], not [start,end).
+	 */
+	XFFloatFrame(sal_Int32 start, sal_Int32 end, sal_Bool all=sal_False);
+	
+public:
+	void	ToXml(IXFStream *pStrm);
+	
+private:	
+	sal_Int32	m_nStart;
+	sal_Int32	m_nEnd;
+	sal_Bool	m_bAll;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffont.cxx lotuswordpro/source/filter/xfilter/xffont.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffont.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffont.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,415 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Font object to serial to xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ * 2005-01-14 add scale,position,emphasize support.
+ * 2005-01-24 move some tool function to xfutil.hxx
+ ************************************************************************/
+#include	"xffont.hxx"
+
+XFFont::XFFont()
+{	
+	m_nFontSize = 0;
+	m_nFontSizeAsia = 0;
+	m_nFontSizeComplex = 0;
+	m_bItalic = sal_False;
+	m_bItalicAsia = sal_False;
+	m_bItalicComplex = sal_False;
+	m_bBold = sal_False;
+	m_bBoldAsia = sal_False;
+	m_bBoldComplex = sal_False;
+	m_eUnderline = enumXFUnderlineNone;
+	m_eCrossout = enumXFCrossoutNone;
+	m_eRelief = enumXFReliefNone;
+	m_eTransform = enumXFTransformNone;
+	m_eEmphasize = enumXFEmphasizeNone;
+	m_bEmphasizeTop = sal_True;
+	m_bOutline = sal_False;
+	m_bShadow = sal_False;
+	m_bBlink = sal_False;
+	m_nPosition = 33;		
+	m_nScale = 58;				
+	m_fCharSpace = 0;
+	m_nWidthScale = 100;
+	m_bWordByWord = sal_False;
+	m_nFlag = 0;
+}
+/*
+	The Following variable are to  be compared:
+		rtl::OUString	m_strFontName;
+		rtl::OUString	m_strFontNameAsia;
+		rtl::OUString	m_strFontNameComplex;
+		sal_Int16		m_nFontSize;
+		sal_Int16		m_nFontSizeAsia;
+		sal_Int16		m_nFontSizeComplex;
+		sal_Bool		m_bItalic;
+		sal_Bool		m_bItalicAsia;
+		sal_Bool		m_bItalicComplex;
+		sal_Bool		m_bBold;
+		sal_Bool		m_bBoldAsia;
+		sal_Bool		m_bBoldComplex;
+		sal_Int16		m_nUnderline;
+		sal_uInt32		m_nUnderlineColor;
+
+		sal_uInt32		m_nFlag;
+*/
+bool operator==(XFFont& f1, XFFont& f2)
+{
+	//The most possible entry be first:
+	if( f1.m_nFlag != f2.m_nFlag )
+		return false;
+
+	if( f1.m_strFontName != f2.m_strFontName ||
+		f1.m_strFontNameAsia != f2.m_strFontNameAsia ||
+		f1.m_strFontNameComplex != f2.m_strFontNameComplex
+		)
+		return false;
+
+	if( f1.m_nFontSize != f2.m_nFontSize ||
+		f1.m_nFontSizeAsia != f2.m_nFontSizeAsia ||
+		f1.m_nFontSizeComplex != f2.m_nFontSizeComplex
+		)
+		return false;
+
+	if( f1.m_bItalic != f2.m_bItalic ||
+		f1.m_bItalicAsia != f2.m_bItalicAsia ||
+		f1.m_bItalicComplex != f2.m_bItalicComplex
+		)
+		return false;
+
+	if( f1.m_bBold != f2.m_bBold ||
+		f1.m_bBoldAsia != f2.m_bBoldAsia ||
+		f1.m_bBoldComplex != f2.m_bBoldComplex
+		)
+		return false;
+	
+	if( f1.m_nFlag&XFFONT_FLAG_UNDERLINE )
+	{
+		if( f1.m_eUnderline != f2.m_eUnderline )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_UNDERLINECOLOR )
+	{
+		if( f1.m_aUnderlineColor != f2.m_aUnderlineColor )
+			return false;
+	}	
+
+	if( f1.m_nFlag&XFFONT_FLAG_CROSSOUT )
+	{
+		if( f1.m_eCrossout != f2.m_eCrossout )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_RELIEF )
+	{
+		if( f1.m_eRelief != f2.m_eRelief )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_TRANSFORM )
+	{
+		if( f1.m_eTransform != f2.m_eTransform )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_EMPHASIZE )
+	{
+		if( f1.m_eEmphasize != f2.m_eEmphasize )
+			return false;
+		if( f1.m_bEmphasizeTop != f2.m_bEmphasizeTop )
+			return false;
+	}
+
+	if( f1.m_bWordByWord != f2.m_bWordByWord )
+		return false;
+		
+	if( f1.m_nFlag&XFFONT_FLAG_OUTLINE )
+	{
+		if( f1.m_bOutline != f2.m_bOutline )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_SHADOW )
+	{
+		if( f1.m_bShadow != f2.m_bShadow )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_BLINK )
+	{
+		if( f1.m_bBlink != f2.m_bBlink )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_POSITION )
+	{
+		if( f1.m_nPosition != f2.m_nPosition )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_SCALE )
+	{
+		if( f1.m_nScale != f2.m_nScale )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_CHARSPACE )
+	{
+		if( f1.m_fCharSpace != f2.m_fCharSpace )
+			return false;	
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_WIDTHSCALE )
+	{
+		if( f1.m_nWidthScale != f2.m_nWidthScale )
+			return false;	
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_COLOR )
+	{
+		if( f1.m_aColor != f2.m_aColor )
+			return false;
+	}
+
+	if( f1.m_nFlag&XFFONT_FLAG_BGCOLOR )
+	{
+		if( f1.m_aBackColor != f2.m_aBackColor )
+			return false;
+	}
+
+	return true;
+}
+
+bool operator!=(XFFont& f1, XFFont& f2)
+{
+	return !(f1==f2);
+}
+
+
+void XFFont::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+
+	if( m_nFlag & XFFONT_FLAG_NAME )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-name"),m_strFontName );
+	}
+	
+	if( m_nFlag & XFFONT_FLAG_NAME_ASIA )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-name-asian"),m_strFontNameAsia );
+	}
+	
+	if( m_nFlag & XFFONT_FLAG_NAME_COMPLEX )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-name-complex"), m_strFontNameComplex);
+	}
+	
+	//font size:
+	if( (m_nFlag & XFFONT_FLAG_SIZE) && m_nFontSize != 0 )
+	{		
+		rtl::OUString strSize = Int32ToOUString(m_nFontSize);
+		strSize += A2OUSTR("pt");
+		pAttrList->AddAttribute(A2OUSTR("fo:font-size"),strSize);
+	}
+	if( (m_nFlag & XFFONT_FLAG_SIZE_ASIA) && m_nFontSizeAsia )
+	{
+		rtl::OUString strSize = Int32ToOUString(m_nFontSizeAsia);
+		strSize += A2OUSTR("pt");
+		pAttrList->AddAttribute(A2OUSTR("style:font-size-asian"),strSize);
+	}
+	if( (m_nFlag & XFFONT_FLAG_SIZE_COMPLEX) && m_nFontSizeComplex )
+	{
+		rtl::OUString strSize = Int32ToOUString(m_nFontSizeComplex);
+		strSize += A2OUSTR("pt");
+		pAttrList->AddAttribute(A2OUSTR("style:font-size-complex"),strSize);
+	}
+	
+	//italic flag:
+	if( ( m_nFlag & XFFONT_FLAG_ITALIC) && m_bItalic )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:font-style"), A2OUSTR("italic"));
+	}
+	if( (m_nFlag & XFFONT_FLAG_ITALIC_ASIA) && m_bItalicAsia )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-style-asian"), A2OUSTR("italic"));
+	}
+	if( (m_nFlag & XFFONT_FLAG_ITALIC_COMPLEX) && m_bItalicComplex )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-style-complex"), A2OUSTR("italic"));
+	}
+	
+	//Bold flag:
+	if( (m_nFlag & XFFONT_FLAG_BOLD) && m_bBold )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:font-weight"), A2OUSTR("bold"));
+	}
+	if( (m_nFlag & XFFONT_FLAG_BOLD_ASIA) && m_bBoldAsia )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-weight-asian"), A2OUSTR("bold"));
+	}
+	if( (m_nFlag & XFFONT_FLAG_BOLD_ASIA) && m_bBoldComplex )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-weight-complex"), A2OUSTR("bold"));
+	}
+	//underline:
+	if( (m_nFlag & XFFONT_FLAG_UNDERLINE) && m_eUnderline )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:text-underline"), GetUnderlineName(m_eUnderline) );
+		if( (m_nFlag & XFFONT_FLAG_UNDERLINECOLOR) )
+		{
+			pAttrList->AddAttribute( A2OUSTR("style:text-underline-color"), m_aUnderlineColor.ToString() );
+		}
+		else
+			pAttrList->AddAttribute( A2OUSTR("style:text-underline-color"), A2OUSTR("font-color") );
+	}	
+
+	//enumCrossoutType	m_eCrossout;
+	if( (m_nFlag & XFFONT_FLAG_CROSSOUT) && m_eCrossout )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:text-crossing-out"), GetCrossoutName(m_eCrossout) );
+	}
+
+	if( m_nFlag & XFFONT_FLAG_UNDERLINE || m_nFlag & XFFONT_FLAG_CROSSOUT )
+	{
+		if( m_bWordByWord )
+			pAttrList->AddAttribute(A2OUSTR("fo:score-spaces"), A2OUSTR("false") );
+		else
+			pAttrList->AddAttribute(A2OUSTR("fo:score-spaces"), A2OUSTR("true") );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_RELIEF) && m_eRelief )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:font-relief"), GetReliefName(m_eRelief) );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_TRANSFORM) && m_eTransform )
+	{
+		//enumTransformSmallCap is different:
+		if( m_eTransform == enumXFTransformSmallCaps )
+			pAttrList->AddAttribute(A2OUSTR("fo:font-variant"), GetTransformName(m_eTransform) );
+		else
+			pAttrList->AddAttribute(A2OUSTR("fo:text-transform"), GetTransformName(m_eTransform) );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_EMPHASIZE) && m_eEmphasize )
+	{
+		rtl::OUString empha = GetEmphasizeName(m_eEmphasize);
+		empha += A2OUSTR(" ");
+		if( m_bEmphasizeTop )
+			empha += A2OUSTR("above");
+		pAttrList->AddAttribute(A2OUSTR("style:text-emphasize"), empha );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_OUTLINE) && m_bOutline )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:text-outline"), A2OUSTR("true") );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_SHADOW) && m_bShadow )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:text-shadow"), A2OUSTR("1pt 1pt") );
+	}
+
+	if( (m_nFlag & XFFONT_FLAG_BLINK) && m_bBlink )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:text-blinking"), A2OUSTR("true") );
+	}
+
+	
+	//position & sacle:
+	if( ((m_nFlag & XFFONT_FLAG_SCALE) && m_nScale>0 ) ||
+		((m_nFlag & XFFONT_FLAG_POSITION) && m_nPosition != 0)
+		)
+	{
+		rtl::OUString tmp;
+		tmp = Int32ToOUString(m_nPosition) + A2OUSTR("% ");
+		tmp += Int32ToOUString(m_nScale) + A2OUSTR("%");
+		pAttrList->AddAttribute(A2OUSTR("style:text-position"), tmp );
+	}
+	
+	//char space:
+	if( (m_nFlag & XFFONT_FLAG_CHARSPACE) && m_fCharSpace != 0 )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:letter-spacing"), DoubleToOUString(m_fCharSpace)+A2OUSTR("cm") );
+	}
+
+	if( (m_nFlag&XFFONT_FLAG_WIDTHSCALE) && m_nWidthScale != 100 )
+	{
+		pAttrList->AddAttribute(A2OUSTR("style:text-scale"), DoubleToOUString(m_nWidthScale)+A2OUSTR("%") );
+	}
+	
+	//Color:
+	if( (m_nFlag & XFFONT_FLAG_COLOR) )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:color"), m_aColor.ToString() );
+	}
+	
+	if( (m_nFlag & XFFONT_FLAG_BGCOLOR) )
+	{
+		if (m_bTransparent)
+			pAttrList->AddAttribute( A2OUSTR("style:text-background-color"), A2OUSTR("transparent"));
+		else
+			pAttrList->AddAttribute( A2OUSTR("style:text-background-color"), m_aBackColor.ToString() );
+	}
+}
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffontdecl.cxx lotuswordpro/source/filter/xfilter/xffontdecl.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffontdecl.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffontdecl.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,104 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Font decl of all used fonts.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xffontdecl.hxx"
+
+XFFontDecl::XFFontDecl()
+{
+}
+
+XFFontDecl::XFFontDecl(rtl::OUString name, rtl::OUString family, sal_Bool fixed)
+{
+	m_strFontName = name;
+	m_strFontFamily = family;
+	m_bPitchFixed = fixed;
+}
+
+rtl::OUString	XFFontDecl::GetFontName()
+{
+	return m_strFontName;
+}
+
+void	XFFontDecl::SetFontName(rtl::OUString name)
+{
+	m_strFontName = name;
+}
+
+rtl::OUString	XFFontDecl::GetFontFamily()
+{
+	return m_strFontFamily;
+}
+
+void	XFFontDecl::SetFontFamily(rtl::OUString family)
+{
+	m_strFontFamily = family;
+}
+
+sal_Bool	XFFontDecl::GetFontPitchFixed()
+{
+	return m_bPitchFixed;
+}
+
+void	XFFontDecl::SetFontPitchFixed(sal_Bool	fixed)
+{
+	m_bPitchFixed = fixed;
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffontdecl.hxx lotuswordpro/source/filter/xfilter/xffontdecl.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffontdecl.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffontdecl.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,112 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Font declaration for OOo xml file.This is needed for every font that was
+ * used.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-24 create this file.
+ ************************************************************************/
+#ifndef		_XFFONTDECL_HXX
+#define		_XFFONTDECL_HXX
+
+#include	"xfglobal.hxx"
+
+/**
+ * @brief
+ * Font declaration in OOo xml file.
+ * Each font used should be declared.
+ */
+class	XFFontDecl
+{
+public:
+	XFFontDecl();
+
+	XFFontDecl(rtl::OUString name, rtl::OUString family, sal_Bool fixed = false);
+
+public:
+	/**
+	 * @descr	Get font name. 
+	 */
+	rtl::OUString	GetFontName();
+
+	/**
+	 * @descr	Set font name. 
+	 */
+	void			SetFontName(rtl::OUString name);
+
+	/**
+	 * @descr	Get font family. 
+	 */
+	rtl::OUString	GetFontFamily();
+
+	/**
+	 * @descr	Set font famuly. 
+	 */
+	void			SetFontFamily(rtl::OUString family);
+
+	sal_Bool		GetFontPitchFixed();
+	
+	void			SetFontPitchFixed(sal_Bool	fixed);
+	
+private:
+	rtl::OUString	m_strFontName;
+	rtl::OUString	m_strFontFamily;
+	sal_Bool		m_bPitchFixed;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffontfactory.cxx lotuswordpro/source/filter/xfilter/xffontfactory.cxx
--- lotuswordpro.bak/source/filter/xfilter/xffontfactory.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffontfactory.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,102 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Implement for font factory which will manage all font.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xffontfactory.hxx"
+
+XFFontFactory::XFFontFactory()
+{	
+}
+
+XFFontFactory::~XFFontFactory()
+{
+	Reset();	
+}
+
+void	XFFontFactory::Reset()
+{
+	std::vector<XFFont*>::iterator it;	
+	for( it = s_aFonts.begin(); it != s_aFonts.end(); it++ )
+	{
+		XFFont *pFont = (*it);
+		if( !pFont )
+			continue;
+		delete pFont;
+	}
+	s_aFonts.clear();
+}
+
+void	XFFontFactory::AddFont(XFFont *pFont)
+{
+	s_aFonts.push_back( pFont );
+}
+
+XFFont*	XFFontFactory::FindSameFont(XFFont *pFont)
+{
+	std::vector<XFFont*>::iterator it;
+	for( it = s_aFonts.begin(); it != s_aFonts.end(); it++ )
+	{
+		if( *pFont == **it )
+			return *it;
+	}
+
+	return NULL;
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffontfactory.hxx lotuswordpro/source/filter/xfilter/xffontfactory.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffontfactory.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffontfactory.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,110 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Factory object for XFFont.It also manages all font life cycle.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFFONTFACTORY_HXX
+#define		_XFFONTFACTORY_HXX
+
+#include	"xfglobal.hxx"
+#include	"xffont.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * Font factory.
+ * Because font object are so used so offten, so make a factory to manager them.
+ * The fonts with same properties will only exist one instance.
+ */
+class XFFontFactory
+{
+public:
+	XFFontFactory();
+	~XFFontFactory();
+	XFFontFactory(const XFFontFactory& other){}
+
+	XFFontFactory operator=(XFFontFactory& other){}	
+
+public:	
+	/**
+	 * @descr	Clear all fonts, this is called when load a file. 
+	 */
+	void	Reset();	
+
+private:
+	/**
+	 * @descr	Add a font. if there exist a font with same properties with pFont, them the font obejct
+	 *			will not be added.
+	 */
+	void	AddFont(XFFont *pFont);
+
+	/**
+	 * @descr	Find whether same font obejct exists. 
+	 */
+	XFFont* FindSameFont(XFFont *pFont);
+	
+	friend class XFStyleContainer;
+	
+private:
+	std::vector<XFFont*>	s_aFonts;	
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffont.hxx lotuswordpro/source/filter/xfilter/xffont.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffont.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffont.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,509 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Font object to serial to xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFFONT_HXX
+#define		_XFFONT_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcolor.hxx"
+
+#define		XFFONT_FLAG_NAME			0X00000001
+#define		XFFONT_FLAG_NAME_ASIA		0X00000002
+#define		XFFONT_FLAG_NAME_COMPLEX	0X00000004
+
+#define		XFFONT_FLAG_SIZE			0X00000008
+#define		XFFONT_FLAG_SIZE_ASIA		0X00000010
+#define		XFFONT_FLAG_SIZE_COMPLEX	0X00000020
+
+#define		XFFONT_FLAG_ITALIC			0X00000040
+#define		XFFONT_FLAG_ITALIC_ASIA		0X00000080
+#define		XFFONT_FLAG_ITALIC_COMPLEX	0X00000100
+
+#define		XFFONT_FLAG_BOLD			0X00000200
+#define		XFFONT_FLAG_BOLD_ASIA		0X00000400
+#define		XFFONT_FLAG_BOLD_COMPLEX	0X00000800
+
+#define		XFFONT_FLAG_UNDERLINE		0X00001000
+#define		XFFONT_FLAG_UNDERLINECOLOR	0X00002000
+
+#define		XFFONT_FLAG_POSITION		0X00004000
+#define		XFFONT_FLAG_SCALE			0X00008000
+#define		XFFONT_FLAG_CHARSPACE		0x00010000
+
+#define		XFFONT_FLAG_COLOR			0x00020000			
+#define		XFFONT_FLAG_BGCOLOR			0x00040000
+
+#define		XFFONT_FLAG_CROSSOUT		0x00080000
+#define		XFFONT_FLAG_RELIEF			0x00100000
+#define		XFFONT_FLAG_TRANSFORM		0x00200000
+#define		XFFONT_FLAG_EMPHASIZE		0x00400000
+#define		XFFONT_FLAG_OUTLINE			0x00800000
+#define		XFFONT_FLAG_SHADOW			0x01000000
+#define		XFFONT_FLAG_BLINK			0x02000000
+#define		XFFONT_FLAG_WIDTHSCALE		0x04000000
+
+/**
+ * @descr 
+ * The font struct of openoffice xml filter.
+ * There should be some basic members,ie:
+
+ * font name
+ * font family
+ * font size
+ * font italic
+ * font bold
+ * font underline
+ * font underline color
+ */
+class XFFont
+{
+public:
+	XFFont();
+
+public:
+	/**
+	 * @descr	Set font name. 
+	 */
+	void	SetFontName(rtl::OUString name);
+
+	/**
+	 * @descr	Set font name for asia locale. 
+	 */
+	void	SetFontNameAsia(rtl::OUString name);
+
+	/**
+	 * @descr	Set font name for BIDI locale. 
+	 */
+	void	SetFontNameComplex(rtl::OUString name);
+
+	/**
+	 * @descr	Set font size. 
+	 */
+	void	SetFontSize(sal_Int16 size);
+
+	/**
+	 * @descr	Set font size for asia locale. 
+	 */
+	void	SetFontSizeAsia(sal_Int16 size);
+
+	/**
+	 * @descr	Set font size for BIDI locale. 
+	 */
+	void	SetFontSizeComplex(sal_Int16 size);	
+
+	/**
+	 * @descr	Set whether font is italic. 
+	 */
+	void	SetItalic(sal_Bool italic = true);
+
+	/**
+	 * @descr	Set whether font is italic for asia locale. 
+	 */
+	void	SetItalicAsia(sal_Bool italic);
+
+	/**
+	 * @descr	Set whether font is italic for BIDI locale. 
+	 */
+	void	SetItalicComplex(sal_Bool italic);
+
+	/**
+	 * @descr	Set font bold. 
+	 */
+	void	SetBold(sal_Bool bold = true);
+
+	/**
+	 * @descr	Set font bold for asia locale. 
+	 */
+	void	SetBoldAsia(sal_Bool bold);
+
+	/**
+	 * @descr	Set font bold for complex locale. 
+	 */
+	void	SetBoldComplex(sal_Bool bold);
+
+	/**
+	 * @descr	Set underline style. 
+	 */
+	void	SetUnderline(enumXFUnderline underline,sal_Bool wordByWord=sal_False);	
+
+	/**
+	 * @descr	Set underline color. 
+	 */
+	void	SetUnderlineColor(XFColor color=XFColor(128,128,0));
+
+	/**
+	 * @descr	Set crossout. 
+	 */
+	void	SetCrossout(enumXFCrossout cross,sal_Bool wordByWord=sal_False);
+
+	/**
+	 * @descr	Set font relief. 
+	 */
+	void	SetRelief(enumXFRelief relief);
+
+	/**
+	 * @descr	Set font transform type,pls refer to enumXFTransform. 
+	 */
+	void	SetTransform(enumXFTransform transform);
+
+	/**
+	 * @descr	Set font emphasize effect. 
+	 */
+	void	SetEmphasize(enumXFEmphasize emphasize, sal_Bool top = sal_True);
+
+	/**
+	 * @descr	Set outline effect. 
+	 */
+	void	SetOutline(sal_Bool outline);
+
+	/**
+	 * @descr	Set font shadow. 
+	 */
+	void	SetShadow(sal_Bool shadow);
+
+	/**
+	 * @descr	Set font blink effect. 
+	 */
+	void	SetBlink(sal_Bool blink);
+
+	/**
+	 * @descr	Set upper script or lower script. 
+	 */
+	void	SetPosition(sal_Bool bUpperScript = sal_True, sal_Int16 pos = 33, sal_Int16 scale = 58);	
+
+	/**
+	 * @descr	Set space between chars in percent. 
+	 */
+	void	SetCharSpace(sal_Int16 space);
+
+	/**
+	 * @descr	Set char width scale in percent. 
+	 */
+	void	SetWidthScale(sal_Int16 widthScale);
+
+	/**
+	 * @descr	Set font color. 
+	 */
+	void	SetColor(XFColor& color);
+
+	/**
+	 * @descr	Set font background color. 
+	 */
+	void	SetBackColor(XFColor& color);
+	void	SetBackColorTransparent();
+
+	//getter:
+	enumXFTransform GetTransform();
+
+	sal_Int16 GetFontSize();
+	XFColor GetColor();
+
+	sal_uInt32	GetFlag(){ return m_nFlag; }
+
+	void	ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFFont& f1, XFFont& f2);
+	friend bool operator!=(XFFont& f1, XFFont& f2);
+	friend class	XFFontFactory;	
+private:
+	rtl::OUString	m_strFontName;
+	rtl::OUString	m_strFontNameAsia;
+	rtl::OUString	m_strFontNameComplex;
+	sal_Int16	m_nFontSize;
+	sal_Int16	m_nFontSizeAsia;
+	sal_Int16	m_nFontSizeComplex;
+	sal_Bool	m_bItalic;
+	sal_Bool	m_bItalicAsia;
+	sal_Bool	m_bItalicComplex;
+	sal_Bool	m_bBold;
+	sal_Bool	m_bBoldAsia;
+	sal_Bool	m_bBoldComplex;	
+	XFColor		m_aUnderlineColor;
+
+	enumXFUnderline	m_eUnderline;
+	enumXFCrossout	m_eCrossout;
+	enumXFRelief	m_eRelief;
+	enumXFTransform	m_eTransform;
+	enumXFEmphasize	m_eEmphasize;
+	sal_Bool	m_bWordByWord;
+	sal_Bool	m_bEmphasizeTop;
+	sal_Bool	m_bOutline;
+	sal_Bool	m_bShadow;
+	sal_Bool	m_bBlink;	
+	sal_Int16	m_nPosition;		
+	sal_Int16	m_nScale;				
+	double		m_fCharSpace;
+	sal_Int16	m_nWidthScale;
+	XFColor		m_aColor;
+	XFColor		m_aBackColor;	
+	//The flag defines which variable will be funtional.
+	sal_uInt32	m_nFlag;
+	sal_Bool	m_bTransparent;
+};
+
+
+inline void	XFFont::SetFontName(rtl::OUString name)
+{	
+	m_strFontName = name;
+	m_nFlag |= XFFONT_FLAG_NAME;
+
+	SetFontNameAsia(name);
+	SetFontNameComplex(name);
+}
+
+inline void	XFFont::SetFontNameAsia(rtl::OUString name)
+{	
+	m_strFontNameAsia = name;
+	m_nFlag |= XFFONT_FLAG_NAME_ASIA;
+}
+
+inline void	XFFont::SetFontNameComplex(rtl::OUString name)
+{	
+	m_strFontNameComplex = name;
+	m_nFlag |= XFFONT_FLAG_NAME_COMPLEX;
+}
+
+//
+inline void	XFFont::SetFontSize(sal_Int16 size)
+{
+	m_nFontSize = size;
+	m_nFlag |= XFFONT_FLAG_SIZE;
+
+	SetFontSizeAsia(size);
+	SetFontSizeComplex(size);
+}
+
+inline void	XFFont::SetFontSizeAsia(sal_Int16 size)
+{
+	m_nFontSizeAsia = size;
+	m_nFlag |= XFFONT_FLAG_SIZE_ASIA;
+}
+
+inline void	XFFont::SetFontSizeComplex(sal_Int16 size)
+{
+	m_nFontSizeComplex = size;
+	m_nFlag |= XFFONT_FLAG_SIZE_COMPLEX;
+}
+
+//---------Italic:
+inline void	XFFont::SetItalic(sal_Bool italic)
+{
+	m_bItalic = italic;
+	m_nFlag |= XFFONT_FLAG_ITALIC;
+
+	SetItalicAsia(italic);
+	SetItalicComplex(italic);
+}
+
+inline void	XFFont::SetItalicAsia(sal_Bool italic)
+{
+	m_bItalicAsia = italic;
+	m_nFlag |= XFFONT_FLAG_ITALIC_ASIA;
+}
+
+inline void	XFFont::SetItalicComplex(sal_Bool italic)
+{
+	m_bItalicComplex = italic;
+	m_nFlag |= XFFONT_FLAG_ITALIC_COMPLEX;
+}
+
+//--------Bold
+inline void	XFFont::SetBold(sal_Bool bold)
+{
+	m_bBold = bold;
+	m_nFlag |= XFFONT_FLAG_BOLD;
+	SetBoldAsia(bold);
+	SetBoldComplex(bold);
+}
+
+inline void	XFFont::SetBoldAsia(sal_Bool bold)
+{
+	m_bBoldAsia = bold;
+	m_nFlag |= XFFONT_FLAG_BOLD_ASIA;
+}
+
+inline void	XFFont::SetBoldComplex(sal_Bool bold)
+{
+	m_bBoldComplex = bold;
+	m_nFlag |= XFFONT_FLAG_BOLD_COMPLEX;
+}
+
+//--------Underline:
+inline void	XFFont::SetUnderline(enumXFUnderline underline, sal_Bool wordByWord)
+{
+	m_eUnderline = underline;
+	m_bWordByWord = wordByWord;
+	m_nFlag |= XFFONT_FLAG_UNDERLINE;	
+}
+
+inline void	XFFont::SetUnderlineColor(XFColor color)
+{
+	m_aUnderlineColor = color;
+	m_nFlag |= XFFONT_FLAG_UNDERLINECOLOR;
+}
+
+inline void	XFFont::SetCrossout(enumXFCrossout cross, sal_Bool wordByWord)
+{ 
+	m_eCrossout = cross; 
+	m_bWordByWord = wordByWord;
+	m_nFlag |= XFFONT_FLAG_CROSSOUT;
+}
+inline void	XFFont::SetRelief(enumXFRelief relief)
+{ 
+	m_eRelief = relief; 
+	m_nFlag |= XFFONT_FLAG_RELIEF;
+}
+inline void	XFFont::SetTransform(enumXFTransform transform)
+{ 
+	m_eTransform = transform; 
+	m_nFlag |= XFFONT_FLAG_TRANSFORM;
+}
+
+inline void	XFFont::SetEmphasize(enumXFEmphasize emphasize, sal_Bool top)
+{ 
+	m_eEmphasize = emphasize; 
+	m_bEmphasizeTop = top;
+	m_nFlag |= XFFONT_FLAG_EMPHASIZE;
+}
+inline void	XFFont::SetOutline(sal_Bool outline)
+{ 
+	m_bOutline = outline; 
+	m_nFlag |= XFFONT_FLAG_OUTLINE;
+}
+inline void	XFFont::SetShadow(sal_Bool shadow)
+{
+	m_bShadow = shadow; 
+	m_nFlag |= XFFONT_FLAG_SHADOW;
+}
+inline void	XFFont::SetBlink(sal_Bool blink)
+{ 
+	m_bBlink = blink; 
+	m_nFlag |= XFFONT_FLAG_BLINK;
+}
+
+inline void	XFFont::SetPosition(sal_Bool bUpperScript, sal_Int16 pos, sal_Int16 scale)
+{
+	assert(pos>=0&&pos<=100);
+	assert(scale>0&&scale<=100);
+	m_nFlag |= XFFONT_FLAG_POSITION;
+	m_nPosition = pos;
+	m_nScale = scale;
+	if( bUpperScript )
+	{
+		if( m_nPosition <0 )
+			m_nPosition = -m_nPosition;
+	}
+	else
+	{
+		if( m_nPosition >0 )
+			m_nPosition = -m_nPosition;
+	}
+}
+
+inline void	XFFont::SetCharSpace(sal_Int16 space)
+{
+	m_nFlag |= XFFONT_FLAG_CHARSPACE;
+	m_fCharSpace = space;
+}
+
+inline void	XFFont::SetWidthScale(sal_Int16 widthScale)
+{
+	m_nFlag |= XFFONT_FLAG_WIDTHSCALE;
+	m_nWidthScale = widthScale;
+}
+
+inline void	XFFont::SetColor(XFColor& color)
+{
+	m_nFlag |= XFFONT_FLAG_COLOR;
+	m_aColor = color;
+}
+
+inline void	XFFont::SetBackColor(XFColor& color)
+{
+	m_bTransparent = sal_False;
+	m_nFlag |= XFFONT_FLAG_BGCOLOR;
+	m_aBackColor = color;
+}
+
+inline void	XFFont::SetBackColorTransparent()
+{
+	m_bTransparent = sal_True;
+	m_nFlag |= XFFONT_FLAG_BGCOLOR;
+}
+
+inline enumXFTransform XFFont::GetTransform()
+{
+	return m_eTransform;
+}
+
+inline sal_Int16 XFFont::GetFontSize()
+{
+	return m_nFontSize;
+}
+
+inline XFColor XFFont::GetColor()
+{
+	return m_aColor;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffontworkstyle.hxx lotuswordpro/source/filter/xfilter/xffontworkstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffontworkstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffontworkstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,156 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style of Fontwork object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-06-20  create this file.
+ ************************************************************************/
+ #ifndef _XFFONTWORKSTYLE_HXX
+ #define _XFFONTWORKSTYLE_HXX
+
+#include	"xfstyle.hxx"
+
+class XFFontWorkStyle
+{
+public:
+	XFFontWorkStyle() :
+		m_nButtonForm(-1),
+		m_bHideForm(sal_True),
+		m_fDistance(-0.10),
+		m_eStyleType(enumXFFWOff),
+		m_eAdjustType(enumXFFWAdjustAutosize),
+		m_eShadowType(enumXFFWShadowNone)
+		{};
+	
+	~XFFontWorkStyle(){}
+
+	inline void SetButtonForm(sal_Int8 nIndex);
+	inline void SetHideForm(sal_Bool bHide);
+	inline void SetFWDistance(double fDist);
+	inline void SetFWStyleType(enumXFFWStyle eStyle);
+	inline void SetFWAdjustType(enumXFFWAdjust eAdjust);
+	inline void SetFWShadowType(enumXFFWShadow eShadow);
+
+	inline sal_Int8 GetButtonForm() const;
+	inline double GetFWDistance() const;
+	inline enumXFFWStyle GetStyleType() const;
+	inline enumXFFWAdjust GetAdjustType() const;
+	inline enumXFFWShadow GetShadowType() const;
+
+private:
+	sal_Int8 m_nButtonForm;
+	sal_Bool m_bHideForm;
+	double m_fDistance;
+	enumXFFWStyle m_eStyleType;
+	enumXFFWAdjust m_eAdjustType;
+	enumXFFWShadow m_eShadowType;
+};
+
+inline void XFFontWorkStyle::SetButtonForm(sal_Int8 nIndex)
+{
+	m_nButtonForm = nIndex;
+}
+
+inline void XFFontWorkStyle::SetHideForm(sal_Bool bHide)
+{
+	m_bHideForm = bHide;
+}
+
+inline void XFFontWorkStyle::SetFWDistance(double fDist)
+{
+	m_fDistance = fDist;
+}
+
+inline void XFFontWorkStyle::SetFWStyleType(enumXFFWStyle eStyle)
+{
+	m_eStyleType = eStyle;
+}
+
+inline void XFFontWorkStyle::SetFWAdjustType(enumXFFWAdjust eAdjust)
+{
+	m_eAdjustType = eAdjust;
+}
+
+inline void XFFontWorkStyle::SetFWShadowType(enumXFFWShadow eShadow)
+{
+	m_eShadowType = eShadow;
+}
+
+inline sal_Int8 XFFontWorkStyle::GetButtonForm() const
+{
+	return m_nButtonForm;
+}
+inline double XFFontWorkStyle::GetFWDistance() const
+{
+	return m_fDistance;
+}
+
+inline enumXFFWStyle XFFontWorkStyle::GetStyleType() const
+{
+	return m_eStyleType;
+}
+inline enumXFFWAdjust XFFontWorkStyle::GetAdjustType() const
+{
+	return m_eAdjustType;
+}
+inline enumXFFWShadow XFFontWorkStyle::GetShadowType() const
+{
+	return m_eShadowType;
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffooter.hxx lotuswordpro/source/filter/xfilter/xffooter.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffooter.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffooter.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,90 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Footer object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ * 2005-04-05 make it derive from XFContentContainer.
+ ************************************************************************/
+#ifndef		_XFFOOTER_HXX
+#define		_XFFOOTER_HXX
+
+#include	"xfcontentcontainer.hxx"
+#include	<vector>
+
+/**
+ * @descr	Foot obejct. It's just a container. 
+ */
+class XFFooter : public XFContentContainer
+{
+public:
+	XFFooter()
+	{
+	}
+	virtual void ToXml(IXFStream *pStrm)
+	{
+		IXFAttrList	*pAttrList = pStrm->GetAttrList();
+		pAttrList->Clear();		
+		pStrm->StartElement( A2OUSTR("style:footer") );		
+		XFContentContainer::ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("style:footer") );		
+	}
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffooterstyle.hxx lotuswordpro/source/filter/xfilter/xffooterstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffooterstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffooterstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,126 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Footer style,exist in page-master object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ * 2005-04-05 change to inherit from xfheaderstyle.
+ ************************************************************************/
+#ifndef		_XFFOOTERSTYLE_HXX
+#define		_XFFOOTERSTYLE_HXX
+
+#include	"xfheaderstyle.hxx"
+#include	"xfmargins.hxx"
+
+class XFFooterStyle : public XFHeaderStyle
+{
+public:
+	XFFooterStyle() : XFHeaderStyle(sal_True)
+	{
+	}
+
+	void	SetMargins(double left = -1, double right = -1, double top = -1)
+	{
+		if( left != -1 )
+			m_aMargin.SetLeft(left);
+		if( right != -1 )
+			m_aMargin.SetRight(right);
+		if( top != -1 )
+			m_aMargin.SetTop(top);
+	}
+/*
+	void SetHeight(float height)
+	{
+		m_fHeight = height;
+	}
+	
+	void	SetDynamicSpace(sal_Bool dynamic)
+	{
+		m_bDynamicSpace = dynamic;
+	}
+	virtual void	ToXml(IXFStream *pStrm)
+	{
+		IXFAttrList	*pAttrList = pStrm->GetAttrList();
+		pAttrList->Clear();
+
+		pStrm->StartElement( A2OUSTR("style:footer-style") );
+
+		if(m_fHeight!=-1)
+		{
+			pAttrList->AddAttribute( A2OUSTR("svg:height"), FloatToOUString(m_fHeight) + A2OUSTR("cm") );
+		}
+		
+		m_aMargin.ToXml(pStrm);
+		if( m_bDynamicSpace )
+			pAttrList->AddAttribute( A2OUSTR("style:dynamic-spacing"), A2OUSTR("true") );
+		else
+			pAttrList->AddAttribute( A2OUSTR("style:dynamic-spacing"), A2OUSTR("false") );	
+		pStrm->StartElement( A2OUSTR("style:properties") );
+		pStrm->EndElement( A2OUSTR("style:properties") );
+
+		pStrm->EndElement( A2OUSTR("style:footer-style") );
+	}
+	
+private:
+	XFMargins	m_aMargin;
+	sal_Bool	m_bDynamicSpace;
+	float m_fHeight;
+	*/
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffootnoteconfig.hxx lotuswordpro/source/filter/xfilter/xffootnoteconfig.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffootnoteconfig.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffootnoteconfig.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,269 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Footnote config.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-29 create this file.
+ ************************************************************************/
+#ifndef		_XFFOOTNOTECONFIG_HXX
+#define		_XFFOOTNOTECONFIG_HXX
+
+#include	"xfstyle.hxx"
+
+class XFFootnoteConfig : public XFStyle
+{
+public:
+	XFFootnoteConfig();
+
+public:
+	void	SetBodyStyle(rtl::OUString style);
+
+	void	SetCitationStyle(rtl::OUString style);
+
+	void	SetDefaultStyle(rtl::OUString style);
+
+	void	SetMasterPage(rtl::OUString masterPage);
+
+	void	SetNumberFormat(rtl::OUString numberFormat);
+
+	void	SetStartValue(sal_Int32 value=0);
+
+	void	SetRestartOnPage();
+
+	void	SetRestartOnChapter();
+
+	void	SetInsertInPage(sal_Bool page=sal_True);
+
+	void	SetNumPrefix(rtl::OUString numprefix);
+
+	void	SetNumSuffix(rtl::OUString numsuffix);
+
+	void	SetMessageOn(rtl::OUString message);
+
+	void	SetMessageFrom(rtl::OUString message);
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+protected:
+	rtl::OUString	m_strBodyStyle;
+	rtl::OUString	m_strCitationStyle;
+	rtl::OUString	m_strDefaultStyle;
+	rtl::OUString	m_strMasterPage;
+	rtl::OUString	m_strNumFmt;
+	rtl::OUString	m_strNumPrefix;
+	rtl::OUString	m_strNumSuffix;
+	rtl::OUString   m_strMessageFrom;
+	rtl::OUString   m_strMessageOn;
+	sal_Int32	m_nStartValue;
+	sal_Int32	m_nRestartType;
+	sal_Bool	m_bInsertInPage;
+	sal_Bool	m_bIsFootnote;
+};
+
+inline XFFootnoteConfig::XFFootnoteConfig()
+{
+	m_nStartValue = 0;
+	m_nRestartType = -1;
+	m_strNumFmt = A2OUSTR("1");
+	m_bInsertInPage = sal_True;
+	m_strDefaultStyle = A2OUSTR("Footnote");
+	m_strMasterPage = A2OUSTR("Footnote");
+	m_strCitationStyle = A2OUSTR("Footnote Symbol");
+	m_strBodyStyle = A2OUSTR("Footnote anchor");
+	m_bIsFootnote = sal_True;
+}
+
+inline void	XFFootnoteConfig::SetBodyStyle(rtl::OUString style)
+{
+	m_strBodyStyle = style;
+}
+
+inline void	XFFootnoteConfig::SetCitationStyle(rtl::OUString style)
+{
+	m_strCitationStyle = style;
+}
+
+inline void	XFFootnoteConfig::SetDefaultStyle(rtl::OUString style)
+{
+	m_strDefaultStyle = style;
+}
+
+inline void	XFFootnoteConfig::SetMasterPage(rtl::OUString masterPage)
+{
+	m_strMasterPage = masterPage;
+}
+
+inline void	XFFootnoteConfig::SetNumberFormat(rtl::OUString numberFormat)
+{
+	m_strNumFmt = numberFormat;
+}
+
+inline void	XFFootnoteConfig::SetStartValue(sal_Int32 value)
+{
+	if( value<0 )
+		return;
+	m_nStartValue = value;
+}
+
+inline void	XFFootnoteConfig::SetRestartOnPage()
+{
+	m_nRestartType = 0;
+}
+
+inline void	XFFootnoteConfig::SetRestartOnChapter()
+{
+	m_nRestartType = 1;
+} 
+
+inline void XFFootnoteConfig::SetInsertInPage(sal_Bool page)
+{
+	m_bInsertInPage = page;
+}
+
+inline void	XFFootnoteConfig::SetNumPrefix(rtl::OUString numprefix)
+{
+	m_strNumPrefix = numprefix;
+}
+
+inline void	XFFootnoteConfig::SetNumSuffix(rtl::OUString numsuffix)
+{
+	m_strNumSuffix = numsuffix;
+}
+
+inline void	XFFootnoteConfig::SetMessageOn(rtl::OUString message)
+{
+	m_strMessageOn = message;
+}
+
+inline void	XFFootnoteConfig::SetMessageFrom(rtl::OUString message)
+{
+	m_strMessageFrom = message;
+}
+
+inline void XFFootnoteConfig::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( m_strCitationStyle.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("text:citation-style-name"), m_strCitationStyle);
+
+	if( m_strBodyStyle.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("text:citation-body-style-name"), m_strBodyStyle);
+
+	if( m_strNumPrefix.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("style:num-prefix"), m_strNumPrefix);
+
+	if( m_strNumSuffix.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("style:num-suffix"), m_strNumSuffix);
+	
+	if( m_strNumFmt.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("style:num-format"), m_strNumFmt);
+
+	if( m_strDefaultStyle.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("text:default-style-name"), m_strDefaultStyle);
+	
+	if( m_strMasterPage.getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("text:master-page-name"), m_strMasterPage);
+	
+
+	pAttrList->AddAttribute( A2OUSTR("text:start-value"), Int32ToOUString(m_nStartValue) );
+	
+	if( m_bIsFootnote )
+	{
+		if( m_nRestartType == -1 )
+			pAttrList->AddAttribute( A2OUSTR("text:start-numbering-at"), A2OUSTR("document") );
+		else if( m_nRestartType == 0 )
+			pAttrList->AddAttribute( A2OUSTR("text:start-numbering-at"), A2OUSTR("page") );
+		else if( m_nRestartType == 1 )
+			pAttrList->AddAttribute( A2OUSTR("text:start-numbering-at"), A2OUSTR("chapter") );
+		
+		if( m_bInsertInPage )
+			pAttrList->AddAttribute( A2OUSTR("text:footnotes-position"), A2OUSTR("page") );
+		else
+			pAttrList->AddAttribute( A2OUSTR("text:footnotes-position"), A2OUSTR("document") );
+	}
+	
+	if(m_bIsFootnote)
+	{
+		pStrm->StartElement( A2OUSTR("text:footnotes-configuration") );
+		if( m_strMessageOn.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("text:footnote-continuation-notice-forward") );
+			pStrm->Characters(m_strMessageOn);
+			pStrm->EndElement( A2OUSTR("text:footnote-continuation-notice-forward") );
+		}
+
+		if( m_strMessageFrom.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("text:footnote-continuation-notice-backward") );
+			pStrm->Characters(m_strMessageFrom);
+			pStrm->EndElement( A2OUSTR("text:footnote-continuation-notice-backward") );
+		}
+
+		pStrm->EndElement( A2OUSTR("text:footnotes-configuration") );	
+	}
+	else
+	{
+		pStrm->StartElement( A2OUSTR("text:endnotes-configuration") );
+		pStrm->EndElement( A2OUSTR("text:endnotes-configuration") );
+	}
+	
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xffootnote.hxx lotuswordpro/source/filter/xfilter/xffootnote.hxx
--- lotuswordpro.bak/source/filter/xfilter/xffootnote.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xffootnote.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,128 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Foot note object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-1-31 create this file.
+ ************************************************************************/
+#ifndef		_XFFOOTNOTE_HXX
+#define		_XFFOOTNOTE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfcontentcontainer.hxx"
+
+/**
+ * @brief
+ * Foot note object.
+ * Foot note has a lable, which is used in page content, and footnote contents in the footnote section.
+ */
+class XFFootNote : public XFContentContainer
+{
+public:
+	XFFootNote();
+
+public:
+	void	SetLabel(sal_Unicode label);
+
+	virtual void	ToXml(IXFStream *pStrm);	
+
+private:
+	rtl::OUString	m_strID;	
+	rtl::OUString	m_strLabel;
+};
+
+inline XFFootNote::XFFootNote()
+{
+	m_strID = XFGlobal::GenNoteName();
+}
+
+inline void	XFFootNote::SetLabel(sal_Unicode label)
+{
+	sal_Unicode		chs[2];
+	chs[0] = label;
+	chs[1] = 0;
+	
+	m_strLabel = rtl::OUString(chs);
+}
+
+inline void	XFFootNote::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("text:id"), m_strID );
+	pStrm->StartElement( A2OUSTR("text:footnote") );
+
+	pAttrList->Clear();
+	if( m_strLabel.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:label"), m_strLabel );
+	pStrm->StartElement( A2OUSTR("text:footnote-citation") );
+	if( m_strLabel.getLength() )
+		pStrm->Characters(m_strLabel);
+	pStrm->EndElement( A2OUSTR("text:footnote-citation") );
+
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:footnote-body") );
+	XFContentContainer::ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("text:footnote-body") );
+
+	pStrm->EndElement( A2OUSTR("text:footnote") );
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfframe.cxx lotuswordpro/source/filter/xfilter/xfframe.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfframe.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfframe.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,208 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Frame whose anchor is not page.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xfframe.hxx"
+#include	"xfparagraph.hxx"
+#define		ZINDEX_MAX 0x7fffffff
+#define		ZINDEX_MIN 0
+XFFrame::XFFrame()
+{
+	m_isTextBox = sal_False;
+	m_eAnchor = enumXFAnchorPara;	
+	m_nAnchorPage = 0;
+	m_nZIndex = ZINDEX_MIN;
+	//give it a default name:
+	m_strName = XFGlobal::GenFrameName();
+	m_fMinHeight = 0;
+	m_fMaxHeight = 0;
+	m_nFlag = 0;
+	m_eType = enumXFFrameTextbox;
+}
+XFFrame::XFFrame(sal_Bool isTextBox):m_isTextBox(isTextBox)
+{
+	m_eAnchor = enumXFAnchorPara;	
+	m_nAnchorPage = 0;
+	m_nZIndex = ZINDEX_MIN;
+	//give it a default name:
+	m_strName = XFGlobal::GenFrameName();
+	m_fMinHeight = 0;
+	m_fMaxHeight = 0;
+	m_nFlag = 0;
+	m_eType = enumXFFrameTextbox;
+}
+
+XFFrame::~XFFrame()
+{
+}
+
+void	XFFrame::Add(IXFContent *pContent)
+{
+	XFContentContainer::Add(pContent);
+	if( pContent->GetContentType() == enumXFContentFrame )
+	{
+		XFFrame *pFrame = (XFFrame*)pContent;
+		if( pFrame )
+		{
+			pFrame->SetZIndex(pFrame->m_nZIndex + 1);
+		}
+	}
+	
+}
+
+void	XFFrame::SetZIndex(sal_Int32 zIndex)
+{
+	if( zIndex == m_nZIndex )
+		return;
+	m_nZIndex = zIndex;
+	AdjustZIndex();
+}
+
+enumXFFrameType	XFFrame::GetFrameType()
+{
+	return m_eType;
+}
+
+enumXFContent	XFFrame::GetContentType()
+{
+	return enumXFContentFrame;
+}
+
+void	XFFrame::ToXml(IXFStream *pStrm)
+{
+	StartFrame(pStrm);
+	
+	XFContentContainer::ToXml(pStrm);
+
+	EndFrame(pStrm);
+}
+
+void	XFFrame::StartFrame(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:style-name"), GetStyleName() );
+	
+	assert(m_strName.getLength()>0);	//name should not be null.
+	if( m_strName.getLength()&&m_isTextBox == sal_False)
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	//anchor type:
+	switch( m_eAnchor )
+	{
+	case enumXFAnchorPara:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("paragraph") );
+		break;
+	case enumXFAnchorPage:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("page") );
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-page-number"), Int32ToOUString(m_nAnchorPage) );
+		break;
+	case enumXFAnchorChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("char") );
+		break;
+	case enumXFAnchorAsChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("as-char") );
+		break;
+	case enumXFAnchorFrame:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("frame") );
+		break;
+	}
+	pAttrList->AddAttribute( A2OUSTR("svg:x"), DoubleToOUString(m_aRect.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y"), DoubleToOUString(m_aRect.GetY()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:width"), DoubleToOUString(m_aRect.GetWidth()) + A2OUSTR("cm") );
+	if( m_nFlag& XFFRAME_FLAG_MINHEIGHT )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:min-height"), DoubleToOUString(m_fMinHeight) + A2OUSTR("cm") );
+		if( m_nFlag&XFFRAME_FLAG_MAXHEIGHT )
+			pAttrList->AddAttribute( A2OUSTR("fo:max-height"), DoubleToOUString(m_fMaxHeight) + A2OUSTR("cm") );
+	}
+	else
+		pAttrList->AddAttribute( A2OUSTR("svg:height"), DoubleToOUString(m_aRect.GetHeight()) + A2OUSTR("cm") );
+
+	pAttrList->AddAttribute( A2OUSTR("draw:z-index"), Int32ToOUString(m_nZIndex) );	
+	
+	if( m_strNextLink.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("draw:chain-next-name"), m_strNextLink );	
+	
+	pStrm->StartElement( A2OUSTR("draw:text-box") );
+}
+
+void	XFFrame::EndFrame(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("draw:text-box") );
+}
+
+void	XFFrame::AdjustZIndex()
+{
+	for( int i=0; i<GetCount(); i++ )
+	{
+		IXFContent *pContent = GetContent(i);
+		if( pContent )
+		{
+			if( pContent->GetContentType() == enumXFContentFrame )
+			{
+				XFFrame *pFrame = (XFFrame*)pContent;
+				pFrame->m_nZIndex = m_nZIndex + 1;
+				pFrame->AdjustZIndex();
+			}
+		}
+	}
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfframe.hxx lotuswordpro/source/filter/xfilter/xfframe.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfframe.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfframe.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,265 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Frame object for OOo.This is the basic object for all Shape Layer.
+ * You can reference to the XFFrame object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10 create and implements.
+ ************************************************************************/
+#ifndef		_XFFRAME_HXX
+#define		_XFFRAME_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfrect.hxx"
+#include	"xfcontentcontainer.hxx"
+
+#define		XFFRAME_FLAG_HEIGHT			0x00000001
+#define		XFFRAME_FLAG_MINHEIGHT		0x00000002
+#define		XFFRAME_FLAG_MAXHEIGHT		0x00000004
+/**
+ * @brief
+ *	Base class for all frame object,include drawing,image,text-box.
+ *	
+ *	Use SetX(),SetY(),SetWidth(),SetHeight() to set postion for the frame.
+ *	Only if you set anchor type to enumXFAnchorPage, the SetAnchorPage functions.
+ */
+class XFFrame : public XFContentContainer
+{
+public:
+	XFFrame();
+	XFFrame(sal_Bool isTextBox);
+	
+	virtual ~XFFrame();
+
+public:
+	/**
+	 * @descr	override the add function to adjust z-index. 
+	 */
+	virtual void	Add(IXFContent *pContent);
+
+	/**
+	 * @descr:	Set the anchor type for the frame object.
+	 */
+	void	SetAnchorType(enumXFAnchor type);
+
+	/**
+	 * @descr:	if it's page anchor,set the page number.
+	 */
+	void	SetAnchorPage(sal_Int32	page);
+
+	/**
+	 * @descr	Set frame name. 
+	 */
+	void	SetName(rtl::OUString name);
+
+	/**
+	 * @descr	Set z-index of the frame. 
+	 */
+	void	SetZIndex(sal_Int32 zIndex);
+	/**
+	 * @descr	Set frame position X. 
+	 */
+	void	SetX(double x);
+
+	/**
+	 * @descr	Set frame position Y. 
+	 */
+	void	SetY(double y);
+
+	/**
+	 * @descr	Set frame wieth. 
+	 */
+	void	SetWidth(double width);
+
+	/**
+	 * @descr	Set frame height. Be careful SetHeight and SetMinHeight will override each other. 
+	 */
+	void	SetHeight(double height);
+
+	/**
+	 * @descr	Set frame min-height. Be careful SetHeight and SetMinHeight will override each other. 
+	 */
+	void	SetMinHeight(double minHeight);
+
+	/**
+	 * @descr	Set frame max-height. 
+	 */
+	void	SetMaxHeight(double minHeight);
+
+	/**
+	 * @descr	Set frame position. 
+	 */
+	void	SetPosition(double x, double y, double width, double height);
+
+	/**
+	 * @descr	Set frame position. 
+	 */
+	void	SetPosition(const XFRect& rect);
+	
+	/**
+	 * @descr:	Link the text content of the two frame.
+	 */
+	void	SetNextLink(rtl::OUString next);
+
+	/**
+	 * @descr	Get the frame type. image, drawing or text-box. 
+	 */
+	virtual enumXFFrameType	GetFrameType();
+
+	/**
+	 * @descr	Get content type, enumXFContentFrame. 
+	 */
+	virtual enumXFContent	GetContentType();
+
+	/**
+	 * @descr	serialize. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	void	StartFrame(IXFStream *pStrm);
+	
+	void	EndFrame(IXFStream *pStrm);
+
+	void	AdjustZIndex();
+
+protected:
+	enumXFAnchor	m_eAnchor;
+	sal_Int32		m_nAnchorPage;
+	rtl::OUString	m_strName;
+	sal_uInt32		m_nZIndex;
+	XFRect			m_aRect;	
+	double			m_fMinHeight;
+	double			m_fMaxHeight;
+	rtl::OUString	m_strNextLink;
+	enumXFFrameType	m_eType;
+	sal_uInt32		m_nFlag;
+	sal_Bool			m_isTextBox;
+};
+
+inline void	XFFrame::SetAnchorType(enumXFAnchor anchor)
+{
+	m_eAnchor = anchor;
+}
+
+inline void	XFFrame::SetName(rtl::OUString name)
+{
+	m_strName = name;
+}
+
+inline void	XFFrame::SetX(double x)
+{
+	m_aRect.SetX(x);
+}
+
+inline void	XFFrame::SetY(double y)
+{
+	m_aRect.SetY(y);
+}
+
+inline void	XFFrame::SetWidth(double width)
+{
+	m_aRect.SetWidth(width);
+}
+
+inline void	XFFrame::SetHeight(double height)
+{
+	m_aRect.SetHeight(height);
+	m_nFlag |= XFFRAME_FLAG_HEIGHT;
+	m_nFlag &= XFFRAME_FLAG_HEIGHT;
+}
+
+inline void	XFFrame::SetMinHeight(double minHeight)
+{
+	m_fMinHeight = minHeight;
+	m_nFlag |= XFFRAME_FLAG_MINHEIGHT;
+	m_nFlag &= XFFRAME_FLAG_MINHEIGHT;
+}
+
+inline void	XFFrame::SetMaxHeight(double maxHeight)
+{
+	m_fMaxHeight = maxHeight;
+	m_nFlag |= XFFRAME_FLAG_MAXHEIGHT;
+	m_nFlag &= XFFRAME_FLAG_MAXHEIGHT;
+}
+
+inline void	XFFrame::SetPosition(double x, double y, double width, double height)
+{
+	m_aRect.SetStartPoint(XFPoint(x,y));
+	m_aRect.SetSize(width,height);
+	m_nFlag |= XFFRAME_FLAG_HEIGHT;
+}
+
+inline void	XFFrame::SetPosition(const XFRect& rect)
+{
+	m_aRect = rect;
+}
+
+inline void XFFrame::SetNextLink(rtl::OUString next)
+{
+	m_strNextLink = next;
+}
+
+inline void XFFrame::SetAnchorPage(sal_Int32 page)
+{
+	m_nAnchorPage = page;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfframestyle.cxx lotuswordpro/source/filter/xfilter/xfframestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfframestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfframestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,238 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Frame style include position,size,rotation and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#include	"xfframestyle.hxx"
+#include	"xfcolumns.hxx"
+#include	"xfborders.hxx"
+#include	"xfshadow.hxx"
+#include	"xfbgimage.hxx"
+
+XFFrameStyle::XFFrameStyle()
+{
+	m_eWrap = enumXFWrapNone;
+	m_nWrapLines = 0;	//not limited.
+	m_pBorders = NULL;
+	m_pColumns = NULL;
+	m_pShadow = NULL;
+	m_pBGImage = NULL;
+
+	m_bProtectContent = sal_False;
+	m_bProtectSize = sal_False;
+	m_bProtectPos = sal_False;
+	m_bEditable = sal_False;
+	m_bPrintable = sal_True;
+	m_bBackground = sal_False;
+	m_nTransparency = 0;
+
+	m_eTextDir = enumXFTextDirNone;
+	m_eXPos = enumXFFrameXPosCenter;
+	m_eXRel = enumXFFrameXRelParaContent;
+	m_eYPos = enumXFFrameYPosTop;
+	m_eYRel = enumXFFrameYRelPage;
+}
+
+XFFrameStyle::~XFFrameStyle()
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	if( m_pColumns )
+		delete m_pColumns;
+	if( m_pShadow )
+		delete m_pShadow;
+	if( m_pBGImage )
+		delete m_pBGImage;
+}
+
+void	XFFrameStyle::SetBorders(XFBorders *pBorders)
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	m_pBorders = pBorders;
+}
+
+void	XFFrameStyle::SetColumns(XFColumns *pColumns)
+{
+	if( m_pColumns )
+		delete m_pColumns;
+	m_pColumns = pColumns;
+}
+
+void	XFFrameStyle::SetShadow(XFShadow *pShadow)
+{
+	if( m_pShadow )
+		delete m_pShadow;
+	m_pShadow = pShadow;
+}
+
+void	XFFrameStyle::SetBackImage(XFBGImage *image)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+	m_pBGImage = image;
+}
+
+enumXFStyle	XFFrameStyle::GetStyleFamily()
+{
+	return enumXFStyleGraphics;
+}
+
+void	XFFrameStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("graphics") );
+	//parent style name ignore now.
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	m_aMargins.ToXml(pStrm);
+	
+	pAttrList->Clear();
+
+	/*if( m_eWrap == enumXFWrapBackground )
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("background") );
+	}
+	else
+	{*/
+	if( m_bBackground)
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("background") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("foreground") );
+
+	if( m_eWrap == enumXFWrapNone )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("none") );
+	else if( m_eWrap == enumXFWrapLeft )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("left") );
+	else if( m_eWrap == enumXFWrapRight )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("right") );
+	else if( m_eWrap == enumXFWrapParallel )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("parallel") );
+	else if( m_eWrap == enumXFWrapRunThrough )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("run-through") );
+	else if( m_eWrap == enumXFWrapBest )
+		pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("dynamic") );
+	//}
+	//background
+	if( m_aBackColor.IsValid() )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+		pAttrList->AddAttribute( A2OUSTR("style:background-transparency"), Int16ToOUString(m_nTransparency) + A2OUSTR("%"));
+	}
+	
+	//pad
+	m_aPad.ToXml(pStrm);
+	//margin:
+	m_aMargins.ToXml(pStrm);
+	//border
+	if( m_pBorders )
+		m_pBorders->ToXml(pStrm);
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:border"), A2OUSTR("none") );
+	//shadow
+	if( m_pShadow )
+		m_pShadow->ToXml(pStrm);
+	//print
+	if( m_bPrintable )
+		pAttrList->AddAttribute( A2OUSTR("style:print-content"), A2OUSTR("true") );	
+	//text directory
+	if( m_eTextDir != enumXFTextDirNone )
+		pAttrList->AddAttribute( A2OUSTR("style:writing-mode"), GetTextDirName(m_eTextDir) );	
+	//protect:
+	if( m_bProtectContent || m_bProtectSize || m_bProtectPos )
+	{
+		rtl::OUString protect;
+		if( m_bProtectContent )
+			protect += A2OUSTR("content");
+		if( m_bProtectSize )
+		{
+			if( protect.getLength()>0 )
+				protect += A2OUSTR(" ");
+			protect += A2OUSTR("size");
+		}
+		if( m_bProtectPos )
+		{
+			if( protect.getLength()>0 )
+				protect += A2OUSTR(" ");
+			protect += A2OUSTR("position");
+		}
+		pAttrList->AddAttribute( A2OUSTR("style:protect"), protect );
+	}
+	//vertical pos and horizon pos:
+	pAttrList->AddAttribute( A2OUSTR("style:vertical-pos"), GetFrameYPos(m_eYPos) );
+	pAttrList->AddAttribute( A2OUSTR("style:vertical-rel"), GetFrameYRel(m_eYRel) );
+	pAttrList->AddAttribute( A2OUSTR("style:horizontal-pos"), GetFrameXPos(m_eXPos) );
+	pAttrList->AddAttribute( A2OUSTR("style:horizontal-rel"), GetFrameXRel(m_eXRel) );
+
+	//
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	if( m_pColumns )
+		m_pColumns->ToXml(pStrm);
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfframestyle.hxx lotuswordpro/source/filter/xfilter/xfframestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfframestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfframestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,254 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Frame object style for OOo.
+ * You can reference to the XFFrame object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10 create and implements.
+ ************************************************************************/
+#ifndef		_XFFRAMESTYLE_HXX
+#define		_XFFRAMESTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfmargins.hxx"
+#include	"xfcolor.hxx"
+#include	"xfpadding.hxx"
+
+class XFBorders;
+class XFColumns;
+class XFShadow;
+class XFBGImage;
+
+/**
+ * @brief
+ * Style for all frame obejcts.
+ */
+class XFFrameStyle : public XFStyle
+{
+public:
+	XFFrameStyle();
+
+	virtual ~XFFrameStyle();
+
+public:
+	void	SetWrapType(enumXFWrap wrap, sal_Int32 nParagraphs = 0);
+
+	/**
+	 * @descr:	space between frame and paragraph text.
+	 */
+	void	SetMargins(double left, double right=-1,double top=-1, double bottom=-1);
+
+	/**
+	 * @descr:	space between frame and text inside frame.
+	 */
+	void	SetPadding(double left, double right=-1,double top=-1, double bottom=-1);
+
+	/**
+	 * @descr:	set the border property of the frame.
+	 */
+	void	SetBorders(XFBorders *pBorders);
+
+	/**
+	 * @descr:	set the column property of the frame.
+	 */
+	void	SetColumns(XFColumns *pColumns);
+
+	/**
+	 * @descr:	set the shadow object the frame.
+	 */
+	void	SetShadow(XFShadow *pShadow);
+
+	/**
+	 * @descr:	set the background image of the frame.
+	 */
+	void	SetBackImage(XFBGImage *iamge);
+
+	/**
+	 * @descr:	set the background color of the frame.
+	 */
+	void	SetBackColor(XFColor& color);
+
+	/**
+	 * @descr	Set whether frame is protected. There are three properties that can be protected, content,size and position. 
+	 */
+	void	SetProtect(sal_Bool content, sal_Bool size, sal_Bool pos);
+
+	/**
+	 * @descr	Set text dir. 
+	 */
+	void	SetTextDir(enumXFTextDir dir);
+
+	/**
+	 * @descr	Set horizontal position type. 
+	 */
+	void	SetXPosType(enumXFFrameXPos pos, enumXFFrameXRel rel);
+
+	/**
+	 * @descr	Set vertical position type. 
+	 */
+	void	SetYPosType(enumXFFrameYPos pos, enumXFFrameYRel rel);
+
+	/**
+	 * @descr	Set frame background. 
+	 */
+	void	SetBackGround(sal_Bool bBackground);
+
+	void SetTransparency(sal_Int16 nTransparency);
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+protected:
+	enumXFWrap	m_eWrap;
+	sal_Int32	m_nWrapLines;
+	XFPadding	m_aPad;
+	XFMargins	m_aMargins;
+	XFBorders	*m_pBorders;
+	XFColumns	*m_pColumns;
+	XFShadow	*m_pShadow;
+	XFBGImage	*m_pBGImage;
+	XFColor		m_aBackColor;
+	sal_Bool	m_bProtectContent;
+	sal_Bool	m_bProtectSize;
+	sal_Bool	m_bProtectPos;
+	sal_Bool	m_bEditable;
+	sal_Bool	m_bPrintable;
+	sal_Bool	m_bBackground;
+	sal_Int16 m_nTransparency;
+
+	enumXFTextDir	m_eTextDir;
+	enumXFFrameXPos	m_eXPos;
+	enumXFFrameXRel	m_eXRel;
+	enumXFFrameYPos	m_eYPos;
+	enumXFFrameYRel m_eYRel;	
+};
+
+inline void	XFFrameStyle::SetWrapType(enumXFWrap wrap, sal_Int32 nParagraphs)
+{
+	m_eWrap = wrap;
+}
+
+inline void	XFFrameStyle::SetMargins(double left, double right,double top, double bottom)
+{
+	if( left != -1 )
+		m_aMargins.SetLeft(left);
+	if( right != -1 )
+		m_aMargins.SetRight(right);
+	if( top != -1 )
+		m_aMargins.SetTop(top);
+	if( bottom != -1 )
+		m_aMargins.SetBottom( bottom );	
+}
+
+inline void	XFFrameStyle::SetPadding(double left, double right,double top, double bottom)
+{
+	if( left != -1 )
+		m_aPad.SetLeft(left);
+	if( right != -1 )
+		m_aPad.SetRight(right);
+	if( top != -1 )
+		m_aPad.SetTop(top);
+	if( bottom != -1 )
+		m_aPad.SetBottom( bottom );	
+}
+
+inline void	XFFrameStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+}
+
+inline void	XFFrameStyle::SetTextDir(enumXFTextDir dir)
+{
+	m_eTextDir = dir;
+}
+
+inline void	XFFrameStyle::SetProtect(sal_Bool content, sal_Bool size, sal_Bool pos)
+{
+	m_bProtectContent = content;
+	m_bProtectSize = size;
+	m_bProtectPos = pos;
+}
+
+inline void	XFFrameStyle::SetXPosType(enumXFFrameXPos pos, enumXFFrameXRel rel)
+{
+	m_eXPos = pos;
+	m_eXRel = rel;
+}
+
+inline void	XFFrameStyle::SetYPosType(enumXFFrameYPos pos, enumXFFrameYRel rel)
+{
+	m_eYPos = pos;
+	m_eYRel = rel;
+}
+
+inline void XFFrameStyle::SetBackGround(sal_Bool bBackground)
+{
+	m_bBackground = bBackground;
+}
+
+inline void XFFrameStyle::SetTransparency(sal_Int16 nTransparency)
+{
+	m_nTransparency = nTransparency;
+}
+
+#endif
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfframetable.hxx lotuswordpro/source/filter/xfilter/xfframetable.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfframetable.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfframetable.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,91 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table object exist in a frame.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-04-4 create and implements.
+ ************************************************************************/
+#ifndef		_XFFRAMETABLE_HXX
+#define		_XFFRAMETABLE_HXX
+
+#include	"xftable.hxx"
+#include	"xfframe.hxx"
+
+class XFFrameTable : public XFTable
+{
+public:
+	void	SetFrameStyle(rtl::OUString style);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString	m_strFrameStyle;
+};
+
+inline void	XFFrameTable::ToXml(IXFStream *pStrm)
+{
+	XFFrame	*pFrame = new XFFrame();
+	pFrame->SetStyleName(m_strFrameStyle);
+	pFrame->Add(this);
+	pFrame->ToXml(pStrm);
+
+	delete pFrame;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfglobal.cxx lotuswordpro/source/filter/xfilter/xfglobal.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfglobal.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfglobal.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,146 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Global functions or include files that are needed.
+ * It's all for the full filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xfglobal.hxx"
+#include	"xffontfactory.hxx"
+#include	"xfstylemanager.hxx"
+
+int	XFGlobal::s_nFrameID = 1;
+int XFGlobal::s_nGraphID = 1;
+int XFGlobal::s_nSectionID = 1;
+int	XFGlobal::s_nTableID = 1;
+int	XFGlobal::s_nNoteID = 1;
+int XFGlobal::s_nStrokeDashID = 1;
+int	XFGlobal::s_nAreaID = 1;
+
+//For chart object, /2005/2
+int XFGlobal::s_nObjID = 1;
+
+int XFGlobal::s_nImageID = 1;
+	
+rtl::OUString XFGlobal::GenSectionName()
+{
+	//give it a initial name:
+	return A2OUSTR("sect") + Int32ToOUString(s_nSectionID++);
+}
+
+rtl::OUString XFGlobal::GenFrameName()
+{
+	//give it a initial name:
+	return A2OUSTR("frame") + Int32ToOUString(s_nFrameID++);
+}
+
+rtl::OUString XFGlobal::GenGraphName()
+{
+	return A2OUSTR("gr") + Int32ToOUString(s_nGraphID++);
+}
+
+//For chart object, /2005/2
+rtl::OUString XFGlobal::GenObjName()
+{
+	return A2OUSTR("Object") + Int32ToOUString(s_nObjID++);
+}
+
+rtl::OUString XFGlobal::GenTableName()
+{
+	return A2OUSTR("table") + Int32ToOUString(s_nFrameID++);
+}
+
+rtl::OUString XFGlobal::GenNoteName()
+{
+	return A2OUSTR("ftn") + Int32ToOUString(s_nNoteID++);
+}
+
+rtl::OUString XFGlobal::GenStrokeDashName()
+{
+	return A2OUSTR("stroke dash ") + Int32ToOUString(s_nStrokeDashID++);
+}
+
+rtl::OUString XFGlobal::GenAreaName()
+{
+	return A2OUSTR("draw area") + Int32ToOUString(s_nAreaID++);
+}
+
+rtl::OUString XFGlobal::GenImageName()
+{
+	return A2OUSTR("Graphic") + Int32ToOUString(s_nImageID++);	
+}
+
+void	XFGlobal::Reset()
+{
+	s_nSectionID = 1;
+	s_nFrameID = 1;
+	s_nTableID = 1;
+	s_nNoteID = 1;
+	s_nStrokeDashID = 1;
+	s_nAreaID = 1;
+	s_nObjID = 1;
+}
+
+void	XFGlobalReset()
+{
+//	XFFontFactory::Reset();
+//	XFStyleManager::Reset();
+	XFGlobal::Reset();
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfglobal.hxx lotuswordpro/source/filter/xfilter/xfglobal.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfglobal.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfglobal.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,178 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Global functions or include files that are needed.
+ * It's all for the full filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_GLOBAL_HXX
+#define		_GLOBAL_HXX
+
+#include	<cassert>
+
+#ifndef _SAL_TYPES_H
+#include	"sal/types.h"
+#endif
+
+#ifndef _RTL_USTRING_HXX_
+#include	<rtl/ustring.hxx>
+#endif
+
+#ifndef	_IXFOBJECT_HXX
+#include	"ixfobject.hxx"
+#endif
+
+#ifndef	_IXFSTREAM_HXX
+#include	"ixfstream.hxx"
+#endif
+
+#ifndef _IXFATTRLIST_HXX
+#include	"ixfattrlist.hxx"
+#endif
+
+#ifndef _XFUTIL_HXX
+#include	"xfutil.hxx"
+#endif
+
+#ifndef	_XFDEFS_HXX
+#include	"xfdefs.hxx"
+#endif
+
+#define PI 3.1415926
+#define	FLOAT_MIN	0.001
+#define MAX2(a,b)    (((a) > (b)) ? (a) : (b))
+#define MAX3(a,b,c)	MAX2(a,MAX2(b,c))
+#define MIN2(a,b)    (((a) < (b)) ? (a) : (b))
+#define MIN3(a,b,c)	MIN2(a,MIN2(b,c))
+#define	FABS(f)		(f>0?f:-f)
+
+void	XFGlobalReset();
+
+/**
+ * @brief
+ * Global object, it manages all global variables for the full filter.
+ * Before loading a file, we'll need to reset all global variables.
+ * XFGlobal::Reset can do this for you.
+ */
+class	XFGlobal
+{
+public:
+	/**
+	 * @descr	Generate a name for the section. 
+	 */
+	static rtl::OUString	GenSectionName();
+
+	/**
+	 * @descr	Gen a name for the frame. 
+	 */
+	static rtl::OUString	GenFrameName();
+
+	/**
+	 * @descr	Generate a name for graphics. 
+	 */
+	static rtl::OUString	GenGraphName();
+
+	/**
+	 * @descr	Generate a name for a table. 
+	 */
+	static rtl::OUString	GenTableName();
+
+	/**
+	 * @descr	Generate a name for a note. 
+	 */
+	static rtl::OUString	GenNoteName();
+
+	/**
+	 * @descr	Generate a name for the stroke style. 
+	 */
+	static rtl::OUString	GenStrokeDashName();
+
+	/**
+	 * @descr	Generate a name for the area fill style. 
+	 */
+	static rtl::OUString	GenAreaName();
+
+	/**
+	 * @descr	Generate a name for a ole obejct. 
+	 */
+	static rtl::OUString	GenObjName();
+
+	/**
+	 * @descr	Generate a name for an image object
+	 */
+	static rtl::OUString	GenImageName();
+	
+	/**
+	 * @descr	Reset all global variables. 
+	 */
+	static void	Reset();
+
+public:
+	static int	s_nSectionID;
+	static int	s_nFrameID;
+	static int	s_nGraphID;
+	static int	s_nTableID;
+	static int	s_nNoteID;
+	static int	s_nStrokeDashID;
+	static int	s_nAreaID;
+	static int s_nObjID;
+	static int s_nImageID;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfheader.hxx lotuswordpro/source/filter/xfilter/xfheader.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfheader.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfheader.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,90 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Header object. Sub object of master page.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ ************************************************************************/
+#ifndef		_XFHEADER_HXX
+#define		_XFHEADER_HXX
+
+#include	"xfcontentcontainer.hxx"
+#include	"xfparagraph.hxx"
+#include	<vector>
+
+class XFHeader : public XFContentContainer
+{
+public:
+	XFHeader()
+	{
+	}
+public:
+	virtual void ToXml(IXFStream *pStrm)
+	{
+		IXFAttrList	*pAttrList = pStrm->GetAttrList();
+		pAttrList->Clear();
+
+		pStrm->StartElement( A2OUSTR("style:header") );		
+		XFContentContainer::ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("style:header") );
+	}
+private:
+	XFContentContainer	m_aContents;	
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfheaderstyle.cxx lotuswordpro/source/filter/xfilter/xfheaderstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfheaderstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfheaderstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,192 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Header style,exist in page-master object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xfheaderstyle.hxx"
+#include	"xfbgimage.hxx"
+
+XFHeaderStyle::XFHeaderStyle(sal_Bool isFooter)
+{
+	m_bIsFooter = isFooter;
+	m_bDynamicSpace = sal_True;
+	m_fHeight = -1;
+	m_fMinHeight = -1;
+	m_pBorders = NULL;
+	m_pShadow = NULL;
+	m_pBGImage = NULL;
+}
+
+XFHeaderStyle::~XFHeaderStyle()
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	if( m_pBGImage )
+		delete m_pBGImage;
+	if( m_pShadow )
+		delete m_pShadow;
+}
+
+void	XFHeaderStyle::SetMargins(double left, double right, double bottom)
+{
+	if( left != -1 )
+		m_aMargin.SetLeft(left);
+	if( right != -1 )
+		m_aMargin.SetRight(right);
+	if( bottom != -1 )
+		m_aMargin.SetBottom(bottom);
+}
+void	XFHeaderStyle::SetDynamicSpace(sal_Bool dynamic)
+{
+	m_bDynamicSpace = dynamic;
+}
+
+void	XFHeaderStyle::SetHeight(double height)
+{
+	m_fHeight = height;
+}
+
+void	XFHeaderStyle::SetMinHeight(double minHeight)
+{
+	m_fMinHeight = minHeight;
+}
+
+void	XFHeaderStyle::SetPadding(double left, double right, double top, double bottom)
+{
+	if( left != -1 )
+		m_aPadding.SetLeft(left);
+	if( right != -1 )
+		m_aPadding.SetRight(right);
+	if( top != -1 )
+		m_aPadding.SetTop(top);
+	if( bottom != -1 )
+		m_aPadding.SetBottom(bottom);
+}
+
+void	XFHeaderStyle::SetShadow(XFShadow *pShadow)
+{
+	if( m_pShadow && (pShadow != m_pShadow) )
+		delete m_pShadow;
+	m_pShadow = pShadow;
+}
+
+void	XFHeaderStyle::SetBorders(XFBorders *pBorders)
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	m_pBorders = pBorders;
+}
+
+void	XFHeaderStyle::SetBackImage(XFBGImage *image)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+	m_pBGImage = image;
+}
+
+void	XFHeaderStyle::SetBackColor(XFColor color)
+{
+	m_aBackColor = color;
+}
+
+void	XFHeaderStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	if( m_bIsFooter )
+		pStrm->StartElement( A2OUSTR("style:footer-style") );
+	else
+		pStrm->StartElement( A2OUSTR("style:header-style") );	
+
+	//height
+	if( m_fMinHeight>0 )
+		pAttrList->AddAttribute( A2OUSTR("fo:min-height"), DoubleToOUString(m_fMinHeight) + A2OUSTR("cm") );
+	else if( m_fHeight>0 )
+		pAttrList->AddAttribute( A2OUSTR("svg:height"), DoubleToOUString(m_fHeight) + A2OUSTR("cm") );
+	
+	m_aMargin.ToXml(pStrm);
+	if(m_pShadow)
+		m_pShadow->ToXml(pStrm);
+	m_aPadding.ToXml(pStrm);
+	if( m_pBorders )
+		m_pBorders->ToXml(pStrm);
+
+	if( m_aBackColor.IsValid() )
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+
+	if( m_bDynamicSpace )
+		pAttrList->AddAttribute( A2OUSTR("style:dynamic-spacing"), A2OUSTR("true") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("style:dynamic-spacing"), A2OUSTR("false") );
+	
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	
+	// background image
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("style:properties") );
+	
+	if( m_bIsFooter )
+		pStrm->EndElement( A2OUSTR("style:footer-style") );
+	else
+		pStrm->EndElement( A2OUSTR("style:header-style") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfheaderstyle.hxx lotuswordpro/source/filter/xfilter/xfheaderstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfheaderstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfheaderstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,142 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Header style,exist in page-master object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ ************************************************************************/
+#ifndef		_XFHEADERSTYLE_HXX
+#define		_XFHEADERSTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfmargins.hxx"
+#include	"xfborders.hxx"
+#include	"xfpadding.hxx"
+#include	"xfshadow.hxx"
+
+/**
+ * @brief
+ * Header style object.
+ */
+class XFBGImage;
+class XFHeaderStyle : public XFStyle
+{
+public:
+	explicit XFHeaderStyle(sal_Bool isFooter=sal_False);
+	
+	virtual ~XFHeaderStyle();
+
+public:
+	/**
+	 * @descr	Set margins for header style. 
+	 */
+	void	SetMargins(double left = -1, double right = -1, double bottom = -1);
+
+	void	SetDynamicSpace(sal_Bool dynamic);
+
+	/**
+	 * @descr	Set header fixed height. 
+	 */
+	void	SetHeight(double height);
+
+	/**
+	 * @descr	Set header min height. 
+	 */
+	void	SetMinHeight(double minHeight);
+
+	/**
+	 * @descr	Set padding for header. Padding is the space between header borde and header content. 
+	 */
+	void	SetPadding(double left=-1, double right=-1, double top=-1, double bottom=-1);
+
+	/**
+	 * @descr	Set header shadow. 
+	 */
+	void	SetShadow(XFShadow *pShadow);
+
+	/**
+	 * @descr	Set header borders. 
+	 */
+	void	SetBorders(XFBorders *pBorders);
+
+	void	SetBackImage(XFBGImage *image);
+	
+	/**
+	 * @descr	Set header background color. 
+	 */
+	void	SetBackColor(XFColor color);
+
+	/**
+	 * @descr	Output header style obejct. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+protected:
+	sal_Bool	m_bIsFooter;
+	sal_Bool	m_bDynamicSpace;
+	double		m_fHeight;
+	double		m_fMinHeight;
+	XFMargins	m_aMargin;
+	XFShadow*	m_pShadow;
+	XFPadding	m_aPadding;
+	XFBorders	*m_pBorders;
+	XFBGImage	*m_pBGImage;
+	XFColor		m_aBackColor;
+};
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfhyperlink.hxx lotuswordpro/source/filter/xfilter/xfhyperlink.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfhyperlink.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfhyperlink.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,140 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Hyperlink object for OOo xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-1-31 create this file.
+ ************************************************************************/
+#ifndef		_XFHYPERLINK_HXX
+#define		_XFHYPERLINK_HXX
+
+class XFHyperlink : public XFContent
+{
+public:
+	XFHyperlink();
+
+public:
+	void	SetHRef(rtl::OUString href);
+
+	void	SetText(rtl::OUString text);
+
+	void	SetName(rtl::OUString name);
+
+	void	SetTargetFrame(rtl::OUString frame=A2OUSTR("_self"));
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString	m_strHRef;
+	rtl::OUString	m_strName;
+	rtl::OUString	m_strFrame;
+	rtl::OUString	m_strText;	
+};
+
+inline XFHyperlink::XFHyperlink()
+{
+	m_strFrame = A2OUSTR("_self");
+}
+
+inline void	XFHyperlink::SetHRef(rtl::OUString href)
+{
+	m_strHRef = href;
+}
+
+inline void XFHyperlink::SetName(rtl::OUString name)
+{
+	m_strName = name;
+}
+
+inline void XFHyperlink::SetTargetFrame(rtl::OUString frame)
+{
+	m_strFrame = frame;
+}
+
+inline void XFHyperlink::SetText(rtl::OUString text)
+{
+	m_strText = text;
+}
+
+inline void XFHyperlink::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("xlink:type"), A2OUSTR("simple") );
+	pAttrList->AddAttribute( A2OUSTR("xlink:href"), m_strHRef );
+	if( m_strName.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("office:name"), m_strName );
+	pAttrList->AddAttribute( A2OUSTR("office:target-frame-name"), m_strFrame );
+	pAttrList->AddAttribute( A2OUSTR("xlink:show"), A2OUSTR("replace") );
+	pStrm->StartElement( A2OUSTR("text:a") );
+
+	pAttrList->Clear();
+	if( GetStyleName().getLength()>0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	pStrm->StartElement( A2OUSTR("text:span") );
+	if( m_strText.getLength() )
+		pStrm->Characters(m_strText);
+	else
+		pStrm->Characters(m_strHRef);
+	pStrm->EndElement( A2OUSTR("text:span") );
+
+	pStrm->EndElement( A2OUSTR("text:a") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfimage.cxx lotuswordpro/source/filter/xfilter/xfimage.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfimage.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfimage.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,145 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Image object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-22	create and implemente.
+ ************************************************************************/
+#include	"xfimage.hxx"
+#include	"xfbase64.hxx"
+
+XFImage::XFImage()
+{
+	m_eType = enumXFFrameImage;
+	m_strName = XFGlobal::GenImageName();
+}
+
+void XFImage::SetFileURL(rtl::OUString url)
+{
+	m_strImageFile = url;
+	m_bUseLink  = sal_True;
+}
+
+void XFImage::SetImageData(sal_uInt8 *buf, int len)
+{
+	m_strData = XFBase64::Encode(buf, len);
+	m_bUseLink = sal_False;
+}
+
+/*
+ <text:p text:style-name="Standard">
+			<draw:image draw:style-name="fr1" draw:name="Graphic1" 
+			text:anchor-type="paragraph" svg:width="4.981cm" svg:height="4.77cm" 
+			draw:z-index="0"  xlink:href="file:///d:/bee.wmf" xlink:type="simple" 
+			xlink:show="embed" xlink:actuate="onLoad"/>
+ </text:p>
+ */
+void	XFImage::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:style-name"), GetStyleName() );
+	
+	assert(m_strName.getLength()>0);	//name should not be null.
+	if( m_strName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	//anchor type:
+	switch( m_eAnchor )
+	{
+	case enumXFAnchorPara:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("paragraph") );
+		break;
+	case enumXFAnchorPage:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("page") );
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-page-number"), Int32ToOUString(m_nAnchorPage) );
+		break;
+	case enumXFAnchorChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("char") );
+		break;
+	case enumXFAnchorAsChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("as-char") );
+		break;
+	case enumXFAnchorFrame:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("frame") );
+		break;
+	}
+	pAttrList->AddAttribute( A2OUSTR("svg:x"), DoubleToOUString(m_aRect.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y"), DoubleToOUString(m_aRect.GetY()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:width"), DoubleToOUString(m_aRect.GetWidth()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:height"), DoubleToOUString(m_aRect.GetHeight()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("draw:z-index"), Int32ToOUString(m_nZIndex) );	
+
+	if( m_bUseLink )
+	{
+		pAttrList->AddAttribute( A2OUSTR("xlink:href"), m_strImageFile );
+		pAttrList->AddAttribute( A2OUSTR("xlink:type"), A2OUSTR("simple") );
+		pAttrList->AddAttribute( A2OUSTR("xlink:show"), A2OUSTR("embed") );
+		pAttrList->AddAttribute( A2OUSTR("xlink:actuate"), A2OUSTR("onLoad") );
+	}
+	
+	pStrm->StartElement( A2OUSTR("draw:image") );
+	if( !m_bUseLink )
+	{
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("office:binary-data") );
+		pStrm->Characters(m_strData);
+		pStrm->EndElement( A2OUSTR("office:binary-data") );
+	}
+	pStrm->EndElement( A2OUSTR("draw:image") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfimage.hxx lotuswordpro/source/filter/xfilter/xfimage.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfimage.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfimage.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,100 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Image object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-22	create and implemente.
+ ************************************************************************/
+#ifndef		_XFIMAGE_HXX
+#define		_XFIMAGE_HXX
+
+#include	"xfframe.hxx"
+
+/**
+ * @brief
+ * Image obejct.
+ * There are two way to import an image, file link or base64 stream.
+ */
+class XFImage : public XFFrame
+{
+public:
+	XFImage();
+
+public:
+	/**
+	 * @descr	Use file link source.a 
+	 */
+	void	SetFileURL(rtl::OUString url);
+
+	/**
+	 * @descr	Use base64 stream. 
+	 */
+	void	SetImageData(sal_uInt8 *buf, int len);
+
+	/**
+	 * @descr	Output image. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString m_strImageFile;
+	rtl::OUString m_strData;
+	sal_Bool	m_bUseLink;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfimagestyle.cxx lotuswordpro/source/filter/xfilter/xfimagestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfimagestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfimagestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,212 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Image style object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-22	create and implemente.
+ ************************************************************************/
+#include	"xfimagestyle.hxx"
+#include	"xfborders.hxx"
+#include	"xfshadow.hxx"
+
+XFImageStyle::XFImageStyle()
+{
+	m_nBrightness = 0;
+	m_nContrast = 0;
+	m_nGamma = 0;
+	m_nTransparent = 0;
+	m_nAdjustRed = 0;
+	m_nAdjustGreen = 0;
+	m_nAdjustBlue = 0;	
+	m_fClipLeft = 0;
+	m_fClipRight = 0;
+	m_fClipTop = 0;
+	m_fClipBottom = 0;
+	m_bHoriFlip = sal_False;
+	m_bVertFlip = sal_False;
+	m_eColorMode = enumXFColorStandard;
+}
+
+void XFImageStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("graphics") );
+	//parent style name ignore now.
+	pStrm->StartElement( A2OUSTR("style:style") );
+	
+	m_aMargins.ToXml(pStrm);
+	
+	pAttrList->Clear();
+
+	if( m_eWrap == enumXFWrapBackground )
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("background") );
+	}
+	else
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("foreground") );
+		
+		if( m_eWrap == enumXFWrapNone )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("none") );
+		else if( m_eWrap == enumXFWrapLeft )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("left") );
+		else if( m_eWrap == enumXFWrapRight )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("right") );
+		else if( m_eWrap == enumXFWrapParallel )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("parallel") );
+		else if( m_eWrap == enumXFWrapRunThrough )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("run-through") );
+		else if( m_eWrap == enumXFWrapBest )
+			pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("dynamic") );
+	}
+	//background
+	if( m_aBackColor.IsValid() )
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	//pad
+	m_aPad.ToXml(pStrm);
+	//margin:
+	m_aMargins.ToXml(pStrm);
+	//flip
+	if( m_bHoriFlip || m_bVertFlip )
+	{
+		if( m_bHoriFlip && m_bVertFlip )
+			pAttrList->AddAttribute( A2OUSTR("style:mirror"), A2OUSTR("horizontal-on-right-pages vertical") );
+		else if( m_bHoriFlip && !m_bVertFlip )
+			pAttrList->AddAttribute( A2OUSTR("style:mirror"), A2OUSTR("horizontal-on-right-pages") );
+		else if( !m_bHoriFlip && m_bVertFlip )
+			pAttrList->AddAttribute( A2OUSTR("style:mirror"), A2OUSTR("vertical") );
+	}
+	//color adjust
+	if( m_nAdjustRed )
+		pAttrList->AddAttribute( A2OUSTR("draw:red"), Int32ToOUString(m_nAdjustRed) + A2OUSTR("%") );
+	if( m_nAdjustGreen )
+		pAttrList->AddAttribute( A2OUSTR("draw:green"), Int32ToOUString(m_nAdjustGreen) + A2OUSTR("%") );
+	if( m_nAdjustBlue )
+		pAttrList->AddAttribute( A2OUSTR("draw:blue"), Int32ToOUString(m_nAdjustBlue) + A2OUSTR("%") );
+	
+	if( m_nGamma )
+		pAttrList->AddAttribute( A2OUSTR("draw:gamma"), Int32ToOUString(m_nGamma) );
+	if( m_nBrightness )
+		pAttrList->AddAttribute( A2OUSTR("draw:luminance"), Int32ToOUString(m_nBrightness) + A2OUSTR("%") );
+	if( m_nContrast )
+		pAttrList->AddAttribute( A2OUSTR("draw:contrast"), Int32ToOUString(m_nContrast) + A2OUSTR("%") );
+
+	if( m_nTransparent )
+		pAttrList->AddAttribute( A2OUSTR("draw:transparency"), Int32ToOUString(m_nTransparent) + A2OUSTR("%") );
+	
+	pAttrList->AddAttribute(A2OUSTR("draw:color-mode"), GetColorMode(m_eColorMode));
+	//border
+	if( m_pBorders )
+		m_pBorders->ToXml(pStrm);
+	//shadow
+	if( m_pShadow )
+		m_pShadow->ToXml(pStrm);
+	
+	if( m_bPrintable )
+		pAttrList->AddAttribute( A2OUSTR("style:print-content"), A2OUSTR("true") );	
+	//protect:
+	if( m_bProtectContent || m_bProtectSize || m_bProtectPos )
+	{
+		rtl::OUString protect;
+		if( m_bProtectContent )
+			protect += A2OUSTR("content");
+		if( m_bProtectSize )
+		{
+			if( protect.getLength()>0 )
+				protect += A2OUSTR(" ");
+			protect += A2OUSTR("size");
+		}
+		if( m_bProtectPos )
+		{
+			if( protect.getLength()>0 )
+				protect += A2OUSTR(" ");
+			protect += A2OUSTR("position");
+		}
+		pAttrList->AddAttribute( A2OUSTR("style:protect"), protect );
+	}
+	//vertical pos and horizon pos:
+	pAttrList->AddAttribute( A2OUSTR("style:vertical-pos"), GetFrameYPos(m_eYPos) );
+	pAttrList->AddAttribute( A2OUSTR("style:vertical-rel"), GetFrameYRel(m_eYRel) );
+	pAttrList->AddAttribute( A2OUSTR("style:horizontal-pos"), GetFrameXPos(m_eXPos) );
+	pAttrList->AddAttribute( A2OUSTR("style:horizontal-rel"), GetFrameXRel(m_eXRel) );
+	
+	//clip:
+	if( FABS(m_fClipLeft)>FLOAT_MIN || FABS(m_fClipRight)>FLOAT_MIN || FABS(m_fClipTop)>FLOAT_MIN || FABS(m_fClipBottom)>FLOAT_MIN )
+	{		
+		rtl::OUString clip = A2OUSTR("rect(");
+		clip += DoubleToOUString(m_fClipTop) + A2OUSTR("cm ");
+		clip += DoubleToOUString(m_fClipRight) + A2OUSTR("cm ");
+		clip += DoubleToOUString(m_fClipBottom) + A2OUSTR("cm ");
+		clip += DoubleToOUString(m_fClipLeft) + A2OUSTR("cm");
+		clip += A2OUSTR(")");
+		pAttrList->AddAttribute(A2OUSTR("fo:clip"),clip);
+	}
+	
+	//
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+	
+	pStrm->EndElement( A2OUSTR("style:style") );
+	
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfimagestyle.hxx lotuswordpro/source/filter/xfilter/xfimagestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfimagestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfimagestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,164 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Image style object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-22	create this file.
+   2005-02-25	make it inherit from XFFrameStyle.
+ ************************************************************************/
+#ifndef		_XFIMAGESTYLE_HXX
+#define		_XFIMAGESTYLE_HXX
+
+#include	"xfframestyle.hxx"
+#include	"xfrect.hxx"
+
+class XFImageStyle : public XFFrameStyle
+{
+public:
+	XFImageStyle();
+
+public:
+	void	SetBrightness(sal_Int32 brightness);
+
+	void	SetContrast(sal_Int32 contrast);
+
+	void	SetGamma(sal_Int32 gamma);
+
+	void	SetTransparent(sal_Int32 transparent);
+
+	void	SetAdjustRed(sal_Int32 red);
+
+	void	SetAdjustGreen(sal_Int32 green);
+
+	void	SetAdjustBlue(sal_Int32 blue);
+
+	void	SetClip(double left, double right, double top, double bottom);
+
+	void	SetFlip(sal_Bool hori, sal_Bool vert);
+
+	void	SetColorMode(enumXFColorMode mode);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	sal_Int32	m_nBrightness;
+	sal_Int32	m_nContrast;
+	sal_Int32	m_nGamma;
+	sal_Int32	m_nTransparent;
+	sal_Int32	m_nAdjustRed;
+	sal_Int32	m_nAdjustGreen;
+	sal_Int32	m_nAdjustBlue;	
+	double		m_fClipLeft;
+	double		m_fClipRight;
+	double		m_fClipTop;
+	double		m_fClipBottom;
+	sal_Bool	m_bHoriFlip;
+	sal_Bool	m_bVertFlip;
+	enumXFColorMode	m_eColorMode;
+};
+
+inline void	XFImageStyle::SetBrightness(sal_Int32 brightness)
+{
+	m_nBrightness = brightness;
+}
+
+inline void	XFImageStyle::SetContrast(sal_Int32 contrast)
+{
+	m_nContrast = contrast;
+}
+
+inline void	XFImageStyle::SetGamma(sal_Int32 gamma)
+{
+	m_nGamma = gamma;
+}
+
+inline void	XFImageStyle::SetTransparent(sal_Int32 transparent)
+{
+	m_nTransparent = transparent;
+}
+
+inline void	XFImageStyle::SetAdjustRed(sal_Int32 red)
+{
+	m_nAdjustRed = red;
+}
+
+inline void	XFImageStyle::SetAdjustGreen(sal_Int32 green)
+{
+	m_nAdjustGreen = green;
+}
+
+inline void	XFImageStyle::SetAdjustBlue(sal_Int32 blue)
+{
+	m_nAdjustBlue = blue;
+}
+
+inline void XFImageStyle::SetClip(double left, double right, double top, double bottom)
+{
+	m_fClipLeft = left;
+	m_fClipRight = right;
+	m_fClipTop = top;
+	m_fClipBottom = bottom;
+}
+
+inline void	XFImageStyle::SetFlip(sal_Bool hori, sal_Bool vert)
+{
+	m_bHoriFlip = hori;
+	m_bVertFlip = vert;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfindex.cxx lotuswordpro/source/filter/xfilter/xfindex.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfindex.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfindex.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,450 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Represente index source,index body and index index entry.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-02	create and implemente.
+ ************************************************************************/
+#include	"xfindex.hxx"
+#include	"xfparagraph.hxx"
+
+XFIndex::XFIndex()
+{
+	m_pTitle = NULL;
+	m_eType = enumXFIndexTOC;
+	m_bProtect = sal_True;
+	m_bSeparator = sal_False;
+	m_nMaxLevel = 0;
+	
+	for(sal_uInt16 i=1;i<MAX_TOC_LEVEL+1;i++)
+	{
+		m_aTOCSource[i].clear();
+	}
+}
+
+XFIndex::~XFIndex()
+{
+	if( m_pTitle )
+		delete m_pTitle;
+	
+	for(sal_uInt16 i=1;i<MAX_TOC_LEVEL+1;i++)
+	{
+		m_aTOCSource[i].clear();
+	}
+	
+	while(m_aTemplates.size()>0)
+	{
+		XFIndexTemplate * pTemplate = m_aTemplates.back();
+		m_aTemplates.pop_back();
+		delete pTemplate;pTemplate=NULL;
+	}
+}
+
+void XFIndex::SetSectionStyle(rtl::OUString strSectStyleName)
+{
+	SetStyleName(strSectStyleName);
+}
+
+void	XFIndex::SetTitle(rtl::OUString title, rtl::OUString strParaStyle)
+{
+	m_strTitle = title;
+
+	m_pTitle = new XFParagraph();
+	m_pTitle->SetStyleName(strParaStyle);
+	m_pTitle->Add(m_strTitle);
+}
+
+void	XFIndex::AddTemplate(sal_uInt32 level, 
+					rtl::OUString style, 
+					enumXFIndexTemplate type1,
+					enumXFIndexTemplate type2,
+					enumXFIndexTemplate type3,
+					enumXFIndexTemplate type4 )
+{
+	if( level<1 )
+		return;
+
+	if (level > m_nMaxLevel)
+		m_nMaxLevel = level;
+
+	XFIndexTemplate * templ = new XFIndexTemplate();
+	
+	templ->AddEntry(type1);
+	templ->AddEntry(type2);
+	templ->AddEntry(type3);
+	templ->AddEntry(type4);
+	templ->SetLevel( rtl::OUString::valueOf( ( sal_Int64 ) level ) );
+	
+	m_aTemplates.push_back( templ );
+}
+
+void	XFIndex::AddTemplate(rtl::OUString level, rtl::OUString style, XFIndexTemplate* templ)
+{
+//	if( level<1 || !templ )
+//		return;
+	
+//	if (level > m_nMaxLevel)
+//		m_nMaxLevel = level;
+
+	templ->SetLevel( level );
+	if(m_eType != enumXFIndexTOC) // TOC's styles are applied to template entries separately
+	{	
+		templ->SetStyleName( style );
+	}
+	m_aTemplates.push_back( templ );
+}
+
+void	XFIndex::AddEntry(rtl::OUString entry, rtl::OUString strParaStyle)
+{
+	XFParagraph *pPara = new XFParagraph();
+	pPara->SetStyleName(strParaStyle);
+	pPara->Add(entry);
+	pPara->Add(new XFTabStop());
+	XFContentContainer::Add(pPara);
+}
+
+sal_Int32	XFIndex::GetEntryCount()
+{
+	return GetCount();
+}
+
+void	XFIndex::SetProtected(sal_Bool protect)
+{
+	m_bProtect = protect;
+}
+
+void	XFIndex::SetSeparator(sal_Bool sep)
+{
+	m_bSeparator = sep;
+}
+
+void XFIndex::AddTocSource(sal_uInt16 nLevel, const rtl::OUString sStyleName)
+{
+	if (nLevel > MAX_TOC_LEVEL)
+	{
+		return;
+	}
+
+	m_aTOCSource[nLevel].push_back(sStyleName);
+}
+
+void XFIndex::SetDefaultAlphaIndex(rtl::OUString strDivision,sal_Bool bRunin, sal_Bool bSeparator)
+{
+	XFIndexTemplate * pTemplateSep = new XFIndexTemplate();
+	if (bSeparator)
+	{
+		SetSeparator(sal_True);
+		pTemplateSep->AddEntry(enumXFIndexTemplateText,A2OUSTR(""));
+	}
+	AddTemplate(A2OUSTR("separator"),A2OUSTR("Separator"),pTemplateSep);
+	
+	XFIndexTemplate * pTemplate1 = new XFIndexTemplate();
+	pTemplate1->AddEntry(enumXFIndexTemplateText,A2OUSTR(""));
+	pTemplate1->AddEntry(enumXFIndexTemplateTab,A2OUSTR(""));
+	pTemplate1->AddEntry(enumXFIndexTemplatePage,A2OUSTR(""));					
+	AddTemplate(Int32ToOUString(1),A2OUSTR("Primary"),pTemplate1);
+	
+	XFIndexTemplate * pTemplate2 = new XFIndexTemplate();
+	pTemplate2->AddEntry(enumXFIndexTemplateText,A2OUSTR(""));
+	pTemplate2->AddEntry(enumXFIndexTemplateTab,A2OUSTR(""));
+	pTemplate2->AddEntry(enumXFIndexTemplatePage,A2OUSTR(""));	
+	XFIndexTemplate * pTemplate3 = new XFIndexTemplate();
+	pTemplate3->AddEntry(enumXFIndexTemplateText,A2OUSTR(""));
+	pTemplate3->AddEntry(enumXFIndexTemplateTab,A2OUSTR(""));
+	pTemplate3->AddEntry(enumXFIndexTemplatePage,A2OUSTR(""));
+		
+	if (bRunin)
+	{
+		AddTemplate(Int32ToOUString(2),A2OUSTR("Primary"),pTemplate2);			
+		AddTemplate(Int32ToOUString(3),A2OUSTR("Primary"),pTemplate3);				
+	}
+	else
+	{
+		AddTemplate(Int32ToOUString(2),A2OUSTR("Secondary"),pTemplate2);			
+		AddTemplate(Int32ToOUString(3),A2OUSTR("Secondary"),pTemplate3);	
+	}
+}
+
+void	XFIndex::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	rtl::OUString strIndexName;
+	rtl::OUString strTplName;
+	rtl::OUString strSourceName;
+
+	if(m_eType == enumXFIndexTOC )
+	{
+		strIndexName = A2OUSTR("text:table-of-content");
+		strSourceName = A2OUSTR("text:table-of-content-source");
+		strTplName = A2OUSTR("text:table-of-content-entry-template");
+	}
+	else if( m_eType == enumXFIndexAlphabetical )
+	{
+		strIndexName = A2OUSTR("text:alphabetical-index");
+		strSourceName = A2OUSTR("text:alphabetical-index-source");
+		strTplName = A2OUSTR("text:alphabetical-index-entry-template");
+	}
+	else if( m_eType == enumXFIndexUserIndex )
+	{
+		strIndexName = A2OUSTR("text:user-index");
+		strSourceName = A2OUSTR("text:text:user-index-source");
+		strTplName = A2OUSTR("text:user-index-entry-template");
+	}
+	else if( m_eType == enumXFIndexObject )
+	{
+		strIndexName = A2OUSTR("text:object-index");
+		strSourceName = A2OUSTR("text:object-index-source");
+		strTplName = A2OUSTR("text:object-index-entry-template");
+	}
+	else if( m_eType == enumXFIndexIllustration )
+	{
+		strIndexName = A2OUSTR("text:illustration-index");
+		strSourceName = A2OUSTR("text:illustration-index-source");
+		strTplName = A2OUSTR("text:illustration-index-entry-template");
+	}
+	else if( m_eType == enumXFIndexTableIndex )
+	{
+		strIndexName = A2OUSTR("text:table-index");
+		strSourceName = A2OUSTR("text:table-index-source");
+		strTplName = A2OUSTR("text:table-index-entry-template");
+	}
+
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	if( m_bProtect )
+		pAttrList->AddAttribute( A2OUSTR("text:protected"), A2OUSTR("true") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("text:protected"), A2OUSTR("false") );
+
+	pAttrList->AddAttribute( A2OUSTR("text:name"), m_strTitle );
+	pStrm->StartElement( strIndexName );
+
+	//text:table-of-content-source:
+	pAttrList->Clear();
+	
+	if(m_eType == enumXFIndexTOC )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:outline-level"), Int32ToOUString(10));
+		pAttrList->AddAttribute( A2OUSTR("text:use-index-source-styles"), A2OUSTR("true"));
+		pAttrList->AddAttribute( A2OUSTR("text:use-index-marks"), A2OUSTR("true"));
+		pAttrList->AddAttribute( A2OUSTR("text:use-outline-level"), A2OUSTR("false"));
+	}
+	if (m_bSeparator)
+		pAttrList->AddAttribute( A2OUSTR("text:alphabetical-separators"), A2OUSTR("true") );
+		
+	pStrm->StartElement( strSourceName );
+	//title template:
+	pAttrList->Clear();
+	
+	pStrm->StartElement( A2OUSTR("text:index-title-template") );
+	pStrm->Characters( m_strTitle );
+	pStrm->EndElement( A2OUSTR("text:index-title-template") );
+
+	//entry templates:
+	std::vector<XFIndexTemplate *>::iterator it;
+	for (it = m_aTemplates.begin(); it != m_aTemplates.end(); it++)
+	{
+		(*it)->SetTagName( strTplName);
+		(*it)->ToXml(pStrm);
+	}
+	
+	// by 
+	if(m_eType == enumXFIndexTOC )
+	{
+		for(sal_uInt16 i=1; i <= MAX_TOC_LEVEL; i++)
+		{
+			if (m_aTOCSource[i].size() == 0)
+			{
+				// unnecessary to output this level
+				continue;
+			}
+			
+			pAttrList->Clear();
+			pAttrList->AddAttribute( A2OUSTR("text:outline-level"), Int32ToOUString(i));
+			pStrm->StartElement( A2OUSTR("text:index-source-styles") );
+
+			std::vector<rtl::OUString>::iterator it;
+			for (it = m_aTOCSource[i].begin(); it != m_aTOCSource[i].end(); it++)
+			{
+				pAttrList->Clear();
+				pAttrList->AddAttribute( A2OUSTR("text:style-name"), *it);
+				pStrm->StartElement( A2OUSTR("text:index-source-style") );
+				pStrm->EndElement( A2OUSTR("text:index-source-style") );
+			}
+			pStrm->EndElement( A2OUSTR("text:index-source-styles") );		
+		}
+	}
+		
+	pStrm->EndElement( strSourceName );
+
+	//index-body:
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:index-body") );
+	//index-title:
+	if(m_strTitle.getLength())
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:name"), m_strTitle + A2OUSTR("_Head") );
+		pStrm->StartElement( A2OUSTR("text:index-title") );
+		if( m_pTitle )
+			m_pTitle->ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("text:index-title") );
+	}
+	
+	XFContentContainer::ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("text:index-body") );
+
+	pStrm->EndElement( strIndexName );
+}
+
+
+void XFIndexTemplate::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("text:outline-level"), m_nLevel );
+	pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_strStyle );
+	if( m_strTagName.getLength() == 0 )
+		m_strTagName = A2OUSTR("text:table-of-content-entry-template");
+	pStrm->StartElement( m_strTagName );		
+	
+	for( size_t i=0; i<m_aEntries.size(); i++ )
+	{
+		pAttrList->Clear();
+		
+		switch( m_aEntries[i].first )
+		{
+		case enumXFIndexTemplateChapter:
+			if(m_aEntries[i].second.getLength() > 0)
+				pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_aEntries[i].second );
+
+			pStrm->StartElement( A2OUSTR("text:index-entry-chapter-number") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-chapter-number") );
+			break;
+		case enumXFIndexTemplateText:
+			if(m_aEntries[i].second.getLength() > 0)
+				pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_aEntries[i].second );
+
+			pStrm->StartElement( A2OUSTR("text:index-entry-text") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-text") );
+			break;
+		case enumXFIndexTemplateTab:	
+			if( m_eTabType != enumXFTabRight )
+				pAttrList->AddAttribute( A2OUSTR("style:position"), DoubleToOUString(m_fTabLength) + A2OUSTR("cm") );
+
+			if(m_aEntries[i].second.getLength() > 0)
+				pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_aEntries[i].second );
+			
+			switch(m_eTabType)
+			{
+			case enumXFTabLeft:
+				pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("left") );
+				break;
+			case enumXFTabCenter:
+				pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("center") );
+				break;
+			case enumXFTabRight:
+				pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("right") );
+				break;
+			case enumXFTabChar:
+				pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("char") );		
+				break;
+			}
+			//delimiter:
+			if( m_eTabType == enumXFTabChar )
+				pAttrList->AddAttribute( A2OUSTR("style:char"), m_strTabDelimiter );
+			//leader char:
+			if( m_strTabLeader.getLength() )
+				pAttrList->AddAttribute( A2OUSTR("style:leader-char"), m_strTabLeader );
+			
+			pStrm->StartElement( A2OUSTR("text:index-entry-tab-stop") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-tab-stop") );
+			break;
+		case enumXFIndexTemplatePage:
+			if(m_aEntries[i].second.getLength() > 0)
+				pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_aEntries[i].second );
+			
+			pStrm->StartElement( A2OUSTR("text:index-entry-page-number") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-page-number") );
+			break;
+		case enumXFIndexTemplateLinkStart:
+			pStrm->StartElement( A2OUSTR("text:index-entry-link-start") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-link-start") );
+			break;
+		case enumXFIndexTemplateLinkEnd:
+			pStrm->StartElement( A2OUSTR("text:index-entry-link-end") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-link-end") );
+			break;
+		case enumXFIndexTemplateSpan:
+			pAttrList->Clear();
+			pAttrList->AddAttribute(A2OUSTR("text:style-name"), GetStyleName());
+			pStrm->StartElement( A2OUSTR("text:index-entry-span") );
+			pStrm->Characters(m_aTextEntries[i]);
+			pStrm->EndElement( A2OUSTR("text:index-entry-span") );
+			break;
+		case enumXFIndexTemplateBibliography:
+			pStrm->StartElement( A2OUSTR("text:index-entry-bibliography") );
+			pStrm->EndElement( A2OUSTR("text:index-entry-bibliography") );
+			break;
+		}
+	}
+	
+	pStrm->EndElement( m_strTagName );
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfindex.hxx lotuswordpro/source/filter/xfilter/xfindex.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfindex.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfindex.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,282 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Represente index source,index body and index index entry.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-02	create and implemente.
+ ************************************************************************/
+#ifndef		_XFINDEX_HXX
+#define		_XFINDEX_HXX
+#include <map>
+#include <vector>
+
+#include	"xfcontent.hxx"
+#include	"ixfproperty.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	"xftabstop.hxx"
+
+class XFIndex;
+class XFIndexEntry;
+class XFIndexTemplate;
+class XFParagraph;
+
+/**
+ * @brief
+ * Index template.
+ * When index update, the template is used to decide the index body.
+ */
+class XFIndexTemplate : public XFContent
+{
+public:
+	XFIndexTemplate();
+	
+public:
+	/**
+	 * @descr	Set template level. 
+	 */
+	void	SetLevel(rtl::OUString level);
+	/**
+	 * @descr	Set style. 
+	 */
+	void	SetStyleName(rtl::OUString style);
+	/**
+	 * @descr	Add a entry in the template. 
+	 */
+	void	AddEntry(enumXFIndexTemplate entry, rtl::OUString styleName = A2OUSTR(""));
+	
+	/**
+	 * @descr	Add a tab entry in the template. 
+	 */
+	void	AddTabEntry(enumXFTab type, double len, sal_Unicode leader = '*', sal_Unicode delimiter='.', rtl::OUString styleName = A2OUSTR(""));
+
+	/**
+	 * @descr	Add a entry in the template. 
+	 */
+	void	AddTextEntry(rtl::OUString sSpan, rtl::OUString styleName = A2OUSTR(""));
+
+	/**
+	 * @descr	clear all index template parts. 
+	 */
+	void	Clear();
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	/**
+	 * @descr	Helper function. 
+	 */
+	void	SetTagName(rtl::OUString tag);
+	
+	friend class XFIndex;
+private:
+	rtl::OUString	m_nLevel;
+	rtl::OUString	m_strStyle;
+	enumXFTab	m_eTabType;
+	double		m_fTabLength;
+	rtl::OUString	m_strTabDelimiter;
+	rtl::OUString	m_strTabLeader;
+	rtl::OUString	m_strTagName;
+	typedef std::pair<enumXFIndexTemplate, rtl::OUString> TOCTEMPLATE_ENTRY_TYPE;
+	std::vector<TOCTEMPLATE_ENTRY_TYPE>	m_aEntries; // template entry + text style
+	std::map<sal_uInt16, rtl::OUString> m_aTextEntries;
+
+	rtl::OUString m_strChapterTextStyle;
+};
+
+/**
+ * @brief
+ * Index, include index template, index body.
+ */
+class XFIndex : public XFContentContainer
+{
+public:
+	XFIndex();
+	
+	virtual ~XFIndex();
+
+public:
+	/**
+	 * @descr	Set index type. 
+	 */
+	void	SetIndexType(enumXFIndex type);
+
+	/**
+	 * @descr	Set index section style. Perhaps you should create a section style first. 
+	 */
+	void	SetSectionStyle(rtl::OUString strSectStyleName);
+
+	/**
+	 * @descr	Set index title. 
+	 */
+	void	SetTitle(rtl::OUString title, rtl::OUString strParaStyle);
+
+	/**
+	 * @descr	Set index entry template.
+	 * @param	level [1-10].
+	 */
+	void	AddTemplate(sal_uInt32 level, 
+		rtl::OUString style, 
+		enumXFIndexTemplate type1 = enumXFIndexTemplateChapter,
+		enumXFIndexTemplate type2 = enumXFIndexTemplateText,
+		enumXFIndexTemplate type3 = enumXFIndexTemplateTab,
+		enumXFIndexTemplate type4 = enumXFIndexTemplatePage);
+
+	/**
+	 * @descr	Add index templaet entry. 
+	 */
+	void	AddTemplate(rtl::OUString level, rtl::OUString style, XFIndexTemplate* templ);
+
+	/**
+	 * @descr	Add index entry. 
+	 */
+	void	AddEntry(rtl::OUString entry, rtl::OUString strParaStyle);
+
+	/**
+	 * @descr	return entry count. 
+	 */
+	sal_Int32	GetEntryCount();
+
+	/**
+	 * @descr	Set if protected index to prevent handly-revise. 
+	 */
+	void	SetProtected(sal_Bool protect);
+	
+	/**
+	 * @descr	Set separator. 
+	 */
+	void	SetSeparator(sal_Bool sep);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+	void AddTocSource(sal_uInt16 nLevel, const rtl::OUString sStyleName);
+	
+	/**
+	 * @descr	Set default value for index. 
+	 */
+	void SetDefaultAlphaIndex(rtl::OUString strDivision,sal_Bool bRunin, sal_Bool bSeparator);
+
+private:
+	enumXFIndex		m_eType;
+	rtl::OUString		m_strTitle;
+	rtl::OUString		m_strSectStyle;
+	bool				m_bProtect;
+	bool			m_bSeparator;
+	XFParagraph		*m_pTitle;
+
+	std::vector<XFIndexTemplate *>	m_aTemplates; // template entry + style
+
+	#define MAX_TOC_LEVEL 10
+	std::vector<rtl::OUString> m_aTOCSource[MAX_TOC_LEVEL+1];
+
+	sal_uInt32		m_nMaxLevel;
+};
+
+inline XFIndexTemplate::XFIndexTemplate()
+{
+	m_nLevel = Int32ToOUString(0);
+}
+
+inline void XFIndexTemplate::SetLevel(rtl::OUString level)
+{
+	m_nLevel = level;
+}
+inline void XFIndexTemplate::SetStyleName(rtl::OUString style)
+{
+	m_strStyle = style;
+}
+
+inline void XFIndexTemplate::SetTagName(rtl::OUString tag)
+{
+	m_strTagName = tag;
+}
+
+inline void XFIndexTemplate::AddEntry(enumXFIndexTemplate entry, rtl::OUString styleName)
+{
+	std::pair<enumXFIndexTemplate, rtl::OUString> pair(entry, styleName);
+	m_aEntries.push_back(pair);
+}
+
+inline void XFIndexTemplate::AddTabEntry(enumXFTab type, double len, sal_Unicode leader, sal_Unicode delimiter, rtl::OUString styleName)
+{
+	m_eTabType = type;
+	m_strTabLeader = rtl::OUString( leader );
+	m_strTabDelimiter = rtl::OUString( delimiter );
+	m_fTabLength = len;
+
+	AddEntry(enumXFIndexTemplateTab, styleName);
+}
+
+inline void XFIndexTemplate::AddTextEntry(rtl::OUString sText, rtl::OUString styleName)
+{
+	sal_uInt16 nLen = m_aEntries.size();
+	AddEntry(enumXFIndexTemplateSpan, styleName);
+
+	m_aTextEntries[nLen] = sText;
+}
+
+
+inline void XFIndexTemplate::Clear()
+{
+	m_aEntries.clear();
+}
+
+inline void XFIndex::SetIndexType(enumXFIndex type)
+{
+	m_eType = type;
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfinputlist.hxx lotuswordpro/source/filter/xfilter/xfinputlist.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfinputlist.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfinputlist.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,115 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * input list field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-27  create this file.
+ ************************************************************************/
+#ifndef		_XFINPUTLIST_HXX
+#define		_XFINPUTLIST_HXX
+
+#include	"xfcontent.hxx"
+
+/**
+ * @brief
+ * input list field.
+ */
+class XFInputList : public XFContent
+{
+public:
+	void SetName(rtl::OUString sName);
+	void SetLabels(std::vector<rtl::OUString> list);
+	virtual void	ToXml(IXFStream *pStrm);
+private:
+	rtl::OUString m_strName;
+	std::vector<rtl::OUString> m_list;
+};
+
+inline void XFInputList::SetName(rtl::OUString sName)
+{
+	m_strName = sName;
+}
+
+inline void XFInputList::SetLabels(std::vector<rtl::OUString> list)
+{
+	m_list=list;
+}
+
+inline void XFInputList::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("text:name"), m_strName );
+	pStrm->StartElement( A2OUSTR("text:drop-down") );
+	
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("text:value"), A2OUSTR(" ") );
+	pStrm->StartElement( A2OUSTR("text:label") );
+	pStrm->EndElement( A2OUSTR("text:label") );
+	for(sal_uInt32 i=0; i< m_list.size();i++)
+	{
+		pAttrList->Clear();
+		pAttrList->AddAttribute( A2OUSTR("text:value"), m_list[i] );
+		pStrm->StartElement( A2OUSTR("text:label") );
+		pStrm->EndElement( A2OUSTR("text:label") );
+	}
+	pStrm->EndElement( A2OUSTR("text:drop-down") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflinebreak.hxx lotuswordpro/source/filter/xfilter/xflinebreak.hxx
--- lotuswordpro.bak/source/filter/xfilter/xflinebreak.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflinebreak.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,84 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/**************************************************************************
+ * @file 
+ * Line break object,<text:line-break/>
+ *************************************************************************/
+/**************************************************************************
+ * Change History
+ * 2004-01-11 create this file.
+ *************************************************************************/
+#ifndef		_XFLINEBREAK_HXX
+#define		_XFLINEBREAK_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+class XFLineBreak : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+inline void	XFLineBreak::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:line-break") );
+	pStrm->EndElement( A2OUSTR("text:line-break") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflineheight.hxx lotuswordpro/source/filter/xfilter/xflineheight.hxx
--- lotuswordpro.bak/source/filter/xfilter/xflineheight.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflineheight.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,176 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line height for paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFLINEHEIGHT_HXX
+#define		_XFLINEHEIGHT_HXX
+
+class XFLineHeight
+{
+public:
+	XFLineHeight()
+	{
+		Reset();
+	}
+public:	
+	void	SetHeight(double value);
+
+	void	SetLeastHeight(double value);
+
+	void	SetPercent(sal_Int32 value);
+
+	void	SetSpace(double value);
+
+	void	Reset();
+
+	void	ToXml(IXFStream *pStrm);
+
+	enumLHType GetType();
+	
+	friend bool operator==(XFLineHeight& indent1, XFLineHeight& indent2);
+	friend bool operator!=(XFLineHeight& indent1, XFLineHeight& indent2);
+private:
+	union{
+		sal_Int32	m_nValue;
+		double		m_fValue;
+	}m_Value;
+	enumLHType		m_eType;
+};
+
+inline void XFLineHeight::SetHeight(double value)
+{
+	m_Value.m_fValue = value;
+	m_eType = enumLHHeight;
+}
+
+inline void XFLineHeight::SetLeastHeight(double value)
+{
+	m_Value.m_fValue = value;
+	m_eType = enumLHLeast;
+}
+
+inline void XFLineHeight::SetPercent(sal_Int32 value)
+{
+	m_Value.m_nValue = value;
+	m_eType = enumLHPercent;
+}
+inline void XFLineHeight::SetSpace(double value)
+{
+	m_Value.m_fValue = value;
+	m_eType = enumLHSpace;
+}	
+inline void XFLineHeight::Reset()
+{
+	m_eType = enumLHNone;
+	rtl_zeroMemory(&m_Value,sizeof(m_Value));
+}		
+
+inline enumLHType XFLineHeight::GetType()
+{ 
+	return m_eType; 
+}
+
+inline void XFLineHeight::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();	
+		
+	switch(m_eType)
+	{
+	case enumLHNone:
+		return;
+	case enumLHHeight:
+		pAttrList->AddAttribute( A2OUSTR("fo:line-height"),DoubleToOUString(m_Value.m_fValue) + A2OUSTR("cm") );
+		break;
+	case enumLHLeast:
+		pAttrList->AddAttribute( A2OUSTR("style:line-height-at-least"),DoubleToOUString(m_Value.m_fValue) + A2OUSTR("cm") );
+		break;
+	case enumLHPercent:
+		pAttrList->AddAttribute( A2OUSTR("fo:line-height"), DoubleToOUString(m_Value.m_nValue) + A2OUSTR("%") );
+		break;
+	case enumLHSpace:
+		pAttrList->AddAttribute( A2OUSTR("style:line-spacing"), DoubleToOUString(m_Value.m_fValue) + A2OUSTR("cm") );
+		break;
+	}
+}
+
+inline bool operator==(XFLineHeight& lh1, XFLineHeight& lh2)
+{
+	if( lh1.m_eType != lh2.m_eType )
+		return false;
+	if( lh1.m_eType == enumLHPercent )
+	{
+		if( lh1.m_Value.m_nValue != lh2.m_Value.m_nValue )
+			return false;
+	}
+	else
+	{
+		if( lh1.m_Value.m_fValue != lh2.m_Value.m_fValue )
+			return false;
+	}
+	return true;
+}
+
+inline bool operator!=(XFLineHeight& lh1, XFLineHeight& lh2)
+{
+	return !(lh1==lh2);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflinenumberconfig.hxx lotuswordpro/source/filter/xfilter/xflinenumberconfig.hxx
--- lotuswordpro.bak/source/filter/xfilter/xflinenumberconfig.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflinenumberconfig.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,211 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Line numbering config for the full document.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-23 create this file.
+ ************************************************************************/
+#ifndef		_XFLINENUMBERCONFIG_HXX
+#define		_XFLINENUMBERCONFIG_HXX
+
+#include	"xfstyle.hxx"
+
+class XFLineNumberConfig : public XFStyle
+{
+public:
+	XFLineNumberConfig();
+
+public:
+	void	SetNumberOffset(double offset);
+
+	void	SetNumberPosition(enumXFLineNumberPos pos);
+	
+	void	SetNumberIncrement(sal_Int32 increment);
+
+	void	SetSeperator(sal_Int32 increment, rtl::OUString seperator);
+
+	void	SetNumberFormat(rtl::OUString numfmt = A2OUSTR("1"));
+
+	void	SetTextStyle(rtl::OUString style);
+
+	void	SetRestartOnPage(sal_Bool restart = sal_True);
+
+	void	SetCountEmptyLines(sal_Bool empty = sal_True);
+
+	void	SetCountFrameLines(sal_Bool frame = sal_True);
+
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	enumXFLineNumberPos	m_ePosition;
+	double		m_fOffset;
+	sal_Int32	m_nIncrement;
+	sal_Int32	m_nSepIncrement;
+	rtl::OUString	m_strSeparator;
+	rtl::OUString	m_strNumFmt;
+	rtl::OUString	m_strTextStyle;
+	sal_Bool	m_bRestartOnPage;
+	sal_Bool	m_bCountEmptyLines;
+	sal_Bool	m_bCountFrameLines;
+};
+
+inline XFLineNumberConfig::XFLineNumberConfig()
+{
+	m_fOffset = 0;
+	m_nIncrement = 5;
+	m_nSepIncrement = 3;
+	m_bRestartOnPage = sal_False;
+	m_bCountEmptyLines = sal_True;
+	m_bCountFrameLines = sal_False;
+}
+
+inline void XFLineNumberConfig::SetNumberOffset(double offset)
+{
+	m_fOffset = offset;
+}
+
+inline void XFLineNumberConfig::SetNumberPosition(enumXFLineNumberPos	position)
+{
+	m_ePosition = position;
+}
+
+inline void XFLineNumberConfig::SetNumberIncrement(sal_Int32 increment)
+{
+	m_nIncrement = increment;
+}
+
+inline void XFLineNumberConfig::SetSeperator(sal_Int32 increment, rtl::OUString seperator)
+{
+	m_nSepIncrement = increment;
+	m_strSeparator = seperator;
+}
+
+inline void XFLineNumberConfig::SetNumberFormat(rtl::OUString numfmt)
+{
+	m_strNumFmt = numfmt;
+}
+
+inline void XFLineNumberConfig::SetTextStyle(rtl::OUString style)
+{
+	m_strTextStyle = style;
+}
+
+inline void XFLineNumberConfig::SetRestartOnPage(sal_Bool restart)
+{
+	m_bRestartOnPage = restart;
+}
+
+inline void XFLineNumberConfig::SetCountEmptyLines(sal_Bool empty)
+{
+	m_bCountEmptyLines = empty;
+}
+
+inline void XFLineNumberConfig::SetCountFrameLines(sal_Bool frame)
+{
+	m_bCountFrameLines = frame;
+}
+
+inline void XFLineNumberConfig::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	
+	if( m_strTextStyle.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), m_strTextStyle );
+	pAttrList->AddAttribute( A2OUSTR("text:offset"), DoubleToOUString(m_fOffset) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("style:num-format"), m_strNumFmt );
+	//position:
+	if( m_ePosition == enumXFLineNumberLeft )
+		pAttrList->AddAttribute( A2OUSTR("text:number-position"), A2OUSTR("left") );
+	else if( m_ePosition == enumXFLineNumberRight )
+		pAttrList->AddAttribute( A2OUSTR("text:number-position"), A2OUSTR("right") );
+	else if( m_ePosition == enumXFLineNumberInner )
+		pAttrList->AddAttribute( A2OUSTR("text:number-position"), A2OUSTR("inner") );
+	else if( m_ePosition == enumXFLineNumberOutter )
+		pAttrList->AddAttribute( A2OUSTR("text:number-position"), A2OUSTR("outter") );
+
+	pAttrList->AddAttribute( A2OUSTR("text:increment"), Int32ToOUString(m_nIncrement) );
+
+	if( m_bRestartOnPage )
+		pAttrList->AddAttribute( A2OUSTR("text:restart-on-page"), A2OUSTR("true") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("text:restart-on-page"), A2OUSTR("false") );
+
+	if( m_bCountEmptyLines )
+		pAttrList->AddAttribute( A2OUSTR("text:count-empty-lines"), A2OUSTR("true") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("text:count-empty-lines"), A2OUSTR("false") );
+
+	if( m_bCountFrameLines )	
+		pAttrList->AddAttribute( A2OUSTR("text:count-in-floating-frames"), A2OUSTR("true") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("text:count-in-floating-frames"), A2OUSTR("false") );
+
+
+	pStrm->StartElement( A2OUSTR("text:linenumbering-configuration") );
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("text:increment"), Int32ToOUString(m_nSepIncrement) );
+	pStrm->StartElement( A2OUSTR("text:linenumbering-separator") );
+	pStrm->Characters(m_strSeparator);
+	pStrm->EndElement( A2OUSTR("text:linenumbering-separator") );
+
+	pStrm->EndElement( A2OUSTR("text:linenumbering-configuration") );	
+}
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflist.cxx lotuswordpro/source/filter/xfilter/xflist.cxx
--- lotuswordpro.bak/source/filter/xfilter/xflist.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflist.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,189 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * List object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#include	"xflist.hxx"
+#include	"xflistitem.hxx"
+#include	"ixfstream.hxx"
+#include	"ixfattrlist.hxx"
+
+XFList::XFList()
+{
+	m_bOrdered = sal_True;
+	m_bContinueNumber = sal_False;
+	m_pHeader = NULL;
+}
+
+XFList::XFList(sal_Bool ordered)
+{
+	m_bOrdered = ordered;
+	m_bContinueNumber = sal_False;
+}
+
+XFList::~XFList()
+{	
+}
+
+void	XFList::AddItem(XFListItem *pItem)
+{
+	assert(pItem);
+	assert(pItem->GetContentType()!=enumXFContentUnknown);
+
+	Add(pItem);
+}
+
+void	XFList::AddItem(rtl::OUString text)
+{
+	XFListItem *pItem = new XFListItem();
+	pItem->Add(text);
+	AddItem(pItem);
+}
+
+void	XFList::SetHeader(XFListItem *pItem)
+{
+	if( m_pHeader )
+		delete m_pHeader;
+	pItem->SetIsHeader(sal_True);
+	m_pHeader = pItem;
+}
+
+void	XFList::ToXml(IXFStream *pStrm)
+{	
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	assert(NULL!=pAttrList);
+	
+	pAttrList->Clear();	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	if( m_bContinueNumber )
+		pAttrList->AddAttribute( A2OUSTR("text:continue-numbering"), A2OUSTR("true") );
+	
+	if( m_bOrdered )
+		pStrm->StartElement( A2OUSTR("text:ordered-list") );
+	else
+		pStrm->StartElement( A2OUSTR("text:unordered-list") );
+	
+	if( m_pHeader )
+	{
+		m_pHeader->ToXml(pStrm);
+	}
+	XFContentContainer::ToXml(pStrm);
+
+	if( m_bOrdered )
+		pStrm->EndElement( A2OUSTR("text:ordered-list") );
+	else
+		pStrm->EndElement( A2OUSTR("text:unordered-list") );
+}
+
+void	XFList::StartList(IXFStream *pStrm, sal_Bool bContinueNumber)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	assert(NULL!=pAttrList);
+	
+	pAttrList->Clear();	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	if( bContinueNumber )
+		pAttrList->AddAttribute( A2OUSTR("text:continue-numbering"), A2OUSTR("true") );
+
+	if( m_bOrdered )
+		pStrm->StartElement( A2OUSTR("text:ordered-list") );
+	else
+		pStrm->StartElement( A2OUSTR("text:unordered-list") );
+}
+
+void	XFList::EndList(IXFStream *pStrm)
+{
+	if( m_bOrdered )
+		pStrm->EndElement( A2OUSTR("text:ordered-list") );
+	else
+		pStrm->EndElement( A2OUSTR("text:unordered-list") );
+}
+
+void	XFList::StartListHeader(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pStrm->StartElement( A2OUSTR("text:list-header") );
+}
+
+void	XFList::EndListHeader(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	pStrm->EndElement( A2OUSTR("text:list-header") );
+}
+
+void	XFList::StartListItem(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	assert(NULL!=pAttrList);
+	
+	pAttrList->Clear();	
+	pStrm->StartElement( A2OUSTR("text:list-item") );
+}
+
+void	XFList::EndListItem(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:list-item") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflist.hxx lotuswordpro/source/filter/xfilter/xflist.hxx
--- lotuswordpro.bak/source/filter/xfilter/xflist.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflist.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,163 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base list object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#ifndef		_XFLIST_HXX
+#define		_XFLIST_HXX
+
+#include	"xflistitem.hxx"
+#include	"xfcontentcontainer.hxx"
+
+class XFListItem;
+
+/**
+ * @brief
+ * list obejct for order-list and unordered-list.
+ */
+class	XFList : public XFContentContainer
+{
+public:
+	XFList();
+
+	XFList(sal_Bool ordered);
+
+	virtual ~XFList();
+
+public:
+	/**
+	 * @descr	Set whether it's an ordered list or an unordered list.
+	 */
+	void	SetOrdered(sal_Bool ordered);
+
+	/**
+	 * @descr	Set whether to continue to number list. 
+	 */
+	void	SetContinueNumber(sal_Bool bContinueNumber=sal_False);
+
+	/**
+	 * @descr	Add a list item. 
+	 */
+	void	AddItem(XFListItem *pItem);
+
+	/**
+	 * @descr	Add a simple text list item. 
+	 */
+	void	AddItem(rtl::OUString text);
+
+	/**
+	 * @descr	Set the header list item. There can only be one list header. 
+	 */
+	void	SetHeader(XFListItem *pItem);
+
+	/**
+	 * @descr	Output list obejct. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+	virtual void	StartList(IXFStream *pStrm, sal_Bool bContinueNumber = sal_False);
+
+	virtual void	EndList(IXFStream *pStrm);
+
+	static void		StartListHeader(IXFStream *pStrm);
+
+	static void		EndListHeader(IXFStream *pStrm);
+
+	static void		StartListItem(IXFStream *pStrm);
+
+	static void		EndListItem(IXFStream *pStrm);
+
+private:
+	sal_Bool	m_bOrdered;
+	sal_Bool	m_bContinueNumber;
+	XFListItem	*m_pHeader;
+	
+};
+
+class XFUnorderedList : public XFList
+{
+public:
+	XFUnorderedList()
+	{
+		SetOrdered(sal_False);
+	}
+};
+
+class XFOrderedList : public XFList
+{
+public:
+	XFOrderedList()
+	{
+		SetOrdered(sal_True);
+	}
+};
+
+inline void XFList::SetOrdered(sal_Bool ordered)
+{
+	m_bOrdered = ordered;
+}
+
+inline void XFList::SetContinueNumber(sal_Bool bContinueNumber)
+{
+	m_bContinueNumber = bContinueNumber;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xflistitem.hxx lotuswordpro/source/filter/xfilter/xflistitem.hxx
--- lotuswordpro.bak/source/filter/xfilter/xflistitem.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xflistitem.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,118 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * List item.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-17 create this file.
+ ************************************************************************/
+#ifndef		_XFLISTITEM_HXX
+#define		_XFLISTITEM_HXX
+
+#include	"xfcontent.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	"xfparagraph.hxx"
+
+class	XFListItem : public XFContentContainer
+{
+public:
+	XFListItem();
+
+public:	
+	void	SetIsHeader(sal_Bool isHeader=sal_True);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	sal_Bool	m_bIsHeader;
+};
+
+inline XFListItem::XFListItem()
+{
+	m_bIsHeader = sal_False;
+}
+
+inline void XFListItem::SetIsHeader(sal_Bool isHeader)
+{
+	m_bIsHeader = isHeader;
+}
+
+inline void XFListItem::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+
+	if( !m_bIsHeader )
+	{
+		pStrm->StartElement( A2OUSTR("text:list-item") );
+		XFContentContainer::ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("text:list-item") );
+	}
+	else
+	{
+		pStrm->StartElement( A2OUSTR("text:list-header") );
+		XFContentContainer::ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("text:list-header") );
+	}
+}
+
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfliststyle.cxx lotuswordpro/source/filter/xfilter/xfliststyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfliststyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfliststyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,346 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Styles for ordered list and unordered list.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-07	create the file.
+ * 2005-01-20	use XFNumFmt to fill XFListLevelNumber.
+ ************************************************************************/
+#include	"xfliststyle.hxx"
+
+XFListLevel::XFListLevel()
+{
+	m_nLevel = 0;	
+	m_nDisplayLevel = 0;
+	m_fIndent = 0;	
+	m_fMinLabelWidth = 0.499;	
+	m_fMinLabelDistance = 0;
+	m_eAlign = enumXFAlignStart;
+	m_eListType = enumXFListLevelNumber;
+}
+
+void XFListLevel::ToXml(IXFStream *pStrm)
+{	
+}
+
+//----------------------------------------------------
+
+void XFListlevelNumber::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("text:level"), Int16ToOUString(m_nLevel) );
+	//text:style-name,ignore now.
+	m_aNumFmt.ToXml(pStrm);	
+	if( m_nDisplayLevel )
+		pAttrList->AddAttribute( A2OUSTR("text:display-levels"), Int16ToOUString(m_nDisplayLevel) );
+	
+	pStrm->StartElement( A2OUSTR("text:list-level-style-number") );
+
+	//<style:properties>...</style:properties>
+	pAttrList->Clear();
+	if( m_fIndent > FLOAT_MIN )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:space-before"), DoubleToOUString(m_fIndent) + A2OUSTR("cm") );
+	}
+	if( m_fMinLabelWidth > FLOAT_MIN )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-width"), DoubleToOUString(m_fMinLabelWidth) + A2OUSTR("cm") );
+	}
+	if( m_fMinLabelDistance > FLOAT_MIN )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-distance"), DoubleToOUString(m_fMinLabelDistance) + A2OUSTR("cm") );
+	}
+	pAttrList->AddAttribute( A2OUSTR("fo:text-align"), GetAlignName(m_eAlign) );
+
+	
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("text:list-level-style-number") );
+}
+
+void	XFListLevelBullet::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("text:level"), Int16ToOUString(m_nLevel) );
+	//text:style-name,ignore now.
+	m_aNumFmt.ToXml(pStrm);
+	//bullet-char
+	rtl::OUString	bullet(m_chBullet);
+	pAttrList->AddAttribute( A2OUSTR("text:bullet-char"), bullet );	
+
+	pStrm->StartElement( A2OUSTR("text:list-level-style-bullet") );
+	
+	//<style:properties>...</style:properties>
+	pAttrList->Clear();
+	if( m_fIndent != 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:space-before"), DoubleToOUString(m_fIndent) + A2OUSTR("cm") );
+	}
+	if( m_fMinLabelWidth != 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-width"), DoubleToOUString(m_fMinLabelWidth) + A2OUSTR("cm") );
+	}
+	if( m_fMinLabelDistance != 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-distance"), DoubleToOUString(m_fMinLabelDistance) + A2OUSTR("cm") );
+	}
+	
+	pAttrList->AddAttribute( A2OUSTR("fo:text-align"), GetAlignName(m_eAlign) );
+
+	if( m_strFontName.getLength() > 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("style:font-name"), m_strFontName );
+	}
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+	
+	pStrm->EndElement( A2OUSTR("text:list-level-style-bullet") );
+}
+
+//----------------------------------------------------
+XFListStyle::XFListStyle()
+{
+	XFNumFmt	nf;
+	nf.SetSuffix( A2OUSTR(".") );
+	nf.SetFormat( A2OUSTR("1") );
+	
+	for( int i=0; i<10; i++ )
+	{
+		m_pListLevels[i] = new XFListlevelNumber();
+		m_pListLevels[i]->SetListlevelType(enumXFListLevelNumber);
+		m_pListLevels[i]->SetMinLabelWidth(0.499);
+		m_pListLevels[i]->SetIndent(0.501*(i+1));
+		m_pListLevels[i]->SetLevel(i+1);
+		( (XFListlevelNumber*)m_pListLevels[i])->SetNumFmt(nf);
+	}	
+}
+
+XFListStyle::XFListStyle(const XFListStyle& other)
+{
+	enumXFListLevel type;
+	for( int i=0; i<10; i++ )
+	{
+		type = other.m_pListLevels[i]->m_eListType;
+		if( type == enumXFListLevelNumber )
+		{
+			XFListlevelNumber *pNum = (XFListlevelNumber*)other.m_pListLevels[i];
+			m_pListLevels[i] = new XFListlevelNumber(*pNum);
+		}
+		else if( type == enumXFListLevelBullet )
+		{
+			XFListLevelBullet *pBullet = (XFListLevelBullet*)other.m_pListLevels[i];
+			m_pListLevels[i] = new XFListLevelBullet(*pBullet);
+		}
+		else
+			m_pListLevels[i] = NULL;
+	}
+}
+
+XFListStyle& XFListStyle::operator=(const XFListStyle& other)
+{
+	enumXFListLevel type;
+	for( int i=0; i<10; i++ )
+	{
+		type = other.m_pListLevels[i]->m_eListType;
+		if( type == enumXFListLevelNumber )
+		{
+			XFListlevelNumber *pNum = (XFListlevelNumber*)m_pListLevels[i];
+			m_pListLevels[i] = new XFListlevelNumber(*pNum);
+		}
+		else if( type == enumXFListLevelBullet )
+		{
+			XFListLevelBullet *pBullet = (XFListLevelBullet*)m_pListLevels[i];
+			m_pListLevels[i] = new XFListLevelBullet(*pBullet);
+		}
+		else
+			m_pListLevels[i] = NULL;
+	}
+	return *this;
+}
+
+XFListStyle::~XFListStyle()
+{
+	for( int i=0; i<10; i++ )
+	{
+		if( m_pListLevels[i] )
+			delete m_pListLevels[i];
+	}
+}
+
+void	XFListStyle::SetDisplayLevel(sal_Int32 level, sal_Int16 nDisplayLevel)
+{
+	assert(level>=1&&level<=10);
+	
+	XFListLevel *pLevel = m_pListLevels[level-1];
+	if( !pLevel )
+	{
+		pLevel = new XFListlevelNumber();
+		pLevel->SetListlevelType(enumXFListLevelNumber);
+		pLevel->SetLevel(level+1);
+		pLevel->SetMinLabelWidth(0.499);
+		pLevel->SetIndent(0.501*(level+1));
+		pLevel->SetDisplayLevel(nDisplayLevel);		
+		m_pListLevels[level-1] = pLevel;
+	}
+	else
+		pLevel->SetDisplayLevel(nDisplayLevel);
+}
+
+void	XFListStyle::SetListPosition(sal_Int32 level,
+				double indent,
+				double minLabelWidth,
+				double minLabelDistance,
+				enumXFAlignType	align
+				)
+{
+	assert(level>=1&&level<=10);
+	
+	XFListLevel *pLevel = m_pListLevels[level-1];
+	if( !pLevel )
+	{
+		XFListLevelBullet *	pLevel = new XFListLevelBullet();
+		pLevel->SetListlevelType(enumXFListLevelNumber);
+		pLevel->SetLevel(level+1);
+		pLevel->SetIndent(indent);
+		pLevel->SetMinLabelWidth(minLabelWidth);
+		pLevel->SetMinLabelDistance(minLabelDistance);
+		pLevel->SetAlignType(align);
+		m_pListLevels[level-1] = pLevel;	
+	}
+	else
+	{
+		pLevel->SetIndent(indent);
+		pLevel->SetMinLabelWidth(minLabelWidth);
+		pLevel->SetMinLabelDistance(minLabelDistance);
+		pLevel->SetAlignType(align);
+	}
+}
+
+void	XFListStyle::SetListBullet(sal_Int32 level, 
+								   UChar32 bullet,
+								   rtl::OUString fontname,
+								   rtl::OUString prefix, 
+								   rtl::OUString suffix								   
+								   )
+{
+	assert(level>=1&&level<=10);
+	
+	if( m_pListLevels[level-1] )
+		delete m_pListLevels[level-1];
+
+	XFListLevelBullet *pLevel = new XFListLevelBullet();
+	pLevel->SetPrefix(prefix);
+	pLevel->SetSuffix(suffix);
+	pLevel->SetBulletChar(bullet);
+	pLevel->SetFontName(fontname);
+	//
+	pLevel->SetListlevelType(enumXFListLevelBullet);
+	pLevel->SetMinLabelWidth(0.499);
+	pLevel->SetIndent(0.501*level);
+	pLevel->SetLevel(level);
+	m_pListLevels[level-1] = pLevel;
+}
+
+void	XFListStyle::SetListNumber(sal_Int32 level, XFNumFmt& fmt, sal_Int16 start )
+{
+	assert(level>=1&&level<=10);
+	
+	if( m_pListLevels[level-1] )
+		delete m_pListLevels[level-1];
+	
+	XFListlevelNumber *pLevel = new XFListlevelNumber();
+	pLevel->SetNumFmt(fmt);
+	pLevel->SetStartValue(start);
+	//
+	pLevel->SetListlevelType(enumXFListLevelNumber);
+	pLevel->SetMinLabelWidth(0.499);
+	pLevel->SetIndent(0.501*level);
+	pLevel->SetLevel(level);
+	m_pListLevels[level-1] = pLevel;
+}
+
+void XFListStyle::ToXml(IXFStream *pStrm)
+{
+	std::vector<XFListLevel*>::iterator it;
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pStrm->StartElement( A2OUSTR("text:list-style") );
+
+	for( int i=0; i<10; i++ )
+	{
+		XFListLevel *pLevel = m_pListLevels[i];
+		if( pLevel )
+			pLevel->ToXml(pStrm);
+	}
+
+	pStrm->EndElement( A2OUSTR("text:list-style") );
+}
+
+
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfliststyle.hxx lotuswordpro/source/filter/xfilter/xfliststyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfliststyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfliststyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,269 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+* @file 
+* Styles for ordered list and unordered list.
+************************************************************************/
+/*************************************************************************
+* Change History
+* 2005-1-7	create the file.
+************************************************************************/
+#ifndef		_XFLISTSTYLE_HXX
+#define		_XFLISTSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfnumfmt.hxx"
+#include	"unicode/utypes.h"
+#include	<vector>
+
+class IXFStream;
+
+enum enumXFListLevel
+{
+	enumXFListLevelBullet,
+	enumXFListLevelNumber,
+	enumXFListLevelImage
+};
+
+/**************************************************************************
+ * @descr
+ * Bullet style wrapper,the underline bullet type can be:
+ *		number,image,or bullet.
+ *************************************************************************/
+class  XFListLevel
+{
+public:
+	XFListLevel();
+
+	virtual ~XFListLevel(){}
+	
+	void	SetListlevelType(enumXFListLevel type);
+
+	void	SetLevel(sal_Int16 level);
+
+	void	SetDisplayLevel(sal_Int16 nDisplayLevel);
+
+	void	SetIndent(double indent);	
+
+	void	SetMinLabelWidth(double labelWidth);	
+
+	void	SetMinLabelDistance(double distance);
+
+	void	SetAlignType(enumXFAlignType align);
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+	friend class XFListStyle;
+protected:
+	sal_Int16	m_nLevel;
+	sal_Int16	m_nDisplayLevel;
+	double		m_fIndent;	
+	double		m_fMinLabelWidth;	
+	double		m_fMinLabelDistance;
+	enumXFAlignType	m_eAlign;
+	enumXFListLevel	m_eListType;
+};
+
+class XFListlevelNumber : public XFListLevel
+{
+public:
+	XFListlevelNumber()
+	{ 
+		m_eListType = enumXFListLevelNumber; 
+	}
+public:
+	void	SetNumFmt(XFNumFmt& fmt)
+	{
+		m_aNumFmt = fmt;
+	}
+
+	void	SetStartValue(sal_Int16 start)
+	{
+		m_aNumFmt.SetStartValue(start);
+	}
+
+	virtual void	ToXml(IXFStream *pStrm);	
+private:
+	XFNumFmt	m_aNumFmt;
+};
+
+
+class XFListLevelBullet : public XFListLevel
+{
+public:
+	XFListLevelBullet()
+	{
+		m_eListType = enumXFListLevelBullet;
+	}
+	
+	void	SetBulletChar(UChar32 ch)
+	{ 
+		m_chBullet = ch; 
+	}
+	void	SetPrefix(rtl::OUString prefix)
+	{
+		m_aNumFmt.SetPrefix(prefix);
+	}
+	void	SetSuffix(rtl::OUString suffix)
+	{
+		m_aNumFmt.SetSuffix(suffix);
+	}
+	void	SetFontName(rtl::OUString name)
+	{
+		m_strFontName = name;
+	}
+
+	virtual void	ToXml(IXFStream *pStrm);
+private:	
+	XFNumFmt	m_aNumFmt;
+	int32_t		m_chBullet;
+	rtl::OUString m_strFontName;
+};
+
+//not complete.
+class XFListLevelImage : public XFListLevel
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+private:	
+	sal_Int16		m_nWidth;
+	sal_Int16		m_nHeight;
+	rtl::OUString	m_strBinaryData;
+};
+
+
+class XFListStyle : public XFStyle
+{
+public:
+	XFListStyle();
+
+	XFListStyle(const XFListStyle& other);
+
+	XFListStyle& operator=(const XFListStyle& other);
+
+	virtual ~XFListStyle();
+
+public:
+	void	SetDisplayLevel(sal_Int32 level, sal_Int16 nShowLevel);
+	
+	void	SetListPosition(sal_Int32 level,
+					double indent,
+					double minLabelWidth,
+					double minLabelDistance,
+					enumXFAlignType	align=enumXFAlignStart
+					);
+
+	void	SetListBullet(sal_Int32 level, 
+							UChar32 bullet_char,
+							rtl::OUString fontname = A2OUSTR(""),
+							rtl::OUString prefix = A2OUSTR(""), 
+							rtl::OUString suffix = A2OUSTR("")						
+							);
+
+	void	SetListNumber( sal_Int32 level, XFNumFmt& numFmt,	sal_Int16 nStartValue = 1 );
+
+	//not implemented now.
+	void	SetListImage(){}
+
+	virtual enumXFStyle GetStyleFamily()
+	{
+		return enumXFStyleList;
+	}
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFListLevel		*m_pListLevels[10];
+};
+
+
+
+inline void XFListLevel::SetListlevelType(enumXFListLevel type)
+{
+	m_eListType = type;
+}
+
+inline void XFListLevel::SetAlignType(enumXFAlignType align)
+{
+	m_eAlign = align;
+}
+
+inline void XFListLevel::SetLevel(sal_Int16 level)
+{
+	m_nLevel = level;
+}
+
+inline void	XFListLevel::SetDisplayLevel(sal_Int16 nDisplayLevel)
+{
+	m_nDisplayLevel = nDisplayLevel;
+}
+
+inline void XFListLevel::SetIndent(double indent)
+{
+	m_fIndent = indent;
+}
+
+inline void XFListLevel::SetMinLabelWidth(double labelWidth)
+{
+	m_fMinLabelWidth = labelWidth;
+}
+
+inline void XFListLevel::SetMinLabelDistance(double distance)
+{
+	m_fMinLabelDistance = distance;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfmargins.cxx lotuswordpro/source/filter/xfilter/xfmargins.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfmargins.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfmargins.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,129 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Margins object, include left margin,right margin,top margin and bottom margin.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ ************************************************************************/
+
+
+#include	"xfmargins.hxx"
+
+XFMargins::XFMargins()
+{
+	Reset();
+}
+
+void	XFMargins::Reset()
+{
+	m_fLeft = 0;
+	m_fRight = 0;	
+	m_fTop = 0;
+	m_fBottom = 0;
+	m_nFlag = 0;
+}
+
+void	XFMargins::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	//margin left:
+	if( m_nFlag&XFMARGINS_FLAG_LEFT )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:margin-left"), DoubleToOUString(m_fLeft) + A2OUSTR("cm") );
+	}
+	//margin right:
+	if( m_nFlag&XFMARGINS_FLAG_RIGHT )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:margin-right"), DoubleToOUString(m_fRight) + A2OUSTR("cm") );
+	}		
+	//margin top:
+	if( m_nFlag&XFMARGINS_FLAG_TOP )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:margin-top"), DoubleToOUString(m_fTop) + A2OUSTR("cm") );
+	}
+	//margin bottom:
+	if( m_nFlag&XFMARGINS_FLAG_BOTTOM )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:margin-bottom"), DoubleToOUString(m_fBottom) + A2OUSTR("cm") );
+	}
+}
+
+bool operator==(XFMargins& indent1, XFMargins& indent2)
+{
+	return (
+		(indent1.m_nFlag == indent2.m_nFlag) &&
+		(indent1.m_fLeft == indent2.m_fLeft) &&
+		(indent1.m_fRight == indent2.m_fRight) &&
+		(indent1.m_fTop == indent2.m_fTop) &&
+		(indent1.m_fBottom == indent2.m_fBottom)
+		);
+}
+bool operator!=(XFMargins& indent1, XFMargins& indent2)
+{
+	return !(indent1==indent2);
+}
+
+XFMargins& XFMargins::operator=(XFMargins& other)
+{
+	m_nFlag = other.m_nFlag;
+	m_fLeft = other.m_fLeft;
+	m_fRight = other.m_fRight;
+	m_fTop = other.m_fTop;
+	m_fBottom = other.m_fBottom;
+	return *this;	
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfmargins.hxx lotuswordpro/source/filter/xfilter/xfmargins.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfmargins.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfmargins.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,147 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Margins object, include left margin,right margin,top margin and bottom margin.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-19 create this file.
+ ************************************************************************/
+#ifndef		_XFMARGINS_HXX
+#define		_XFMARGINS_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+
+#define		XFMARGINS_FLAG_LEFT		0x00000001
+#define		XFMARGINS_FLAG_RIGHT	0x00000002
+#define		XFMARGINS_FLAG_TOP		0x00000004
+#define		XFMARGINS_FLAG_BOTTOM	0x00000008
+
+class XFMargins : public IXFProperty
+{
+public:
+	XFMargins();
+public:	
+	void	Reset();
+	void	SetLeft(double left);
+	void	SetRight(double right);
+	void	SetTop(double top);
+	void	SetBottom(double bottom);
+
+	double	GetLeft();
+	double	GetRight();
+	double	GetTop();
+	double	GetBottom();
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	friend bool operator==(XFMargins& indent1, XFMargins& indent2);
+	friend bool operator!=(XFMargins& indent1, XFMargins& indent2);	
+	XFMargins& operator=(XFMargins& other);
+private:		
+	double	m_fLeft;
+	double	m_fRight;	
+	double	m_fTop;
+	double	m_fBottom;	
+	int		m_nFlag;
+};
+
+inline void	XFMargins::SetLeft(double left) 
+{
+	m_fLeft = left; 
+	m_nFlag |= XFMARGINS_FLAG_LEFT;
+}
+
+inline void	XFMargins::SetRight(double right) 
+{ 
+	m_fRight = right;
+	m_nFlag |= XFMARGINS_FLAG_RIGHT;
+}
+
+inline void	XFMargins::SetTop(double top) 
+{ 
+	m_fTop = top; 
+	m_nFlag |= XFMARGINS_FLAG_TOP;
+}
+
+inline void	XFMargins::SetBottom(double bottom) 
+{ 
+	m_fBottom = bottom; 
+	m_nFlag |= XFMARGINS_FLAG_BOTTOM;
+}
+
+inline double	XFMargins::GetLeft()
+{ 
+	return m_fLeft; 
+}
+
+inline double	XFMargins::GetRight()
+{ 
+	return m_fRight; 
+}
+
+inline double	XFMargins::GetTop()
+{ 
+	return m_fTop; 
+}
+
+inline double	XFMargins::GetBottom()
+{ 
+	return m_fBottom; 
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfmasterpage.cxx lotuswordpro/source/filter/xfilter/xfmasterpage.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfmasterpage.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfmasterpage.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,132 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Master page object which was used to apply a layout to the pages.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xfmasterpage.hxx"
+#include	"xfpagemaster.hxx"
+#include	"xfstylemanager.hxx"
+#include	"xffooter.hxx"
+#include	"xfheader.hxx"
+#include "../lwpglobalmgr.hxx"
+XFMasterPage::XFMasterPage()
+{
+	m_pHeader = NULL;
+	m_pFooter = NULL;
+}
+
+XFMasterPage::~XFMasterPage()
+{
+	if( m_pHeader )
+		delete m_pHeader;
+	if( m_pFooter )
+		delete m_pFooter;
+}
+
+void	XFMasterPage::SetHeader(XFHeader *pHeader)
+{
+	if( m_pHeader )
+		delete m_pHeader;
+	m_pHeader = pHeader;
+}
+
+void	XFMasterPage::SetFooter(XFFooter *pFooter)
+{
+	if( m_pFooter )
+		delete m_pFooter;
+	m_pFooter = pFooter;
+}
+
+enumXFStyle	XFMasterPage::GetStyleFamily()
+{
+	return enumXFStyleMasterPage;
+}
+
+
+void	XFMasterPage::SetPageMaster(rtl::OUString pm)
+{
+	m_strPageMaster = pm;
+}
+
+void	XFMasterPage::SetPageMaster(XFPageMaster *pPM)
+{
+	if( pPM->GetStyleName().getLength() > 0 )
+		m_strPageMaster = pPM->GetStyleName();
+	else
+	{
+		XFStyleManager* pXFStyleManager = LwpGlobalMgr::GetInstance()->GetXFStyleManager(); 
+		m_strPageMaster = pXFStyleManager->AddStyle(pPM)->GetStyleName();
+	}
+}
+
+void	XFMasterPage::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList		*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), m_strStyleName );
+	pAttrList->AddAttribute( A2OUSTR("style:page-master-name"), m_strPageMaster );
+	pStrm->StartElement( A2OUSTR("style:master-page") );
+	if( m_pHeader )
+		m_pHeader->ToXml(pStrm);
+	if( m_pFooter )
+		m_pFooter->ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("style:master-page") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfmasterpage.hxx lotuswordpro/source/filter/xfilter/xfmasterpage.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfmasterpage.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfmasterpage.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,99 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Master page object which was used to apply a layout to the pages.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFMASTERPAGE_HXX
+#define		_XFMASTERPAGE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfcontentcontainer.hxx"
+
+class XFPageMaster;
+class XFFooter;
+class XFHeader;
+class XFMasterPage : public XFStyle
+{
+public:
+	XFMasterPage();
+
+	virtual ~XFMasterPage();
+	
+public:	
+	void	SetPageMaster(rtl::OUString pm);
+
+	void	SetPageMaster(XFPageMaster *pPM);
+
+	void	SetHeader(XFHeader *pHeader);
+
+	void	SetFooter(XFFooter *pFooter);
+
+	virtual enumXFStyle	GetStyleFamily();
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString	m_strPageMaster;
+	XFHeader	*m_pHeader;
+	XFFooter	*m_pFooter;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfnumberstyle.cxx lotuswordpro/source/filter/xfilter/xfnumberstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfnumberstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfnumberstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,388 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Number style for table cell.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-23 create this file.
+ ************************************************************************/
+#include	"xfnumberstyle.hxx"
+
+XFNumberStyle::XFNumberStyle():m_aColor(0,0,0),m_aNegativeColor(255,0,0)
+{
+	m_eType = enumXFNumberNumber;
+	m_nDecimalDigits = 0;
+	m_nMinInteger = 1;
+	m_nMinExponent = 2;
+	m_bGroup = sal_False;
+	m_bRedIfNegative = sal_False;
+	m_bCurrencySymbolPost = sal_False;
+}
+
+XFNumberStyle::XFNumberStyle(enumXFNumberType type)
+{
+	m_eType = type;
+	m_nDecimalDigits = 0;
+	m_nMinInteger = 1;
+	m_nMinExponent = 1;
+	m_bRedIfNegative = sal_False;
+	m_bCurrencySymbolPost = sal_False;
+}
+
+enumXFStyle XFNumberStyle::GetStyleFamily()
+{
+	return enumXFStyleNumber;
+}
+
+sal_Bool XFNumberStyle::Equal(IXFStyle *pStyle)
+{
+	if( !pStyle || pStyle->GetStyleFamily() != enumXFStyleNumber )
+		return sal_False;
+	XFNumberStyle *pOther = (XFNumberStyle*)pStyle;
+	if( !pOther )
+		return sal_False;
+
+	if( m_eType != pOther->m_eType )
+		return sal_False;
+	if( m_nDecimalDigits != pOther->m_nDecimalDigits )
+		return sal_False;
+	if( m_nMinInteger != pOther->m_nMinInteger )
+		return sal_False;
+	if( m_bRedIfNegative != pOther->m_bRedIfNegative )
+		return sal_False;
+	if( m_bGroup != pOther->m_bGroup )
+		return sal_False;
+	if( m_aColor != pOther->m_aColor )
+		return sal_False;
+	if( m_strPrefix != pOther->m_strPrefix )
+		return sal_False;
+	if( m_strSuffix != pOther->m_strSuffix )
+		return sal_False;
+
+	//When category of number format is scientific, the number can not be displayed normally in table.
+	if ( m_nMinExponent != pOther->m_nMinExponent )
+		return sal_False;
+	
+	if( m_bRedIfNegative )
+	{
+		if( m_aNegativeColor != pOther->m_aNegativeColor )
+			return sal_False;
+		if( m_strNegativePrefix != pOther->m_strNegativePrefix )
+			return sal_False;
+		if( m_strNegativeSuffix != pOther->m_strNegativeSuffix )
+			return sal_False;
+	}
+
+	if( m_eType == enuMXFNumberCurrency )
+	{
+		if( m_bCurrencySymbolPost != pOther->m_bCurrencySymbolPost )
+			return sal_False;
+		if( m_strCurrencySymbol != pOther->m_strCurrencySymbol )
+			return sal_False;
+	}
+
+	return sal_True;
+}
+
+void XFNumberStyle::ToXml(IXFStream *pStrm)
+{
+	// for Text content number format 
+	if (m_eType == enumXFText)
+	{
+		ToXml_StartElement(pStrm);
+		ToXml_EndElement(pStrm);
+		return;
+	}
+	// END for Text content number format 
+
+	if( !m_bRedIfNegative )
+	{
+		ToXml_Normal(pStrm);
+	}
+	else
+	{
+		ToXml_Negative(pStrm);
+	}	
+}
+
+void XFNumberStyle::ToXml_StartElement(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("data-style") );	
+
+	if( m_eType == enumXFNumberNumber )
+	{
+		pStrm->StartElement( A2OUSTR("number:number-style") );
+	}
+	else if( m_eType == enumXFNumberPercent )
+	{
+		pStrm->StartElement( A2OUSTR("number:percentage-style") );
+	}
+	else if( m_eType == enuMXFNumberCurrency )
+	{		
+		pStrm->StartElement( A2OUSTR("number:currency-style") );
+	}
+	else if( m_eType == enumXFNumberScientific )
+	{
+		pStrm->StartElement( A2OUSTR("number:number-style") );
+	}
+	// for Text content number format 
+	else if (m_eType == enumXFText)
+	{
+		pStrm->StartElement( A2OUSTR("number:text-content"));
+	}
+	// END for Text content number format 
+
+}
+
+void XFNumberStyle::ToXml_EndElement(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("data-style") );	
+	
+	if( m_eType == enumXFNumberNumber )
+	{
+		pStrm->EndElement( A2OUSTR("number:number-style") );
+	}
+	else if( m_eType == enumXFNumberPercent )
+	{
+		pStrm->EndElement( A2OUSTR("number:percentage-style") );
+	}
+	else if( m_eType == enuMXFNumberCurrency )
+	{		
+		pStrm->EndElement( A2OUSTR("number:currency-style") );
+	}
+	else if( m_eType == enumXFNumberScientific )
+	{
+		pStrm->EndElement( A2OUSTR("number:number-style") );
+	}
+	// for Text content number format 
+	else if (m_eType == enumXFText)
+	{
+		pStrm->EndElement( A2OUSTR("number:text-content"));
+	}
+	// END for Text content number format 
+
+}
+void XFNumberStyle::ToXml_Normal(IXFStream *pStrm)
+{	
+	ToXml_StartElement(pStrm);
+
+	ToXml_Content(pStrm,sal_False);
+	
+	ToXml_EndElement(pStrm);
+}
+
+void XFNumberStyle::ToXml_Negative(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	rtl::OUString strStyleName = GetStyleName();
+	rtl::OUString strGEStyle = strStyleName + A2OUSTR("PO");
+	
+	SetStyleName(strGEStyle);
+	ToXml_Normal(pStrm);
+	SetStyleName(strStyleName);
+	
+	ToXml_StartElement(pStrm);
+	
+	ToXml_Content(pStrm,sal_True);
+	
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:condition"), A2OUSTR("value()>=0") );
+	pAttrList->AddAttribute( A2OUSTR("style:apply-style-name"), strGEStyle );
+	pStrm->StartElement( A2OUSTR("style:map") );
+	pStrm->EndElement( A2OUSTR("style:map") );	
+	
+	ToXml_EndElement(pStrm);
+}
+
+void XFNumberStyle::ToXml_Content(IXFStream *pStrm, sal_Bool nagetive)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	//color:
+	if( !nagetive )
+		pAttrList->AddAttribute( A2OUSTR("fo:color"), m_aColor.ToString() );
+	else
+		pAttrList->AddAttribute( A2OUSTR("fo:color"), m_aNegativeColor.ToString() );
+	
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	if( !nagetive )
+	{
+		if( m_strPrefix.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:text") );
+			pStrm->Characters(m_strPrefix);				
+			pStrm->EndElement( A2OUSTR("number:text") );
+		}
+	}
+	else
+	{
+		if( m_strNegativePrefix.getLength() == 0 )
+			m_strNegativePrefix = m_strPrefix;
+		if( m_strNegativePrefix.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:text") );
+			// pStrm->Characters(m_strNegativePrefix);
+			pStrm->Characters(m_strNegativePrefix + A2OUSTR("-"));
+			pStrm->EndElement( A2OUSTR("number:text") );
+		}
+		else
+		{
+			pStrm->StartElement( A2OUSTR("number:text") );
+			pStrm->Characters(A2OUSTR("-"));
+			pStrm->EndElement( A2OUSTR("number:text") );
+		}
+	}
+
+	if( m_eType == enuMXFNumberCurrency && !m_bCurrencySymbolPost )
+	{		
+		if( m_strCurrencySymbol.getLength() > 0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:currency-symbol") );
+			pStrm->Characters(m_strCurrencySymbol);
+			pStrm->EndElement( A2OUSTR("number:currency-symbol") );
+		}
+	}
+	
+	//When category of number format is scientific, the number can not be displayed normally in table.
+	if ( m_eType == enumXFNumberScientific )
+	{
+		pAttrList->Clear();
+		pAttrList->AddAttribute(A2OUSTR("number:decimal-places"), Int32ToOUString(m_nDecimalDigits));
+		pAttrList->AddAttribute(A2OUSTR("number:min-integer-digits"), Int32ToOUString(m_nMinInteger));
+		pAttrList->AddAttribute(A2OUSTR("number:min-exponent-digits"), Int32ToOUString(m_nMinExponent));
+		pStrm->StartElement( A2OUSTR("number:scientific-number") );
+		pStrm->EndElement( A2OUSTR("number:scientific-number") );
+	}
+	else
+	{
+		pAttrList->Clear();
+		pAttrList->AddAttribute(A2OUSTR("number:decimal-places"),Int32ToOUString(m_nDecimalDigits));
+		pAttrList->AddAttribute(A2OUSTR("number:min-integer-digits"),Int32ToOUString(m_nMinInteger));
+	
+		if( m_bGroup )
+			pAttrList->AddAttribute(A2OUSTR("number:grouping"),A2OUSTR("true"));
+		else
+			pAttrList->AddAttribute(A2OUSTR("number:grouping"),A2OUSTR("false"));
+		
+		pStrm->StartElement( A2OUSTR("number:number") );
+		pStrm->EndElement( A2OUSTR("number:number") );
+	}
+
+	if( m_eType == enuMXFNumberCurrency && m_bCurrencySymbolPost )
+	{		
+		if( m_strCurrencySymbol.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:currency-symbol") );
+			pStrm->Characters(m_strCurrencySymbol);
+			pStrm->EndElement( A2OUSTR("number:currency-symbol") );
+		}
+	}
+	
+	if( !nagetive )
+	{
+		if( m_strSuffix.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:text") );
+			pStrm->Characters(m_strSuffix);				
+			pStrm->EndElement( A2OUSTR("number:text") );
+		}
+		else
+		{
+			if( m_eType == enumXFNumberPercent )
+			{
+				pStrm->StartElement( A2OUSTR("number:text") );
+				pStrm->Characters(A2OUSTR("%"));				
+				pStrm->EndElement( A2OUSTR("number:text") );
+			}
+		}
+	}
+	else
+	{
+		if( m_strNegativeSuffix.getLength() == 0 )
+			m_strNegativeSuffix = m_strSuffix;
+		if( m_strNegativeSuffix.getLength()>0 )
+		{
+			pStrm->StartElement( A2OUSTR("number:text") );
+			pStrm->Characters(m_strNegativeSuffix);
+			pStrm->EndElement( A2OUSTR("number:text") );
+		}
+		else
+		{
+			if( m_eType == enumXFNumberPercent )
+			{
+				pStrm->StartElement( A2OUSTR("number:text") );
+				pStrm->Characters(A2OUSTR("%"));				
+				pStrm->EndElement( A2OUSTR("number:text") );
+			}
+		}
+	}
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfnumberstyle.hxx lotuswordpro/source/filter/xfilter/xfnumberstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfnumberstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfnumberstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,197 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Number style for table cell.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-23 create this file.
+ ************************************************************************/
+#ifndef		_XFNUMBERSTYLE_HXX
+#define		_XFNUMBERSTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfstylemanager.hxx"
+#include	"xfcolor.hxx"
+#include	<rtl/ustring.hxx> 
+
+class XFNumberStyle : public XFStyle
+{
+public:
+	XFNumberStyle();
+	
+	XFNumberStyle(enumXFNumberType type );
+
+public:
+	void	SetDecimalDigits(sal_Int32 decimal);
+
+	void	SetMinInteger(sal_Int32 integer);
+
+	void	SetMinExponent(sal_Int32 exponent);	
+	
+	void	SetGroup(sal_Bool group = sal_True);
+
+	void	SetColor(const XFColor& color);
+	XFColor GetColor(){return m_aColor;}//add by ,2005/11/30
+
+	void	SetPrefix(rtl::OUString prefix);
+	
+	void	SetSurfix(rtl::OUString surfix);
+
+	void	SetNegativeStyle(rtl::OUString prefix, rtl::OUString suffix, const XFColor& color=XFColor(255,0,0));
+
+	void	SetNumberType(enumXFNumberType type);
+
+	void	SetCurrencySymbol(sal_Bool post, rtl::OUString symbol, sal_Bool bShowSpace=sal_False);
+
+	virtual enumXFStyle GetStyleFamily();
+
+	virtual sal_Bool Equal(IXFStyle *pStyle);
+
+	virtual void ToXml(IXFStream *pStrm);
+
+protected:
+	void	ToXml_StartElement(IXFStream *pStrm);
+
+	void	ToXml_EndElement(IXFStream *pStrm);
+
+	void	ToXml_Normal(IXFStream *pStrm);
+
+	void	ToXml_Negative(IXFStream *pStrm);
+
+	void	ToXml_Content(IXFStream *pStrm, sal_Bool nagetive);
+	
+protected:
+	enumXFNumberType	m_eType;
+	sal_Int32	m_nDecimalDigits;
+	sal_Int32	m_nMinInteger;
+	sal_Int32	m_nMinExponent;
+	sal_Bool	m_bGroup;
+	XFColor		m_aColor;
+	sal_Bool	m_bCurrencySymbolPost;
+	rtl::OUString	m_strCurrencySymbol;
+	rtl::OUString	m_strPrefix;
+	rtl::OUString	m_strSuffix;
+
+	sal_Bool	m_bRedIfNegative;
+	XFColor		m_aNegativeColor;
+	rtl::OUString	m_strNegativePrefix;
+	rtl::OUString	m_strNegativeSuffix;
+};
+
+inline void XFNumberStyle::SetDecimalDigits(sal_Int32 decimal)
+{
+	m_nDecimalDigits = decimal;
+}
+
+inline void XFNumberStyle::SetMinInteger(sal_Int32 integer)
+{
+	m_nMinInteger = integer;
+}
+
+inline void XFNumberStyle::SetMinExponent(sal_Int32 exponent)
+{
+	m_nMinExponent = exponent;
+}
+
+inline void XFNumberStyle::SetNegativeStyle(rtl::OUString prefix, rtl::OUString suffix, const XFColor& color)
+{
+	m_bRedIfNegative = sal_True;
+	m_aNegativeColor = color;
+	m_strNegativePrefix = prefix;
+	m_strNegativeSuffix = suffix;
+}
+
+inline void XFNumberStyle::SetGroup(sal_Bool group)
+{
+	m_bGroup = group;
+}
+
+inline void XFNumberStyle::SetColor(const XFColor& color)
+{
+	m_aColor = color;
+}
+
+inline void XFNumberStyle::SetNumberType(enumXFNumberType type)
+{
+	m_eType = type;
+}
+
+inline void XFNumberStyle::SetPrefix(rtl::OUString prefix)
+{
+	m_strPrefix = prefix;
+}
+
+inline void XFNumberStyle::SetSurfix(rtl::OUString surfix)
+{
+	m_strSuffix = surfix;
+}
+
+inline void XFNumberStyle::SetCurrencySymbol(sal_Bool post, rtl::OUString symbol, sal_Bool bShowSpace)
+{
+	m_bCurrencySymbolPost = post;
+	m_strCurrencySymbol = symbol;
+	
+	if( bShowSpace )
+	{
+		if( post )
+			m_strCurrencySymbol = A2OUSTR(" ") + m_strCurrencySymbol;
+		else
+			m_strCurrencySymbol += A2OUSTR(" ");
+	}
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfnumfmt.hxx lotuswordpro/source/filter/xfilter/xfnumfmt.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfnumfmt.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfnumfmt.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,153 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Number format. a),A),i),1),(1)
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+
+#ifndef		_XFNUMFMT_HXX
+#define		_XFNUMFMT_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+
+/**
+ * @brief
+ * Bullet number format.
+ */
+class XFNumFmt : public IXFProperty
+{
+public:
+	XFNumFmt()
+	{
+		m_nStartValue = 0;
+	}
+
+public:
+	/**********************************************************************
+	 * @descr:		set the prefix of the number format,that the '(' of output
+					(1 item1
+					(2 item2
+	 * @param:		prefix 
+	 *********************************************************************/
+	void	SetPrefix(rtl::OUString prefix)
+	{
+		m_strPrefix = prefix;
+	}
+
+	/**********************************************************************
+	 * @descr:		set the suffix of the number format,that the ')' of output
+					1) item1
+					2) item2
+	 * @param:		prefix 
+	 *********************************************************************/
+	void	SetSuffix(rtl::OUString suffix)
+	{
+		m_strSuffix = suffix;
+	}
+
+	/**********************************************************************
+	 * @descr:		set the display value. ie. if you set format to '1',then 
+					the ouput would be:
+						1 item1
+						2 item2
+					or if you set the format to 'a', then the output would be:
+						a item1
+						b item2
+					some sepecial, if you set the format to a sequence,ie. ",,,..."
+					the output would be:
+						 item1
+						 item2
+						 item3
+
+					Of cource, for unordered-list, you can also set the format to
+					be a bullet char,ie:
+						'','','','','',
+	 * @param:		prefix 
+	 *********************************************************************/
+	void	SetFormat(rtl::OUString format)
+	{
+		m_strFormat = format;
+	}
+
+	void	SetStartValue(sal_Int16 start)
+	{
+		m_nStartValue = start;
+	}
+
+	virtual void ToXml(IXFStream *pStrm)
+	{	
+		IXFAttrList *pAttrList = pStrm->GetAttrList();
+
+		if( m_strPrefix.getLength() > 0 )
+			pAttrList->AddAttribute( A2OUSTR("style:num-prefix"), m_strPrefix );
+		if( m_strSuffix.getLength() > 0 )
+			pAttrList->AddAttribute( A2OUSTR("style:num-suffix"), m_strSuffix );
+		pAttrList->AddAttribute( A2OUSTR("style:num-format"), m_strFormat );
+		if( m_nStartValue != 0 )
+			pAttrList->AddAttribute( A2OUSTR("text:start-value"), Int16ToOUString(m_nStartValue) );
+	}
+private:
+	rtl::OUString	m_strPrefix;
+	rtl::OUString	m_strSuffix;
+	rtl::OUString	m_strFormat;
+	sal_Int16	m_nStartValue;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfofficemeta.cxx lotuswordpro/source/filter/xfilter/xfofficemeta.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfofficemeta.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfofficemeta.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,150 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Implemention file for Meta data,pls reference to the header file.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ * 2004-01-05 it works now.
+ ************************************************************************/
+#include	"xfofficemeta.hxx"
+#include	"ixfstream.hxx"
+#include	"ixfattrlist.hxx"
+
+void	XFOfficeMeta::SetGenerator(rtl::OUString generator)
+{
+	m_strGenerator = generator;
+}
+
+void	XFOfficeMeta::SetTitle(rtl::OUString title)
+{
+	m_strTitle = title;
+}
+
+void	XFOfficeMeta::SetCreator(rtl::OUString creator)
+{
+	m_strCreator = creator;
+}
+void	XFOfficeMeta::SetDescription(rtl::OUString dsr)
+{
+	m_strDsr = dsr;
+}
+void XFOfficeMeta::SetKeywords(rtl::OUString keywords)
+{
+	m_strKeywords = keywords;
+}
+void XFOfficeMeta::SetCreationTime(rtl::OUString crtime)
+{
+	m_strCrtime = crtime;
+}
+void XFOfficeMeta::SetLastTime(rtl::OUString lstime)
+{
+	m_strLstime = lstime;
+}
+void XFOfficeMeta::SetEditTime(rtl::OUString edtime)
+{
+	m_strEdtime = edtime;
+}
+void	XFOfficeMeta::ToXml(IXFStream *pStream)
+{
+	IXFAttrList	*pAttrList = pStream->GetAttrList();
+
+	pAttrList->Clear();
+	pStream->StartElement( A2OUSTR("office:meta") );
+	
+	//generator:
+	pStream->StartElement( A2OUSTR("meta:generator") );
+	pStream->Characters( m_strGenerator );
+	pStream->EndElement( A2OUSTR("meta:generator") );
+
+	//title
+	pStream->StartElement( A2OUSTR("dc:title") );
+	pStream->Characters( m_strTitle );
+	pStream->EndElement( A2OUSTR("dc:title") );
+
+	//keywords
+	pStream->StartElement( A2OUSTR("meta:keywords") );
+	pStream->StartElement( A2OUSTR("meta:keyword") );
+	pStream->Characters( m_strKeywords );
+	pStream->EndElement( A2OUSTR("meta:keyword") );
+	pStream->EndElement( A2OUSTR("meta:keywords") );
+
+	//creation time
+	pStream->StartElement( A2OUSTR("meta:creation-date") );
+	pStream->Characters( m_strCrtime);
+	pStream->EndElement( A2OUSTR("meta:creation-date") );
+	
+	//last revision time
+	pStream->StartElement( A2OUSTR("dc:date") );
+	pStream->Characters( m_strLstime);
+	pStream->EndElement( A2OUSTR("dc:date") );
+	//total edit time
+	pStream->StartElement( A2OUSTR("meta:editing-duration") );
+	pStream->Characters( m_strEdtime);
+	pStream->EndElement( A2OUSTR("meta:editing-duration") );
+	
+	//description
+	pStream->StartElement( A2OUSTR("dc:description") );
+	pStream->Characters( m_strDsr );
+	pStream->EndElement( A2OUSTR("dc:description") );
+	//creator
+	pStream->StartElement( A2OUSTR("meta:initial-creator") );
+	pStream->Characters( m_strCreator );
+	pStream->EndElement( A2OUSTR("meta:initial-creator") );
+
+	pStream->EndElement( A2OUSTR("office:meta") );
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfofficemeta.hxx lotuswordpro/source/filter/xfilter/xfofficemeta.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfofficemeta.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfofficemeta.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,98 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Meta info for the full document.
+ * You can see this by click: File->Properties.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ ************************************************************************/
+#ifndef		_XFOFFICEMETA_HXX
+#define		_XFOFFICEMETA_HXX
+
+#include	"xfglobal.hxx"
+
+class XFOfficeMeta : public IXFObject
+{
+public:
+	XFOfficeMeta(){};
+	virtual ~XFOfficeMeta(){};
+
+	void	SetGenerator(rtl::OUString generator);
+	void	SetTitle(rtl::OUString title);
+	void	SetCreator(rtl::OUString creator);
+	void	SetDescription(rtl::OUString dsr);
+	void SetKeywords(rtl::OUString keywords);
+	void SetCreationTime(rtl::OUString crtime);
+	void SetLastTime(rtl::OUString lstime);
+	void SetEditTime(rtl::OUString edtime);
+
+	virtual void ToXml(IXFStream *pStream);
+private:
+	rtl::OUString	m_strGenerator;
+	rtl::OUString	m_strTitle;
+	rtl::OUString	m_strCreator;	
+	rtl::OUString	m_strDsr;	
+	rtl::OUString	m_strKeywords;	
+	rtl::OUString	m_strCrtime;	
+	rtl::OUString	m_strLstime;	
+	rtl::OUString	m_strEdtime;	
+
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfoleobj.cxx lotuswordpro/source/filter/xfilter/xfoleobj.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfoleobj.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfoleobj.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,118 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ 2005-02-25		Created 
+ ************************************************************************/
+#include	"xfoleobj.hxx"
+#include	"xfbase64.hxx"
+
+XFOleObject::XFOleObject()
+{
+}
+
+void	XFOleObject::SetOleData(sal_uInt8 *buf, int len)
+{
+	m_strData = XFBase64::Encode(buf, len);
+}
+
+void	XFOleObject::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:style-name"), GetStyleName() );
+	
+	assert(m_strName.getLength()>0);	//name should not be null.
+	if( m_strName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("draw:name"), m_strName );
+	//anchor type:
+	switch( m_eAnchor )
+	{
+	case enumXFAnchorPara:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("paragraph") );
+		break;
+	case enumXFAnchorPage:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("page") );
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-page-number"), Int32ToOUString(m_nAnchorPage) );
+		break;
+	case enumXFAnchorChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("char") );
+		break;
+	case enumXFAnchorAsChar:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("as-char") );
+		break;
+	case enumXFAnchorFrame:
+		pAttrList->AddAttribute( A2OUSTR("text:anchor-type"), A2OUSTR("frame") );
+		break;
+	}
+	pAttrList->AddAttribute( A2OUSTR("svg:x"), DoubleToOUString(m_aRect.GetX()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:y"), DoubleToOUString(m_aRect.GetY()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:width"), DoubleToOUString(m_aRect.GetWidth()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("svg:height"), DoubleToOUString(m_aRect.GetHeight()) + A2OUSTR("cm") );
+	pAttrList->AddAttribute( A2OUSTR("draw:z-index"), Int32ToOUString(m_nZIndex) );	
+	
+	if( m_strNextLink.getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("draw:chain-next-name"), m_strNextLink );	
+
+	pStrm->StartElement( A2OUSTR("draw:object-ole") );
+
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("office:binary-data") );
+	pStrm->Characters(m_strData);
+	pStrm->EndElement( A2OUSTR("office:binary-data") );
+
+	pStrm->EndElement( A2OUSTR("draw:object-ole") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfoleobj.hxx lotuswordpro/source/filter/xfilter/xfoleobj.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfoleobj.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfoleobj.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,89 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ 2005-02-25		Created 
+ ************************************************************************/
+#ifndef		_XFOLEOBJ_HXX
+#define		_XFOLEOBJ_HXX
+
+#include	"xfframe.hxx"
+
+/**
+ * @brief
+ * Ole object.
+ * Ole object is a frame object, it inherits all properties of frame obejct.
+ */
+class XFOleObject : public XFFrame
+{
+public:
+	XFOleObject();
+
+public:
+	/**
+	 * @descr	Set ole object data. The data will be base64 encoded before sent to SODC. 
+	 */
+	void	SetOleData(sal_uInt8 *buf, int len);
+	
+	/**
+	 * @descr	output ole obejct. 
+	 */
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	rtl::OUString m_strData;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfoutlinestyle.cxx lotuswordpro/source/filter/xfilter/xfoutlinestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfoutlinestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfoutlinestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,131 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Outline style for the full document.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-2 create and implements.
+ ************************************************************************/
+#include	"xfoutlinestyle.hxx"
+
+XFOutlineLevelStyle::XFOutlineLevelStyle()
+{
+	m_nLevel = 0;
+	m_fIndent = 0;
+	m_fMinLabelWidth = 0;
+	m_fMinLabelDistance = 0;
+	m_eAlign = enumXFAlignNone;
+	m_pNumFmt = NULL;
+}
+
+XFOutlineLevelStyle::~XFOutlineLevelStyle()
+{
+	if( m_pNumFmt )
+		delete m_pNumFmt;
+}
+
+void XFOutlineLevelStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	assert(m_nLevel>0);
+	pAttrList->AddAttribute( A2OUSTR("text:level"), Int32ToOUString(m_nLevel) );
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	if( m_pNumFmt )
+		m_pNumFmt->ToXml(pStrm);
+	else
+		pAttrList->AddAttribute( A2OUSTR("style:num-format"), A2OUSTR("") );
+	pStrm->StartElement( A2OUSTR("text:outline-level-style") );
+
+	pAttrList->Clear();
+	if( m_fIndent )
+		pAttrList->AddAttribute( A2OUSTR("text:space-before"), DoubleToOUString(m_fIndent) + A2OUSTR("cm") );
+	if( m_fMinLabelWidth )
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-width"), DoubleToOUString(m_fMinLabelWidth) + A2OUSTR("cm") );
+	if( m_fMinLabelDistance )
+		pAttrList->AddAttribute( A2OUSTR("text:min-label-distance"), DoubleToOUString(m_fMinLabelDistance) + A2OUSTR("cm") );
+	if( enumXFAlignNone != m_eAlign )
+		pAttrList->AddAttribute( A2OUSTR("fo:text-align"), GetAlignName(m_eAlign) );
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("text:outline-level-style") );
+}
+
+XFOutlineStyle::XFOutlineStyle()
+{
+	for( int i=0; i<10; i++ )
+		m_aLevels[i].SetLevel(i+1);
+}
+
+enumXFStyle	XFOutlineStyle::GetStyleFamily()
+{
+	return enumXFStyleOutline;
+}
+
+void XFOutlineStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pStrm->StartElement( A2OUSTR("text:outline-style") );
+	for( int i=0; i<10; i++ )
+		m_aLevels[i].ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("text:outline-style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfoutlinestyle.hxx lotuswordpro/source/filter/xfilter/xfoutlinestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfoutlinestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfoutlinestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,191 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Outline style for the full document.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-02-2 create and implements.
+ ************************************************************************/
+#ifndef		_XFOUTLINESTYLE_HXX
+#define		_XFOUTLINESTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfnumfmt.hxx"
+
+class XFNumFmt;
+class XFOutlineLevelStyle : public XFStyle
+{
+public:
+	XFOutlineLevelStyle();
+
+	virtual ~XFOutlineLevelStyle();
+
+public:
+	void	SetNumFmt(XFNumFmt& fmt);
+	
+	void	SetLevel(sal_Int16 level);
+	
+	void	SetIndent(double indent);	
+	
+	void	SetMinLabelWidth(double labelWidth);	
+	
+	void	SetMinLabelDistance(double distance);
+
+	void	SetTextAlign(enumXFAlignType align);
+
+	virtual void	ToXml(IXFStream *pStrm);	
+private:
+	XFNumFmt	*m_pNumFmt;
+	sal_Int16	m_nLevel;
+	double		m_fIndent;	
+	double		m_fMinLabelWidth;	
+	double		m_fMinLabelDistance;
+	enumXFAlignType	m_eAlign;
+};
+
+class XFOutlineStyle : public XFStyle
+{
+public:
+	XFOutlineStyle();
+
+public:
+	void	SetNumFmt(sal_Int32 level, XFNumFmt& fmt);
+	
+	void	SetIndent(sal_Int32 level, double indent);	
+	
+	void	SetMinLabelWidth(sal_Int32 level, double labelWidth);	
+	
+	void	SetMinLabelDistance(sal_Int32 level, double distance);
+	
+	void	SetTextAlign(sal_Int32 level, enumXFAlignType align);
+
+	virtual enumXFStyle	GetStyleFamily();
+	
+	virtual void	ToXml(IXFStream *pStrm);	
+
+private:
+	XFOutlineLevelStyle	m_aLevels[10];
+};
+
+
+//
+//XFOutlineLevelStyle:
+//
+inline void XFOutlineLevelStyle::SetNumFmt(XFNumFmt& fmt)
+{
+	m_pNumFmt = new XFNumFmt(fmt);
+}
+
+inline void XFOutlineLevelStyle::SetLevel(sal_Int16 level)
+{
+	m_nLevel = level;
+}
+
+inline void XFOutlineLevelStyle::SetIndent(double indent)
+{
+	m_fIndent = indent;
+}
+
+inline void XFOutlineLevelStyle::SetMinLabelWidth(double width)
+{
+	m_fMinLabelWidth = width;
+}
+
+inline void XFOutlineLevelStyle::SetMinLabelDistance(double distance)
+{
+	m_fMinLabelDistance = distance;
+}
+
+inline void XFOutlineLevelStyle::SetTextAlign(enumXFAlignType align)
+{
+	m_eAlign = align;
+}
+
+//
+//XFOutlineStyle:
+//
+inline void XFOutlineStyle::SetNumFmt(sal_Int32 level, XFNumFmt& fmt)
+{
+	assert(level>=1&&level<=10);
+	m_aLevels[level].SetNumFmt(fmt);
+}
+
+inline void XFOutlineStyle::SetIndent(sal_Int32 level, double indent)
+{
+	assert(level>=1&&level<=10);
+	m_aLevels[level].SetIndent(indent);
+}
+
+inline void XFOutlineStyle::SetMinLabelWidth(sal_Int32 level, double width)
+{
+	assert(level>=1&&level<=10);
+	m_aLevels[level].SetMinLabelWidth(width);
+}
+
+inline void XFOutlineStyle::SetMinLabelDistance(sal_Int32 level, double distance)
+{
+	assert(level>=1&&level<=10);
+	m_aLevels[level].SetMinLabelDistance(distance);
+}
+
+inline void XFOutlineStyle::SetTextAlign(sal_Int32 level, enumXFAlignType align)
+{
+	assert(level>=1&&level<=10);
+	m_aLevels[level].SetTextAlign(align);
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpadding.hxx lotuswordpro/source/filter/xfilter/xfpadding.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpadding.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpadding.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,210 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Padding for paragraph.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 move some structure out of this file.
+ ************************************************************************/
+#ifndef		_XFPADDING_HXX
+#define		_XFPADDING_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+
+#define XFPADDING_FLAG_LEFT		0X00000001
+#define XFPADDING_FLAG_RIGHT	0X00000002
+#define XFPADDING_FLAG_TOP		0X00000004
+#define XFPADDING_FLAG_BOTTOM	0X00000008
+
+/**
+ * @brief
+ * Padings for paragraph,frame,...
+ */
+class XFPadding : public IXFProperty
+{
+public:
+	XFPadding();
+
+public:	
+	/**
+	 * @descr	Reset all values. 
+	 */
+	void	Reset();
+	
+	/**
+	 * @descr	Set padding left. 
+	 */
+	void	SetLeft(double left);
+
+	/**
+	 * @descr	Set padding right. 
+	 */
+	void	SetRight(double right);
+
+	/**
+	 * @descr	Set padding top. 
+	 */
+	void	SetTop(double top);
+
+	/**
+	 * @descr	Set padding bottom. 
+	 */
+	void	SetBottom(double bottom);
+	
+	/**
+	 * @descr	Output padding properties. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	friend bool operator==(XFPadding& p1, XFPadding& p2);
+	friend bool operator!=(XFPadding& p1, XFPadding& p2);		
+private:		
+	int		m_nFlag;
+	double	m_fLeft;
+	double	m_fRight;	
+	double	m_fTop;
+	double	m_fBottom;	
+};
+
+
+inline XFPadding::XFPadding()
+{
+	Reset();
+}
+
+inline void	XFPadding::Reset()
+{
+	m_nFlag = 0;
+	m_fLeft = 0;
+	m_fRight = 0;	
+	m_fTop = 0;
+	m_fBottom = 0;
+}
+
+inline void	XFPadding::SetLeft(double left) 
+{ 
+	m_fLeft = left; 
+	m_nFlag |= XFPADDING_FLAG_LEFT;
+}
+
+inline void	XFPadding::SetRight(double right) 
+{ 
+	m_fRight = right; 
+	m_nFlag |= XFPADDING_FLAG_RIGHT;
+}
+
+inline void	XFPadding::SetTop(double top) 
+{ 
+	m_fTop = top; 
+	m_nFlag |= XFPADDING_FLAG_TOP;
+}
+
+inline void	XFPadding::SetBottom(double bottom) 
+{ 
+	m_fBottom = bottom;
+	m_nFlag |= XFPADDING_FLAG_BOTTOM;
+}
+
+inline void	XFPadding::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	if( (m_fLeft == m_fRight) && (m_fLeft == m_fTop) && (m_fLeft== m_fBottom ) && m_nFlag == 0x00000015 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:padding"), DoubleToOUString(m_fLeft) + A2OUSTR("cm") );
+		return;
+	}
+	//margin left:
+	if( m_nFlag&XFPADDING_FLAG_LEFT )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:padding-left"), DoubleToOUString(m_fLeft) + A2OUSTR("cm") );
+	}
+	//margin right:
+	if( m_nFlag&XFPADDING_FLAG_RIGHT )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:padding-right"), DoubleToOUString(m_fRight) + A2OUSTR("cm") );
+	}		
+	//margin top:
+	if( m_nFlag&XFPADDING_FLAG_TOP )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:padding-top"), DoubleToOUString(m_fTop) + A2OUSTR("cm") );
+	}
+	//margin bottom:
+	if( m_nFlag&XFPADDING_FLAG_BOTTOM )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:padding-bottom"), DoubleToOUString(m_fBottom) + A2OUSTR("cm") );
+	}
+}
+
+inline bool operator==(XFPadding& p1, XFPadding& p2)
+{
+	return (
+		(p1.m_nFlag == p2.m_nFlag) &&
+		(p1.m_fLeft == p2.m_fLeft) &&
+		(p1.m_fRight == p2.m_fRight) &&
+		(p1.m_fTop == p2.m_fTop) &&
+		(p1.m_fBottom == p2.m_fBottom)
+		);
+}
+
+inline bool operator!=(XFPadding& p1, XFPadding& p2)
+{
+	return !(p1==p2);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpagecount.hxx lotuswordpro/source/filter/xfilter/xfpagecount.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpagecount.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpagecount.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,89 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page number field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-31 create this file.
+ ************************************************************************/
+#ifndef		_XFPAGECOUNT_HXX
+#define		_XFPAGECOUNT_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfnumfmt.hxx"
+
+/**
+ * @brief
+ * Page count field.
+ */
+class XFPageCount : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+inline void XFPageCount::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pStrm->StartElement( A2OUSTR("text:page-count") );
+	pStrm->EndElement( A2OUSTR("text:page-count") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpagemaster.cxx lotuswordpro/source/filter/xfilter/xfpagemaster.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfpagemaster.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpagemaster.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,300 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page master used bye XFMasterPage.
+ * It is the real object to define header and footer of pages.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#include	"xfpagemaster.hxx"
+#include	"ixfstream.hxx"
+#include	"ixfattrlist.hxx"
+#include	"xfborders.hxx"
+#include	"xfshadow.hxx"
+#include	"xfcolumns.hxx"
+#include	"xfheaderstyle.hxx"
+#include	"xffooterstyle.hxx"
+#include	"xfbgimage.hxx"
+
+XFPageMaster::XFPageMaster()
+{
+	m_fPageWidth = 0;
+	m_fPageHeight = 0;
+	m_eUsage = enumXFPageUsageNone;
+	m_eTextDir = enumXFTextDirNone;
+	m_bPrintOrient = sal_True;
+	m_pBorders = NULL;
+	m_pShadow = NULL;
+	m_pColumns = NULL;
+	m_pBGImage = NULL;
+
+	m_pHeaderStyle = NULL;
+	m_pFooterStyle = NULL;
+
+	m_eSepAlign = enumXFAlignNone;
+	m_fSepWidth = 0;
+	m_aSepColor = 0;
+	m_fSepSpaceAbove = 0;
+	m_fSepSpaceBelow = 0;
+	m_nSepLengthPercent = 0;
+}
+
+XFPageMaster::~XFPageMaster()
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	if( m_pShadow )
+		delete m_pShadow;
+	if( m_pColumns )
+		delete m_pColumns;
+	if( m_pHeaderStyle )
+		delete m_pHeaderStyle;
+	if( m_pFooterStyle )
+		delete m_pFooterStyle;
+	if( m_pBGImage )
+		delete m_pBGImage;
+}
+
+enumXFStyle	XFPageMaster::GetStyleFamily()
+{
+	return enumXFStylePageMaster;
+}
+
+void	XFPageMaster::SetPageWidth(double width)
+{
+	m_fPageWidth = width;
+}
+
+void	XFPageMaster::SetPageHeight(double height)
+{
+	m_fPageHeight = height;
+}
+
+void	XFPageMaster::SetMargins(double left, double right,double top, double bottom)
+{
+	if( left != -1 )
+		m_aMargin.SetLeft(left);
+	if( right != -1 )
+		m_aMargin.SetRight(right);
+	if( top != -1 )
+		m_aMargin.SetTop(top);
+	if( bottom != -1 )
+		m_aMargin.SetBottom(bottom);
+}
+
+void	XFPageMaster::SetBorders(XFBorders *pBorders)
+{
+	if( m_pBorders && (pBorders != m_pBorders) )
+		delete m_pBorders;
+	m_pBorders = pBorders;
+}
+
+void	XFPageMaster::SetShadow(XFShadow *pShadow)
+{
+	if( m_pShadow && (pShadow != m_pShadow) )
+		delete m_pShadow;
+	m_pShadow = pShadow;
+}
+
+void	XFPageMaster::SetBackColor(XFColor color)
+{
+	m_aBackColor = color;
+}
+
+void	XFPageMaster::SetBackImage(XFBGImage *image)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+	m_pBGImage = image;
+}
+
+void	XFPageMaster::SetColumns(XFColumns *pColumns)
+{
+	if( m_pColumns && (pColumns != m_pColumns) )
+		delete m_pColumns;
+	m_pColumns = pColumns;
+}
+
+ void	XFPageMaster::SetHeaderStyle(XFHeaderStyle *pHeaderStyle)
+{
+	if( m_pHeaderStyle && (pHeaderStyle != m_pHeaderStyle) )
+		delete m_pHeaderStyle;
+	m_pHeaderStyle = pHeaderStyle;
+}
+
+void	XFPageMaster::SetFooterStyle(XFFooterStyle *pFooterStyle)
+{
+	if( m_pFooterStyle && (pFooterStyle != m_pFooterStyle) )
+		delete m_pFooterStyle;
+	m_pFooterStyle = pFooterStyle;
+}
+
+void	XFPageMaster::SetFootNoteSeparator(
+							 enumXFAlignType align,
+							 double width, 
+							 sal_Int32 lengthPercent,
+							 double spaceAbove, 
+							 double spaceBelow,
+							 XFColor color
+							 )
+{
+	m_eSepAlign = align;
+	m_fSepWidth = width;
+	m_nSepLengthPercent = lengthPercent;
+	m_fSepSpaceAbove = spaceAbove;
+	m_fSepSpaceBelow = spaceBelow;
+	m_aSepColor = color;
+}
+
+/**
+ *
+	<style:page-master style:name="pm1">
+		<style:properties fo:page-width="20.999cm" fo:page-height="29.699cm" style:num-format="1" 
+			style:print-orientation="portrait" fo:margin-top="1.249cm" fo:margin-bottom="1.249cm" 
+			fo:margin-left="3.175cm" fo:margin-right="3.175cm" style:writing-mode="lr-tb" 
+			style:layout-grid-color="#c0c0c0" style:layout-grid-lines="42" 
+			style:layout-grid-base-height="0.494cm" style:layout-grid-ruby-height="0.141cm" 
+			style:layout-grid-mode="none" style:layout-grid-ruby-below="false" style:layout-grid-print="false" 
+			style:layout-grid-display="false" style:footnote-max-height="0cm">
+				<style:footnote-sep style:width="0.018cm" style:distance-before-sep="0.101cm" 
+					style:distance-after-sep="0.101cm" style:adjustment="left" style:rel-width="25%" style:color="#000000"/>
+		</style:properties>
+		<style:header-style>
+			<style:properties fo:min-height="1.291cm" fo:margin-bottom="0.792cm" style:dynamic-spacing="true"/>
+		</style:header-style>
+		<style:footer-style>
+			<style:properties fo:min-height="1.291cm" fo:margin-top="0.792cm" style:dynamic-spacing="true"/>
+		</style:footer-style>
+	</style:page-master>
+				
+ */
+void	XFPageMaster::ToXml(IXFStream *pStream)
+{
+	IXFAttrList	*pAttrList = pStream->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute(A2OUSTR("style:name"),GetStyleName());
+
+	if( m_eUsage != enumXFPageUsageNone )
+		pAttrList->AddAttribute(A2OUSTR("style:page-usage"), GetPageUsageName(m_eUsage));
+
+	pStream->StartElement( A2OUSTR("style:page-master") );
+
+	//style:properties
+	pAttrList->Clear();
+	if( m_fPageWidth != 0 )
+		pAttrList->AddAttribute( A2OUSTR("fo:page-width"), DoubleToOUString(m_fPageWidth) + A2OUSTR("cm") );
+	if( m_fPageHeight != 0 )
+		pAttrList->AddAttribute( A2OUSTR("fo:page-height"), DoubleToOUString(m_fPageHeight) + A2OUSTR("cm") );
+	
+	m_aMargin.ToXml(pStream);
+
+	if( m_bPrintOrient )
+		pAttrList->AddAttribute( A2OUSTR("style:print-orientation"), A2OUSTR("portrait") );
+	else
+		pAttrList->AddAttribute( A2OUSTR("style:print-orientation"), A2OUSTR("landscape") );
+	
+	if( m_pBorders )
+		m_pBorders->ToXml(pStream);
+	if( m_pShadow )
+		pAttrList->AddAttribute( A2OUSTR("style:shadow"), m_pShadow->ToString() );
+
+	if( m_aBackColor.IsValid() )
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+
+	//text directory
+	if( m_eTextDir != enumXFTextDirNone )
+		pAttrList->AddAttribute( A2OUSTR("style:writing-mode"), GetTextDirName(m_eTextDir) );	
+
+	pStream->StartElement( A2OUSTR("style:properties") );	
+	if( m_pColumns )
+		m_pColumns->ToXml(pStream);
+
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStream);
+
+	if( m_eSepAlign || m_nSepLengthPercent>0 || m_fSepSpaceAbove>0 || m_fSepSpaceBelow>0 )
+	{
+		pAttrList->Clear();
+		pAttrList->AddAttribute( A2OUSTR("style:width"), DoubleToOUString(m_fSepWidth) + A2OUSTR("cm") );
+		pAttrList->AddAttribute( A2OUSTR("style:distance-before-sep"), DoubleToOUString(m_fSepSpaceAbove) + A2OUSTR("cm") );
+		pAttrList->AddAttribute( A2OUSTR("style:distance-after-sep"), DoubleToOUString(m_fSepSpaceBelow) + A2OUSTR("cm") );
+		pAttrList->AddAttribute( A2OUSTR("style:color"), m_aSepColor.ToString() );
+		if( m_eSepAlign == enumXFAlignStart )
+			pAttrList->AddAttribute( A2OUSTR("style:adjustment"), A2OUSTR("left") );
+		else if( m_eSepAlign == enumXFAlignCenter )
+			pAttrList->AddAttribute( A2OUSTR("style:adjustment"), A2OUSTR("center") );
+		else if( m_eSepAlign == enumXFAlignEnd )
+			pAttrList->AddAttribute( A2OUSTR("style:adjustment"), A2OUSTR("right") );
+		pAttrList->AddAttribute( A2OUSTR("style:rel-width"), Int32ToOUString(m_nSepLengthPercent) + A2OUSTR("%") );
+		pStream->StartElement( A2OUSTR("style:footnote-sep") );
+		pStream->EndElement( A2OUSTR("style:footnote-sep") );
+	}
+
+	pStream->EndElement( A2OUSTR("style:properties") );
+
+	//header style:
+	if( m_pHeaderStyle )
+		m_pHeaderStyle->ToXml(pStream);
+	//footer style:
+	if( m_pFooterStyle )
+		m_pFooterStyle->ToXml(pStream);
+
+	pStream->EndElement( A2OUSTR("style:page-master") );
+
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpagemaster.hxx lotuswordpro/source/filter/xfilter/xfpagemaster.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpagemaster.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpagemaster.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,169 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page master used bye XFMasterPage.
+ * It is the real object to define header and footer of pages.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-17 create this file.
+ ************************************************************************/
+#ifndef		_XFPAGEMASTER_HXX
+#define		_XFPAGEMASTER_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+#include	"xfmargins.hxx"
+
+class XFBorders;
+class XFShadow;
+class XFColumns;
+class XFHeaderStyle;
+class XFFooterStyle;
+class XFBGImage;
+
+class XFPageMaster : public XFStyle
+{
+public:
+	XFPageMaster();
+
+	virtual ~XFPageMaster();
+
+public:
+	void	SetPageWidth(double width);
+
+	void	SetPageHeight(double height);
+
+	void	SetMargins(double left=-1, double right=-1,double top=-1, double bottom=-1);
+
+	void	SetPageUsage(enumXFPageUsage usage);
+
+	void	SetPrintOrient(sal_Bool bUseWidth=sal_True);
+
+	void	SetBorders(XFBorders *pBorders);
+
+	void	SetShadow(XFShadow *pShadow);
+
+	void	SetBackColor(XFColor color);
+
+	void	SetBackImage(XFBGImage *image);
+
+	void	SetColumns(XFColumns *pColumns);
+
+	void	SetHeaderStyle(XFHeaderStyle *pHeaderStyle);
+
+	void	SetFooterStyle(XFFooterStyle *pFooterStyle);
+
+	void	SetTextDir(enumXFTextDir dir);
+
+	void	SetFootNoteSeparator(enumXFAlignType align = enumXFAlignStart,
+								double width = 0.05, 
+								sal_Int32 lengthPercent = 25,
+								double spaceAbove = 0.1, 
+								double spaceBelow = 0.1,
+								XFColor color=XFColor(0,0,0)
+								);
+
+	virtual enumXFStyle	GetStyleFamily();
+	
+	virtual void	ToXml(IXFStream *pStream);
+
+private:
+	double	m_fPageWidth;
+	double	m_fPageHeight;
+	
+	XFMargins	m_aMargin;
+
+	enumXFPageUsage m_eUsage;
+	enumXFTextDir	m_eTextDir;
+	sal_Bool	m_bPrintOrient;
+
+	XFBorders	*m_pBorders;
+	XFShadow	*m_pShadow;
+	XFColor		m_aBackColor;
+	XFColumns	*m_pColumns;
+	XFBGImage	*m_pBGImage;
+
+	XFHeaderStyle	*m_pHeaderStyle;
+	XFFooterStyle	*m_pFooterStyle;
+	//seperator:
+	enumXFAlignType	m_eSepAlign;
+	double	m_fSepWidth;
+	XFColor	m_aSepColor;
+	double	m_fSepSpaceAbove;
+	double	m_fSepSpaceBelow;
+	sal_Int32	m_nSepLengthPercent;
+	
+};
+
+inline void	XFPageMaster::SetPageUsage(enumXFPageUsage usage)
+{
+	this->m_eUsage = usage;
+}
+
+inline void	XFPageMaster::SetPrintOrient(sal_Bool bUseWidth)
+{
+	m_bPrintOrient = bUseWidth;
+}
+
+inline void	XFPageMaster::SetTextDir(enumXFTextDir dir)
+{
+	m_eTextDir = dir;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpagenumber.hxx lotuswordpro/source/filter/xfilter/xfpagenumber.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpagenumber.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpagenumber.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,101 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page number field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-31 create this file.
+ ************************************************************************/
+#ifndef		_XFPAGENUMBER_HXX
+#define		_XFPAGENUMBER_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfnumfmt.hxx"
+
+/**
+ * @brief
+ * Page number field.
+ */
+class XFPageNumber : public XFContent
+{
+public:
+	void	SetNumFmt(rtl::OUString fmt);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	XFNumFmt	m_aNumFmt;
+};
+
+inline void	XFPageNumber::SetNumFmt(rtl::OUString fmt)
+{
+	m_aNumFmt.SetFormat(fmt);
+}
+
+inline void XFPageNumber::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	m_aNumFmt.ToXml(pStrm);
+	pAttrList->AddAttribute( A2OUSTR("text:select-page"), A2OUSTR("current") );
+	pStrm->StartElement( A2OUSTR("text:page-number") );
+	pStrm->EndElement( A2OUSTR("text:page-number") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfparagraph.cxx lotuswordpro/source/filter/xfilter/xfparagraph.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfparagraph.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfparagraph.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,123 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Paragraph object of OOo, it will output <text:p >...</text:p> element.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ ************************************************************************/
+#include	"xfparagraph.hxx"
+#include	"ixfstream.hxx"
+#include	"ixfattrlist.hxx"
+#include	"xftextcontent.hxx"
+
+XFParagraph::XFParagraph()
+{
+	
+}
+
+XFParagraph::XFParagraph(rtl::OUString& text,rtl::OUString& style)					
+{
+	IXFContent *pText = new XFTextContent(text);
+	Add(pText);
+
+	SetStyleName(style);
+}
+
+XFParagraph::~XFParagraph()
+{
+}
+
+enumXFContent XFParagraph::GetContentType()
+{
+	return enumXFContentPara;
+}
+
+/**
+ * The paragraph obejct serial function,the ouput will be like:
+ *		<text:p>
+ *			<text:span text:style-name="T1">text content</text:span>
+ *				text.
+ *			<text:span text:style-name="T1">text content</text:span>
+ *		</text:p>
+ */
+void	XFParagraph::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	assert(pAttrList);
+	
+	pAttrList->Clear();
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	pStrm->StartElement( A2OUSTR("text:p") );	
+	
+	XFContentContainer::ToXml(pStrm);
+	
+	pStrm->EndElement( A2OUSTR("text:p") );
+}
+
+void XFParagraph::ClearContents()
+{
+	Reset();
+}
+
+sal_Bool XFParagraph::HasContents()
+{
+	return GetCount()>0;
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfparagraph.hxx lotuswordpro/source/filter/xfilter/xfparagraph.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfparagraph.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfparagraph.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,99 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Paragraph object of OOo, it will output <text:p >...</text:p> element.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ ************************************************************************/
+#ifndef		_XFPARAGRAPH_HXX
+#define		_XFPARAGRAPH_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	<vector>
+
+class IXFStream;
+class IXFTextSpan;
+
+/**
+ * @brief
+ * Paragraph object for SODC.
+ * You can call Add() to add text span or drawing obejcts to XFParagraph.
+ */
+class XFParagraph : public XFContentContainer
+{
+public:
+	XFParagraph();
+
+	XFParagraph(rtl::OUString& text, rtl::OUString& style);
+
+	virtual ~XFParagraph();	
+
+public:	
+	void	ClearContents();
+
+	sal_Bool	HasContents();
+
+	virtual enumXFContent	GetContentType();
+	
+	virtual void	ToXml(IXFStream *pStrm);
+
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfparastyle.cxx lotuswordpro/source/filter/xfilter/xfparastyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfparastyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfparastyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,527 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Styles for paragraph.
+ * Styles for paragraph may include many style,include font,indent,margin,
+ * shadow,line height,and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10 create this file.
+ * 2005-01-20 move some structure out of this file.
+ ************************************************************************/
+#include	"xfparastyle.hxx"
+#include	"xffont.hxx"
+#include	"xfborders.hxx"
+#include	"xftabstyle.hxx"
+#include	"xfbgimage.hxx"
+
+XFParaStyle::XFParaStyle()
+{
+	//init member variables:
+	m_nFlag = 0;
+	m_eAlignType = enumXFAlignNone;
+	m_eLastLineAlign = enumXFAlignNone;
+	m_bJustSingleWord = sal_False;
+	m_bKeepWithNext = sal_False;
+	m_nPageNumber = 0;
+	m_fTextIndent = 0;
+
+	m_pFont = NULL;
+	m_pBorders = NULL;
+	m_pBGImage = NULL;
+
+	m_nLineNumberRestart = 0;
+	m_bNumberLines = sal_True;
+	m_bNumberRight = sal_False;
+}
+
+XFParaStyle::XFParaStyle(XFParaStyle& other)
+{
+	m_strParentStyleName = other.m_strParentStyleName;
+	m_nFlag = other.m_nFlag;
+	m_eAlignType = other.m_eAlignType;
+	m_fTextIndent = other.m_fTextIndent;
+	m_bNumberLines = other.m_bNumberLines;
+	m_nLineNumberRestart = other.m_nLineNumberRestart;
+	m_bNumberRight = other.m_bNumberRight;
+
+	if( other.m_pFont )
+		m_pFont = other.m_pFont;
+	else
+		m_pFont = NULL;
+
+	if( other.m_pBorders )
+		m_pBorders = new XFBorders(*other.m_pBorders);
+	else
+		m_pBorders = NULL;
+	m_aBackColor = other.m_aBackColor;
+	if( other.m_pBGImage )
+		m_pBGImage = new XFBGImage(*other.m_pBGImage);
+	else
+		m_pBGImage = NULL;
+	
+	m_aShadow = other.m_aShadow;	
+	m_aMargin = other.m_aMargin;
+	m_aDropcap = other.m_aDropcap;
+	m_aLineHeight = other.m_aLineHeight;
+	m_aPadding = other.m_aPadding;
+	m_aBreaks = other.m_aBreaks;
+//	m_aTabs = other.m_aTabs;
+	for( int i=0; i<other.m_aTabs.GetCount(); i++ )
+	{
+		IXFStyle *pStyle = other.m_aTabs.Item(i);
+		if( pStyle )
+		{
+			XFTabStyle *pTabStyle = (XFTabStyle*)(pStyle);
+			if( pTabStyle )
+			{
+				XFTabStyle *pCopyStyle = new XFTabStyle(*pTabStyle);
+				m_aTabs.AddStyle(pCopyStyle);
+			}
+		}
+	}
+}
+
+XFParaStyle& XFParaStyle::operator=(XFParaStyle& other)
+{
+	m_strParentStyleName = other.m_strParentStyleName;
+	m_nFlag = other.m_nFlag;
+	m_eAlignType = other.m_eAlignType;
+	m_fTextIndent = other.m_fTextIndent;
+	m_bNumberLines = other.m_bNumberLines;
+	m_nLineNumberRestart = other.m_nLineNumberRestart;
+	m_bNumberRight = other.m_bNumberRight;
+	
+	if( other.m_pFont )
+		m_pFont = other.m_pFont;
+	else
+		m_pFont = NULL;
+
+	if( other.m_pBorders )
+		m_pBorders = new XFBorders(*other.m_pBorders);
+	else
+		m_pBorders = NULL;
+	m_aBackColor = other.m_aBackColor;
+	if( other.m_pBGImage )
+		m_pBGImage = new XFBGImage(*other.m_pBGImage);
+	else
+		m_pBGImage = NULL;
+
+	m_aShadow = other.m_aShadow;	
+	m_aMargin = other.m_aMargin;
+	m_aDropcap = other.m_aDropcap;
+	m_aLineHeight = other.m_aLineHeight;
+	m_aPadding = other.m_aPadding;
+	m_aBreaks = other.m_aBreaks;
+	//	m_aTabs = other.m_aTabs;
+	for( int i=0; i<other.m_aTabs.GetCount(); i++ )
+	{
+		IXFStyle *pStyle = other.m_aTabs.Item(i);
+		if( pStyle )
+		{
+			XFTabStyle *pTabStyle = (XFTabStyle*)(pStyle);
+			if( pTabStyle )
+			{
+				XFTabStyle *pCopyStyle = new XFTabStyle(*pTabStyle);
+				m_aTabs.AddStyle(pCopyStyle);
+			}
+		}
+	}
+
+	return *this;
+}
+
+XFParaStyle::~XFParaStyle()
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	if( m_pBGImage )
+		delete m_pBGImage;
+}
+
+enumXFStyle	XFParaStyle::GetStyleFamily()
+{
+	return enumXFStylePara;
+}
+
+void	XFParaStyle::SetFont(XFFont *pFont)
+{
+	m_pFont = pFont;
+}
+
+void	XFParaStyle::SetIndent(double indent )
+{
+	m_fTextIndent = indent;	
+}
+
+void	XFParaStyle::SetMargins(double left, double right, double top, double bottom)
+{
+	if( left != -1 )
+		m_aMargin.SetLeft(left);
+	if( right != -1 )
+		m_aMargin.SetRight(right);
+	if( top != -1 )
+		m_aMargin.SetTop(top);
+	if( bottom != -1 )
+		m_aMargin.SetBottom( bottom );	
+}
+
+void	XFParaStyle::SetShadow(enumXFShadowPos pos, double offset, XFColor& color)
+{
+	m_aShadow.SetPosition(pos);
+	m_aShadow.SetOffset(offset);
+	m_aShadow.SetColor(color);
+}
+
+void	XFParaStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+	m_nFlag |= XFPARA_FLAG_BACKCOLOR;
+}
+
+void	XFParaStyle::SetBackImage(XFBGImage *image)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+	m_pBGImage = image;
+}
+
+void	XFParaStyle::SetBorders(XFBorders *pBorders)
+{
+	if( m_pBorders )
+		delete m_pBorders;
+	m_pBorders = pBorders;
+}
+
+void	XFParaStyle::SetDropCap(sal_Int16 nLength,	
+					   sal_Int16 nLines,
+					   double fDistance
+					   )
+{
+	assert(nLength>=1);
+	assert(nLines>=2);
+	assert(fDistance>=0);
+	
+	m_aDropcap.SetCharCount(nLength);
+	m_aDropcap.SetLines(nLines);
+	m_aDropcap.SetDistance(fDistance);	
+}
+
+void	XFParaStyle::SetLineHeight(enumLHType type, double value)
+{
+	if( type == enumLHNone )
+	{		
+		return;
+	}
+	switch(type)
+	{
+	case enumLHHeight:
+		m_aLineHeight.SetHeight(value)	;
+		break;
+	case enumLHLeast:
+		m_aLineHeight.SetLeastHeight(value);
+		break;
+	case enumLHPercent:	//perhaps i should redesign the interface here,ohm..
+		m_aLineHeight.SetPercent((sal_Int32)value);
+		break;
+	case enumLHSpace:
+		m_aLineHeight.SetSpace(value*0.5666);	//don't known why,just suspect.
+		break;
+	}
+}
+
+void	XFParaStyle::AddTabStyle(enumXFTab type, double len, sal_Unicode leader, sal_Unicode delimiter)
+{
+	XFTabStyle	*tab = new XFTabStyle();
+	tab->SetTabType(type);
+	tab->SetLength(len);
+	tab->SetLeaderChar(leader);
+	tab->SetDelimiter(delimiter);
+	m_aTabs.AddStyle(tab);
+}
+
+/**
+ *Affirm whether two XFParaStyle objects are equal.
+ */
+sal_Bool	XFParaStyle::Equal(IXFStyle *pStyle)
+{
+	if( this == pStyle )
+		return sal_True;
+	if( !pStyle || pStyle->GetStyleFamily() != enumXFStylePara )
+		return sal_False;
+		
+	XFParaStyle	*pOther = (XFParaStyle*)(pStyle);
+	if( !pOther )
+		return sal_False;
+
+	if( m_nFlag != pOther->m_nFlag )
+		return sal_False;
+	if( m_strParentStyleName != pOther->m_strParentStyleName )
+		return sal_False;	
+	if( m_strMasterPage != pOther->m_strMasterPage )
+		return sal_False;
+	if( m_fTextIndent != pOther->m_fTextIndent )
+		return sal_False;
+	if( m_bJustSingleWord != pOther->m_bJustSingleWord )
+		return sal_False;
+	if( m_bKeepWithNext != pOther->m_bKeepWithNext )
+		return sal_False;
+	//line number:
+	if( m_bNumberLines != pOther->m_bNumberLines )
+		return sal_False;
+	if( m_nLineNumberRestart != pOther->m_nLineNumberRestart )
+		return sal_False;
+	//align:
+	if( m_eAlignType != pOther->m_eAlignType )
+		return sal_False;
+	//last line align:
+	if( m_eLastLineAlign != pOther->m_eLastLineAlign )
+		return sal_False;
+
+	//shadow:
+	if( m_aShadow != pOther->m_aShadow )
+		return sal_False;
+	//margin:
+	if( m_aMargin != pOther->m_aMargin )
+		return sal_False;
+
+	if( m_aPadding != pOther->m_aPadding )
+		return sal_False;
+	
+	//dropcap:
+	if( m_aDropcap != pOther->m_aDropcap )
+		return sal_False;
+	//line height:
+	if( m_aLineHeight != pOther->m_aLineHeight )
+		return sal_False;
+	//breaks:
+	if( m_aBreaks != pOther->m_aBreaks )
+		return sal_False;
+	if( m_nPageNumber != pOther->m_nPageNumber )
+		return sal_False;
+	if( m_aTabs != pOther->m_aTabs )
+		return sal_False;
+
+	//font:
+	if( m_pFont )
+	{
+		if( !pOther->m_pFont )
+			return sal_False;
+		if(*m_pFont != *pOther->m_pFont )
+			return sal_False;
+	}
+	else if( pOther->m_pFont )
+		return sal_False;
+
+	//border:
+	if( m_pBorders )
+	{
+		if( !pOther->m_pBorders )
+			return sal_False;
+		if( *m_pBorders != *pOther->m_pBorders )
+			return sal_False;
+	}
+	else if( pOther->m_pBorders )
+		return sal_False;
+
+	if( m_pBGImage )
+	{
+		if( !pOther->m_pBGImage )
+			return sal_False;
+		if( *m_pBGImage != *pOther->m_pBGImage )
+			return sal_False;		
+	}
+	else if( pOther->m_pBGImage )
+		return sal_False;//add end
+		
+	//number right
+	if (	m_bNumberRight  != pOther->m_bNumberRight)
+		return sal_False;
+	
+	return sal_True;
+}
+
+void	XFParaStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	rtl::OUString style = GetStyleName();	
+	
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute(A2OUSTR("style:name"),GetStyleName());
+	pAttrList->AddAttribute(A2OUSTR("style:family"), A2OUSTR("paragraph"));
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());	
+	
+	if( m_strMasterPage.getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:master-page-name"),m_strMasterPage);		
+	pStrm->StartElement(A2OUSTR("style:style"));	
+	
+	//Paragraph properties:
+	pAttrList->Clear();
+
+	//text indent:
+	if( m_fTextIndent )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:text-indent"), DoubleToOUString(m_fTextIndent) + A2OUSTR("cm") );
+	}
+	//padding:
+	m_aPadding.ToXml(pStrm);
+	//margin:
+	m_aMargin.ToXml(pStrm);
+
+	//text align:
+	if( m_eAlignType != enumXFAlignNone )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:text-align"), GetAlignName(m_eAlignType) );
+	}
+	//last line align:
+	if( m_eLastLineAlign != enumXFAlignNone )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:fo:text-align-last"), GetAlignName(m_eLastLineAlign) );
+		if( m_bJustSingleWord )
+			pAttrList->AddAttribute(A2OUSTR("style:justify-single-word"), A2OUSTR("true") );
+	}
+	//line number:
+	if( m_bNumberLines )
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:number-lines"), A2OUSTR("true") );
+		pAttrList->AddAttribute( A2OUSTR("text:line-number"), Int32ToOUString(m_nLineNumberRestart) );
+	}
+	else
+	{
+		pAttrList->AddAttribute( A2OUSTR("text:number-lines"), A2OUSTR("false") );
+		assert(m_nLineNumberRestart>0);
+		pAttrList->AddAttribute( A2OUSTR("text:line-number"), A2OUSTR("0") );
+	}
+	
+	//shadow:
+	m_aShadow.ToXml(pStrm);
+	//borders:
+	if( m_pBorders )
+		m_pBorders->ToXml(pStrm);
+	//line height:
+	m_aLineHeight.ToXml(pStrm);
+
+	//background color:
+	if( m_nFlag&XFPARA_FLAG_BACKCOLOR && m_aBackColor.IsValid() )
+	{
+		pAttrList->AddAttribute(A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	}
+	//Font properties:
+	if( m_pFont )
+		m_pFont->ToXml(pStrm);
+
+	//page number:
+	if( m_nPageNumber )
+		pAttrList->AddAttribute(A2OUSTR("fo:page-number"), Int32ToOUString(m_nPageNumber) );
+	//page breaks:
+	m_aBreaks.ToXml(pStrm);
+
+	if( m_bKeepWithNext )
+		pAttrList->AddAttribute(A2OUSTR("fo:fo:keep-with-next"), A2OUSTR("true") );
+	
+	pStrm->StartElement(A2OUSTR("style:properties"));
+
+	//dropcap:
+	m_aDropcap.ToXml(pStrm);
+
+	//tabs:
+	if( m_aTabs.GetCount() > 0 )
+	{
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("style:tab-stops") );
+		m_aTabs.ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("style:tab-stops") );
+	}
+
+	//background color:
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStrm);
+
+	pStrm->EndElement(A2OUSTR("style:properties"));
+	
+	pStrm->EndElement(A2OUSTR("style:style"));
+}
+
+XFDefaultParaStyle::XFDefaultParaStyle()
+{
+	m_fTabDistance = 1.28;
+}
+
+enumXFStyle	XFDefaultParaStyle::GetStyleFamily()
+{
+	return enumXFStyleDefaultPara;
+}
+
+
+void XFDefaultParaStyle::ToXml(IXFStream * pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pAttrList->AddAttribute(A2OUSTR("style:family"), A2OUSTR("paragraph"));
+	pStrm->StartElement(A2OUSTR("style:default-style"));	
+	
+	//Paragraph properties:
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute(A2OUSTR("style:tab-stop-distance"), DoubleToOUString(m_fTabDistance) + A2OUSTR("cm") );
+
+	pStrm->StartElement(A2OUSTR("style:properties"));
+	pStrm->EndElement(A2OUSTR("style:properties"));
+	pStrm->EndElement(A2OUSTR("style:default-style"));
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfparastyle.hxx lotuswordpro/source/filter/xfilter/xfparastyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfparastyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfparastyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,364 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Styles for paragraph.
+ * Styles for paragraph may include many style,include font,indent,margin,
+ * shadow,line height,and so on.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10 create this file.
+ * 2005-01-20 move some structure out of this file.
+ ************************************************************************/
+#ifndef		_XFPARASTYLE_HXX
+#define		_XFPARASTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+#include	"xfmargins.hxx"
+#include	"xfbreaks.hxx"
+#include	"xfpadding.hxx"
+#include	"xfshadow.hxx"
+#include	"xfdropcap.hxx"
+#include	"xfstylecont.hxx"
+#include	"xflineheight.hxx"
+
+#define		XFPARA_FLAG_FONT		0X00000001
+#define		XFPARA_FLAG_DROPCAP		0X00000002
+#define		XFPARA_FLAG_BACKCOLOR	0X00000004
+
+class XFFont;
+class XFBorders;
+class XFBGImage;
+
+/**
+ * @brief	
+ * Style object for aragraph.
+ */
+class XFParaStyle : public XFStyle
+{
+public:
+	XFParaStyle();
+
+	XFParaStyle(XFParaStyle& other);
+
+	XFParaStyle& operator=(XFParaStyle& other);
+
+	virtual ~XFParaStyle();
+
+public:
+	/**
+	 * @descr	Set layout for the paragraph.When such property was setted, this paragraph will
+	 *			start at an new page.
+	 */
+	void	SetMasterPage(rtl::OUString master);
+	
+	rtl::OUString GetMasterPage();
+
+	/**
+	 * @descr	set the paragraph defaut font.
+	 * @param	font font obejct to be setted.Font object are deleted by font-factory,so
+	 *			dont't delete it in the destructure function of para style.
+	 */
+	void	SetFont(XFFont *font);	
+
+	/**
+	 * @descr	get the font object. 
+	 */
+	XFFont*	GetFont(){ return m_pFont; }
+
+	/**
+	 * @descr	Set the indent of the paragraph.This is the indent for
+				the first line.
+	 * @param	indent value of the first-line indent.
+	 */
+	void	SetIndent(double indent );
+
+	/**
+	 * @descr	Set line number style. 
+	 */
+	void	SetLineNumber(sal_Bool show, sal_Int32 restart=1);
+	/**
+	 * @descr	Set the pading of the paragraph.This is the distance 
+				between the border and the top of the text.
+	 * @param	indent value of the padding.
+	 */
+	void	SetPadding(double left, double right = -1, double top = -1, double bottom = -1);
+
+	/**
+	 * @descr	Set the Margins of the paragraph.
+	 * @param	-1:		don't change.
+				other:	set value.					
+	 */
+	void	SetMargins(double left, double right=-1,double top=-1, double bottom=-1);
+
+	/**
+	 * @descr	Set alignment property of the paragraph.
+	 * @param	eAlign alignment type,left,right,center or justify.					
+	 */
+	void	SetAlignType(enumXFAlignType eAlign);	
+
+	enumXFAlignType GetAlighType();
+	
+	
+	/**
+	 * @descr	Set last line alignment property of the paragraph.
+	 * @param	eAlign alignment type,left,right,center or justify.	
+				eJustSingleWord If chars of the last-line'word should be
+				stretched.
+	 */
+	void	SetLastLineAlign(enumXFAlignType align,sal_Bool	bJustSingleWord = sal_False);
+
+	/**
+	 * @descr	Set the shadow of the paragraph.there is 4 postions, you
+				can find it in the definition of enumShadowPos.
+	 * @param	pos
+	 * @param	offset the distance between the paragraph border and the shadow.
+	 * @param	color color to fill the shadow.
+	 */
+	void	SetShadow(enumXFShadowPos pos, double offset, XFColor& color);
+
+	/**
+	 * @descr	The borders is complex,so you have to create one before use.
+				Very few paragraphs will readly have borders property,this way
+				we can save much memory.
+	 * @param	pBorders borders of the paragraph,please reference the XFBorders.
+	 */
+	void	SetBorders(XFBorders *pBorders);
+
+	/**
+	 * @descr	Set drop caption of the paragraph.
+	 * @param	nLength number of chars to be droped.
+	 * @param	nLines line of which the droped chars will occupy.
+	 */
+	void	SetDropCap(sal_Int16 nLength = 1,sal_Int16 nLines = 3,double fDistance = 0);
+
+	/**
+	 * @descr	Set line height of the paragraph.
+	 * @param	type type of line height,fixed,space,percent or cm.
+	 * @param	value value of the line height
+	 */
+	void	SetLineHeight(enumLHType type, double value);
+
+	/**
+	 * @descr	Set background color of the paragraph.
+	 * @param	color value of the back color.	 
+	 */
+	void	SetBackColor(XFColor& color);
+
+	/**
+	 * @descr	Set background image of the paragraph.
+	 * @param	image the background image to set.	 
+	 */
+	void	SetBackImage(XFBGImage *image);
+
+	/**
+	 * descr	You can only set one break property for every para style object.
+	 */
+	void	SetBreaks(enumXFBreaks breaks);
+
+	/**
+	 * @descr	For paragraph numbering.
+	 */
+	void	SetPageNumber(sal_Int32 num);
+
+	/**
+	 * @descr	Add a tab style. 
+	 */
+	void	AddTabStyle(enumXFTab type, double len, sal_Unicode leader = '*', sal_Unicode delimiter='.');
+
+	/**
+	 * @descr	for para style copy operator,sometimes you may need to override tab styles.
+	 */
+	void	ClearTabStyles();
+
+	/**
+	 * descr	set the paragraph to be in the same page with the next paragraph. 
+	 *			If that can't be insured,the paragraph will start with a new page.
+	 */
+	void	SetKeepWithNext(sal_Bool keepWithNext);	
+
+	sal_uInt32 GetFlag(){ return m_nFlag; }
+	
+	/**
+	 * @descr	return margins. 
+	 */	
+	XFMargins GetMargins(){return m_aMargin;}	
+
+	virtual enumXFStyle	GetStyleFamily();	
+
+	virtual sal_Bool Equal(IXFStyle *pStyle);	
+
+	virtual void	ToXml(IXFStream *strm);
+
+	void SetNumberRight(sal_Bool bFlag){m_bNumberRight = bFlag;}
+	sal_Bool GetNumberRight(){return m_bNumberRight;}
+
+protected:	
+	rtl::OUString	m_strMasterPage;
+	enumXFAlignType	m_eAlignType;
+	enumXFAlignType	m_eLastLineAlign;
+	sal_Bool		m_bJustSingleWord;
+	sal_Bool		m_bKeepWithNext;
+	
+	double		m_fTextIndent;	
+	XFColor		m_aBackColor;
+	XFMargins	m_aMargin;
+	XFPadding	m_aPadding;
+	XFStyleContainer m_aTabs;
+	XFFont		*m_pFont;		
+	XFShadow	m_aShadow;
+	XFBorders	*m_pBorders;	
+	XFBGImage	*m_pBGImage;
+	XFDropcap	m_aDropcap;
+	XFLineHeight m_aLineHeight;	
+	XFBreaks	m_aBreaks;
+	sal_Int32	m_nPageNumber;	
+	sal_Bool	m_bNumberLines;
+	sal_Int32	m_nLineNumberRestart;
+
+	sal_uInt32	m_nFlag;
+	sal_Bool m_bNumberRight;
+};
+
+inline void XFParaStyle::SetMasterPage(rtl::OUString master)
+{
+	m_strMasterPage = master;
+}
+
+inline void	XFParaStyle::SetBreaks(enumXFBreaks breaks)
+{
+	m_aBreaks.SetBreakType(breaks);
+}
+
+inline void	XFParaStyle::SetPageNumber(sal_Int32 num)
+{
+	assert(num>0);
+	m_nPageNumber = num;
+}
+
+inline void	XFParaStyle::SetLineNumber(sal_Bool show, sal_Int32 restart)
+{
+	m_bNumberLines = show;
+	m_nLineNumberRestart = restart;
+}
+
+inline void XFParaStyle::SetPadding(double left, double right, double top, double bottom)
+{
+	m_aPadding.SetLeft(left);
+	if( right == -1 )
+		m_aPadding.SetRight(left);
+	else
+		m_aPadding.SetRight(right);
+	if( top == -1 )
+		m_aPadding.SetTop(left);
+	else
+		m_aPadding.SetTop(top);
+	if( bottom == -1 )
+		m_aPadding.SetBottom(left);
+	else
+		m_aPadding.SetBottom(bottom);
+}
+
+inline void	XFParaStyle::SetAlignType(enumXFAlignType eAlign)
+{
+	m_eAlignType = eAlign;
+}
+
+inline void XFParaStyle::SetLastLineAlign(enumXFAlignType align, sal_Bool	bJustSingleWord)
+{
+	m_eLastLineAlign = align;
+	m_bJustSingleWord = bJustSingleWord;
+}
+
+inline void XFParaStyle::SetKeepWithNext(sal_Bool keep)
+{
+	m_bKeepWithNext = keep;
+}
+
+inline void XFParaStyle::ClearTabStyles()
+{
+	m_aTabs.Reset();
+}
+
+inline 	rtl::OUString XFParaStyle::GetMasterPage()
+{
+	return m_strMasterPage;
+}
+
+inline enumXFAlignType XFParaStyle::GetAlighType()
+{
+	return m_eAlignType;
+}
+
+class XFDefaultParaStyle : public XFStyle
+{
+public:
+	XFDefaultParaStyle();
+	void SetTabDistance(double len);
+	enumXFStyle	GetStyleFamily();
+	virtual void	ToXml(IXFStream *pStrm);
+private:
+	double m_fTabDistance;	
+};
+
+inline void XFDefaultParaStyle::SetTabDistance(double len)
+{
+	m_fTabDistance = len;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfplaceholder.hxx lotuswordpro/source/filter/xfilter/xfplaceholder.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfplaceholder.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfplaceholder.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,144 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * place holder object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-05-24  create this file.
+ ************************************************************************/
+
+#ifndef		_XFPLACEHOLDER_HXX
+#define		_XFPLACEHOLDER_HXX
+
+#include	"xfcontent.hxx"
+
+/**
+ * @brief
+ * Index entry obejct.
+ */
+class XFHolderStart : public XFContent
+{
+public:
+	XFHolderStart();
+	~XFHolderStart();
+	void SetType(rtl::OUString sType);
+	void SetDesc(rtl::OUString sDesc);
+	void SetPrompt(rtl::OUString sText);
+	void ToXml(IXFStream *pStrm);
+private:
+	rtl::OUString m_strType;
+	rtl::OUString m_strDesc;
+	rtl::OUString m_strText;
+};
+
+XFHolderStart::XFHolderStart()
+{
+}
+
+XFHolderStart::~XFHolderStart()
+{
+}
+
+inline void XFHolderStart::SetType(rtl::OUString sType)
+{
+	m_strType = sType;
+}
+
+inline void XFHolderStart::SetDesc(rtl::OUString sDesc)
+{
+	m_strDesc = sDesc;
+}
+
+inline void XFHolderStart::SetPrompt(rtl::OUString sText)
+{
+	m_strText = sText;
+}
+
+inline void XFHolderStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("text:placeholder-type"),m_strType);
+	if (m_strDesc.getLength()>0)
+		pAttrList->AddAttribute( A2OUSTR("text:description"), m_strDesc);
+	pStrm->StartElement( A2OUSTR("text:placeholder") );	
+	if( m_strText.getLength()>0)
+		pStrm->Characters(m_strText);	
+}
+
+class XFHolderEnd : public XFContent
+{
+public:
+	XFHolderEnd();
+	~XFHolderEnd();
+	void ToXml(IXFStream *pStrm);
+};
+
+XFHolderEnd::XFHolderEnd()
+{
+}
+
+XFHolderEnd::~XFHolderEnd()
+{
+}
+
+inline void XFHolderEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:placeholder") );	
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpoint.hxx lotuswordpro/source/filter/xfilter/xfpoint.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpoint.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpoint.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,106 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Reperesent a point.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFPOINT_HXX
+#define		_XFPOINT_HXX
+
+class XFPoint
+{
+public:
+	XFPoint()
+	{
+		m_fX = m_fY = 0;
+	}
+
+	XFPoint(double x, double y)
+	{
+		m_fX = x;
+		m_fY = y;
+	}
+
+public:
+	void	SetX(double x)
+	{
+		m_fX = x;
+	}
+
+	void	SetY(double y)
+	{
+		m_fY = y;
+	}
+
+	double	GetX() const
+	{
+		return m_fX;
+	}
+
+	double	GetY() const
+	{
+		return m_fY;
+	}
+
+private:
+	double	m_fX;
+	double	m_fY;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfpvector.hxx lotuswordpro/source/filter/xfilter/xfpvector.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfpvector.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfpvector.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,100 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Pointer vector.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFPVECTOR_HXX
+#define		_XFPVECTOR_HXX
+
+#include	<vector>
+
+template<class T>
+class	XFPVector : public std::vector<T>
+{
+public:
+	~XFPVector()
+	{
+		std::vector<T>::iterator it;
+		for( it=begin(); it != end(); it++ )
+		{
+			T pT = *it;
+			if( pT )
+			{
+				delete pT;
+			}
+		}
+	}
+
+	void		Reset()
+	{
+		std::vector<T>::iterator it;
+		for( it=begin(); it != end(); it++ )
+		{
+			T *pT = *it;
+			if( pT )
+			{
+				delete pT;
+			}
+		}
+		clear();
+	}
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrect.hxx lotuswordpro/source/filter/xfilter/xfrect.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfrect.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrect.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,140 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Rect object
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-2-18 create this file.
+ ************************************************************************/
+#ifndef		_XFRECT_HXX
+#define		_XFRECT_HXX
+
+#include	"xfpoint.hxx"
+
+class XFRect
+{
+public:
+	XFRect()
+	{
+		m_fWidth = m_fHeight = 0;
+	}
+
+	XFRect(double x, double y, double width, double height):m_aPoint(x,y)
+	{
+		m_fWidth = width;
+		m_fHeight = height;
+	}
+
+public:
+	void	SetX(double x)
+	{
+		m_aPoint.SetX(x);
+	}
+
+	double	GetX() const
+	{
+		return m_aPoint.GetX();
+	}
+
+	void	SetY(double y)
+	{
+		m_aPoint.SetY(y);
+	}
+
+	double	GetY() const
+	{
+		return m_aPoint.GetY();
+	}
+
+	void	SetWidth(double width)
+	{
+		m_fWidth = width;
+	}
+
+	double	GetWidth() const
+	{
+		return m_fWidth;
+	}
+
+	void	SetHeight(double height)
+	{
+		m_fHeight = height;
+	}
+
+	double	GetHeight() const
+	{
+		return m_fHeight;
+	}
+
+	void	SetStartPoint(XFPoint pt)
+	{
+		m_aPoint = pt;
+	}
+
+	void	SetSize(double width, double height)
+	{
+		m_fWidth = width;
+		m_fHeight = height;
+	}
+
+public:
+	XFPoint	m_aPoint;
+	double	m_fWidth;
+	double	m_fHeight;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrow.cxx lotuswordpro/source/filter/xfilter/xfrow.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfrow.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrow.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,185 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-24 create and implements.
+ ************************************************************************/
+#include	"xfrow.hxx"
+#include	"xfcell.hxx"
+#include	"xftable.hxx"
+
+XFRow::XFRow()
+{
+	m_nRepeat = 0;
+	m_nRow = 0;
+}
+
+XFRow::XFRow(const XFRow& other)
+{
+	m_pOwnerTable = NULL;
+	m_nRepeat = other.m_nRepeat;
+	m_nRow = other.m_nRow;
+
+	for( int i=1; i<=other.GetCellCount(); i++ )
+	{
+		XFCell *pCell = new XFCell;
+		*pCell = *other.GetCell(i);
+		AddCell(pCell);
+	}
+}
+
+XFRow& XFRow::operator=(const XFRow& other)
+{
+	m_pOwnerTable = NULL;
+	m_nRepeat = other.m_nRepeat;
+	m_nRow = other.m_nRow;
+	
+	for( int i=1; i<=other.GetCellCount(); i++ )
+	{
+		XFCell *pCell = new XFCell;
+		*pCell = *other.GetCell(i);
+		AddCell(pCell);
+	}
+	return *this;
+}
+
+
+XFRow::~XFRow()
+{
+	std::map<sal_Int32,XFCell*>::iterator it;
+	for( it=m_aCells.begin(); it!=m_aCells.end(); it++ )
+	{
+		XFCell *pCell = (*it).second;
+		if( pCell )
+			delete pCell;
+	}
+}
+
+void	XFRow::AddCell(XFCell *pCell)
+{
+	if( !pCell )
+		return;
+/*	sal_Int32	col = pCell->GetCol();
+	if( col<1 )
+	{
+		pCell->SetCol(m_aCells.size()+1);
+	}
+
+	col = pCell->GetCol();
+	if( m_aCells.find(col) != m_aCells.end() )
+		delete m_aCells[col];
+*/
+	sal_Int32 col = m_aCells.size()+1;
+	pCell->SetCol(col);
+	pCell->SetOwnerRow(this);
+	m_aCells[col]=pCell;
+}
+
+sal_Int32	XFRow::GetCellCount() const
+{
+	return m_aCells.size();
+}
+
+XFCell*	XFRow::GetCell(sal_Int32 col) const
+{
+	if( m_aCells.find(col) == m_aCells.end() )
+		return NULL;	
+	else
+		return m_aCells.find(col)->second;
+}
+
+rtl::OUString	XFRow::GetRowName()
+{
+	if( m_pOwnerTable && m_pOwnerTable->IsSubTable() )
+		return m_pOwnerTable->GetTableName();
+	return A2OUSTR("");
+}
+
+void	XFRow::ToXml(IXFStream *pStrm)
+{
+	sal_Int32	lastCol = 0;
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("table:style-name"), GetStyleName() );
+	if( m_nRepeat )
+		pAttrList->AddAttribute( A2OUSTR("table:number-rows-repeated"), Int32ToOUString(m_nRepeat) );
+	pStrm->StartElement( A2OUSTR("table:table-row") );
+
+	std::map<sal_Int32,XFCell*>::iterator	it = m_aCells.begin();
+	for( ; it!=m_aCells.end(); it++ )
+	{
+		int	col = (*it).first;
+		XFCell	*pCell = (*it).second;
+		if( !pCell )
+			continue;	
+		if( col>lastCol+1 )
+		{			
+			XFCell *pNULLCell = new XFCell();
+			if( col>lastCol+2 )
+				pNULLCell->SetRepeated(col-lastCol-1);
+			pNULLCell->ToXml(pStrm);
+		}			
+		pCell->ToXml(pStrm);
+		lastCol = col;
+	}
+
+	pStrm->EndElement( A2OUSTR("table:table-row") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrow.hxx lotuswordpro/source/filter/xfilter/xfrow.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfrow.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrow.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,142 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table row object. A table is consist by rows.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create and implements.
+ ************************************************************************/
+#ifndef		_XFROW_HXX
+#define		_XFROW_HXX
+
+#include	"xfcontent.hxx"
+#include	<map>
+
+class XFCell;
+class XFTable;
+class XFRow : public XFContent
+{
+public:
+	XFRow();
+
+	XFRow(const XFRow& other);
+
+	XFRow& operator=(const XFRow& other);
+
+	virtual ~XFRow();
+
+public:
+	void	AddCell(XFCell *pCell);
+
+	void	SetRepeated(sal_Int32 repeat);
+
+	void	SetRow(sal_Int32 row);
+
+	void	SetOwnerTable(XFTable *pTable);
+
+	sal_Int32	GetRow();
+	
+	sal_Int32	GetCellCount() const;
+
+	XFCell*		GetCell(sal_Int32 col) const;
+
+	XFTable*	GetOwnerTable();
+
+	rtl::OUString	GetRowName();
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	void		RemoveCell(sal_Int32 cell);
+	
+private:
+	XFTable		*m_pOwnerTable;
+	std::map<sal_Int32,XFCell*>	m_aCells;
+	sal_Int32	m_nRepeat;
+	sal_Int32	m_nRow;
+};
+
+inline void XFRow::SetRepeated(sal_Int32 repeat)
+{
+	m_nRepeat = repeat;
+}
+
+inline void XFRow::SetRow(sal_Int32 row)
+{
+	m_nRow = row;
+}
+
+inline void XFRow::SetOwnerTable(XFTable *pTable)
+{
+	m_pOwnerTable = pTable;
+}
+
+inline sal_Int32 XFRow::GetRow()
+{
+	return m_nRow;
+}
+
+inline XFTable*	XFRow::GetOwnerTable()
+{
+	return m_pOwnerTable;
+}
+
+inline void XFRow::RemoveCell(sal_Int32 cell)
+{
+	m_aCells.erase(cell);
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrowstyle.cxx lotuswordpro/source/filter/xfilter/xfrowstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfrowstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrowstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,129 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table row style, ie. table row height.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create and implements.
+ ************************************************************************/
+#include	"xfrowstyle.hxx"
+#include	"xfbgimage.hxx"
+
+XFRowStyle::XFRowStyle():m_fHeight(0)
+{
+	m_fHeight = 0;
+	m_fMinHeight = 0;
+	m_pBGImage = NULL;
+}
+
+
+void	XFRowStyle::SetbackImage(XFBGImage *pImage)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+	m_pBGImage = pImage;
+}
+
+enumXFStyle	XFRowStyle::GetStyleFamily()
+{
+	return enumXFStyleTableRow;
+}
+
+void	XFRowStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("table-row") );
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	pAttrList->Clear();
+	if( m_fMinHeight )
+		pAttrList->AddAttribute( A2OUSTR("style:min-row-height"), DoubleToOUString(m_fMinHeight) + A2OUSTR("cm") );
+	else if( m_fHeight )
+		pAttrList->AddAttribute( A2OUSTR("style:row-height"), DoubleToOUString(m_fHeight) + A2OUSTR("cm") );
+	
+	if( m_aBackColor.IsValid() && !m_pBGImage )
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
+
+XFRowStyle& XFRowStyle::operator=(XFRowStyle& other)
+{
+	m_fHeight = other.m_fHeight;
+	m_fMinHeight = other.m_fMinHeight;
+	m_aBackColor = other.m_aBackColor;
+
+	if( m_pBGImage )
+		delete m_pBGImage;
+
+	if( other.m_pBGImage )
+		m_pBGImage = new XFBGImage(*other.m_pBGImage);
+	else
+		m_pBGImage = NULL;
+	return *this;
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrowstyle.hxx lotuswordpro/source/filter/xfilter/xfrowstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfrowstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrowstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,126 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table row style, ie. table row height.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-28 create and implements.
+ ************************************************************************/
+#ifndef		_XFROWSTYLE_HXX
+#define		_XFROWSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfcolor.hxx"
+
+class XFBGImage;
+class XFRowStyle : public XFStyle
+{
+public:
+	XFRowStyle();
+	XFRowStyle& operator=(XFRowStyle& other);
+
+public:
+	void	SetRowHeight(double height);
+	
+	double	GetRowHeight();
+
+	void	SetMinRowHeight(double height);
+
+	void	SetBackColor(XFColor& color);
+
+	void	SetbackImage(XFBGImage *pImage);
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	double	m_fHeight;
+	double	m_fMinHeight;
+	XFColor	m_aBackColor;		
+	XFBGImage	*m_pBGImage;
+};
+
+inline void XFRowStyle::SetRowHeight(double height)
+{
+	m_fHeight = height;
+}
+
+inline void XFRowStyle::SetMinRowHeight(double height)
+{
+	m_fMinHeight = height;
+}
+
+inline void XFRowStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+}
+inline double XFRowStyle::GetRowHeight()
+{
+	if (m_fMinHeight > FLOAT_MIN)
+	{
+		return m_fMinHeight;
+	}
+
+	else if (m_fHeight > FLOAT_MIN)
+	{
+		return m_fHeight;
+	}
+	return 0;
+}
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfruby.hxx lotuswordpro/source/filter/xfilter/xfruby.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfruby.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfruby.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,113 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * ruby text.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-06-21  create this file.
+ ************************************************************************/
+#ifndef		_XFRUBY_HXX
+#define		_XFRUBY_HXX
+
+#include "xfcontent.hxx"
+
+class XFRubyStart : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+class XFRubyEnd : public XFContent
+{
+public:
+	void SetText(rtl::OUString sText);
+	virtual void	ToXml(IXFStream *pStrm);
+private:
+	rtl::OUString m_strText;
+};
+
+void XFRubyStart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if( GetStyleName().getLength())
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName());	
+	pStrm->StartElement( A2OUSTR("text:ruby") );
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:ruby-base") );
+}
+
+void XFRubyEnd::SetText(rtl::OUString sText)
+{
+	m_strText = sText;
+}
+
+void XFRubyEnd::ToXml(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:ruby-base") );
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	if( GetStyleName().getLength())
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName());		
+	pStrm->StartElement( A2OUSTR("text:ruby-text") );
+	if( m_strText.getLength() )
+		pStrm->Characters(m_strText);
+	pStrm->EndElement( A2OUSTR("text:ruby-text") );		
+	pStrm->EndElement( A2OUSTR("text:ruby") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfrubystyle.hxx lotuswordpro/source/filter/xfilter/xfrubystyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfrubystyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfrubystyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,143 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * ruby style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-06-21  create this file.
+ ************************************************************************/
+#ifndef		_XFRUBYSTYLE_HXX
+#define		_XFRUBYSTYLE_HXX
+
+#include "xfglobal.hxx"
+#include "xfstyle.hxx"
+#include "xfdefs.hxx"
+
+class XFRubyStyle : public XFStyle 
+{
+public:
+	XFRubyStyle(){};
+	virtual ~XFRubyStyle(){};
+	virtual void ToXml(IXFStream *strm);
+	void SetPosition(enumXFRubyPosition ePosition);
+	void SetAlignment(enumXFRubyPosition eAlignment);
+	enumXFStyle GetStyleFamily();
+
+private:
+	enumXFRubyPosition m_ePos;
+	enumXFRubyPosition m_eAlign;	
+};
+
+void XFRubyStyle::SetPosition(enumXFRubyPosition ePosition)
+{
+	m_ePos = ePosition;
+}
+void XFRubyStyle::SetAlignment(enumXFRubyPosition eAlignment)
+{
+	m_eAlign = eAlignment;
+}
+enumXFStyle XFRubyStyle::GetStyleFamily()
+{
+	return enumXFStyleRuby;
+}
+void XFRubyStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	rtl::OUString style = GetStyleName();	
+	
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute(A2OUSTR("style:name"),GetStyleName());
+	pAttrList->AddAttribute(A2OUSTR("style:family"), A2OUSTR("ruby"));	
+	pStrm->StartElement(A2OUSTR("style:style"));
+	
+	pAttrList->Clear();
+	
+	OUString sPos;
+	if (m_eAlign == enumXFRubyLeft)
+	{
+		sPos = A2OUSTR("left");
+	}
+	else if(m_eAlign == enumXFRubyRight)
+	{
+		sPos =  A2OUSTR("right");
+	}
+	else if(m_eAlign == enumXFRubyCenter)
+	{
+		sPos =  A2OUSTR("center");
+	}
+	if (sPos.getLength()>0)	
+		pAttrList->AddAttribute(A2OUSTR("style:ruby-align"),sPos);
+	
+	OUString sAlign;
+	if (m_ePos == enumXFRubyTop)
+	{
+		sAlign = A2OUSTR("above");
+	}
+	else if(m_ePos == enumXFRubyBottom)
+	{
+		sAlign =  A2OUSTR("below");
+	}
+	if (sAlign.getLength()>0)
+		pAttrList->AddAttribute(A2OUSTR("style:ruby-position"),sAlign);
+	
+	pStrm->StartElement(A2OUSTR("style:properties"));
+	pStrm->EndElement(A2OUSTR("style:properties"));	
+	pStrm->EndElement(A2OUSTR("style:style"));		
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsaxattrlist.cxx lotuswordpro/source/filter/xfilter/xfsaxattrlist.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfsaxattrlist.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsaxattrlist.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,88 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Document object of the xml filter framework.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+
+#include	"xfsaxattrlist.hxx"
+#include	"xmloff/attrlist.hxx"
+
+XFSaxAttrList::XFSaxAttrList()
+{
+	m_pSvAttrList = new SvXMLAttributeList();
+	m_xAttrList.set(m_pSvAttrList);
+}
+
+XFSaxAttrList::~XFSaxAttrList()
+{
+	//pls don't delete m_pSvAttrList,because when m_xAttrList release,the object will be automatic deleted.
+//	if( m_pSvAttrList )
+//		delete m_pSvAttrList;
+}
+
+void	XFSaxAttrList::AddAttribute(const rtl::OUString& name, const rtl::OUString& value)
+{
+	m_pSvAttrList->AddAttribute(name,value);
+}
+
+void	XFSaxAttrList::Clear()
+{
+	m_pSvAttrList->Clear();
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsaxattrlist.hxx lotuswordpro/source/filter/xfilter/xfsaxattrlist.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfsaxattrlist.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsaxattrlist.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,101 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Wrapper the attibute list of a xml element.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFSAXATTRLIST_HXX
+#define		_XFSAXATTRLIST_HXX
+
+#include	"ixfattrlist.hxx"
+#include	"xmloff/attrlist.hxx"
+#include <com/sun/star/xml/sax/XDocumentHandler.hpp>
+
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::xml::sax;
+
+class	XFSaxAttrList : public IXFAttrList
+{
+public:
+	XFSaxAttrList();
+
+	virtual ~XFSaxAttrList();
+
+public:
+	//Interface ISaxAttributeList:
+	virtual void	AddAttribute(const rtl::OUString& name, const rtl::OUString& value);	
+
+	virtual void	Clear();
+
+	Reference<XAttributeList>	GetAttributeList();
+
+	friend class XFSaxStream;
+private:
+	SvXMLAttributeList	*m_pSvAttrList;
+	Reference<XAttributeList>	m_xAttrList;
+	
+};
+
+inline Reference<XAttributeList>	XFSaxAttrList::GetAttributeList()
+{
+	return m_xAttrList;
+}
+
+#endif //XFSAXATTRLIST_INC
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsaxstream.cxx lotuswordpro/source/filter/xfilter/xfsaxstream.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfsaxstream.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsaxstream.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,130 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Tool for sax writer.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-12-23 create this file.
+ ************************************************************************/
+#include	"xfsaxstream.hxx"
+#include	"xfsaxattrlist.hxx"
+
+#include <cppuhelper/implbase1.hxx>
+#include <cppuhelper/implbase3.hxx>
+#include <cppuhelper/factory.hxx>
+
+#include <com/sun/star/document/XFilter.hpp>
+#include <com/sun/star/document/XImporter.hpp>
+#include <com/sun/star/xml/sax/XDocumentHandler.hpp>
+#include <com/sun/star/lang/XServiceInfo.hpp>
+#include <com/sun/star/io/XInputStream.hpp>
+
+using namespace ::rtl;
+using namespace ::cppu;
+using namespace ::com::sun::star::lang;
+using namespace ::com::sun::star::io;
+using namespace ::com::sun::star::registry;
+using namespace ::com::sun::star::document;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::xml::sax;
+using namespace ::com::sun::star::uno;
+
+XFSaxStream::XFSaxStream(Reference<XDocumentHandler>& xHandler)
+{
+	m_aHandler = xHandler;
+	m_pAttrList = new XFSaxAttrList();
+}
+
+XFSaxStream::~XFSaxStream()
+{
+	if( m_pAttrList )
+		delete m_pAttrList;
+}
+
+void		XFSaxStream::StartDocument()
+{
+	m_aHandler->startDocument();
+}
+
+void		XFSaxStream::EndDocument()
+{
+	m_aHandler->endDocument();
+}
+
+void		XFSaxStream::StartElement(const rtl::OUString& oustr)
+{	
+	m_aHandler->startElement( oustr, m_pAttrList->GetAttributeList() );
+	m_pAttrList->Clear();
+}
+
+void		XFSaxStream::EndElement(const rtl::OUString& oustr)
+{
+	m_aHandler->endElement(oustr);
+	
+	if( m_pAttrList )
+		m_pAttrList->Clear();
+}
+
+void		XFSaxStream::Characters(const rtl::OUString& oustr)
+{
+	m_aHandler->characters(oustr);
+}
+
+IXFAttrList*	XFSaxStream::GetAttrList()
+{
+	return m_pAttrList;
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsaxstream.hxx lotuswordpro/source/filter/xfilter/xfsaxstream.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfsaxstream.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsaxstream.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,138 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Tool for sax writer.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFSAXSTREAM_HXX
+#define		_XFSAXSTREAM_HXX
+
+#include	"ixfstream.hxx"
+
+#include	<cppuhelper/implbase1.hxx>
+#include	<cppuhelper/implbase3.hxx>
+#include	<cppuhelper/factory.hxx>
+#include	<com/sun/star/document/XFilter.hpp>
+#include	<com/sun/star/document/XImporter.hpp>
+#include	<com/sun/star/xml/sax/XDocumentHandler.hpp>
+#include	<com/sun/star/lang/XServiceInfo.hpp>
+#include	<com/sun/star/io/XInputStream.hpp>
+
+using namespace ::rtl;
+using namespace ::cppu;
+using namespace ::com::sun::star::lang;
+using namespace ::com::sun::star::io;
+using namespace ::com::sun::star::registry;
+using namespace ::com::sun::star::document;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::xml::sax;
+using namespace ::com::sun::star::uno;
+
+class XFSaxAttrList;
+class IXFAttrList;
+
+/**
+ * @brief
+ * Sax stream object, XDocumentHandler wrapper.
+ */
+class XFSaxStream : public IXFStream
+{
+public:
+	XFSaxStream(Reference<XDocumentHandler>& xHandler);
+
+	virtual ~XFSaxStream();
+
+public:	
+	/**
+	 * @descr	Start document callback. 
+	 */
+	virtual void			StartDocument();
+
+	/**
+	 * @descr	End document callback. 
+	 */
+	virtual void			EndDocument();
+
+	/**
+	 * @descr	Start output element. 
+	 */
+	virtual void			StartElement(const rtl::OUString& oustr);
+
+	/**
+	 * @descr	End output element. 
+	 */
+	virtual void			EndElement(const rtl::OUString& oustr);
+
+	/**
+	 * @descr	Output Character section. 
+	 */
+	virtual void			Characters(const rtl::OUString& oustr);
+	
+	/**
+	 * @descr	Get the attribute list interface. 
+	 */
+	virtual IXFAttrList*	GetAttrList();
+	
+public:
+	Reference<XDocumentHandler> m_aHandler;
+	XFSaxAttrList				*m_pAttrList;
+};
+
+#endif //XFSAXSTREAM_INC
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsection.cxx lotuswordpro/source/filter/xfilter/xfsection.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfsection.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsection.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,155 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Section object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-12-28 create this file.
+ ************************************************************************/
+#include	"xfsection.hxx"
+
+XFSection::XFSection()
+{
+	m_bProtected = sal_False;
+	m_bHiden = sal_False;	
+	m_strSectionName = XFGlobal::GenSectionName();
+}
+
+XFSection::~XFSection()
+{
+}
+
+void	XFSection::SetSectionName(rtl::OUString name)
+{
+	m_strSectionName = name;
+}
+
+void XFSection::SetSourceLink( rtl::OUString link)
+{
+	m_strSourceLink = link;
+}
+
+void	XFSection::SetProtected(sal_Bool bProtected)
+{
+	m_bProtected = bProtected;
+}
+
+void	XFSection::SetHiden(sal_Bool hiden)
+{
+	m_bHiden = hiden;
+}
+
+void	XFSection::ToXml(IXFStream *pStrm)
+{
+	assert(m_strSectionName.getLength() > 0 );
+
+	IXFAttrList		*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	rtl::OUString style = GetStyleName();
+	if( style.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), style);
+	//section name
+	if( m_strSectionName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:name"), m_strSectionName);
+	if( m_bProtected )
+		pAttrList->AddAttribute( A2OUSTR("text:protected"), A2OUSTR("true") );
+	if( m_bHiden )
+		pAttrList->AddAttribute( A2OUSTR("text:display"), A2OUSTR("none") );
+	
+	pStrm->StartElement( A2OUSTR("text:section") );	
+	if( m_strSourceLink.getLength() )
+	{
+		pAttrList->Clear();
+		pAttrList->AddAttribute( A2OUSTR("xlink:href"), m_strSourceLink);
+		pAttrList->AddAttribute( A2OUSTR("text:filter-name"), A2OUSTR("wordpro"));
+		pStrm->StartElement( A2OUSTR("text:section-source") );
+		pStrm->EndElement( A2OUSTR("text:section-source") );
+	}
+
+	XFContentContainer::ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("text:section") );
+
+}
+/*
+void XFSection::ToXmlHeader(IXFStream *pStrm)
+{
+	assert(m_strSectionName.getLength() > 0 );
+
+	IXFAttrList		*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	rtl::OUString style = GetStyleName();
+	if( style.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), style);
+	//section name
+	if( m_strSectionName.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:name"), m_strSectionName);
+	if( m_bProtected )
+		pAttrList->AddAttribute( A2OUSTR("text:protected"), A2OUSTR("true") );
+	if( m_bHiden )
+		pAttrList->AddAttribute( A2OUSTR("text:display"), A2OUSTR("none") );
+	
+	pStrm->StartElement( A2OUSTR("text:section") );
+}
+
+void XFSection::ToXmlTail(IXFStream *pStrm)
+{
+	pStrm->EndElement( A2OUSTR("text:section") );
+}
+*/
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsection.hxx lotuswordpro/source/filter/xfilter/xfsection.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfsection.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsection.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,121 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Section object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-12-28 create this file.
+ ************************************************************************/
+#ifndef		_XFSECTION_HXX
+#define		_XFSECTION_HXX
+
+#include	"xfcontentcontainer.hxx"
+#include	"xfcontent.hxx"
+#include	"xfcolor.hxx"
+#include	<vector>
+
+/**
+ * @brief
+ * Section object.
+ */
+class XFSection : public XFContentContainer
+{
+public:
+	XFSection();
+
+	virtual ~XFSection();
+
+public:
+	/**
+	 * @descr	Set section name. If not setted, i'll generate a name for it. 
+	 */
+	void	SetSectionName(rtl::OUString name);
+
+	void	SetSourceLink(rtl::OUString link);
+
+	/**
+	 * @descr	Set protected. 
+	 */
+	void	SetProtected(sal_Bool bProtected);
+
+	/**
+	 * @descr	Set hidden. 
+	 */
+	void	SetHiden(sal_Bool hiden);	
+
+	/**
+	 * @descr	Output section obejct. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+/*
+private:
+	void ToXmlHeader(IXFStream *pStrm);
+
+	void ToXmlTail(IXFStream *pStrm);
+*/
+private:
+	rtl::OUString	m_strSectionName;
+	sal_Bool	m_bProtected;
+	sal_Bool	m_bHiden;
+	XFColor		m_aBackColor;
+	double		m_fMarginLeft;
+	double		m_fMarginRight;
+	rtl::OUString	m_strSourceLink;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsectionstyle.cxx lotuswordpro/source/filter/xfilter/xfsectionstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfsectionstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsectionstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,156 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Section style,whose family is "section"
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10	create this file.
+ ************************************************************************/
+#include	"xfsectionstyle.hxx"
+#include	"xfcolumns.hxx"
+
+XFSectionStyle::XFSectionStyle()
+{
+	m_fMarginLeft = 0;
+	m_fMarginRight = 0;
+	m_pBackImage = NULL;
+	m_pColumns = NULL;
+}
+
+XFSectionStyle::~XFSectionStyle()
+{
+	if( m_pColumns )
+		delete m_pColumns;
+	if( m_pBackImage )
+		delete m_pBackImage;
+}
+
+enumXFStyle XFSectionStyle::GetStyleFamily()
+{
+	return enumXFStyleSection;
+}
+
+void XFSectionStyle::SetMarginLeft(double left)
+{
+	m_fMarginLeft = left;
+}
+
+void XFSectionStyle::SetMarginRight(double right)
+{
+	m_fMarginRight = right;
+}
+
+void XFSectionStyle::SetBackColor(const XFColor& color)
+{
+	m_aBackColor = color;
+}
+
+void	XFSectionStyle::SetColumns(XFColumns *pColumns)
+{
+	if( m_pColumns )
+		delete m_pColumns;
+	m_pColumns = pColumns;
+}
+
+void	XFSectionStyle::SetBackImage(XFBGImage *image)
+{
+	if( m_pBackImage )
+		delete m_pBackImage;
+	m_pBackImage = image;
+}
+
+void XFSectionStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("section") );
+
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	pAttrList->Clear();
+	if( m_fMarginLeft != 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:margin-left"), DoubleToOUString(m_fMarginLeft) + A2OUSTR("cm") );
+	}
+	if( m_fMarginRight != 0 )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:margin-right"), DoubleToOUString(m_fMarginRight) + A2OUSTR("cm") );
+	}
+	if( m_aBackColor.IsValid() && !m_pBackImage )
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	}
+	else
+	{
+		pAttrList->AddAttribute( A2OUSTR("fo:background-color"), A2OUSTR("transparent") );
+	}
+
+	pStrm->StartElement( A2OUSTR("style:properties") );
+
+	if( m_pColumns )
+		m_pColumns->ToXml(pStrm);
+	if( m_pBackImage )
+		m_pBackImage->ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+
+
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsectionstyle.hxx lotuswordpro/source/filter/xfilter/xfsectionstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfsectionstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsectionstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,107 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Section style,whose family is "section"
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-10	create this file.
+ ************************************************************************/
+#ifndef		_XFSECTIONSTYLE_HXX
+#define		_XFSECTIONSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfbgimage.hxx"
+#include	"xfcolor.hxx"
+
+class XFColumns;
+/*
+ *	@descr
+ *	Section style, include background color,background image, columns and margins.
+ */
+class XFSectionStyle : public XFStyle
+{
+public:
+	XFSectionStyle();
+
+	virtual ~XFSectionStyle();
+
+public:
+	void	SetMarginLeft(double left);
+
+	void	SetMarginRight(double right);
+
+	void	SetBackColor(const XFColor& color);
+
+	void	SetColumns(XFColumns *pColumns);
+
+	void	SetBackImage(XFBGImage *image);
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	double		m_fMarginLeft;
+	double		m_fMarginRight;
+	XFColor		m_aBackColor;		
+	XFColumns	*m_pColumns;
+	XFBGImage	*m_pBackImage;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfshadow.cxx lotuswordpro/source/filter/xfilter/xfshadow.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfshadow.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfshadow.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,128 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Shadow object,now only used by paragraph object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xfshadow.hxx"
+
+XFShadow::XFShadow():m_aColor(128,128,0)
+{
+	m_ePosition = enumXFShadowNone;
+	m_fOffset = 0.18;
+}
+
+XFShadow::~XFShadow()
+{
+}
+
+rtl::OUString XFShadow::ToString()
+{
+	rtl::OUString	buf;
+	rtl::OUString	strOff = DoubleToOUString(m_fOffset);
+
+	buf = m_aColor.ToString();
+	switch(m_ePosition)
+	{
+	case enumXFShadowRightBottom:
+		buf += A2OUSTR(" ") + strOff + A2OUSTR("cm") + A2OUSTR(" ") + strOff + A2OUSTR("cm");
+		break;
+	case enumXFShadowRightTop:
+		buf += A2OUSTR(" ") + strOff + A2OUSTR("cm") + A2OUSTR(" -") + strOff + A2OUSTR("cm");
+		break;
+	case enumXFShadowLeftBottom:
+		buf += A2OUSTR(" -") + strOff + A2OUSTR("cm") + A2OUSTR(" ") + strOff + A2OUSTR("cm");
+		break;
+	case enumXFShadowLeftTop:
+		buf += A2OUSTR(" -") + strOff + A2OUSTR("cm") + A2OUSTR(" -") + strOff + A2OUSTR("cm");
+		break;
+	}
+
+	return buf;
+}
+
+void	XFShadow::Reset()
+{
+	m_ePosition = enumXFShadowNone;
+	m_fOffset = 0;
+}
+
+void	XFShadow::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	if( m_ePosition == enumXFShadowNone )
+		return;
+	else
+		pAttrList->AddAttribute( A2OUSTR("style:shadow"), ToString() );
+}
+
+sal_Bool operator==(XFShadow& s1, XFShadow& s2)
+{
+	if( (s1.m_ePosition == s2.m_ePosition) &&
+		(s1.m_fOffset == s2.m_fOffset) &&
+		(s1.m_aColor == s2.m_aColor)
+		)
+		return sal_True;
+	return sal_False;
+}
+
+sal_Bool operator!=(XFShadow& s1, XFShadow& s2)
+{
+	return !(s1==s2);
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfshadow.hxx lotuswordpro/source/filter/xfilter/xfshadow.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfshadow.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfshadow.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,157 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Shadow object,now only used by paragraph object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFSHADOW_HXX
+#define		_XFSHADOW_HXX
+
+#include	"xfglobal.hxx"
+#include	"ixfproperty.hxx"
+#include	"xfcolor.hxx"
+
+/**
+ * @brief
+ * Shadow object.
+ */
+class XFShadow : public IXFProperty
+{
+public:
+	XFShadow();
+
+	virtual ~XFShadow();
+	
+public:
+	/**
+	 * @descr	set shadow position. You can refer to enumXFShadowPos to get all posible positions. 
+	 */
+	void	SetPosition(enumXFShadowPos pos);
+
+	/**
+	 * @descr	return shadow position. 
+	 */
+	enumXFShadowPos GetPosition();
+
+	/**
+	 * @descr	Set shadow offset from owner obejct. 
+	 */
+	void	SetOffset(double offset);
+
+	/**
+	 * @descr	return shadow offset. 
+	 */
+	double	GetOffset();
+
+	/**
+	 * @descr	Set shadow color. 
+	 */
+	void	SetColor(const XFColor& color);
+
+	/**
+	 * @descr	return shadow color. 
+	 */
+	XFColor GetColor();
+
+	void	Reset();
+
+	rtl::OUString	ToString();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+	friend sal_Bool operator==(XFShadow& s1, XFShadow& s2);
+	friend sal_Bool operator!=(XFShadow& s1, XFShadow& s2);	
+private:
+	enumXFShadowPos	m_ePosition;
+	double			m_fOffset;
+	XFColor			m_aColor;
+};
+
+
+inline void	XFShadow::SetPosition(enumXFShadowPos pos)
+{
+	m_ePosition = pos;
+}
+
+inline enumXFShadowPos XFShadow::GetPosition()
+{
+	return m_ePosition;
+}
+
+inline void	XFShadow::SetOffset(double offset)
+{
+	m_fOffset = offset;
+}
+
+inline double	XFShadow::GetOffset()
+{
+	return m_fOffset;
+}
+
+inline void	XFShadow::SetColor(const XFColor& color)
+{
+	m_aColor = color;
+}
+
+inline XFColor XFShadow::GetColor()
+{
+	return m_aColor;
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstylecont.cxx lotuswordpro/source/filter/xfilter/xfstylecont.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfstylecont.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstylecont.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,299 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Font object to serial to xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xfstylecont.hxx"
+#include	"ixfstyle.hxx"
+#include	"xffont.hxx"
+#include	"xftextstyle.hxx"
+#include	"xfparastyle.hxx"
+#include	"xffontfactory.hxx"
+#include "../lwpglobalmgr.hxx"
+
+XFStyleContainer::XFStyleContainer(const rtl::OUString& strStyleNamePrefix)
+	:m_strStyleNamePrefix(strStyleNamePrefix)
+{
+}
+
+XFStyleContainer::XFStyleContainer(const XFStyleContainer& other)
+	:m_strStyleNamePrefix(other.m_strStyleNamePrefix)
+{
+	this->m_aStyles = other.m_aStyles;
+}
+
+XFStyleContainer& XFStyleContainer::operator=(const XFStyleContainer& other)
+{
+	this->m_strStyleNamePrefix = other.m_strStyleNamePrefix;
+	this->m_aStyles = other.m_aStyles;
+	return *this;
+}
+
+XFStyleContainer::~XFStyleContainer()
+{
+	std::vector<IXFStyle*>::iterator it;
+	for( it = m_aStyles.begin(); it != m_aStyles.end(); it++ )
+	{
+		IXFStyle *pStyle = *it;
+		if( pStyle )
+			delete pStyle;
+	}
+}
+
+
+void	XFStyleContainer::Reset()
+{
+	std::vector<IXFStyle*>::iterator it;
+	
+	for( it = m_aStyles.begin(); it != m_aStyles.end(); it++ )
+	{
+		IXFStyle *pStyle = *it;
+		if( pStyle )
+			delete pStyle;
+	}
+	m_aStyles.clear();
+}
+
+IXFStyle*	XFStyleContainer::AddStyle(IXFStyle *pStyle)
+{
+	IXFStyle	*pConStyle = NULL;
+	rtl::OUString	name;	
+	
+	if( !pStyle )
+		return NULL;	
+	//no matter we want to delete the style or not,XFFont obejct should be saved first.
+	ManageStyleFont(pStyle);
+
+	if( pStyle->GetStyleName().getLength()==0 )
+		pConStyle = FindSameStyle(pStyle);
+
+	if( pConStyle )//such a style has exist:
+	{
+		delete pStyle;		
+		return pConStyle;
+	}
+	else
+	{
+		if( pStyle->GetStyleName().getLength() == 0 )
+		{
+			name = m_strStyleNamePrefix + Int32ToOUString(m_aStyles.size()+1);
+			pStyle->SetStyleName(name);
+		}
+		else
+		{
+			name = pStyle->GetStyleName();
+			//for name conflict
+			if(FindStyle( name))
+			{
+				name = name + Int32ToOUString(m_aStyles.size()+1);
+				pStyle->SetStyleName(name);
+			}
+		}
+			
+		
+		m_aStyles.push_back(pStyle);	
+		//transform the font object to XFFontFactory
+		
+		return pStyle;
+	}	
+}
+
+IXFStyle*	XFStyleContainer::FindSameStyle(IXFStyle *pStyle)
+{
+	std::vector<IXFStyle*>::iterator it;
+	for( it = m_aStyles.begin(); it != m_aStyles.end(); it++ )
+	{
+		IXFStyle *pConStyle = *it;
+		if( !pConStyle )
+			continue;
+
+		if( pConStyle->Equal(pStyle) )
+			return pConStyle;
+	}
+	
+	return NULL;
+}
+
+IXFStyle*	XFStyleContainer::FindStyle(rtl::OUString name)
+{
+	std::vector<IXFStyle*>::iterator it;
+	for( it = m_aStyles.begin(); it != m_aStyles.end(); it++ )
+	{
+		IXFStyle *pConStyle = *it;
+		if( !pConStyle )
+			continue;
+		
+		if( pConStyle->GetStyleName() == name )
+			return pConStyle;
+	}
+	
+	return NULL;
+}
+
+IXFStyle*	XFStyleContainer::Item(int index)
+{
+	assert(index>=0&&index<m_aStyles.size());
+	if( index >=0 && index < m_aStyles.size() )
+	{
+		return m_aStyles[index];
+	}
+	return NULL;
+}
+
+void	XFStyleContainer::ToXml(IXFStream *pStrm)
+{
+	std::vector<IXFStyle*>::iterator it;
+
+	for( it = m_aStyles.begin(); it != m_aStyles.end(); it++ )
+	{
+		IXFStyle *pStyle = *it;
+		
+		assert(pStyle);
+		if( !pStyle )
+			continue;
+		
+		pStyle->ToXml(pStrm);
+	}
+}
+
+
+void	XFStyleContainer::ManageStyleFont(IXFStyle *pStyle)
+{
+	XFFont *pStyleFont = NULL;
+	XFFont *pFactoryFont = NULL;
+	
+	if( !pStyle )
+		return;
+	
+	if( pStyle->GetStyleFamily() == enumXFStyleText )
+	{
+		XFTextStyle	*pTS = (XFTextStyle*)pStyle;
+		pStyleFont = pTS->GetFont();
+		if( !pStyleFont )
+			return;
+		LwpGlobalMgr* pGlobal = LwpGlobalMgr::GetInstance();
+		XFFontFactory* pFontFactory = pGlobal->GetXFFontFactory();
+		pFactoryFont = pFontFactory->FindSameFont(pStyleFont);
+		//this font has been exists in the factory:
+		if( pFactoryFont )
+		{
+			pTS->SetFont(pFactoryFont);
+			if( pStyleFont != pFactoryFont )
+				delete pStyleFont;
+		}
+		else
+		{
+			pFontFactory->AddFont(pStyleFont);
+		}
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStylePara )
+	{
+		XFParaStyle	*pPS = (XFParaStyle*)pStyle;
+		pStyleFont = pPS->GetFont();
+		if( !pStyleFont )
+			return;
+		LwpGlobalMgr* pGlobal = LwpGlobalMgr::GetInstance();
+		XFFontFactory* pFontFactory = pGlobal->GetXFFontFactory();
+		pFactoryFont = pFontFactory->FindSameFont(pStyleFont);
+		//this font has been exists in the factory:
+		if( pFactoryFont )
+		{
+			pPS->SetFont(pFactoryFont);
+			if( pFactoryFont != pStyleFont )
+				delete pStyleFont;
+		}
+		else
+		{
+			pFontFactory->AddFont(pStyleFont);
+		}
+	}	
+}
+
+bool operator==(XFStyleContainer& b1, XFStyleContainer& b2)
+{
+	if( b1.m_strStyleNamePrefix != b2.m_strStyleNamePrefix )
+		return false;
+	if( b1.m_aStyles.size() != b2.m_aStyles.size() )
+		return false;
+	for( int i=0; i<b1.m_aStyles.size(); i++ )
+	{
+		IXFStyle *pS1 = b1.m_aStyles[i];
+		IXFStyle *pS2 = b2.m_aStyles[i];
+
+		if( pS1 )
+		{
+			if( !pS2 )
+				return false;
+			if( !pS1->Equal(pS2) )
+				return false;
+		}
+		else
+		{
+			if( pS2 )
+				return false;
+		}
+	}
+	return true;
+}
+
+bool operator!=(XFStyleContainer& b1, XFStyleContainer& b2)
+{
+	return !(b1==b2);
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstylecont.hxx lotuswordpro/source/filter/xfilter/xfstylecont.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfstylecont.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstylecont.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,140 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style container,which response for special style,ie. text style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFSTYLECONTAINER_HXX
+#define		_XFSTYLECONTAINER_HXX
+
+#include	"xfglobal.hxx"
+#include	<vector>
+
+class IXFStyle;
+
+/**
+ * @descr	container obejct for styles. 
+ *			All styles can be placed into an style container.
+ */
+class XFStyleContainer : public IXFObject
+{
+public:
+	XFStyleContainer(){};
+
+	XFStyleContainer(const rtl::OUString& strStyleNamePrefix);
+
+	XFStyleContainer(const XFStyleContainer& other);
+
+	XFStyleContainer& operator=(const XFStyleContainer& other);
+	
+	virtual ~XFStyleContainer();
+
+public:
+	/**
+	 * @descr	Add style to container.
+	 *			If the same style has exist, then pStyle will be deleted, and the same style will be return.
+	 */
+	IXFStyle*		AddStyle(IXFStyle *pStyle);
+
+	/**
+	 * @descr	Find the same style. 
+	 */
+	IXFStyle*		FindSameStyle(IXFStyle *pStyle);
+
+	/**
+	 * @descr	get style by name. 
+	 */
+	IXFStyle*		FindStyle(rtl::OUString name);
+
+	/**
+	 * @descr	clear container. 
+	 */
+	void			Reset();
+
+	/**
+	 * @descr	get count of styles in the container. 
+	 */
+	sal_Int32		GetCount();
+
+	/**
+	 * @descr	get style by index. 
+	 */
+	IXFStyle*		Item(int index);
+
+	/**
+	 * @descr	Output all style. 
+	 */
+	virtual void	ToXml(IXFStream *pStrm);
+
+	friend bool operator==(XFStyleContainer& b1, XFStyleContainer& b2);
+	friend bool operator!=(XFStyleContainer& b1, XFStyleContainer& b2);
+private:
+	static void		ManageStyleFont(IXFStyle *pStyle);	
+private:
+	std::vector<IXFStyle*>	m_aStyles;
+	rtl::OUString	m_strStyleNamePrefix;
+};
+
+inline sal_Int32 XFStyleContainer::GetCount()
+{
+	return m_aStyles.size();
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstyle.cxx lotuswordpro/source/filter/xfilter/xfstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,107 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base style object .
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-28 create this file.
+ ************************************************************************/
+#include	"xfstyle.hxx"
+
+XFStyle::XFStyle()
+{
+	
+}
+
+XFStyle::~XFStyle()
+{
+}
+
+rtl::OUString	XFStyle::GetStyleName()
+{
+	return m_strStyleName;
+}
+
+void	XFStyle::SetStyleName(const rtl::OUString& styleName)
+{
+	m_strStyleName = styleName;
+}
+
+rtl::OUString	XFStyle::GetParentStyleName()
+{
+	return m_strParentStyleName;
+}
+
+void	XFStyle::SetParentStyleName(const rtl::OUString& styleName)
+{
+	m_strParentStyleName = styleName;
+}
+
+enumXFStyle	XFStyle::GetStyleFamily()
+{
+	return enumXFStyleUnknown;
+}
+
+void	XFStyle::SetStyleFamily(enumXFStyle family)
+{
+	m_enumFamily = family;
+}
+
+sal_Bool	XFStyle::Equal(IXFStyle *pStyle)
+{
+	return sal_False;
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstylefamily.hxx lotuswordpro/source/filter/xfilter/xfstylefamily.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfstylefamily.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstylefamily.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,72 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+#ifndef		_XFSTYLEFAMILY_HXX
+#define		_XFSTYLEFAMILY_HXX
+
+enum	enumXFStyleFamily
+{
+	enumXFStyleUnknown,
+	enumXFStyleText,
+	enumXFStylePara,
+	enumXFStyleList,
+	enumXFStyleSection,
+	enumXFStyleGraphics,
+	enumXFStylePageMaster,
+	enumXFStyleMasterPage,
+	enumXFStyleDate
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstyle.hxx lotuswordpro/source/filter/xfilter/xfstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,122 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Base style object .
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-28 create this file.
+ ************************************************************************/
+#ifndef		_XFSTYLE_HXX
+#define		_XFSTYLE_HXX
+
+#include	"ixfstyle.hxx"
+
+/**
+ * @brief
+ * implements ixfstyle interface. This is the base class for all concentrate style.
+ */
+class XFStyle : public IXFStyle
+{
+public:
+	XFStyle();
+
+	virtual ~XFStyle();
+
+public:
+	/**
+	 * @descr	get style name. 
+	 */
+	virtual rtl::OUString	GetStyleName();
+
+	/**
+	 * @descr	set style name.
+	 */
+	virtual void			SetStyleName(const rtl::OUString& styleName);
+
+	/**
+	 * @descr	Set parent style name. 
+	 */
+	virtual rtl::OUString	GetParentStyleName();
+
+	/**
+	 * @descr	return parent style name. 
+	 */
+	virtual void			SetParentStyleName(const rtl::OUString& styleName);
+
+	/**
+	 * @descr	get styel family. 
+	 */
+	virtual enumXFStyle		GetStyleFamily();
+
+	/**
+	 * @descr	set style family. 
+	 */
+	virtual void			SetStyleFamily(enumXFStyle family);
+
+	/**
+	 * @descr	decide whether two style are equal. 
+	 */
+	virtual sal_Bool		Equal(IXFStyle *pStyle);
+
+protected:
+	rtl::OUString	m_strStyleName;
+	rtl::OUString	m_strParentStyleName;	
+	enumXFStyle		m_enumFamily;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstylemanager.cxx lotuswordpro/source/filter/xfilter/xfstylemanager.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfstylemanager.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstylemanager.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,388 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style manager for the filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xfstylemanager.hxx"
+#include	"ixfstyle.hxx"
+
+XFStyleManager::XFStyleManager() : s_aStdArrowStyles( A2OUSTR("arrow") ),s_aListStyles( A2OUSTR("L") ),
+	s_aTextStyles( A2OUSTR("T") ),s_aParaStyles( A2OUSTR("P") ),s_aSectionStyles( A2OUSTR("Sect") ),
+	s_aPageMasters( A2OUSTR("PM") ),s_aMasterpages( A2OUSTR("MP") ),s_aDateStyles( A2OUSTR("N") ),
+	s_aGraphicsStyles( A2OUSTR("fr") ),s_aTableStyles( A2OUSTR("table") ),s_aTableCellStyles( A2OUSTR("cell") ),
+	s_aTableRowStyles( A2OUSTR("row") ),s_aTableColStyles( A2OUSTR("col") ),s_pOutlineStyle(NULL)
+{
+}
+
+XFStyleManager::~XFStyleManager()
+{
+	Reset();
+}
+
+void	XFStyleManager::Reset()
+{
+	if( s_pOutlineStyle )
+	{
+		delete s_pOutlineStyle;
+		s_pOutlineStyle = NULL;
+	}
+
+	s_aStdTextStyles.Reset();
+	s_aStdParaStyles.Reset();
+	s_aStdStrokeDashStyles.Reset();
+	s_aStdAreaStyles.Reset();
+	s_aStdArrowStyles.Reset();
+	s_aTextStyles.Reset();
+	s_aParaStyles.Reset();
+	s_aListStyles.Reset();
+	s_aSectionStyles.Reset();
+	s_aPageMasters.Reset();
+	s_aMasterpages.Reset();
+	s_aDateStyles.Reset();
+	s_aGraphicsStyles.Reset();
+	s_aConfigManager.Reset();
+	//must clear all static containers.
+	s_aFontDecls.clear();
+}
+
+void	XFStyleManager::AddFontDecl(rtl::OUString name, rtl::OUString family, sal_Bool fixed)
+{
+	s_aFontDecls.push_back( XFFontDecl(name, family, fixed) );
+}
+
+void	XFStyleManager::AddFontDecl(XFFontDecl& aFontDecl)
+{
+	s_aFontDecls.push_back(aFontDecl);
+}
+
+IXFStyle*	XFStyleManager::AddStyle(IXFStyle *pStyle)
+{
+	assert(pStyle);
+	rtl::OUString	name;	
+	IXFStyle	*pStyleRet = NULL;
+
+	if( !pStyle )
+		return NULL;
+	name = pStyle->GetStyleName();
+
+	if( pStyle->GetStyleFamily() == enumXFStyleText )
+	{
+		if( name.getLength() )
+		{
+			pStyleRet = s_aStdTextStyles.AddStyle(pStyle);
+		}
+		else
+			pStyleRet = s_aTextStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStylePara )
+	{
+		if( name.getLength() )
+		{
+			pStyleRet = s_aStdParaStyles.AddStyle(pStyle);
+		}
+		else
+			pStyleRet = s_aParaStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleDefaultPara )
+	{
+		pStyleRet = s_aStdParaStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleList )
+	{
+		pStyleRet = s_aListStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleSection )
+	{
+		pStyleRet = s_aSectionStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStylePageMaster )
+	{
+		pStyleRet = s_aPageMasters.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleMasterPage )
+	{
+		//Master page don't need name.
+ 		pStyleRet = s_aMasterpages.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleDate )
+	{
+		pStyleRet = s_aDateStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleTime )
+	{
+		pStyleRet = s_aDateStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleNumber )
+	{
+		pStyleRet = s_aDateStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStylePercent )
+	{
+		pStyleRet = s_aDateStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleCurrency )
+	{
+		pStyleRet = s_aDateStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleGraphics )
+	{
+		pStyleRet = s_aGraphicsStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleTable )
+	{
+		pStyleRet = s_aTableStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleTableCell )
+	{
+		pStyleRet = s_aTableCellStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleTableRow )
+	{
+		pStyleRet = s_aTableRowStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleTableCol )
+	{
+		pStyleRet = s_aTableColStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleOutline )
+	{
+		if( s_pOutlineStyle )
+			delete s_pOutlineStyle;
+		s_pOutlineStyle = pStyle;
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleStrokeDash )
+	{
+		pStyleRet = s_aStdStrokeDashStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleArea )
+	{
+		pStyleRet = s_aStdAreaStyles.AddStyle(pStyle);
+	}
+	else if( pStyle->GetStyleFamily() == enumXFStyleArrow )
+	{
+		pStyleRet = s_aStdArrowStyles.AddStyle(pStyle);
+	}
+	else if (pStyle->GetStyleFamily() == enumXFStyleRuby)
+	{
+		pStyleRet = s_aRubyStyles.AddStyle(pStyle);
+	}
+
+	return pStyleRet;
+}
+
+IXFStyle*	XFStyleManager::FindStyle(rtl::OUString name)
+{
+	IXFStyle *pStyle = (IXFStyle*)FindParaStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = (IXFStyle*)FindTextStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aListStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aSectionStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aPageMasters.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aMasterpages.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aDateStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aGraphicsStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aTableStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aTableCellStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aTableRowStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aTableColStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	if(s_pOutlineStyle && s_pOutlineStyle->GetStyleName() == name )
+		return s_pOutlineStyle;
+	pStyle = s_aStdStrokeDashStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aStdAreaStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+	pStyle = s_aStdArrowStyles.FindStyle(name);
+	if( pStyle )
+		return pStyle;
+
+	return NULL;
+}
+
+XFParaStyle*	XFStyleManager::FindParaStyle(rtl::OUString name)
+{
+	IXFStyle *pStyle = s_aParaStyles.FindStyle(name);
+	if( pStyle )
+		return (XFParaStyle*)pStyle;
+	else
+		return (XFParaStyle*)s_aStdParaStyles.FindStyle(name);
+}
+
+XFTextStyle*	XFStyleManager::FindTextStyle(rtl::OUString name)
+{
+	IXFStyle *pStyle = s_aTextStyles.FindStyle(name);
+	if( pStyle )
+		return (XFTextStyle*)pStyle;
+	else
+		return (XFTextStyle*)s_aStdTextStyles.FindStyle(name);
+}
+
+void	XFStyleManager::SetLineNumberConfig(XFLineNumberConfig *pLNConf)
+{
+	s_aConfigManager.SetLineNumberConfig(pLNConf);
+}
+
+void	XFStyleManager::SetFootnoteConfig(XFFootnoteConfig *pFNConfig)
+{
+	s_aConfigManager.SetFootnoteConfig(pFNConfig);
+}
+
+void	XFStyleManager::SetEndnoteConfig(XFEndnoteConfig *pENConfig)
+{
+	s_aConfigManager.SetEndnoteConfig(pENConfig);
+}
+
+void	XFStyleManager::ToXml(IXFStream *pStrm)
+{
+	std::vector<XFFontDecl>::iterator	itDecl;
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();	
+	pStrm->StartElement( A2OUSTR("office:font-decls") );
+
+	//font declarations:
+	for( itDecl = s_aFontDecls.begin(); itDecl != s_aFontDecls.end(); itDecl++ )
+	{
+		XFFontDecl &f = *itDecl;
+
+		pAttrList->Clear();
+		pAttrList->AddAttribute( A2OUSTR("style:name"), f.GetFontName() );
+		pAttrList->AddAttribute( A2OUSTR("fo:font-family"), f.GetFontFamily() );
+		if( f.GetFontPitchFixed() )
+			pAttrList->AddAttribute( A2OUSTR("style:font-pitch"), A2OUSTR("fixed") );
+		else
+			pAttrList->AddAttribute( A2OUSTR("style:font-pitch"), A2OUSTR("variable") );
+		pStrm->StartElement( A2OUSTR("style:font-decl") );
+		pStrm->EndElement( A2OUSTR("style:font-decl") );
+	}
+	
+	pStrm->EndElement( A2OUSTR("office:font-decls") );
+
+	//office:styles:
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("office:styles") );
+	
+	s_aStdParaStyles.ToXml(pStrm);
+	s_aStdTextStyles.ToXml(pStrm);
+	s_aStdStrokeDashStyles.ToXml(pStrm);
+	s_aStdAreaStyles.ToXml(pStrm);
+	s_aStdArrowStyles.ToXml(pStrm);
+	//date,time styles:
+	s_aDateStyles.ToXml(pStrm);
+	s_aConfigManager.ToXml(pStrm);
+	//for optimist.
+	s_aListStyles.ToXml(pStrm);
+
+	if( s_pOutlineStyle )
+		s_pOutlineStyle->ToXml(pStrm);
+		
+	pStrm->EndElement( A2OUSTR("office:styles") );
+
+	//automatic styles:
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("office:automatic-styles") );
+
+	s_aTableStyles.ToXml(pStrm);
+	s_aTableCellStyles.ToXml(pStrm);
+	s_aTableRowStyles.ToXml(pStrm);
+	s_aTableColStyles.ToXml(pStrm);
+	s_aParaStyles.ToXml(pStrm);
+	s_aTextStyles.ToXml(pStrm);	
+	s_aSectionStyles.ToXml(pStrm);
+	s_aPageMasters.ToXml(pStrm);
+	s_aRubyStyles.ToXml(pStrm);
+	//graphics:
+	s_aGraphicsStyles.ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("office:automatic-styles") );
+
+	//master:styles
+	pAttrList->Clear();	
+	pStrm->StartElement( A2OUSTR("office:master-styles") );
+	//masters pages:
+	s_aMasterpages.ToXml(pStrm);	
+	
+	pStrm->EndElement( A2OUSTR("office:master-styles") );
+}
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfstylemanager.hxx lotuswordpro/source/filter/xfilter/xfstylemanager.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfstylemanager.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfstylemanager.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,149 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style manager for the filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFSTYLEMANAGER_HXX
+#define		_XFSTYLEMANAGER_HXX
+
+#include	"xfglobal.hxx"
+#include	"xffontdecl.hxx"
+#include	"xfstylecont.hxx"
+#include	"xfconfigmanager.hxx"
+#include	<map>
+#include	<vector>
+
+class IXFStream;
+class IXFStyle;
+class XFOutlineStyle;
+class XFParaStyle;
+class XFTextStyle;
+class XFLineNumberConfig;
+class XFFootnoteConfig;
+class XFEndnoteConfig;
+
+/**
+ * @brief
+ * Style manager for the filter.
+ * This is a global obejct, all styles will be placed here before output.
+ */
+class XFStyleManager// : public IXFObject
+{
+public:
+	XFStyleManager();
+	~XFStyleManager();
+	XFStyleManager(XFStyleManager& other){}
+
+	XFStyleManager operator=(XFStyleManager& other){}	
+
+public:	
+	/**
+	 * @descr	clear all styles, called before load file. 
+	 */
+	void		Reset();
+
+	void		AddFontDecl(XFFontDecl& aFontDecl);
+
+	void		AddFontDecl(rtl::OUString name, rtl::OUString family, sal_Bool fixed = false);
+
+	IXFStyle*	AddStyle(IXFStyle *pStyle);
+
+	IXFStyle*	FindStyle(rtl::OUString name);
+
+	XFParaStyle*	FindParaStyle(rtl::OUString name);
+
+	XFTextStyle*	FindTextStyle(rtl::OUString name);
+
+	void		SetLineNumberConfig(XFLineNumberConfig *pLNConfig);
+
+	void		SetFootnoteConfig(XFFootnoteConfig *pFNConfig);
+
+	void		SetEndnoteConfig(XFEndnoteConfig *pFNConfig);
+
+	void		ToXml(IXFStream *strm);
+
+private:
+	std::vector<XFFontDecl>	s_aFontDecls;	
+	//standard styles that can be inherited,<office:styles>
+	XFStyleContainer	s_aStdTextStyles;
+	XFStyleContainer	s_aStdParaStyles;
+	XFStyleContainer	s_aStdStrokeDashStyles;
+	XFStyleContainer	s_aStdAreaStyles;
+	XFStyleContainer	s_aStdArrowStyles;
+	XFConfigManager	s_aConfigManager;
+	//automatic styles,<office:automatic-styles>
+	XFStyleContainer	s_aTextStyles;
+	XFStyleContainer	s_aParaStyles;
+	XFStyleContainer s_aListStyles;
+	XFStyleContainer	s_aSectionStyles;
+	XFStyleContainer	s_aPageMasters;
+	XFStyleContainer	s_aMasterpages;
+	XFStyleContainer	s_aDateStyles;	
+	XFStyleContainer	s_aGraphicsStyles;
+	XFStyleContainer	s_aTableStyles;
+	XFStyleContainer	s_aTableCellStyles;
+	XFStyleContainer	s_aTableRowStyles;
+	XFStyleContainer	s_aTableColStyles;
+	IXFStyle			*s_pOutlineStyle;
+	XFStyleContainer s_aRubyStyles;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfsubject.hxx lotuswordpro/source/filter/xfilter/xfsubject.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfsubject.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfsubject.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,85 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page number field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-31 create this file.
+ ************************************************************************/
+#ifndef		_XFSUBJECT_HXX
+#define		_XFSUBJECT_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfnumfmt.hxx"
+
+class XFSubject : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+inline void XFSubject::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pStrm->StartElement( A2OUSTR("text:subject") );
+	pStrm->EndElement( A2OUSTR("text:subject") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftable.cxx lotuswordpro/source/filter/xfilter/xftable.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftable.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftable.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,319 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-24 create and implements.
+ ************************************************************************/
+#include	"xftable.hxx"
+#include	"xfrow.hxx"
+#include	"xfcolstyle.hxx"
+#include	"xfstylemanager.hxx"
+#include	<cassert>
+
+XFTable::XFTable()
+{
+	m_strName = XFGlobal::GenTableName();
+	m_bSubTable = sal_False;
+	m_pOwnerCell = NULL;
+}
+
+XFTable::XFTable(const XFTable& other)
+{
+	m_strName = other.m_strName;
+	m_bSubTable = other.m_bSubTable;
+	m_pOwnerCell = NULL;
+	for( int i=1; i<=other.m_aHeaderRows.GetCount(); i++ )
+	{
+		XFRow *pRow = (XFRow*)other.m_aHeaderRows.GetContent(i+1);
+		if( pRow )
+		{
+			m_aHeaderRows.Add( new XFRow(*pRow) );
+		}
+	}
+
+	m_aColumns = other.m_aColumns;
+	m_strDefCellStyle = other.m_strDefCellStyle;
+	m_strDefRowStyle = other.m_strDefRowStyle;
+	m_strDefColStyle = other.m_strDefColStyle;
+}
+
+XFTable& XFTable::operator =(const XFTable& other)
+{
+	m_strName = other.m_strName;
+	m_bSubTable = other.m_bSubTable;
+	m_pOwnerCell = NULL;
+	for( int i=1; i<=other.m_aHeaderRows.GetCount(); i++ )
+	{
+		XFRow *pRow = (XFRow*)other.m_aHeaderRows.GetContent(i);
+		if( pRow )
+		{
+			m_aHeaderRows.Add( new XFRow(*pRow) );
+		}
+	}
+	
+	m_aColumns = other.m_aColumns;
+	m_strDefCellStyle = other.m_strDefCellStyle;
+	m_strDefRowStyle = other.m_strDefRowStyle;
+	m_strDefColStyle = other.m_strDefColStyle;
+	return *this;
+}
+
+
+
+XFTable::~XFTable()
+{
+	std::map<sal_Int32,XFRow*>::iterator it;
+	for( it=m_aRows.begin(); it!=m_aRows.end(); it++ )
+	{
+		XFRow *pRow = (*it).second;
+		if( pRow )
+			delete pRow;
+	}
+	m_aRows.clear();
+	m_aColumns.clear();
+}
+
+void	XFTable::SetColumnStyle(sal_Int32 col, rtl::OUString style)
+{
+	m_aColumns[col] = style;
+}
+
+void	XFTable::AddRow(XFRow *pRow)
+{
+	assert(pRow);
+	if( !pRow )
+		return;
+
+	int	row = pRow->GetRow();
+
+	if( row<1 )
+		pRow->SetRow(m_aRows.size()+1);
+
+	row = pRow->GetRow();
+	if( m_aRows.find(row) != m_aRows.end() )
+		delete m_aRows[row];
+	
+	pRow->SetOwnerTable(this);
+	m_aRows[row] = pRow;	
+}
+
+void	XFTable::AddHeaderRow(XFRow *pRow)
+{
+	if( !pRow )
+		return;
+	m_aHeaderRows.Add(pRow);
+}
+
+rtl::OUString XFTable::GetTableName()
+{
+	if( m_bSubTable )
+	{
+		return m_pOwnerCell->GetCellName();
+	}
+	else
+		return m_strName;
+}
+
+sal_Int32	XFTable::GetRowCount()
+{
+	sal_Int32	rowMax = -1;
+	std::map<sal_Int32,XFRow*>::iterator it;
+	for( it=m_aRows.begin(); it!=m_aRows.end(); it++ )
+	{
+		if( it->first>rowMax )
+			rowMax = it->first;
+	}
+
+	return rowMax;
+/*	
+	if( m_aRows.size()<1 )
+		return 0;
+	std::map<sal_Int32,XFRow*>::iterator it = m_aRows.end();
+	it--;
+	return it->first;*/
+}
+
+XFRow*	XFTable::GetRow(sal_Int32 row)
+{
+	return m_aRows[row];
+}
+
+sal_Int32	XFTable::GetColumnCount()
+{
+	int		colMax = -1;
+	std::map<sal_Int32,rtl::OUString>::iterator it;
+	for( it=m_aColumns.begin(); it!=m_aColumns.end(); it++ )
+	{
+		if( it->first>colMax )
+			colMax = it->first;
+	}
+	return colMax;
+/*	
+	if( m_aColumns.size()<1 )
+		return 0;
+	std::map<sal_Int32,rtl::OUString>::iterator it = m_aColumns.end();
+	it--;
+	return it->first;*/
+}
+
+rtl::OUString XFTable::GetColumnStyle(sal_Int32 col)
+{
+	if( m_aColumns.find(col) != m_aColumns.end() )
+		return m_aColumns[col];
+	return A2OUSTR("");
+}
+
+enumXFContent XFTable::GetContentType()
+{
+	return enumXFContentTable;
+}
+
+void	XFTable::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	//sub table shouldn't use table name.
+	if( !m_bSubTable )
+		pAttrList->AddAttribute( A2OUSTR("table:name"), m_strName);
+
+	if( GetStyleName().getLength() )
+		pAttrList->AddAttribute( A2OUSTR("table:style-name"), GetStyleName() );
+	
+	if( m_bSubTable )
+		pStrm->StartElement( A2OUSTR("table:sub-table") );
+	else
+		pStrm->StartElement( A2OUSTR("table:table") );
+
+	//test code
+//	sal_Int32 rowMax = GetRowCount();
+//	sal_Int32 colMax = GetColumnCount();
+	//output columns:
+	{
+		int	lastCol = 0;		
+		std::map<sal_Int32,rtl::OUString>::iterator it;
+		for( it=m_aColumns.begin(); it!=m_aColumns.end(); it++ )
+		{
+			sal_Int32	col = (*it).first;
+			rtl::OUString	style = m_aColumns[col];
+			
+			//default col repeated:
+			if( col >lastCol+1 )
+			{
+				if( col > lastCol + 2 )
+				{
+					if( m_strDefColStyle.getLength() > 0 )
+					{
+						pAttrList->AddAttribute( A2OUSTR("table:style-name"), m_strDefColStyle ); 
+					}
+					pAttrList->AddAttribute( A2OUSTR("table:number-columns-repeated"), Int32ToOUString(col-lastCol-1) ); 
+				}
+				pStrm->StartElement( A2OUSTR("table:table-column") );
+				pStrm->EndElement( A2OUSTR("table:table-column") );
+			}
+			
+			if( style.getLength() > 0 )
+			{
+				pAttrList->AddAttribute( A2OUSTR("table:style-name"), style ); 
+			}
+			pStrm->StartElement( A2OUSTR("table:table-column") );
+			pStrm->EndElement( A2OUSTR("table:table-column") );			
+			lastCol = col;
+		}
+	}
+	
+	if( m_aHeaderRows.GetCount()>0 )
+	{
+		pStrm->StartElement( A2OUSTR("table:table-header-rows") );
+		m_aHeaderRows.ToXml(pStrm);
+		pStrm->EndElement( A2OUSTR("table:table-header-rows") );
+	}
+	//output rows:
+	{
+		int		lastRow = 0;	
+		IXFAttrList	*pAttrList = pStrm->GetAttrList();
+		
+		std::map<sal_Int32,XFRow* >::iterator it = m_aRows.begin();
+		for( ; it!=m_aRows.end(); it++ )
+		{		
+			int	row = (*it).first;
+			XFRow *pRow = (*it).second;
+			
+			//null row repeated:
+			if( row>lastRow+1 )
+			{
+				XFRow *pNullRow = new XFRow();
+				pNullRow->SetStyleName(m_strDefRowStyle);
+				if( row>lastRow+2)
+					pNullRow->SetRepeated(row-lastRow-1);
+				XFCell *pCell = new XFCell();
+				pCell->SetStyleName(m_strDefCellStyle);
+				pNullRow->AddCell(pCell);
+				pNullRow->ToXml(pStrm);
+			}		
+			pRow->ToXml(pStrm);			
+			lastRow = row;
+		}
+	}
+
+	if( m_bSubTable )
+		pStrm->EndElement( A2OUSTR("table:sub-table") );
+	else
+		pStrm->EndElement( A2OUSTR("table:table") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftable.hxx lotuswordpro/source/filter/xfilter/xftable.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftable.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftable.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,172 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table object.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-24 create and implements.
+ ************************************************************************/
+#ifndef		_XFTABLE_HXX
+#define		_XFTABLE_HXX
+
+#include	"xfcontent.hxx"
+#include	"xfrow.hxx"
+#include	"xfcell.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	<map>
+#include	<vector>
+
+class XFTable : public XFContent
+{
+public:
+	XFTable();
+
+	XFTable(const XFTable& other);
+
+	XFTable& operator=(const XFTable& other);
+
+	virtual ~XFTable();
+
+public:
+	void	SetTableName(rtl::OUString name);	
+
+	void	SetColumnStyle(sal_Int32 col, rtl::OUString style);	
+
+	void	AddRow(XFRow *pRow);
+
+	void	AddHeaderRow(XFRow *pRow);
+
+	void	SetDefaultCellStyle(rtl::OUString style);
+	
+	void	SetDefaultRowStyle(rtl::OUString style);
+	
+	void	SetDefaultColStyle(rtl::OUString style);
+
+public:
+	void	SetOwnerCell(XFCell *pCell);
+
+	rtl::OUString	GetTableName();
+
+	sal_Int32	GetRowCount();
+
+	XFRow*		GetRow(sal_Int32 row);
+
+	sal_Int32	GetColumnCount();
+
+	rtl::OUString	GetColumnStyle(sal_Int32 col);
+
+	sal_Bool	IsSubTable();
+
+	void		Normalize();
+
+	enumXFContent	GetContentType();
+	
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	void		RemoveRow(sal_Int32 row);
+	
+private:
+	rtl::OUString	m_strName;
+	sal_Bool	m_bSubTable;
+	XFCell		*m_pOwnerCell;
+	XFContentContainer	m_aHeaderRows;
+	std::map<sal_Int32,XFRow*>	m_aRows;	
+	std::map<sal_Int32,rtl::OUString>	m_aColumns;
+	rtl::OUString	m_strDefCellStyle;
+	rtl::OUString	m_strDefRowStyle;
+	rtl::OUString	m_strDefColStyle;
+};
+
+inline void	XFTable::SetTableName(rtl::OUString name)
+{
+	m_strName = name;
+}
+
+inline void	XFTable::SetOwnerCell(XFCell *pCell)
+{
+	m_pOwnerCell = pCell;
+	m_bSubTable = (pCell!=NULL);
+}
+
+inline sal_Bool XFTable::IsSubTable()
+{
+	return m_bSubTable;
+}
+
+
+inline void XFTable::SetDefaultCellStyle(rtl::OUString style)
+{
+	m_strDefCellStyle = style;
+}
+
+inline void XFTable::SetDefaultRowStyle(rtl::OUString style)
+{
+	m_strDefRowStyle = style;
+}
+
+inline void XFTable::SetDefaultColStyle(rtl::OUString style)
+{
+	m_strDefColStyle = style;
+}
+
+inline void XFTable::RemoveRow(sal_Int32 row)
+{
+	m_aRows.erase(row);
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftablestyle.cxx lotuswordpro/source/filter/xfilter/xftablestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftablestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftablestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,139 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-24 create and implements.
+ ************************************************************************/
+#include	"xftablestyle.hxx"
+#include	"xfbgimage.hxx"
+
+XFTableStyle::XFTableStyle()
+{
+	m_fWidth = 2;
+	m_eAlign = enumXFAlignStart;	
+	m_pBGImage = NULL;
+}
+
+XFTableStyle::~XFTableStyle()
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+}
+
+void	XFTableStyle::SetBackImage(XFBGImage *pImage)
+{
+	if( m_pBGImage )
+		delete m_pBGImage;
+
+	m_pBGImage = pImage;
+}
+
+enumXFStyle	XFTableStyle::GetStyleFamily()
+{
+	return enumXFStyleTable;
+}
+
+void	XFTableStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("table") );
+	pStrm->StartElement( A2OUSTR("style:style") );	
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:width"), DoubleToOUString(m_fWidth) + A2OUSTR("cm") );
+	//text align:
+	if( m_eAlign == enumXFAlignStart )
+	{
+		pAttrList->AddAttribute(A2OUSTR("table:align"),A2OUSTR("left"));
+	}
+	else if( m_eAlign == enumXFAlignCenter )
+	{
+		pAttrList->AddAttribute(A2OUSTR("table:align"),A2OUSTR("center"));
+	}
+	else if( m_eAlign == enumXFAlignEnd )
+	{
+		pAttrList->AddAttribute(A2OUSTR("table:align"),A2OUSTR("right"));
+	}
+	else if( m_eAlign == enumXFALignMargins )
+	{
+		pAttrList->AddAttribute(A2OUSTR("table:align"),A2OUSTR("margins"));
+	}
+	//background color:
+	if( m_aBackColor.IsValid() && !m_pBGImage )
+		pAttrList->AddAttribute(A2OUSTR("fo:background-color"), m_aBackColor.ToString() );
+	//shadow:
+	m_aShadow.ToXml(pStrm);
+	//margin:
+	m_aMargins.ToXml(pStrm);
+	//breaks:
+	m_aBreaks.ToXml(pStrm);
+
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	if( m_pBGImage )
+		m_pBGImage->ToXml(pStrm);
+
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftablestyle.hxx lotuswordpro/source/filter/xfilter/xftablestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftablestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftablestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,155 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Table style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-24 create and implements.
+ ************************************************************************/
+#ifndef		_XFTABLESTYLE_HXX
+#define		_XFTABLESTYLE_HXX
+
+#include	"xfstyle.hxx"
+#include	"xfmargins.hxx"
+#include	"xfshadow.hxx"
+#include	"xfcolor.hxx"
+#include	"xfbreaks.hxx"
+
+class XFBGImage;
+class XFTableStyle : public XFStyle
+{
+public:
+	XFTableStyle();
+
+	virtual ~XFTableStyle();
+
+public:
+	void	SetWidth(double width);
+
+	void	SetAlign(enumXFAlignType eAlign, double offset = 0);
+
+	void	SetShadow(enumXFShadowPos pos, double offset = 0.18, XFColor color=XFColor(128,128,0) );	
+
+	void	SetMargins(double left=-1, double right=-1, double top=-1, double bottom=-1);	
+
+	void	SetBackColor(XFColor& color);
+
+	void	SetBackImage(XFBGImage *pImage);
+
+	void	SetBreaks(enumXFBreaks breaks);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+	virtual enumXFStyle GetStyleFamily();
+
+private:
+	double	m_fWidth;
+	XFColor	m_aBackColor;
+	XFBGImage	*m_pBGImage;
+	XFShadow	m_aShadow;
+	XFMargins	m_aMargins;
+	XFBreaks	m_aBreaks;
+	enumXFAlignType	m_eAlign;
+};
+
+inline void	XFTableStyle::SetWidth(double width)
+{	
+	m_fWidth = width;
+}
+
+inline void XFTableStyle::SetAlign(enumXFAlignType eAlign, double offset)
+{
+	m_eAlign = eAlign;
+	if( m_eAlign == enumXFAlignStart )
+	{
+		m_aMargins.SetLeft(offset);
+		m_aMargins.SetRight(0);
+		m_aMargins.SetTop(0);
+		m_aMargins.SetBottom(0);
+	}
+}
+
+inline void	XFTableStyle::SetShadow(enumXFShadowPos pos, double offset, XFColor color)
+{
+	m_aShadow.SetColor(color);
+	m_aShadow.SetOffset(offset);
+	m_aShadow.SetPosition(pos);
+}
+
+inline void	XFTableStyle::SetMargins(double left, double right, double top, double bottom)
+{
+	if( left != -1 )
+		m_aMargins.SetLeft(left);
+	if( right != -1 )
+		m_aMargins.SetRight(right);
+	if( top != -1 )
+		m_aMargins.SetTop(top);
+	if( bottom != -1 )
+		m_aMargins.SetBottom(bottom);
+}
+
+inline void	XFTableStyle::SetBackColor(XFColor& color)
+{
+	m_aBackColor = color;
+}
+
+inline void XFTableStyle::SetBreaks(enumXFBreaks breaks)
+{
+	m_aBreaks.SetBreakType(breaks);
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftabstop.hxx lotuswordpro/source/filter/xfilter/xftabstop.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftabstop.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftabstop.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,84 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/**************************************************************************
+ * @file 
+ * Tab stop object,<text:tab-stop/>
+ *************************************************************************/
+/**************************************************************************
+ * Change History
+ * 2004-01-11 create this file.
+ *************************************************************************/
+#ifndef		_XFTABSTOP_HXX
+#define		_XFTABSTOP_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+class XFTabStop : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+inline void	XFTabStop::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+	
+	pAttrList->Clear();
+	pStrm->StartElement( A2OUSTR("text:tab-stop") );
+	pStrm->EndElement( A2OUSTR("text:tab-stop") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftabstyle.cxx lotuswordpro/source/filter/xfilter/xftabstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftabstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftabstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,102 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Tab style for paragraph.include tab offset and tab char properties.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-27 create this file.
+ ************************************************************************/
+#include	"xftabstyle.hxx"
+
+XFTabStyle::XFTabStyle()
+{
+	m_eType = enumXFTabNone;
+	m_fLength = 0;
+}
+
+void	XFTabStyle::ToXml(IXFStream *pStrm)
+{
+	assert(m_fLength>0);
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+	
+	pAttrList->AddAttribute( A2OUSTR("style:position"), DoubleToOUString(m_fLength) + A2OUSTR("cm") );
+	switch(m_eType)
+	{
+	case enumXFTabLeft:
+		pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("left") );
+		break;
+	case enumXFTabCenter:
+		pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("center") );
+		break;
+	case enumXFTabRight:
+		pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("right") );
+		break;
+	case enumXFTabChar:
+		pAttrList->AddAttribute( A2OUSTR("style:type"), A2OUSTR("char") );		
+		break;
+	}
+	//delimiter:
+	if( m_eType == enumXFTabChar )
+		pAttrList->AddAttribute( A2OUSTR("style:char"), m_strDelimiter );
+	//leader char:
+	if( m_strLeader.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("style:leader-char"), m_strLeader );
+
+	pStrm->StartElement( A2OUSTR("style:tab-stop") );
+	pStrm->EndElement( A2OUSTR("style:tab-stop") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftabstyle.hxx lotuswordpro/source/filter/xfilter/xftabstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftabstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftabstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,122 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Tab style for paragraph.include tab offset and tab char properties.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-27 create this file.
+ ************************************************************************/
+#ifndef		_XFTABSSTYLE_HXX
+#define		_XFTABSSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	<vector>
+
+class XFTabStyle : public XFStyle
+{
+public:
+	XFTabStyle();
+
+public:
+	void	SetTabType(enumXFTab type);
+
+	void	SetLength(double len);
+
+	void	SetDelimiter(sal_Unicode delimiter);
+
+	void	SetLeaderChar(sal_Unicode leader);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+private:
+	enumXFTab	m_eType;
+	double		m_fLength;
+	rtl::OUString	m_strDelimiter;
+	rtl::OUString	m_strLeader;	
+};
+
+inline void	XFTabStyle::SetTabType(enumXFTab type)
+{
+	m_eType = type;
+}
+
+inline void	XFTabStyle::SetLength(double len)
+{
+	m_fLength = len;
+}
+
+inline void	XFTabStyle::SetDelimiter(sal_Unicode delimiter)
+{	
+	sal_Unicode		chs[2];
+	chs[0] = delimiter;
+	chs[1] = 0;
+
+	m_strDelimiter = rtl::OUString(chs);
+}
+
+inline void	XFTabStyle::SetLeaderChar(sal_Unicode leader)
+{
+	sal_Unicode		chs[2];
+	chs[0] = leader;
+	chs[1] = 0;		
+
+	m_strLeader = rtl::OUString(chs);
+}
+
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextboxstyle.cxx lotuswordpro/source/filter/xfilter/xftextboxstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftextboxstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextboxstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,102 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+#include	"xftextboxstyle.hxx"
+#include	"xfcolumns.hxx"
+#include	"xfborders.hxx"
+#include	"xfshadow.hxx"
+#include	"xfbgimage.hxx"
+
+XFTextBoxStyle::XFTextBoxStyle()
+{
+}
+
+XFTextBoxStyle::~XFTextBoxStyle()
+{
+}
+
+enumXFStyle	XFTextBoxStyle::GetStyleFamily()
+{
+	return enumXFStyleGraphics;
+}
+
+void	XFTextBoxStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList *pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("graphics") );
+	//parent style name ignore now.
+	pStrm->StartElement( A2OUSTR("style:style") );
+
+	pAttrList->Clear();
+	pAttrList->AddAttribute( A2OUSTR("draw:stroke"), A2OUSTR("none") );
+	pAttrList->AddAttribute( A2OUSTR("svg:stroke-color"), A2OUSTR("#000000") );
+	pAttrList->AddAttribute( A2OUSTR("draw:fill"), A2OUSTR("none") );
+	pAttrList->AddAttribute( A2OUSTR("draw:fill-color"), A2OUSTR("#ffffff") );
+	pAttrList->AddAttribute( A2OUSTR("draw:auto-grow-height"), A2OUSTR("true") );
+	pAttrList->AddAttribute( A2OUSTR("style:run-through"), A2OUSTR("foreground") );
+	pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("run-through") );
+	pAttrList->AddAttribute( A2OUSTR("style:wrap"), A2OUSTR("run-through") );
+	pAttrList->AddAttribute( A2OUSTR("style:number-wrapped-paragraphs"), A2OUSTR("no-limit") );
+	pAttrList->AddAttribute( A2OUSTR("style:wrap-contour"), A2OUSTR("false") );
+
+	pStrm->StartElement( A2OUSTR("style:properties") );
+	pStrm->EndElement( A2OUSTR("style:properties") );
+
+	pStrm->EndElement( A2OUSTR("style:style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextboxstyle.hxx lotuswordpro/source/filter/xfilter/xftextboxstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftextboxstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextboxstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,89 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+#ifndef		_XFTEXTBOXSTYLE_HXX
+#define		_XFTEXTBOXSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"xfmargins.hxx"
+#include	"xfcolor.hxx"
+#include	"xfpadding.hxx"
+
+class XFBorders;
+class XFColumns;
+class XFShadow;
+class XFBGImage;
+
+/**
+* @brief
+* Style for all frame obejcts.
+*/
+class XFTextBoxStyle : public XFStyle
+{
+public:
+	XFTextBoxStyle();
+
+	virtual ~XFTextBoxStyle();
+
+public:
+
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+protected:
+};
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextcontent.cxx lotuswordpro/source/filter/xfilter/xftextcontent.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftextcontent.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextcontent.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,125 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Text content, it's an adapter for string to IXFObject.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-02	create and implemente.
+ ************************************************************************/
+#include	"xftextcontent.hxx"
+#include	"ixfstream.hxx"
+
+XFTextContent::XFTextContent(rtl::OUString text):m_strText(text)
+{
+}
+
+XFTextContent::~XFTextContent()
+{
+}
+
+enumXFContent XFTextContent::GetContentType()
+{
+	return enumXFContentText;
+}
+
+void	XFTextContent::SetText(const rtl::OUString& text)
+{
+	m_strText = text;
+}
+
+rtl::OUString XFTextContent::GetText()
+{
+	return m_strText;
+}
+
+void	XFTextContent::ToXml(IXFStream *pStrm)
+{
+//	pStrm->Characters(m_strText);
+	rtl::OUString sSpaceToken = rtl::OUString::createFromAscii(" ");
+	sSpaceToken += rtl::OUString::createFromAscii(" ");
+	rtl::OUString sSubString;
+	sal_Int32 nIndex = 0;
+	sal_Int32 nSize = m_strText.getLength();	
+	sal_Int32 i,j;
+	for (i=0; i<nSize;)
+	{
+		sSubString = m_strText.copy(i,nSize-i);
+		nIndex = sSubString.indexOf(sSpaceToken); 
+		if (nIndex == -1)
+		{
+			pStrm->Characters(sSubString);
+			return;	
+		}
+		else
+		{
+			if (nIndex != 0)
+				pStrm->Characters(sSubString.copy(0,nIndex));	
+			for (j=nIndex+1;j<nSize-i;j++)
+			{
+				if (sSubString[j] != sal_Char(' '))
+					break;
+			}
+			IXFAttrList	*pAttrList = pStrm->GetAttrList();
+			pAttrList->Clear();
+			pAttrList->AddAttribute( A2OUSTR("text:c"), rtl::OUString::valueOf(j-nIndex) );
+			pStrm->StartElement( A2OUSTR("text:s") );	
+			pStrm->EndElement( A2OUSTR("text:s") );			
+			
+			i+=j;
+		}	
+	}
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextcontent.hxx lotuswordpro/source/filter/xfilter/xftextcontent.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftextcontent.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextcontent.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,105 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Text content, it's an adapter for string to IXFObject.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+   2005-02-02	create and implemente.
+ ************************************************************************/
+#ifndef		_XFTEXTCONTENT_HXX
+#define		_XFTEXTCONTENT_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+class IXFStream;
+
+/**
+ * @brief
+ * Adapter for text to content.
+ */
+class XFTextContent : public XFContent
+{
+public:
+	XFTextContent(){}
+
+	XFTextContent(rtl::OUString text);
+
+	virtual ~XFTextContent();
+
+public:
+	/**
+	 * @descr	Set the text. 
+	 */
+	void				SetText(const rtl::OUString& text);
+
+	/**
+	 * @descr	return the content.
+	 * @return	text content.
+	 */
+	rtl::OUString		GetText();
+
+	virtual enumXFContent GetContentType();
+
+	virtual void		ToXml(IXFStream *pStrm);
+	
+private:
+	rtl::OUString		m_strText;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextheading.cxx lotuswordpro/source/filter/xfilter/xftextheading.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftextheading.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextheading.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,108 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Heading text for OOo.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-07 create this file.
+ * 2005-01-10 it works now.
+ ************************************************************************/
+#include	"xftextheading.hxx"
+#include	"xftextcontent.hxx"
+
+XFTextHeading::XFTextHeading()
+{
+	m_pContent = NULL;
+	m_nLevel = 0;
+}
+
+XFTextHeading::~XFTextHeading()
+{
+	if( m_pContent )
+		delete m_pContent;
+}
+
+enumXFContent XFTextHeading::GetContentType()
+{
+	return enumXFContentHeading;
+}
+
+void XFTextHeading::SetLevel(sal_Int16 level)
+{
+	m_nLevel = level;
+}
+
+void XFTextHeading::SetText(rtl::OUString text)
+{
+	m_pContent = new XFTextContent(text);
+}
+
+void XFTextHeading::ToXml(IXFStream *pStrm)
+{
+	rtl::OUString style = GetStyleName();
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	assert(m_nLevel>0);
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), style );
+	pAttrList->AddAttribute( A2OUSTR("text:level"), Int16ToOUString(m_nLevel) );
+
+	pStrm->StartElement( A2OUSTR("text:h") );
+	m_pContent->ToXml(pStrm);
+	pStrm->EndElement( A2OUSTR("text:h") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextheading.hxx lotuswordpro/source/filter/xfilter/xftextheading.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftextheading.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextheading.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,93 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Heading text for OOo.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-07 create this file.
+ * 2005-01-10 it works now.
+ ************************************************************************/
+#ifndef		_XFTEXTHEADING_HXX
+#define		_XFTEXTHEADING_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+class XFTextContent;
+/**
+ * @descr 
+ * <text:h> object. It has a single property text:level.
+ * This object use the same style type with <text:p>	
+ */
+class XFTextHeading : public XFContent
+{
+public:
+	XFTextHeading();
+	virtual ~XFTextHeading();
+
+	void				SetLevel(sal_Int16 level);
+	void				SetText(rtl::OUString text);
+
+	virtual enumXFContent GetContentType();
+	virtual void		ToXml(IXFStream *pStrm);
+private:
+	XFTextContent		*m_pContent;
+	sal_Int16			m_nLevel;
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextspan.cxx lotuswordpro/source/filter/xfilter/xftextspan.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftextspan.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextspan.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,191 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * An span of text with style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#include	"xftextspan.hxx"
+#include	"ixfstream.hxx"
+#include	"ixfattrlist.hxx"
+#include	"xftextcontent.hxx"
+
+XFTextSpan::XFTextSpan()
+{
+
+}
+
+XFTextSpan::XFTextSpan(rtl::OUString& text, 
+					   rtl::OUString& style 
+					   )
+{	
+	Add(text);
+	SetStyleName(style);
+}
+
+XFTextSpan::~XFTextSpan()
+{
+	std::vector<IXFContent*>::iterator it;
+	for( it = m_aContents.begin(); it != m_aContents.end(); it++ )
+	{
+		IXFContent	*pContent = *it;
+		if( pContent )
+		{
+			delete pContent;
+		}
+	}
+	m_aContents.clear();
+}
+
+enumXFContent XFTextSpan::GetContentType()
+{
+	return enumXFContentSpan;
+}
+
+void	XFTextSpan::SetText(rtl::OUString& text)
+{
+	m_aContents.clear();
+	Add(text);
+}
+
+rtl::OUString	XFTextSpan::GetText()
+{
+	rtl::OUString	text;
+	std::vector<IXFContent*>::iterator it;
+
+	it = m_aContents.begin();
+	if( it != m_aContents.end() )
+	{
+		IXFContent	*pContent = *it;
+		if( pContent->GetContentType() != enumXFContentText )
+		{
+			assert(false);
+		}
+		XFTextContent *pText = (XFTextContent*)pContent;
+		if( pText )
+			text = pText->GetText();
+	}
+
+	return text;
+}
+
+void	XFTextSpan::Add(IXFContent *pContent)
+{
+	m_aContents.push_back(pContent);
+}
+
+void	XFTextSpan::Add(rtl::OUString& text)
+{
+	IXFContent *pText = new XFTextContent(text);
+	Add(pText);
+}
+
+void	XFTextSpan::ToXml(IXFStream *pStrm)
+{
+	rtl::OUString style = GetStyleName();
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	assert(pAttrList);
+
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	pStrm->StartElement( A2OUSTR("text:span") );
+	
+	std::vector<IXFContent*>::iterator it;
+	for( it= m_aContents.begin(); it!= m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			pContent->ToXml(pStrm);
+	}
+
+	pStrm->EndElement( A2OUSTR("text:span") );
+}
+
+void	XFTextSpanStart::ToXml(IXFStream *pStrm)
+{
+	rtl::OUString style = GetStyleName();
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	assert(pAttrList);
+
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute( A2OUSTR("text:style-name"), GetStyleName() );
+	pStrm->StartElement( A2OUSTR("text:span") );
+	
+	std::vector<IXFContent*>::iterator it;
+	for( it= m_aContents.begin(); it!= m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			pContent->ToXml(pStrm);
+	}	
+}
+void	XFTextSpanEnd::ToXml(IXFStream *pStrm)
+{
+	std::vector<IXFContent*>::iterator it;
+	for( it= m_aContents.begin(); it!= m_aContents.end(); it++ )
+	{
+		IXFContent *pContent = *it;
+		if( pContent )
+			pContent->ToXml(pStrm);
+	}	
+	pStrm->EndElement( A2OUSTR("text:span") );	
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextspan.hxx lotuswordpro/source/filter/xfilter/xftextspan.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftextspan.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextspan.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,103 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * An span of text with style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFTEXTSPAN_HXX
+#define		_XFTEXTSPAN_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	<vector>
+
+class IXFStream;
+
+class XFTextSpan : public XFContent
+{
+public:
+	XFTextSpan();
+	XFTextSpan(rtl::OUString& text, rtl::OUString& style );
+	
+	virtual ~XFTextSpan();
+	
+	void			SetText(rtl::OUString& text);
+	rtl::OUString	GetText();
+	void			Add(IXFContent *pContent);	
+	void			Add(rtl::OUString& text);
+
+	virtual enumXFContent GetContentType();
+	virtual void	ToXml(IXFStream *pStrm);
+protected:		
+	std::vector<IXFContent*>	m_aContents;
+};
+
+class XFTextSpanStart : public XFTextSpan //for adding style of power field
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+class XFTextSpanEnd : public XFTextSpan //for adding style of power field
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextstyle.cxx lotuswordpro/source/filter/xfilter/xftextstyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftextstyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextstyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,142 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style for <text:p> or <text:h> or <text:span>
+ * Now we have only font attributes.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ ************************************************************************/
+#include	"xftextstyle.hxx"
+#include	"ixfattrlist.hxx"
+#include	"ixfstream.hxx"
+#include	"xffont.hxx"
+#include	"xfutil.hxx"
+
+XFTextStyle::XFTextStyle()
+{	
+	m_pFont = NULL;
+}
+
+XFTextStyle::~XFTextStyle()
+{
+}
+
+void	XFTextStyle::SetFont(XFFont *font)
+{
+	m_pFont = font;
+}
+
+sal_Bool	XFTextStyle::Equal(IXFStyle *pStyle)
+{
+	if( !pStyle || pStyle->GetStyleFamily() != enumXFStyleText )
+	{
+		return sal_False;
+	}
+
+	XFTextStyle	*pOther = (XFTextStyle*)pStyle;
+	if( !pOther )
+	{
+		return sal_False;
+	}
+
+	if( m_pFont )
+	{
+		if( !pOther->m_pFont )
+			return sal_False;
+		if( *m_pFont != *pOther->m_pFont )
+			return sal_False;
+	}
+	else if( pOther->m_pFont )
+		return sal_False;
+
+	return sal_True;
+}
+
+enumXFStyle	XFTextStyle::GetStyleFamily()
+{
+	return enumXFStyleText;
+}
+
+void	XFTextStyle::ToXml(IXFStream *strm)
+{
+	IXFAttrList	*pAttrList = strm->GetAttrList();
+	rtl::OUString style = GetStyleName();
+
+	pAttrList->Clear();
+	if( style.getLength() )
+		pAttrList->AddAttribute(rtl::OUString::createFromAscii("style:name"),GetStyleName());
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	
+	pAttrList->AddAttribute(rtl::OUString::createFromAscii("style:family"),A2OUSTR("text") );
+	strm->StartElement(rtl::OUString::createFromAscii("style:style"));	
+
+	//Font properties:
+	pAttrList->Clear();	
+	//font name:
+	if( m_pFont )
+		m_pFont->ToXml(strm);
+
+	strm->StartElement(rtl::OUString::createFromAscii("style:properties"));
+	strm->EndElement(rtl::OUString::createFromAscii("style:properties"));
+
+	strm->EndElement(rtl::OUString::createFromAscii("style:style"));
+}
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftextstyle.hxx lotuswordpro/source/filter/xfilter/xftextstyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftextstyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftextstyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,123 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Style for <text:p> or <text:h> or <text:span>
+ * Now we have only font attributes.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-26 create this file.
+ * 2005-01-04 Change the static style id.
+ * 2005-01-20 Get rid of the static id.
+ ************************************************************************/
+#ifndef		_XFTEXTSTYLE_HXX
+#define		_XFTEXTSTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+
+class	IXFStream;
+class	XFFont;
+
+class XFTextStyle : public XFStyle
+{
+public:
+	XFTextStyle();
+
+	virtual ~XFTextStyle();
+
+public:
+	/**
+	 * @descr:	set the font for the text span.
+	 */
+	void	SetFont(XFFont *font);
+
+	XFFont*	GetFont(){ return m_pFont; }
+
+	
+	virtual enumXFStyle	GetStyleFamily();
+
+	virtual sal_Bool	Equal(IXFStyle *pStyle);
+	
+	virtual void		ToXml(IXFStream *strm);
+	
+private:
+	XFFont				*m_pFont;	
+};
+
+#endif
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftexttable.cxx lotuswordpro/source/filter/xfilter/xftexttable.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftexttable.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftexttable.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,142 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Text table object. It's the table used in writer.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-31 create and implements.
+ ************************************************************************/
+#include	"xftexttable.hxx"
+
+XFTextTable::XFTextTable()
+{
+	
+}
+
+void	XFTextTable::SetColCount(sal_Int32 col)
+{
+	m_nColCount = col;
+}
+
+void	XFTextTable::SetRowCount(sal_Int32 row)
+{
+	m_nRowCount = row;
+}
+
+void	XFTextTable::SetCell(sal_Int32 row, sal_Int32 col, XFCell *pCell)
+{
+	if( row<0 || col<0 || !pCell )
+		return;
+	
+	XFRow *pRow = GetRow(row);
+	if( !pRow )
+	{
+		pRow = new XFRow();
+		pRow->SetRow(row);
+		AddRow(pRow);
+
+		pRow = GetRow(row);
+	}
+	if( !pRow )
+		return;
+	pCell->SetCol(col);
+
+	pRow->AddCell(pCell);
+}
+
+virtual void	XFTextTable::ToXml(IXFStream *pStrm)
+{
+	for( int i=0; i<m_nColCount; i++ )
+	{
+		rtl::OUString strColStyle = GetColumnStyle(i);
+		if( strColStyle.getLength()>0 )
+			SetColumnStyle(col, m_strDefColStyle);
+	}
+
+	for( int i=0; i<m_nRowCount; i++ )
+	{
+		XFRow *pRow = GetRow(i);
+		if( !pRow )
+		{
+			pRow = new XFRow();
+			pRow->SetRow(i);
+			pRow->SetStyleName(m_strDefRowStyle);
+
+			XFCell *pCell = new XFCell();
+			pCell->SetColumnSpaned(m_nColCount);
+			pRow->AddCell(pCell);
+
+			SetRow(i, pRow);
+		}
+		else
+		{
+			for( int j=0; j<m_nColCount; j++ )
+			{
+				XFCell *pCell = pRow->GetCell(j);
+				if( !pCell )
+				{
+					pCell = new XFCell();
+					pCell->SetCol(j);
+					pCell->SetStyleName(m_strDefCellStyle);
+					pRow->AddCell(pCell);
+				}
+			}
+		}
+	}
+
+	XFTable::ToXml(pStrm);
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftexttable.hxx lotuswordpro/source/filter/xfilter/xftexttable.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftexttable.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftexttable.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,87 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Text table object. It's the table used in writer.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-03-31 create and implements.
+ ************************************************************************/
+#ifndef		_XFTEXTTABLE_HXX
+#define		_XFTEXTTABLE_HXX
+
+#include	"xftable.hxx"
+
+class XFTextTable : public XFTable
+{
+public:
+	XFTextTable();
+
+private:
+	void	SetRowCount(sal_Int32 row);
+
+	void	SetColCount(sal_Int32 col);
+
+	rtl::OUString	SetCell(sal_Int32 row, sal_Int32 col, XFCell *pCell);
+
+	virtual void ToXml(IXFStream *pStrm);
+
+private:
+	sal_Int32		m_nColCount;
+	sal_Int32		m_nRowCount;
+};
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftime.cxx lotuswordpro/source/filter/xfilter/xftime.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftime.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftime.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,91 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Time field with time style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#include	"xftime.hxx"
+
+XFTime::XFTime()
+{
+	m_bFixed = 0;
+	rtl_zeroMemory(&m_aDateTime,sizeof(m_aDateTime));
+}
+
+XFTime::~XFTime()
+{	
+}
+
+void	XFTime::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();
+	if( GetStyleName().getLength() > 0 )
+		pAttrList->AddAttribute( A2OUSTR("style:data-style-name"), GetStyleName() );
+	pAttrList->AddAttribute( A2OUSTR("text:time-value"), DateTimeToOUString(m_aDateTime) );
+	if( m_bFixed )
+		pAttrList->AddAttribute( A2OUSTR("text:fixed"), A2OUSTR("true") );
+
+	pStrm->StartElement( A2OUSTR("text:time") );
+	pStrm->Characters(m_strText);
+	pStrm->EndElement( A2OUSTR("text:time") );
+}
+
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftime.hxx lotuswordpro/source/filter/xfilter/xftime.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftime.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftime.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,109 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Time field with time style.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-21 create this file.
+ ************************************************************************/
+#ifndef		_XFTIME_HXX
+#define		_XFTIME_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+
+class XFTime : public XFContent
+{
+public:
+	XFTime();
+
+	virtual ~XFTime();
+
+public:
+	void	SetDate(XFDateTime& dt);
+
+	void	SetText(rtl::OUString& text);
+
+	void	SetFixed(sal_Bool fixed = sal_True);
+	
+	virtual	void	ToXml(IXFStream *pStrm);
+
+private:
+	sal_Bool	m_bFixed;
+
+	rtl::OUString m_strText;
+
+	XFDateTime	m_aDateTime;
+};
+
+inline	void XFTime::SetDate(XFDateTime& dt)
+{
+	m_aDateTime = dt;
+}
+
+inline	void XFTime::SetText(rtl::OUString& text)
+{
+	m_strText = text;
+}
+
+inline	void XFTime::SetFixed(sal_Bool fixed)
+{
+	m_bFixed = fixed;
+}
+
+#endif
+
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftimestyle.cxx lotuswordpro/source/filter/xfilter/xftimestyle.cxx
--- lotuswordpro.bak/source/filter/xfilter/xftimestyle.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftimestyle.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,152 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Time style. The TIme format for time field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-20 create this file.
+ ************************************************************************/
+
+#include	"xftimestyle.hxx"
+
+XFTimePart::XFTimePart()
+{
+	m_nDecimalPos = 0;
+}
+
+void	XFTimePart::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	
+	switch(m_ePart)
+	{
+	case enumXFDateHour:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:hours") );
+		pStrm->EndElement( A2OUSTR("number:hours") );
+		break;
+	case enumXFDateMinute:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		if( m_nDecimalPos>0 )
+			pAttrList->AddAttribute( A2OUSTR("number:decimal-places"), Int32ToOUString(m_nDecimalPos) );
+		
+		pStrm->StartElement( A2OUSTR("number:minutes") );
+		pStrm->EndElement( A2OUSTR("number:minutes") );
+		break;
+	case enumXFDateSecond:
+		pAttrList->Clear();
+		if( m_bLongFmt )
+			pAttrList->AddAttribute( A2OUSTR("number:style"), A2OUSTR("long") );
+		pStrm->StartElement( A2OUSTR("number:seconds") );
+		pStrm->EndElement( A2OUSTR("number:seconds") );
+		break;
+	case enumXFDateText:
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("number:text") );
+		pStrm->Characters( m_strText );
+		pStrm->EndElement( A2OUSTR("number:text") );	
+		break;
+	}
+}
+
+XFTimeStyle::XFTimeStyle()
+{
+	m_bFixed = sal_True;
+	m_bAmPm = sal_False;
+	m_bTruncate = sal_True;
+}
+
+XFTimeStyle::~XFTimeStyle()
+{
+}
+
+enumXFStyle XFTimeStyle::GetStyleFamily()
+{
+	return enumXFStyleTime;
+}
+
+
+void	XFTimeStyle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+
+	pAttrList->Clear();	
+	pAttrList->AddAttribute( A2OUSTR("style:name"), GetStyleName() );
+	if( GetParentStyleName().getLength() > 0 )
+		pAttrList->AddAttribute(A2OUSTR("style:parent-style-name"),GetParentStyleName());
+	pAttrList->AddAttribute( A2OUSTR("style:family"), A2OUSTR("data-style") );
+	if (!m_bTruncate)
+		pAttrList->AddAttribute( A2OUSTR("number:truncate-on-overflow"), A2OUSTR("false") );
+	pStrm->StartElement( A2OUSTR("number:time-style") );	
+
+	std::vector<XFTimePart>::iterator it;
+	for( it = m_aParts.begin(); it != m_aParts.end(); it++ )
+	{
+		(*it).ToXml(pStrm);
+	}
+	if( m_bAmPm )
+	{
+		pAttrList->Clear();
+		pStrm->StartElement( A2OUSTR("number:am-pm") );
+		pStrm->EndElement( A2OUSTR("number:am-pm") );
+	}
+	pStrm->EndElement( A2OUSTR("number:time-style") );
+}
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftimestyle.hxx lotuswordpro/source/filter/xfilter/xftimestyle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftimestyle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftimestyle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,205 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Time style. The TIme format for time field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-20 create this file.
+ ************************************************************************/
+#ifndef		_XFTIMESTYLE_HXX
+#define		_XFTIMESTYLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfstyle.hxx"
+#include	"ixfproperty.hxx"
+#include	<vector>
+
+class XFDateTimePart : public XFStyle
+{
+public:
+	XFDateTimePart()
+	{
+		m_ePart = enumXFDateUnknown;
+		m_bLongFmt = sal_False;
+	}
+
+	virtual ~XFDateTimePart(){}
+public:
+	void	SetPartType(enumXFDatePart ePart);
+	
+	void	SetLongFmt(sal_Bool bLongFmt);
+
+	void	SetText(rtl::OUString& text);
+
+protected:
+	enumXFDatePart	m_ePart;
+	sal_Bool		m_bLongFmt;
+	rtl::OUString	m_strText;
+};
+
+class XFTimePart : public XFDateTimePart
+{
+public:
+	XFTimePart();
+
+	virtual ~XFTimePart(){}
+public:
+	void	SetDecimalPos(sal_Int32 pos);
+
+	virtual void	ToXml(IXFStream *pStrm);
+
+protected:
+	sal_Int32		m_nDecimalPos;
+};
+
+class XFTimeStyle : public XFStyle
+{
+public:
+	XFTimeStyle();
+
+	virtual ~XFTimeStyle();
+
+public:
+
+	void	AddHour( sal_Bool bLongFmt = sal_True );
+	
+	void	AddMinute( sal_Bool bLongFmt = sal_True );
+	
+	void	AddSecond( sal_Bool bLongFmt = sal_True, sal_Int16 nDecimalPos = 2);
+	
+	void	SetAmPm(sal_Bool bAmPm);
+
+	void	AddText( rtl::OUString part );
+
+	virtual enumXFStyle GetStyleFamily();
+
+	virtual void	ToXml(IXFStream *pStrm);
+	
+	void 	SetTruncate(sal_Bool bTrunc);
+
+private:
+	sal_Bool	m_bFixed;
+	sal_Bool	m_bAmPm;
+	std::vector<XFTimePart>	m_aParts;
+	sal_Bool	m_bTruncate;
+};
+
+
+inline void	XFDateTimePart::SetPartType(enumXFDatePart ePart)
+{
+	m_ePart = ePart;
+}
+
+inline void	XFDateTimePart::SetLongFmt(sal_Bool bLongFmt)
+{
+	m_bLongFmt = bLongFmt;
+}
+
+inline void	XFDateTimePart::SetText(rtl::OUString& text)
+{
+	m_strText = text;
+}
+
+inline void	XFTimePart::SetDecimalPos(sal_Int32 pos)
+{
+	m_nDecimalPos = pos;
+}
+
+inline void	XFTimeStyle::AddHour( sal_Bool bLongFmt )
+{
+	XFTimePart	part;
+	part.SetPartType(enumXFDateHour);
+	part.SetLongFmt(bLongFmt);
+	m_aParts.push_back(part);
+}
+
+inline void	XFTimeStyle::AddMinute( sal_Bool bLongFmt )
+{
+	XFTimePart	part;
+	part.SetPartType(enumXFDateMinute);
+	part.SetLongFmt(bLongFmt);
+	m_aParts.push_back(part);
+}
+
+inline void	XFTimeStyle::AddSecond( sal_Bool bLongFmt, sal_Int16 pos)
+{
+	XFTimePart	part;
+	part.SetPartType(enumXFDateSecond);
+	part.SetLongFmt(bLongFmt);
+	part.SetDecimalPos(pos);
+	m_aParts.push_back(part);
+}
+
+inline void	XFTimeStyle::SetAmPm(sal_Bool bAmPm)
+{
+	m_bAmPm = bAmPm;
+}
+
+inline void	XFTimeStyle::AddText( rtl::OUString text )
+{
+	XFTimePart	part;
+	part.SetPartType(enumXFDateText);
+	part.SetText(text);
+	m_aParts.push_back(part);	
+}
+
+inline 	void 	XFTimeStyle::SetTruncate(sal_Bool bTrunc)
+{
+	m_bTruncate = bTrunc;
+}
+
+#endif
diff -urNp lotuswordpro.bak/source/filter/xfilter/xftitle.hxx lotuswordpro/source/filter/xfilter/xftitle.hxx
--- lotuswordpro.bak/source/filter/xfilter/xftitle.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xftitle.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,89 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Page number field.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2005-01-31 create this file.
+ ************************************************************************/
+#ifndef		_XFTITLE_HXX
+#define		_XFTITLE_HXX
+
+#include	"xfglobal.hxx"
+#include	"xfcontent.hxx"
+#include	"xfnumfmt.hxx"
+
+/**
+ * @brief
+ * Title field.
+ */
+class XFTitle : public XFContent
+{
+public:
+	virtual void	ToXml(IXFStream *pStrm);
+};
+
+inline void XFTitle::ToXml(IXFStream *pStrm)
+{
+	IXFAttrList	*pAttrList = pStrm->GetAttrList();
+	pAttrList->Clear();
+
+	pStrm->StartElement( A2OUSTR("text:title") );
+	pStrm->EndElement( A2OUSTR("text:title") );
+}
+
+#endif
\ No newline at end of file
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfutil.cxx lotuswordpro/source/filter/xfilter/xfutil.cxx
--- lotuswordpro.bak/source/filter/xfilter/xfutil.cxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfutil.cxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,562 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Util functions for xml filter.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ * 2005-01-24 add some enum tool funtion here.
+ ************************************************************************/
+#include	<stdio.h>
+#include	"xfutil.hxx"
+#include	"xfparagraph.hxx"
+#include	"xfcontentcontainer.hxx"
+#include	<rtl/ustrbuf.hxx>
+#include	<sstream>
+
+rtl::OUString Int32ToOUString(sal_Int32 num)
+{
+	/*std::stringstream	sstrm;
+	
+	sstrm<<(int)num;
+	return rtl::OUString::createFromAscii(sstrm.str().c_str());
+	*/
+	return rtl::OUString::valueOf(num);
+}
+
+rtl::OUString Int16ToOUString(sal_Int16 num)
+{
+	/*std::stringstream	sstrm;
+	
+	sstrm<<(int)num;
+	return rtl::OUString::createFromAscii(sstrm.str().c_str());
+	*/
+	sal_Int32 nNum = static_cast<sal_Int32>(num);
+	return rtl::OUString::valueOf(nNum);
+}
+
+rtl::OUString	FloatToOUString(float num, sal_Int32 precision)
+{
+	/*std::stringstream	sstrm;
+	std::string			strRet;
+
+	sstrm.precision(precision);
+	sstrm<<num;
+	return rtl::OUString::createFromAscii(sstrm.str().c_str());
+	*/
+	return rtl::OUString::valueOf(num);
+}
+
+rtl::OUString	DoubleToOUString(double num, sal_Int32 precision)
+{
+	/*std::stringstream	sstrm;
+	std::string			strRet;
+	
+	sstrm.precision(precision);
+	sstrm<<num;
+	return rtl::OUString::createFromAscii(sstrm.str().c_str());
+	*/
+	return rtl::OUString::valueOf(num);
+}
+
+rtl::OUString	OEMToOUString(const std::string& str)
+{
+	return rtl::OUString();	
+}
+
+rtl::OUString	ColorToOUString( sal_uInt32 color)
+{
+	unsigned int	c = color&0x00ffffff;
+	unsigned char	r;
+	unsigned char	g;
+	unsigned char	b;
+	char			buf[8];
+
+	unsigned int	temp = c;
+	r = temp&0x000000ff;
+
+	temp = c;
+	g = (temp&0x0000ff00)>>8;
+
+	temp = c;
+	b = (temp&0x00ff0000)>>16;
+
+	rtl_zeroMemory(buf,8);
+	sprintf(buf,"#%2x%2x%2x",r,g,b);
+	for( int i=0; i<6; i++ )
+	{
+		if( buf[i] == ' ' )
+			buf[i] = '0';
+	}
+	return rtl::OUString::createFromAscii(buf);
+}
+
+rtl::OUString	DateTimeToOUString(XFDateTime& dt)
+{
+	rtl::OUStringBuffer	buf;
+	buf.append(dt.nYear);
+	buf.append( A2OUSTR("-") );
+	buf.append(dt.nMonth);
+	buf.append( A2OUSTR("-") );
+	buf.append(dt.nDay);
+	buf.append( A2OUSTR("T") );
+	buf.append(dt.nHour);
+	buf.append( A2OUSTR(":") );
+	buf.append(dt.nMinute);
+	buf.append( A2OUSTR(":") );
+	buf.append(dt.nSecond);
+	buf.append( A2OUSTR(".") );
+	buf.append(dt.nMillSecond);
+
+	return buf.makeStringAndClear();
+}
+
+rtl::OUString	GetTableColName(sal_Int32 col)
+{	
+	int		remain;
+	char	ch;
+	std::string	strOut;
+
+	if( col <= 26 )
+	{
+		ch = 'A' + col -1;
+		strOut += ch;
+		return A2OUSTR(strOut.c_str());
+	}
+
+	while( col>26 )
+	{
+		remain = col%26;
+		col = col/26;
+		ch = 'A' + remain -1;
+		strOut += ch;
+	}
+
+	ch = 'A' + remain -1;
+	strOut += ch;
+	return A2OUSTR(strOut.c_str());	
+}
+
+//tool functions:
+rtl::OUString	GetUnderlineName(enumXFUnderline type)
+{
+	switch(type)
+	{
+	case enumXFUnderlineNone:
+		return A2OUSTR("none");
+		break;
+	case enumXFUnderlineSingle:
+		return A2OUSTR("single");
+		break;
+	case enumXFUnderlineDouble:
+		return A2OUSTR("double");
+		break;
+	case enumXFUnderlineDotted:
+		return A2OUSTR("dotted");
+		break;
+	case enumXFUnderlineDash:
+		return A2OUSTR("dash");
+		break;
+	case enumXFUnderlineLongDash:
+		return A2OUSTR("long-dash");
+		break;
+	case enumXFUnderlineDotDash:
+		return A2OUSTR("dot-dash");
+		break;
+	case enumXFUnderlineDotDotDash:
+		return A2OUSTR("dot-dot-dash");
+		break;
+	case enumXFUnderlineWave:
+		return A2OUSTR("wave");
+		break;
+	case enumXFUnderlineBold:
+		return A2OUSTR("bold");
+		break;
+	case enumXFUnderlineBoldDotted:
+		return A2OUSTR("bold-dotted");
+		break;
+	case enumXFUnderlineBoldDash:
+		return A2OUSTR("bold-dash");
+		break;
+	case enumXFUnderlineBoldLongDash:
+		return A2OUSTR("bold-long-dash");
+		break;
+	case enumXFUnderlineBoldDotDash:
+		return A2OUSTR("bold-dot-dash");
+		break;
+	case enumXFUnderlineBoldDotDotDash:
+		return A2OUSTR("bold-dot-dot-dash");
+		break;
+	case enumXFUnderlineBoldWave:
+		return A2OUSTR("bold-wave");
+		break;
+	case enumXFUnderlineDoubleWave:
+		return A2OUSTR("double-wave");
+		break;
+	case enumXFUnderlineSmallWave:
+		return A2OUSTR("samll-wave");
+		break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetReliefName(enumXFRelief type)
+{
+	switch(type)
+	{
+		case enumXFReliefEngraved:
+			return A2OUSTR("engraved");
+			break;
+		case enumXFReliefEmbossed:
+			return A2OUSTR("embossed");
+			break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetCrossoutName(enumXFCrossout type)
+{
+	switch(type)
+	{
+	case enumXFCrossoutSignel:
+		return A2OUSTR("single-line");
+		break;
+	case enumXFCrossoutDouble:
+		return A2OUSTR("double-line");
+		break;
+	case enumXFCrossoutThick:
+		return A2OUSTR("thick-line");
+		break;
+	case enumXFCrossoutSlash:
+		return A2OUSTR("slash");
+		break;
+	case enumXFCrossoutX:
+		return A2OUSTR("X");
+		break;
+	}
+	
+}
+
+rtl::OUString	GetTransformName(enumXFTransform type)
+{
+	switch(type) {
+	case enumXFTransformUpper:
+		return A2OUSTR("uppercase");
+		break;
+	case enumXFTransformLower:
+		return A2OUSTR("lowercase");
+		break;
+	case enumXFTransformCapitalize:
+		return A2OUSTR("capitalize");
+		break;
+	case enumXFTransformSmallCaps:
+		return A2OUSTR("small-caps");
+		break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetEmphasizeName(enumXFEmphasize type)
+{
+	switch(type) {
+	case enumXFEmphasizeDot:
+		return A2OUSTR("dot");
+		break;
+	case enumXFEmphasizeCircle:
+		return A2OUSTR("circle");
+		break;
+	case enumXFEmphasizeDisc:
+		return A2OUSTR("disc");
+		break;
+	case enumXFEmphasizeAccent:
+		return A2OUSTR("accent");
+		break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetTextDirName(enumXFTextDir dir)
+{
+	switch(dir)
+	{
+	case enumXFTextDirLR:
+		return A2OUSTR("lr");
+		break;
+	case enumXFTextDirLR_TB:
+		return A2OUSTR("lr-tb");
+		break;
+	case enumXFTextDirPage:
+		return A2OUSTR("page");
+		break;
+	case enumXFTextDirRL:
+		return A2OUSTR("rl");
+		break;
+	case enumXFTextDirRL_TB:
+		return A2OUSTR("rl-tb");
+		break;
+	case enumXFTextDirTB:
+		return A2OUSTR("tb");
+		break;
+	case enumXFTextDirTB_LR:
+		return A2OUSTR("tb-lr");
+		break;
+	case enumXFTextDirTB_RL:
+		return A2OUSTR("tb-rl");
+		break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetFrameXPos(enumXFFrameXPos pos)
+{
+	switch(pos)
+	{
+	case enumXFFrameXPosLeft:
+		return A2OUSTR("left");
+		break;
+	case enumXFFrameXPosRight:
+		return A2OUSTR("right");
+		break;
+	case enumXFFrameXPosCenter:
+		return A2OUSTR("center");
+		break;
+	case enumXFFrameXPosFromLeft:
+		return A2OUSTR("from-left");
+		break;
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetFrameXRel(enumXFFrameXRel rel)
+{
+	switch(rel)
+	{
+	case enumXFFrameXRelPage:
+		return A2OUSTR("page");
+		break;
+	case enumXFFrameXRelPageContent:
+		return A2OUSTR("page-content");
+		break;
+	case enumXFFrameXRelPageEndMargin:
+		return A2OUSTR("page-end-margin");
+		break;
+	case enumXFFrameXRelPageStartMargin:
+		return A2OUSTR("page-start-margin");
+		break;
+	case enumXFFrameXRelPara:
+		return A2OUSTR("paragraph");
+		break;
+	case enumXFFrameXRelParaContent:
+		return A2OUSTR("paragraph-content");
+		break;
+	case enumXFFrameXRelParaEndMargin:
+		return A2OUSTR("paragraph-end-margin");
+		break;
+	case enumXFFrameXRelParaStartMargin:
+		return A2OUSTR("paragraph-start-margin");
+		break;
+	case enumXFFrameXRelChar:
+		return A2OUSTR("char");
+		break;
+	case enumXFFrameXRelFrame:
+		return A2OUSTR("frame");
+		break;
+	case enumXFFrameXRelFrameContent:
+		return A2OUSTR("frame-content");
+		break;
+	case enumXFFrameXRelFrameEndMargin:
+		return A2OUSTR("frame-end-margin");
+		break;
+	case enumXFFrameXRelFrameStartMargin:
+		return A2OUSTR("frame-start-margin");
+		break;
+	}
+}
+
+rtl::OUString	GetFrameYPos(enumXFFrameYPos pos)
+{
+	switch(pos)
+	{
+	case enumXFFrameYPosTop:
+		return A2OUSTR("top");
+	case enumXFFrameYPosMiddle:
+		return A2OUSTR("middle");
+	case enumXFFrameYPosBottom:
+		return A2OUSTR("bottom");
+	case enumXFFrameYPosFromTop:
+		return A2OUSTR("from-top");
+	case enumXFFrameYPosBelow:
+		return A2OUSTR("below");
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetFrameYRel(enumXFFrameYRel rel)
+{
+	switch(rel)
+	{
+	case enumXFFrameYRelBaseLine:
+		return A2OUSTR("baseline");
+	case enumXFFrameYRelChar:
+		return A2OUSTR("char");
+	case enumXFFrameYRelFrame:
+		return A2OUSTR("frame");
+	case enumXFFrameYRelFrameContent:
+		return A2OUSTR("frame-content");
+	case enumXFFrameYRelLine:
+		return A2OUSTR("line");
+	case enumXFFrameYRelPage:
+		return A2OUSTR("page");
+	case enumXFFrameYRelPageContent:
+		return A2OUSTR("page-content");
+	case enumXFFrameYRelPara:
+		return A2OUSTR("paragraph");
+	case enumXFFrameYRelParaContent:
+		return A2OUSTR("paragraph-content");
+	case enumXFFrameYRelText:
+		return A2OUSTR("text");
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetAlignName(enumXFAlignType align)
+{
+	if( align == enumXFAlignStart )
+		return A2OUSTR("start");
+	else if( align == enumXFAlignCenter )
+		return A2OUSTR("center");
+	else if( align == enumXFAlignEnd )
+		return A2OUSTR("end");
+	else if( align == enumXFAlignJustify )
+		return A2OUSTR("justify");
+	else if( align == enumXFAlignBottom )
+		return A2OUSTR("bottom");
+	else if( align == enumXFAlignTop )
+		return A2OUSTR("top");
+	else if( align == enumXFAlignMiddle )
+		return A2OUSTR("middle");
+	else if( align == enumXFALignMargins )
+		return A2OUSTR("margins");
+
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetDrawKind(enumXFDrawKind kind)
+{
+	if( kind == enumXFDrawKindFull )
+		return A2OUSTR("full");
+	else if( kind == enumXFDrawKindSection )
+		return A2OUSTR("section");
+	else if( kind == enumXFDrawKindCut )
+		return A2OUSTR("cut");
+	else	//( kind == enumXFDrawKindArc )
+		return A2OUSTR("arc");
+}
+
+rtl::OUString	GetPageUsageName(enumXFPageUsage usage)
+{
+	switch(usage)
+	{
+	case enumXFPageUsageAll:
+		return A2OUSTR("all");
+	case enumXFPageUsageLeft:
+		return A2OUSTR("left");
+	case enumXFPageUsageRight:
+		return A2OUSTR("right");
+	case enumXFPageUsageMirror:
+		return A2OUSTR("mirrored");
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetValueType(enumXFValueType type)
+{
+	switch(type)
+	{
+	case enumXFValueTypeBoolean:
+		return A2OUSTR("boolean");
+	case enumXFValueTypeCurrency:
+		return A2OUSTR("currency");
+	case enumXFValueTypeDate:
+		return A2OUSTR("date");
+	case enumXFValueTypeFloat:
+		return A2OUSTR("float");
+	case enumXFValueTypePercentage:
+		return A2OUSTR("percentage");
+	case enumXFValueTypeString:
+		return A2OUSTR("string");
+	case enumXFValueTypeTime:
+		return A2OUSTR("time");
+	}
+	return A2OUSTR("");
+}
+
+rtl::OUString	GetColorMode(enumXFColorMode mode)
+{
+	switch(mode)
+	{
+	case enumXFColorStandard:
+		return A2OUSTR("standard");
+	case enumXFColorGreyscale:
+		return A2OUSTR("greyscale");
+	case enumXFColorWatermark:
+		return A2OUSTR("watermark");
+	case enumXFColorMono:
+		return A2OUSTR("mono");
+	}
+	return A2OUSTR("");
+}
diff -urNp lotuswordpro.bak/source/filter/xfilter/xfutil.hxx lotuswordpro/source/filter/xfilter/xfutil.hxx
--- lotuswordpro.bak/source/filter/xfilter/xfutil.hxx	1970-01-01 08:00:00.000000000 +0800
+++ lotuswordpro/source/filter/xfilter/xfutil.hxx	2008-10-22 11:42:34.000000000 +0800
@@ -0,0 +1,122 @@
+/*************************************************************************
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: IBM Corporation
+ *
+ *  Copyright: 2008 by IBM Corporation
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+/*************************************************************************
+ * @file 
+ * Tool funtions for xml filter.
+ * Don't use any template for the ***TOOUString function list for easy.
+ ************************************************************************/
+/*************************************************************************
+ * Change History
+ * 2004-12-23 create this file.
+ ************************************************************************/
+#ifndef		_XFUTIL_HXX
+#define		_XFUTIL_HXX
+
+#include	"xfdefs.hxx"
+#include	<rtl/ustring.hxx>
+#include	<rtl/memory.h>
+#include	<string>
+
+
+#define	A2OUSTR(str)	rtl::OUString::createFromAscii(str)
+
+rtl::OUString	Int32ToOUString(sal_Int32 num);
+
+rtl::OUString	Int16ToOUString(sal_Int16 num);
+
+rtl::OUString	FloatToOUString(float num, sal_Int32 precision=6);
+
+rtl::OUString	DoubleToOUString(double num, sal_Int32 precision=6);
+
+rtl::OUString	OEMToOUString(const std::string& str);
+
+rtl::OUString	ColorToOUString( sal_uInt32 color);
+
+rtl::OUString	DateTimeToOUString(XFDateTime& dt);
+
+rtl::OUString	GetTableColName(sal_Int32 col);
+
+rtl::OUString	GetUnderlineName(enumXFUnderline type);
+
+rtl::OUString	GetReliefName(enumXFRelief type);
+
+rtl::OUString	GetCrossoutName(enumXFCrossout type);
+
+rtl::OUString	GetTransformName(enumXFTransform type);
+
+rtl::OUString	GetEmphasizeName(enumXFEmphasize type);
+
+rtl::OUString	GetTextDirName(enumXFTextDir dir);
+
+rtl::OUString	GetFrameXPos(enumXFFrameXPos pos);
+
+rtl::OUString	GetFrameXRel(enumXFFrameXRel rel);
+
+rtl::OUString	GetFrameYPos(enumXFFrameYPos pos);
+
+rtl::OUString	GetFrameYRel(enumXFFrameYRel rel);
+
+rtl::OUString	GetAlignName(enumXFAlignType align);
+
+rtl::OUString	GetDrawKind(enumXFDrawKind kind);
+
+rtl::OUString	GetPageUsageName(enumXFPageUsage usage);
+
+rtl::OUString	GetValueType(enumXFValueType type);
+
+rtl::OUString	GetColorMode(enumXFColorMode mode);
+
+#endif
+
