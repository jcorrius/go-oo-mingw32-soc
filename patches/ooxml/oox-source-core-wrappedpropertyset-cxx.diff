--- /dev/null	
+++ oox/source/core/wrappedpropertyset.cxx	
@@ -0,0 +1,159 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: wrappedpropertyset.cxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: dr $ $Date: 2007/02/26 16:04:54 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "oox/core/wrappedpropertyset.hxx"
+#include <rtl/strbuf.hxx>
+#include <osl/diagnose.h>
+
+using ::rtl::OUString;
+using ::rtl::OStringBuffer;
+using ::rtl::OUStringToOString;
+using ::com::sun::star::uno::Any;
+using ::com::sun::star::uno::Reference;
+using ::com::sun::star::uno::Sequence;
+using ::com::sun::star::uno::Exception;
+using ::com::sun::star::uno::UNO_QUERY;
+using ::com::sun::star::beans::XPropertySet;
+
+namespace oox {
+namespace core {
+
+// ============================================================================
+
+void WrappedPropertySet::set( const Reference< XPropertySet >& rxPropSet )
+{
+    mxPropSet = rxPropSet;
+    mxMultiPropSet.set( mxPropSet, UNO_QUERY );
+}
+
+// Get properties -------------------------------------------------------------
+
+bool WrappedPropertySet::getAnyProperty( Any& rValue, const OUString& rPropName ) const
+{
+    bool bHasValue = false;
+    try
+    {
+        if( mxPropSet.is() )
+        {
+            rValue = mxPropSet->getPropertyValue( rPropName );
+            bHasValue = true;
+        }
+    }
+    catch( Exception& )
+    {
+        OSL_ENSURE( false, OStringBuffer( "WrappedPropertySet::getAnyProperty - cannot get property \"" ).
+            append( OUStringToOString( rPropName, RTL_TEXTENCODING_ASCII_US ) ).append( '"' ).getStr() );
+    }
+    return bHasValue;
+}
+
+bool WrappedPropertySet::getBoolProperty( const OUString& rPropName ) const
+{
+    Any aAny;
+    bool bValue = false;
+    return getAnyProperty( aAny, rPropName ) && (aAny >>= bValue) && bValue;
+}
+
+void WrappedPropertySet::getProperties( Sequence< Any >& rValues, const Sequence< OUString >& rPropNames ) const
+{
+    try
+    {
+        if( mxMultiPropSet.is() )   // first try the XMultiPropertySet
+        {
+            rValues = mxMultiPropSet->getPropertyValues( rPropNames );
+        }
+        else if( mxPropSet.is() )
+        {
+            sal_Int32 nLen = rPropNames.getLength();
+            const OUString* pPropName = rPropNames.getConstArray();
+            const OUString* pPropNameEnd = pPropName + nLen;
+            rValues.realloc( nLen );
+            Any* pValue = rValues.getArray();
+            for( ; pPropName != pPropNameEnd; ++pPropName, ++pValue )
+                *pValue = mxPropSet->getPropertyValue( *pPropName );
+        }
+    }
+    catch( Exception& )
+    {
+        OSL_ENSURE( false, "WrappedPropertySet::getProperties - cannot get all property values" );
+    }
+}
+
+// Set properties -------------------------------------------------------------
+
+void WrappedPropertySet::setAnyProperty( const OUString& rPropName, const Any& rValue )
+{
+    try
+    {
+        if( mxPropSet.is() )
+            mxPropSet->setPropertyValue( rPropName, rValue );
+    }
+    catch( Exception& )
+    {
+        OSL_ENSURE( false, OStringBuffer( "WrappedPropertySet::setAnyProperty - cannot set property \"" ).
+            append( OUStringToOString( rPropName, RTL_TEXTENCODING_ASCII_US ) ).append( '"' ).getStr() );
+    }
+}
+
+void WrappedPropertySet::setProperties( const Sequence< OUString >& rPropNames, const Sequence< Any >& rValues )
+{
+    OSL_ENSURE( rPropNames.getLength() == rValues.getLength(),
+        "WrappedPropertySet::setProperties - length of sequences different" );
+    try
+    {
+        if( mxMultiPropSet.is() )   // first try the XMultiPropertySet
+        {
+            mxMultiPropSet->setPropertyValues( rPropNames, rValues );
+        }
+        else if( mxPropSet.is() )
+        {
+            const OUString* pPropName = rPropNames.getConstArray();
+            const OUString* pPropNameEnd = pPropName + rPropNames.getLength();
+            const Any* pValue = rValues.getConstArray();
+            for( ; pPropName != pPropNameEnd; ++pPropName, ++pValue )
+                mxPropSet->setPropertyValue( *pPropName, *pValue );
+        }
+    }
+    catch( Exception& )
+    {
+        OSL_ENSURE( false, "WrappedPropertySet::setAnyProperty - cannot set all property values" );
+    }
+}
+
+// ============================================================================
+
+} // namespace core
+} // namespace oox
+
