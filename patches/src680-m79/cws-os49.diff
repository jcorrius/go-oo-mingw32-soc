Index: svtools/source/edit/texteng.cxx
===================================================================
RCS file: /cvs/util/svtools/source/edit/texteng.cxx,v
retrieving revision 1.38
retrieving revision 1.37.58.2
diff -u -p -u -p -r1.38 -r1.37.58.2
--- svtools/source/edit/texteng.cxx	31 Jan 2005 09:25:50 -0000	1.38
+++ svtools/source/edit/texteng.cxx	7 Feb 2005 08:11:05 -0000	1.37.58.2
@@ -477,7 +477,7 @@ BOOL TextEngine::IsSimpleCharInput( cons
 {
 	if( rKeyEvent.GetCharCode() >= 32 && rKeyEvent.GetCharCode() != 127 &&
 #ifndef MAC
-		KEY_MOD2 != (rKeyEvent.GetKeyCode().GetModifier() & ~KEY_SHIFT ) )
+        0 == ((KEY_MOD2|KEY_MOD1) & (rKeyEvent.GetKeyCode().GetModifier() ) ))
 #else
 		KEY_MOD1 != rKeyEvent.GetKeyCode().GetModifier() )
 #endif
Index: svtools/source/edit/textview.cxx
===================================================================
RCS file: /cvs/util/svtools/source/edit/textview.cxx,v
retrieving revision 1.46
retrieving revision 1.46.58.2
diff -u -p -u -p -r1.46 -r1.46.58.2
--- svtools/source/edit/textview.cxx	15 Nov 2004 16:32:41 -0000	1.46
+++ svtools/source/edit/textview.cxx	1 Mar 2005 14:03:29 -0000	1.46.58.2
@@ -881,6 +881,12 @@ void TextView::MouseButtonDown( const Mo
 
     mpImpl->mpSelEngine->SelMouseButtonDown( rMouseEvent );
 
+	// mbu 20.01.2005 - SelMouseButtonDown() possibly triggers a 'selection changed'
+	// notification. The appropriate handler could change the current selection,
+	// which is the case in the MailMerge address block control. To enable select'n'drag
+	// we need to reevaluate the selection after the notification has been fired.
+    mpImpl->mbClickedInSelection = IsSelectionAtPoint( rMouseEvent.GetPosPixel() );
+
 	// Sonderbehandlungen
 	if ( !rMouseEvent.IsShift() && ( rMouseEvent.GetClicks() >= 2 ) )
 	{
@@ -2089,8 +2095,9 @@ void TextView::drop( const ::com::sun::s
                 mpImpl->maSelection.GetEnd().GetIndex(), FALSE );
         }
 
-		if ( aPrevSel.HasRange() &&
-				( rDTDE.DropAction & datatransfer::dnd::DNDConstants::ACTION_MOVE ) || !bStarterOfDD )
+        if ( aPrevSel.HasRange() && 
+                !mpImpl->mbSupportProtectAttribute && // don't remove currently selected element
+                (( rDTDE.DropAction & datatransfer::dnd::DNDConstants::ACTION_MOVE ) || !bStarterOfDD) )
 		{
 			// ggf. Selection anpasssen:
             if ( ( mpImpl->mpDDInfo->maDropPos.GetPara() < aPrevSel.GetStart().GetPara() ) ||
Index: officecfg/registry/schema/org/openoffice/Office/Writer.xcs
===================================================================
RCS file: /cvs/util/officecfg/registry/schema/org/openoffice/Office/Writer.xcs,v
retrieving revision 1.35
retrieving revision 1.35.50.1
diff -u -p -u -p -r1.35 -r1.35.50.1
--- officecfg/registry/schema/org/openoffice/Office/Writer.xcs	15 Nov 2004 13:27:14 -0000	1.35
+++ officecfg/registry/schema/org/openoffice/Office/Writer.xcs	13 Jan 2005 16:44:37 -0000	1.35.50.1
@@ -822,7 +822,8 @@
                     <desc>Contains a list of settings for address blocks. It is a sequence of address column positions separated with breaks (\n) and spaces. The column positions start at 0 and after 9 follows a, b, c and they are equivalent to the following parts of an address: TITLE,FIRSTNAME,LASTNAME,COMPANY,ADDRESS_1,ADDRESS_2,CITY,REGION,ZIP,COUNTRY,PHONE_PRIVATE,PHONE_BUSINESS,E_MAIL</desc>
                     <label>Address block settings</label>
                 </info>
-                <value oor:separator=";">&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;9&gt;;&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;3&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;5&gt;;&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;9&gt;;&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;5&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;9&gt;</value>
+                <value oor:separator=";">&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;4&gt;\n&lt;8&gt; &lt;6&gt;;&lt;0&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;4&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;9&gt;;&lt;3&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;4&gt;\n&lt;8&gt; &lt;6&gt;;&lt;3&gt;\n&lt;1&gt; &lt;2&gt;\n&lt;4&gt;\n&lt;8&gt; &lt;6&gt;\n&lt;9&gt;</value>
+            
             </prop>
             <prop oor:name="IsAddressBlock" oor:type="xs:boolean">
                 <info>
Index: sw/source/core/doc/docbm.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docbm.cxx,v
retrieving revision 1.12
retrieving revision 1.12.84.1
diff -u -p -u -p -r1.12 -r1.12.84.1
--- sw/source/core/doc/docbm.cxx	16 Nov 2004 15:39:14 -0000	1.12
+++ sw/source/core/doc/docbm.cxx	11 Jan 2005 14:10:13 -0000	1.12.84.1
@@ -157,8 +157,7 @@ void lcl_FixPosition( SwPosition& rPos )
     // make sure the position has 1) the proper node, and 2) a proper index
     SwTxtNode* pTxtNode = rPos.nNode.GetNode().GetTxtNode();
 
-    if( rPos.nContent.GetIdxReg() != pTxtNode  ||
-        rPos.nContent.GetIndex() > ( pTxtNode == NULL ? 0 : pTxtNode->Len() ) )
+    if( rPos.nContent.GetIndex() > ( pTxtNode == NULL ? 0 : pTxtNode->Len() ) )
     {
         DBG_ERROR( "illegal position" );
         xub_StrLen nLen = rPos.nContent.GetIndex();
Index: sw/source/core/tox/tox.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/tox/tox.cxx,v
retrieving revision 1.14
retrieving revision 1.13.72.2
diff -u -p -u -p -r1.14 -r1.13.72.2
--- sw/source/core/tox/tox.cxx	5 Jan 2005 14:32:05 -0000	1.14
+++ sw/source/core/tox/tox.cxx	20 Jan 2005 16:06:41 -0000	1.13.72.2
@@ -840,6 +840,8 @@ SwTOXBase & SwTOXBase::operator = (const
     aName = rSource.aName;
     aTitle = rSource.aTitle;
     sMainEntryCharStyle = rSource.sMainEntryCharStyle;
+    for(USHORT nLevel = 0; nLevel < MAXLEVEL; nLevel++)
+        aStyleNames[nLevel] = rSource.aStyleNames[nLevel];
     sSequenceName = rSource.sSequenceName;
     eLanguage = rSource.eLanguage;
     sSortAlgorithm = rSource.sSortAlgorithm;
Index: sw/source/core/unocore/unoobj2.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unoobj2.cxx,v
retrieving revision 1.49
retrieving revision 1.48.210.2
diff -u -p -u -p -r1.49 -r1.48.210.2
--- sw/source/core/unocore/unoobj2.cxx	27 Jan 2005 12:37:42 -0000	1.49
+++ sw/source/core/unocore/unoobj2.cxx	7 Feb 2005 08:30:21 -0000	1.48.210.2
@@ -1244,32 +1244,27 @@ uno::Reference< XTextContent > SAL_CALL 
     SwUnoCrsr* pUnoCrsr = GetCrsr();
     if(pUnoCrsr)
     {
-        // check for end of iteration
-        if(!bFirstParagraph)
+        // check for exceeding selections
+        if(!bFirstParagraph && 
+            CURSOR_SELECTION == eCursorType || CURSOR_SELECTION_IN_TABLE == eCursorType)
         {
-            sal_Bool bNext;     // true if there is another paragraph
-                                // to travel through
             SwPosition* pStart = pUnoCrsr->Start();
-            SwUnoCrsr* pNewCrsr = pUnoCrsr->GetDoc()->CreateUnoCrsr(*pStart, sal_False);
+            ::std::auto_ptr<SwUnoCrsr> aNewCrsr( pUnoCrsr->GetDoc()->CreateUnoCrsr(*pStart, sal_False) );
             //man soll hier auch in Tabellen landen duerfen
             if(CURSOR_TBLTEXT != eCursorType && CURSOR_SELECTION_IN_TABLE != eCursorType)
-                pNewCrsr->SetRemainInSection( sal_False );
+                aNewCrsr->SetRemainInSection( sal_False );
 
-            //was mache ich, wenn ich schon in einer Tabelle stehe?
-            SwTableNode* pTblNode = pNewCrsr->GetNode()->FindTableNode();
+            // os 2005-01-14: This part is only necessary to detect movements out of a selection 
+            // if there is no selection we don't have to care
+            SwTableNode* pTblNode = aNewCrsr->GetNode()->FindTableNode();
             if((CURSOR_TBLTEXT != eCursorType && CURSOR_SELECTION_IN_TABLE != eCursorType) && pTblNode)
             {
-                pNewCrsr->GetPoint()->nNode = pTblNode->EndOfSectionIndex();
-                bNext = pNewCrsr->Move(fnMoveForward, fnGoNode);
+                aNewCrsr->GetPoint()->nNode = pTblNode->EndOfSectionIndex();
+                aNewCrsr->Move(fnMoveForward, fnGoNode);
             }
             else
-                bNext = pNewCrsr->MovePara(fnParaNext, fnParaStart);
-            if((CURSOR_SELECTION == eCursorType || CURSOR_SELECTION_IN_TABLE == eCursorType)
-                        && nEndIndex < pNewCrsr->Start()->nNode.GetIndex())
-                bNext = FALSE;
-            delete pNewCrsr;
-
-            if (!bNext)
+                aNewCrsr->MovePara(fnParaNext, fnParaStart);
+            if(nEndIndex < aNewCrsr->Start()->nNode.GetIndex())
                 return aRef;	// empty reference
         }
 
@@ -1309,7 +1304,6 @@ uno::Reference< XTextContent > SAL_CALL 
             SwPosition* pStart = pUnoCrsr->Start();
             sal_Int32 nFirstContent = bFirstParagraph ? nFirstParaStart : -1;
             sal_Int32 nLastContent = nEndIndex ==  pStart->nNode.GetIndex() ? nLastParaEnd : -1;
-//            bFirstParagraph = sal_False;
             //steht man nun in einer Tabelle, oder in einem einfachen Absatz?
 
             SwTableNode* pTblNode = pUnoCrsr->GetNode()->FindTableNode();
@@ -1317,7 +1311,6 @@ uno::Reference< XTextContent > SAL_CALL 
             if(/*CURSOR_TBLTEXT != eCursorType && CURSOR_SELECTION_IN_TABLE != eCursorType && */ 
 				pTblNode  &&  &pTblNode->GetTable() != pOwnTable)
             {
-
                 // wir haben es mit einer fremden Tabelle zu tun
                 SwFrmFmt* pTableFmt = (SwFrmFmt*)pTblNode->GetTable().GetFrmFmt();
                 XTextTable* pTable = SwXTextTables::GetObject( *pTableFmt );
@@ -1329,9 +1322,6 @@ uno::Reference< XTextContent > SAL_CALL 
                 aRef =  (XTextContent*)new SwXParagraph((SwXText*)pText, pNewCrsr, nFirstContent, nLastContent);
             }
         }
-//        else
-//            throw container::NoSuchElementException();
-     
     }
     else
         throw uno::RuntimeException();
Index: sw/source/ui/app/mn.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/app/mn.src,v
retrieving revision 1.38
retrieving revision 1.38.84.1
diff -u -p -u -p -r1.38 -r1.38.84.1
--- sw/source/ui/app/mn.src	16 Nov 2004 16:57:07 -0000	1.38
+++ sw/source/ui/app/mn.src	12 Jan 2005 14:32:33 -0000	1.38.84.1
@@ -340,16 +340,6 @@
         Text [ en-US ] = "~Name Object..." ; \
     };
 
-#define MN_RESET\
-    MenuItem\
-    {\
-        Text [ de ] = "Standar~d" ; \
-        Identifier = FN_FORMAT_RESET ; \
-        HelpID = FN_FORMAT_RESET ; \
-        Text [ en-US ] = "~Default" ; \
-        Text [ de ] = "Standar~d" ; \
-    };
-
 #define MN_FRM \
     MenuItem\
     {\
Index: sw/source/ui/config/mailconfigpage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/config/mailconfigpage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.1
diff -u -p -u -p -r1.2 -r1.2.212.1
--- sw/source/ui/config/mailconfigpage.src	20 Sep 2004 13:08:23 -0000	1.2
+++ sw/source/ui/config/mailconfigpage.src	14 Jan 2005 16:34:04 -0000	1.2.212.1
@@ -71,6 +71,9 @@ TabPage TP_MAILCONFIG
     Size = MAP_APPFONT ( 260 , 185 ) ;
     Hide = TRUE ;
 
+    Text [ de ] = "Serienbrief-E-Mail" ;
+    Text[ en-US ] = "Mail Merge E-mail";
+
     FixedLine  FL_IDENTITY
     {
         Pos = MAP_APPFONT ( 6 , 3 ) ;
Index: sw/source/ui/config/optdlg.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/config/optdlg.src,v
retrieving revision 1.97
retrieving revision 1.97.326.1
diff -u -p -u -p -r1.97 -r1.97.326.1
--- sw/source/ui/config/optdlg.src	28 Jun 2004 13:12:35 -0000	1.97
+++ sw/source/ui/config/optdlg.src	18 Jan 2005 07:47:54 -0000	1.97.326.1
@@ -622,14 +622,14 @@ TabPage TP_OPTTABLE_PAGE
     FixedLine FL_TABLE
 	{
         Pos = MAP_APPFONT ( 6 , 3 ) ;
-        Size = MAP_APPFONT ( 118 , 8 ) ;
+        Size = MAP_APPFONT ( 113 , 8 ) ;
         Text [ de ] = "Standard" ;
 		Text [ en-US ] = "Default";
 	};
     CheckBox CB_HEADER
 	{
         Pos = MAP_APPFONT ( 12 , 14 ) ;
-		Size = MAP_APPFONT ( 112 , 10 ) ;
+        Size = MAP_APPFONT ( 107 , 10 ) ;
 		Text [ de ] = "Übe~rschrift" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "H~eading";
@@ -638,7 +638,7 @@ TabPage TP_OPTTABLE_PAGE
 	CheckBox CB_REPEAT_HEADER
 	{
         Pos = MAP_APPFONT ( 21 , 27 ) ;
-        Size = MAP_APPFONT ( 104 , 10 ) ;
+        Size = MAP_APPFONT ( 99 , 10 ) ;
 		Text [ de ] = "Auf jeder Seite ~wiederholen" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "Re~peat on each page";
@@ -647,7 +647,7 @@ TabPage TP_OPTTABLE_PAGE
 	CheckBox CB_DONT_SPLIT
 	{
         Pos = MAP_APPFONT ( 12 , 40 ) ;
-		Size = MAP_APPFONT ( 112 , 10 ) ;
+        Size = MAP_APPFONT ( 107 , 10 ) ;
 		Text [ de ] = "~Nicht trennen" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "Do not split";
@@ -656,7 +656,7 @@ TabPage TP_OPTTABLE_PAGE
 	CheckBox CB_BORDER
 	{
         Pos = MAP_APPFONT ( 12 , 53 ) ;
-		Size = MAP_APPFONT ( 112 , 10 ) ;
+        Size = MAP_APPFONT ( 107 , 10 ) ;
 		Text [ de ] = "~Umrandung" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "B~order";
@@ -664,22 +664,22 @@ TabPage TP_OPTTABLE_PAGE
 	};
     FixedLine FL_TABLE_SEPARATOR
 	{
-        Pos = MAP_APPFONT ( 125 , 14 ) ;
+        Pos = MAP_APPFONT ( 120 , 14 ) ;
         Size = MAP_APPFONT ( 4 , 52 ) ;
         Vert = TRUE;
     };
     FixedLine FL_TABLE_INSERT
 	{
-        Pos = MAP_APPFONT ( 130 , 3 ) ;
-        Size = MAP_APPFONT ( 124 , 8 ) ;
+        Pos = MAP_APPFONT ( 125 , 3 ) ;
+        Size = MAP_APPFONT ( 129 , 8 ) ;
 		Text [ de ] = "Eingabe in Tabellen" ;
 		Text [ en-US ] = "Input in tables";
 		Text [ x-comment ] = " ";
 	};
     CheckBox CB_NUMFORMATTING
 	{
-        Pos = MAP_APPFONT ( 136 , 14 ) ;
-		Size = MAP_APPFONT ( 113 , 10 ) ;
+        Pos = MAP_APPFONT ( 131 , 14 ) ;
+        Size = MAP_APPFONT ( 118 , 10 ) ;
 		Text [ de ] = "Zahlen~erkennung" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "Number recognition";
@@ -687,8 +687,8 @@ TabPage TP_OPTTABLE_PAGE
 	};
 	CheckBox CB_NUMFMT_FORMATTING
 	{
-        Pos = MAP_APPFONT ( 145 , 27 ) ;
-		Size = MAP_APPFONT ( 109 , 10 ) ;
+        Pos = MAP_APPFONT ( 140 , 27 ) ;
+        Size = MAP_APPFONT ( 114 , 10 ) ;
         Text [ de ] = "Zahlenformater~kennung" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "Number format recognition";
@@ -696,8 +696,8 @@ TabPage TP_OPTTABLE_PAGE
 	};
 	CheckBox CB_NUMALIGNMENT
 	{
-        Pos = MAP_APPFONT ( 145 , 40 ) ;
-		Size = MAP_APPFONT ( 109 , 10 ) ;
+        Pos = MAP_APPFONT ( 140 , 40 ) ;
+        Size = MAP_APPFONT ( 114 , 10 ) ;
 		Text [ de ] = "Au~srichtung" ;
 		TabStop = TRUE ;
 		Text [ en-US ] = "Alignment";
Index: sw/source/ui/dbui/addresslistdialog.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/addresslistdialog.cxx,v
retrieving revision 1.4
retrieving revision 1.4.158.2
diff -u -p -u -p -r1.4 -r1.4.158.2
--- sw/source/ui/dbui/addresslistdialog.cxx	22 Oct 2004 13:57:06 -0000	1.4
+++ sw/source/ui/dbui/addresslistdialog.cxx	20 Jan 2005 14:30:56 -0000	1.4.158.2
@@ -299,15 +299,15 @@ SwAddressListDialog::SwAddressListDialog
     Size aSz(m_aListHB.GetOutputSizePixel());
     m_aListHB.InsertItem( ITEMID_NAME, m_sName,
                             aSz.Width()/2,
-                            HIB_LEFT | HIB_VCENTER /*| HIB_CLICKABLE | HIB_UPARROW */);
+                            HIB_LEFT | HIB_VCENTER | HIB_FIXED | HIB_FIXEDPOS/*| HIB_CLICKABLE | HIB_UPARROW */);
     m_aListHB.InsertItem( ITEMID_TABLE, m_sTable,
                             aSz.Width()/2,
-                            HIB_LEFT | HIB_VCENTER /*| HIB_CLICKABLE | HIB_UPARROW */);
+                            HIB_LEFT | HIB_VCENTER | HIB_FIXED | HIB_FIXEDPOS /*| HIB_CLICKABLE | HIB_UPARROW */);
     m_aListHB.SetHelpId(HID_MM_ADDRESSLIST_HB );
     m_aListHB.Show();
 
     m_aListLB.SetHelpId(HID_MM_ADDRESSLIST_TLB);
-    static long nTabs[] = {3, 0, aSz.Width()/2, aSz.Width() };
+    static long nTabs[] = {2, 0, aSz.Width()/2 };
     m_aListLB.SetWindowBits( WB_SORT | WB_HSCROLL | WB_CLIPCHILDREN | WB_TABSTOP );
     m_aListLB.SetSelectionMode( SINGLE_SELECTION );
     m_aListLB.SetTabs(&nTabs[0], MAP_PIXEL);
@@ -365,6 +365,7 @@ SwAddressListDialog::SwAddressListDialog
     m_aOK.Enable(m_aListLB.GetEntryCount()>0 && bEnableOK);
     m_aEditPB.Enable(bEnableEdit);
     m_aListLB.SetSelectHdl(LINK(this, SwAddressListDialog, ListBoxSelectHdl_Impl));
+	TableSelectHdl_Impl(NULL);
 }
 /*-- 07.04.2004 16:35:43---------------------------------------------------
 
Index: sw/source/ui/dbui/mailmergehelper.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mailmergehelper.cxx,v
retrieving revision 1.4
retrieving revision 1.3.84.4
diff -u -p -u -p -r1.4 -r1.3.84.4
--- sw/source/ui/dbui/mailmergehelper.cxx	28 Jan 2005 15:28:42 -0000	1.4
+++ sw/source/ui/dbui/mailmergehelper.cxx	28 Feb 2005 14:32:40 -0000	1.3.84.4
@@ -453,16 +453,24 @@ void SwAddressPreview::Paint(const Recta
         nStartRow = (sal_uInt16)aVScrollBar.GetThumbPos();
     }
     Size aPartSize( aSize.Width()/pImpl->nColumns, aSize.Height()/pImpl->nRows );
+	aPartSize.Width() -= 2;
+	aPartSize.Height() -= 2;
     
     sal_uInt16 nAddress = nStartRow * pImpl->nColumns;
+	const sal_uInt16 nNumAddresses = pImpl->aAdresses.size();
     for(sal_uInt16 nRow = 0; nRow < pImpl->nRows ; ++nRow)
     {        
         for(sal_uInt16 nCol = 0; nCol < pImpl->nColumns; ++nCol)
         {
-            if(nAddress >= pImpl->aAdresses.size())
+            if(nAddress >= nNumAddresses)
                 break;
             Point aPos(nCol * aPartSize.Width(), (nRow) * aPartSize.Height());
-            DrawText_Impl( pImpl->aAdresses[nAddress], aPos, aPartSize, nAddress == pImpl->nSelectedAddress);
+			aPos.Move(1,1);
+			bool bIsSelected = nAddress == pImpl->nSelectedAddress;
+			if((pImpl->nColumns * pImpl->nRows) == 1)
+				bIsSelected = false;
+			::rtl::OUString adr(pImpl->aAdresses[nAddress]);
+            DrawText_Impl(adr,aPos,aPartSize,bIsSelected);
             ++nAddress;
         }
     }
@@ -821,7 +829,7 @@ uno::Reference< uno::XComponentContext> 
 /*-- 13.07.2004 09:07:01---------------------------------------------------
 
   -----------------------------------------------------------------------*/
-SwMailTransferable::SwMailTransferable(const String& rBody, const String& rMimeType) :
+SwMailTransferable::SwMailTransferable(const rtl::OUString& rBody, const rtl::OUString& rMimeType) :
     cppu::WeakComponentImplHelper1< datatransfer::XTransferable >(m_aMutex),
     m_aMimeType( rMimeType ),
     m_sBody( rBody ),
@@ -831,8 +839,8 @@ SwMailTransferable::SwMailTransferable(c
 /*-- 13.07.2004 09:07:01---------------------------------------------------
 
   -----------------------------------------------------------------------*/
-SwMailTransferable::SwMailTransferable(const String& rURL, 
-                const String& rName, const String& rMimeType) :
+SwMailTransferable::SwMailTransferable(const rtl::OUString& rURL, 
+                const rtl::OUString& rName, const rtl::OUString& rMimeType) :
     cppu::WeakComponentImplHelper1< datatransfer::XTransferable >(m_aMutex),
     m_aMimeType( rMimeType ),
     m_aURL(rURL),
Index: sw/source/ui/dbui/mmaddressblockpage.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmaddressblockpage.cxx,v
retrieving revision 1.5
retrieving revision 1.4.84.11
diff -u -p -u -p -r1.5 -r1.4.84.11
--- sw/source/ui/dbui/mmaddressblockpage.cxx	7 Jan 2005 09:45:05 -0000	1.5
+++ sw/source/ui/dbui/mmaddressblockpage.cxx	28 Feb 2005 13:42:02 -0000	1.4.84.11
@@ -257,6 +257,7 @@ IMPL_LINK(SwMailMergeAddressBlockPage, S
         for(sal_Int32 nAddress = 0; nAddress < aBlocks.getLength(); ++nAddress)
             m_aSettingsWIN.AddAddress(aBlocks[nAddress]);
         m_aSettingsWIN.SelectAddress(0);
+        m_aSettingsWIN.Invalidate();	// #i40408
         rConfig.SetCountrySettings(pDlg->IsIncludeCountry(), pDlg->GetCountry());
         InsertDataHdl_Impl(0);
     }            
@@ -447,11 +448,14 @@ const uno::Sequence< ::rtl::OUString >& 
         ::rtl::OUString* pTemp = aTemp.getArray();
         pTemp[0] = m_aAddressBlocks[nSelect];
         sal_uInt32 nIndex = 1;
-        for(sal_Int32 nAddress = 1; nAddress < m_aAddressBlocks.getLength(); ++nAddress)
+		const sal_uInt32 nNumBlocks = m_aAddressBlocks.getLength();
+        for(sal_uInt32 nAddress = 1; nAddress < nNumBlocks; ++nAddress)
         {
-            if(nIndex == nSelect)
+			if(nIndex == nSelect)
+			{
                 ++nIndex;
-            pTemp[nAddress] = m_aAddressBlocks[nIndex];
+	            pTemp[nAddress] = m_aAddressBlocks[nIndex];
+			}
         }            
         m_aAddressBlocks = aTemp;
     }            
@@ -510,10 +514,12 @@ IMPL_LINK(SwSelectAddressBlockDialog, De
   -----------------------------------------------------------------------*/
 IMPL_LINK(SwSelectAddressBlockDialog, NewCustomizeHdl_Impl, PushButton*, pButton)
 {
-    SwCustomizeAddressBlockDialog* pDlg = 
-            new SwCustomizeAddressBlockDialog(pButton, m_rConfig, 
-                            SwCustomizeAddressBlockDialog::ADDRESSBLOCK);
     bool bCustomize = pButton == &m_aCustomizePB;
+	SwCustomizeAddressBlockDialog::DialogType nType = bCustomize ?
+		SwCustomizeAddressBlockDialog::ADDRESSBLOCK_EDIT :
+		SwCustomizeAddressBlockDialog::ADDRESSBLOCK_NEW;
+    SwCustomizeAddressBlockDialog *pDlg = 
+		new SwCustomizeAddressBlockDialog(pButton,m_rConfig,nType);
     if(bCustomize)
     {
         pDlg->SetAddress(m_aAddressBlocks[m_aPreview.GetSelectedAddress()]);
@@ -546,6 +552,50 @@ IMPL_LINK(SwSelectAddressBlockDialog, In
     return 0;
 }
 
+/* -----------------------------28.02.05 09:00--------------------------------
+
+ ---------------------------------------------------------------------------*/
+SwRestrictedComboBox::~SwRestrictedComboBox()
+{
+}
+/* -----------------------------28.02.05 09:00--------------------------------
+
+ ---------------------------------------------------------------------------*/
+void SwRestrictedComboBox::KeyInput(const KeyEvent& rEvt)
+{
+	BOOL bCallParent = TRUE;
+	if(rEvt.GetCharCode())
+	{
+		String sKey = rEvt.GetCharCode();
+		if(	STRING_NOTFOUND != sForbiddenChars.Search(sKey))
+			bCallParent = FALSE;
+	}
+	if(bCallParent)
+		ComboBox::KeyInput(rEvt);
+}
+/* -----------------------------28.02.05 09:00--------------------------------
+
+ ---------------------------------------------------------------------------*/
+void SwRestrictedComboBox::Modify()
+{
+	Selection aSel = GetSelection();
+	String sTemp = GetText();
+	for(USHORT i = 0; i < sForbiddenChars.Len(); i++)
+	{
+		sTemp.EraseAllChars( sForbiddenChars.GetChar(i) );
+	}
+	USHORT nDiff = GetText().Len() - sTemp.Len();
+	if(nDiff)
+	{
+		aSel.setMin(aSel.getMin() - nDiff);
+		aSel.setMax(aSel.getMin());
+		SetText(sTemp);
+		SetSelection(aSel);
+	}
+	if(GetModifyHdl().IsSet())
+		GetModifyHdl().Call(this);
+}
+
 /*-- 13.04.2004 16:01:08---------------------------------------------------
 
   -----------------------------------------------------------------------*/
@@ -580,8 +630,9 @@ SwCustomizeAddressBlockDialog::SwCustomi
     m_eType(eType),
     m_rConfigItem(rConfig)
 {
+    m_aFieldCB.SetForbiddenChars( String::CreateFromAscii("<>"));
     m_aDragED.SetStyle(m_aDragED.GetStyle() |WB_NOHIDESELECTION);
-    if( eType != ADDRESSBLOCK  )
+    if( eType >= GREETING_FEMALE )
     {
         m_aFieldFT.Show();
         m_aFieldCB.Show();
@@ -608,6 +659,9 @@ SwCustomizeAddressBlockDialog::SwCustomi
     }
     else
     {
+		if(eType == ADDRESSBLOCK_EDIT)
+	        SetText(String(ResId(ST_TITLE_EDIT)));
+
         //resize the preview 
         Point aFieldPos(m_aFieldFT.GetPosPixel());
         long nDiff = m_aPreviewFI.GetPosPixel().Y() - aFieldPos.Y();
@@ -673,7 +727,7 @@ IMPL_LINK(SwCustomizeAddressBlockDialog,
 {
     m_aDragED.Modified();
     String sAddress = SwAddressPreview::FillData(
-            m_aDragED.GetText(), 
+            GetAddress(), 
             m_rConfigItem);
     m_aPreviewWIN.SetAddress(sAddress);
     UpdateImageButtons_Impl();
@@ -762,38 +816,44 @@ bool   SwCustomizeAddressBlockDialog::Ha
   -----------------------------------------------------------------------*/
 IMPL_LINK(SwCustomizeAddressBlockDialog, SelectionChangedHdl_Impl, AddressMultiLineEdit*, pEdit)
 {
-    //determine selection - if it's one of the editable fields then 
-    //enable the related ComboBox and fill it 
-    sal_Int32 nSelected;
-    if(m_aFieldCB.IsVisible() && 
-            USER_DATA_NONE != (nSelected = GetSelectedItem_Impl()) && nSelected < 0)
+	// called in case the selection of the edit field changes.
+    // determine selection - if it's one of the editable fields then 
+    // enable the related ComboBox and fill it 
+	static bool bOnEntry = false;
+	if(bOnEntry)
+		return 0;
+
+	bOnEntry = true;
+    sal_Int32 nSelected = GetSelectedItem_Impl();
+    if(USER_DATA_NONE != nSelected)
+		pEdit->SelectCurrentItem();
+
+    if(m_aFieldCB.IsVisible() && (USER_DATA_NONE != nSelected) && (nSelected < 0))
     {        
         //search in ListBox if it's one of the first entries        
         sal_Bool bFound = sal_False;
         String sSelect;
         ::std::vector<String>* pVector = 0;
-        switch(nSelected)
-        {
-            case USER_DATA_SALUTATION : 
+        switch(nSelected) {
+            case USER_DATA_SALUTATION: 
                 sSelect =  m_sCurrentSalutation;      
                 pVector = &m_aSalutations; 
-            break;
-            case USER_DATA_PUNCTUATION : 
+				break;
+            case USER_DATA_PUNCTUATION: 
                 sSelect =  m_sCurrentPunctuation;     
                 pVector = &m_aPunctuations;
-            break;
-            case USER_DATA_TEXT : sSelect =  m_sCurrentText;  
-            break;
+				break;
+            case USER_DATA_TEXT:
+				sSelect =  m_sCurrentText;  
+				break;
         }
         m_aFieldCB.Clear();
-        if(pVector)
-        {
+        if(pVector) {
             ::std::vector<String>::iterator  aIterator;
             for( aIterator = pVector->begin(); aIterator != pVector->end(); ++aIterator)
                 m_aFieldCB.InsertEntry(*aIterator);
-            if(sSelect.Len())
-                m_aFieldCB.SetText(sSelect);
         }            
+		m_aFieldCB.SetText(sSelect);
         m_aFieldCB.Enable(sal_True);
         m_aFieldFT.Enable(sal_True);
     }    
@@ -802,12 +862,9 @@ IMPL_LINK(SwCustomizeAddressBlockDialog,
         m_aFieldCB.Enable(sal_False);
         m_aFieldFT.Enable(sal_False);
     }            
-    //make a selection 
-    if(USER_DATA_NONE != nSelected)
-    {
-        pEdit->SelectCurrentItem();
-    }            
+
     UpdateImageButtons_Impl();
+	bOnEntry = false;
     return 0;
 }
 /*-- 25.06.2004 13:36:29---------------------------------------------------
@@ -818,18 +875,20 @@ IMPL_LINK(SwCustomizeAddressBlockDialog,
     //changing the field content changes the related members, too
     sal_Int32 nSelected = GetSelectedItem_Impl();
     String sContent = m_aFieldCB.GetText();
-    switch(nSelected)
-    {
-        case USER_DATA_SALUTATION : 
+    switch(nSelected) {
+        case USER_DATA_SALUTATION: 
             m_sCurrentSalutation = sContent; 
-        break;
-        case USER_DATA_PUNCTUATION : 
+			break;
+        case USER_DATA_PUNCTUATION: 
             m_sCurrentPunctuation = sContent;     
-        break;
-        case USER_DATA_TEXT : m_sCurrentText = sContent;  
-        break;
+			break;
+        case USER_DATA_TEXT:
+			m_sCurrentText = sContent;  
+			break;
     }
     UpdateImageButtons_Impl();
+    m_aPreviewWIN.SetAddress(GetAddress());
+	m_aDragED.Modify();
     return 0;
 }
 
@@ -855,6 +914,7 @@ void SwCustomizeAddressBlockDialog::SetA
 {
     m_aDragED.SetText( rAddress );
     UpdateImageButtons_Impl();
+	m_aDragED.Modify();
 }
 /*-- 28.04.2004 12:04:14---------------------------------------------------
 
@@ -882,6 +942,75 @@ void SwCustomizeAddressBlockDialog::SetA
     }            
     return sAddress;
 }
+/*-- 28.02.2005 11:03:35---------------------------------------------------
+
+  -----------------------------------------------------------------------*/
+void SwCustomizeAddressBlockDialog::MoveFocus( Window* pMember, bool bNext )   
+{
+    ::std::vector< Window* > aControls;
+    
+    aControls.push_back(&m_aAddressElementsLB);
+    aControls.push_back(&m_aInsertFieldIB);
+    aControls.push_back(&m_aRemoveFieldIB);
+    aControls.push_back(&m_aDragED);
+    aControls.push_back(&m_aUpIB);
+    aControls.push_back(&m_aLeftIB);
+    aControls.push_back(&m_aRightIB);
+    aControls.push_back(&m_aDownIB);
+    aControls.push_back(&m_aFieldCB);
+    aControls.push_back(&m_aOK);
+    aControls.push_back(&m_aCancel);
+    aControls.push_back(&m_aHelp); 
+
+    ::std::vector< Window* >::iterator aMemberIter = aControls.begin();
+    for( ; aMemberIter != aControls.end(); ++aMemberIter)
+    {
+        if(*aMemberIter == pMember)
+            break;
+    }
+    if( aMemberIter == aControls.end() )
+    {
+        DBG_ERROR( "Window not found?" )
+        return;
+    }
+    
+    if( bNext )
+    {
+        ::std::vector< Window* >::iterator aSearch = aMemberIter;
+        ++aSearch;
+        while( true )
+        {
+            if( aSearch == aControls.end())
+                aSearch = aControls.begin();
+            else if( (*aSearch)->IsEnabled() )
+            {
+                (*aSearch)->GrabFocus();
+                break;
+            }
+            else
+                ++aSearch;
+        }         
+    }
+    else
+    {
+        ::std::vector< Window* >::iterator aSearch = aMemberIter;
+        if(aSearch == aControls.begin())
+            aSearch = aControls.end();
+        while( true )
+        {
+            if(aSearch == aControls.begin())
+                aSearch = aControls.end();
+            else
+                --aSearch;
+            if( (*aSearch)->IsEnabled() )
+            {
+                (*aSearch)->GrabFocus();
+                break;
+            }
+        }         
+    }
+      
+}
 /*-- 13.04.2004 17:49:45---------------------------------------------------
 
   -----------------------------------------------------------------------*/
@@ -1336,12 +1465,15 @@ void  DDListBox::StartDrag( sal_Int8 nAc
 /*-- 26.05.2004 13:14:53---------------------------------------------------
 
   -----------------------------------------------------------------------*/
-AddressMultiLineEdit::AddressMultiLineEdit(Window* pParent, const ResId& rResId) :
-    MultiLineEdit(pParent, rResId)
+AddressMultiLineEdit::AddressMultiLineEdit(SwCustomizeAddressBlockDialog* pParent, const ResId& rResId) :
+    MultiLineEdit(pParent, rResId),
+    m_pParentDialog(pParent)
+    
 {
     GetTextView()->SupportProtectAttribute(sal_True);
     StartListening(*GetTextEngine());
-    DisableSelectionOnFocus();
+    //DisableSelectionOnFocus();
+	EnableFocusSelectionHide(FALSE);
 }
 /*-- 26.05.2004 13:14:53---------------------------------------------------
 
@@ -1368,11 +1500,22 @@ void    AddressMultiLineEdit::Notify( Sf
 long  AddressMultiLineEdit::PreNotify( NotifyEvent& rNEvt )
 {
     long nHandled = 0;
-    if( EVENT_KEYINPUT == rNEvt.GetType() &&
-         rNEvt.GetKeyEvent()->GetCharCode() )
+    if( EVENT_KEYINPUT == rNEvt.GetType()  && 
+        rNEvt.GetKeyEvent()->GetCharCode())
     {
-         nHandled = 1;
+        const KeyEvent* pKEvent = rNEvt.GetKeyEvent(); 
+        if('\t' == pKEvent->GetCharCode() && 
+            0 == (pKEvent->GetKeyCode().GetModifier() & (KEY_MOD1|KEY_MOD2)))
+        {
+            m_pParentDialog->MoveFocus(this, !pKEvent->GetKeyCode().IsShift());
+        }
+        nHandled = 1;
     }
+	else if(EVENT_MOUSEBUTTONDOWN == rNEvt.GetType()) {
+		const MouseEvent *pMEvt = rNEvt.GetMouseEvent();
+		if(pMEvt->GetClicks() >= 2)
+			nHandled = 1;
+	}
     if(!nHandled)
         nHandled = MultiLineEdit::PreNotify( rNEvt );
     return nHandled;
@@ -1410,6 +1553,17 @@ void AddressMultiLineEdit::SetText( cons
         }
             
     }
+    // add two empty paragraphs at the end
+    if(m_pParentDialog->m_eType == SwCustomizeAddressBlockDialog::ADDRESSBLOCK_NEW || 
+            m_pParentDialog->m_eType == SwCustomizeAddressBlockDialog::ADDRESSBLOCK_EDIT)
+    {
+        xub_StrLen nLastLen = pTextEngine->GetText(nParaCount - 1).Len(); 
+        if(nLastLen)
+        {
+            TextPaM aPaM(nParaCount ? nParaCount - 1 : 0, nLastLen);
+            pTextEngine->ReplaceText( TextSelection( aPaM ), String::CreateFromAscii("\n \n "));
+        }
+    }
 }
 /*-- 25.06.2004 09:10:43---------------------------------------------------
 
@@ -1417,7 +1571,14 @@ void AddressMultiLineEdit::SetText( cons
 void AddressMultiLineEdit::Modified()
 {
     //restore the attributes
+    ExtTextView* pTextView = GetTextView();
+    const TextSelection& rSelection = pTextView->GetSelection();
+    ULONG nPara = rSelection.GetStart().GetPara();
+    USHORT nStartIndex = rSelection.GetStart().GetIndex();
+    USHORT nEndIndex = rSelection.GetEnd().GetIndex();
     SetText( GetAddress() );
+	TextSelection aEntrySel(TextPaM(nPara, nStartIndex), TextPaM(nPara, nEndIndex));
+	pTextView->SetSelection(aEntrySel);
 }
 
 /*-- 25.06.2004 12:32:41---------------------------------------------------
@@ -1426,11 +1587,23 @@ void AddressMultiLineEdit::Modified()
   -----------------------------------------------------------------------*/
 void AddressMultiLineEdit::InsertNewEntry( const String& rStr )
 {
+	// insert new entry after current selected one.
     ExtTextView* pTextView = GetTextView();
     const TextSelection& rSelection = pTextView->GetSelection();
     ULONG nPara = rSelection.GetStart().GetPara();
-    USHORT nIndex = rSelection.GetStart().GetIndex();
+    USHORT nIndex = rSelection.GetEnd().GetIndex();
+    ExtTextEngine *pTextEngine = GetTextEngine();
+	const TextCharAttrib *pAttrib;
+    if(pAttrib = pTextEngine->FindCharAttrib( rSelection.GetStart(), TEXTATTR_PROTECTED ))
+		nIndex = pAttrib->GetEnd();
     InsertNewEntryAtPosition( rStr, nPara, nIndex );
+
+	// select the new entry
+    pAttrib = pTextEngine->FindCharAttrib(TextPaM(nPara, nIndex),TEXTATTR_PROTECTED);
+	TextSelection aEntrySel(TextPaM(nPara, nIndex), TextPaM(nPara, pAttrib->GetEnd()));
+	pTextView->SetSelection(aEntrySel);
+	Invalidate();
+	Modify();
 }
 
 void AddressMultiLineEdit::InsertNewEntryAtPosition( const String& rStr, ULONG nPara, USHORT nIndex )
@@ -1467,6 +1640,7 @@ void AddressMultiLineEdit::RemoveCurrent
         pTextEngine->ReplaceText(aEntrySel, String());
         //restore the attributes
         SetText( GetAddress() );
+		Modify();
     }    
 }
 /*-- 25.06.2004 12:32:41---------------------------------------------------
@@ -1535,6 +1709,14 @@ void AddressMultiLineEdit::MoveCurrentIt
             pTextEngine->ReplaceText( aTemp, String('\n'));
         }
         InsertNewEntryAtPosition( sCurrentItem, nPara, nIndex );
+
+		// select the new entry [#i40817]
+		const TextCharAttrib *pAttrib;
+		pAttrib = pTextEngine->FindCharAttrib(TextPaM(nPara, nIndex),TEXTATTR_PROTECTED);
+		aEntrySel = TextSelection(TextPaM(nPara, nIndex), TextPaM(nPara, pAttrib->GetEnd()));
+		pTextView->SetSelection(aEntrySel);
+		Invalidate();
+		Modify();
     }    
 }
 /*-- 25.06.2004 12:32:41---------------------------------------------------
Index: sw/source/ui/dbui/mmaddressblockpage.hrc
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmaddressblockpage.hrc,v
retrieving revision 1.2
retrieving revision 1.2.212.1
diff -u -p -u -p -r1.2 -r1.2.212.1
--- sw/source/ui/dbui/mmaddressblockpage.hrc	20 Sep 2004 13:14:30 -0000	1.2
+++ sw/source/ui/dbui/mmaddressblockpage.hrc	18 Jan 2005 15:41:29 -0000	1.2.212.1
@@ -116,6 +116,7 @@
 #define ST_INSERTSALUTATIONFIELD 65
 #define ST_REMOVESALUTATIONFIELD 66
 #define ST_DRAGSALUTATION       67
+#define ST_TITLE_EDIT			68
 
 
 #define FI_MATCHING             70
Index: sw/source/ui/dbui/mmaddressblockpage.hxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmaddressblockpage.hxx,v
retrieving revision 1.3
retrieving revision 1.3.84.3
diff -u -p -u -p -r1.3 -r1.3.84.3
--- sw/source/ui/dbui/mmaddressblockpage.hxx	16 Nov 2004 16:58:35 -0000	1.3
+++ sw/source/ui/dbui/mmaddressblockpage.hxx	28 Feb 2005 11:21:53 -0000	1.3.84.3
@@ -213,11 +213,12 @@ public:    
 
 class AddressMultiLineEdit : public MultiLineEdit, public SfxListener
 {
-    Link            m_aSelectionLink;
+    Link                            m_aSelectionLink;
+    SwCustomizeAddressBlockDialog*  m_pParentDialog;
 protected:
     long            PreNotify( NotifyEvent& rNEvt );
 public: 
-    AddressMultiLineEdit(Window* pParent, const ResId& rResId);
+    AddressMultiLineEdit(SwCustomizeAddressBlockDialog* pParent, const ResId& rResId);
     ~AddressMultiLineEdit();
 
     virtual void    Notify( SfxBroadcaster& rBC, const SfxHint& rHint );
@@ -243,13 +244,31 @@ public: 
     Dialog is used to create custom address blocks as well as 
     custom greeting lines
   -----------------------------------------------------------------------*/
+class SwRestrictedComboBox : public ComboBox
+{ 
+	String sForbiddenChars;
+
+protected:
+	virtual void KeyInput( const KeyEvent& );
+	virtual void		Modify();
+public: 
+    SwRestrictedComboBox(Window* pParent, const ResId& rResId):
+        ComboBox( pParent, rResId ){}
+        
+    ~SwRestrictedComboBox(); 
+    
+	void			SetForbiddenChars(const String& rSet){sForbiddenChars = rSet;}
+
+};
 class SwCustomizeAddressBlockDialog : public SfxModalDialog
 {
     friend class DDListBox;
+    friend class AddressMultiLineEdit;
 public:
     enum DialogType
     {
-        ADDRESSBLOCK,
+        ADDRESSBLOCK_NEW,
+        ADDRESSBLOCK_EDIT,
         GREETING_FEMALE,
         GREETING_MALE
     };            
@@ -268,7 +287,7 @@ private:    
     ImageButton             m_aDownIB;
 
     FixedText               m_aFieldFT;
-    ComboBox                m_aFieldCB;
+    SwRestrictedComboBox    m_aFieldCB;
 
     FixedInfo               m_aPreviewFI;
     SwAddressPreview        m_aPreviewWIN;
@@ -298,7 +317,8 @@ private:    
 
     bool            HasItem_Impl(sal_Int32 nUserData);
     sal_Int32       GetSelectedItem_Impl();
-    void            UpdateImageButtons_Impl();   
+    void            UpdateImageButtons_Impl();
+    void            MoveFocus( Window* pMember, bool bNext );   
 
 public:
     SwCustomizeAddressBlockDialog(Window* pParent, SwMailMergeConfigItem& rConfig, DialogType);
Index: sw/source/ui/dbui/mmaddressblockpage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmaddressblockpage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.6
diff -u -p -u -p -r1.2 -r1.2.212.6
--- sw/source/ui/dbui/mmaddressblockpage.src	20 Sep 2004 13:14:52 -0000	1.2
+++ sw/source/ui/dbui/mmaddressblockpage.src	28 Feb 2005 11:21:53 -0000	1.2.212.6
@@ -76,12 +76,12 @@
 TabPage DLG_MM_ADDRESSBLOCK_PAGE
 {
     HelpID = HID_MM_ADDRESSBLOCKPAGE;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Adressblock einfügen";
         Text [ en-US ] = "Insert address block";
@@ -89,7 +89,7 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
 
     FixedText FI_ADDRESSLIST
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 20 ) ;
         WordBreak = TRUE;
         Text [ de ] = "1. Wählen Sie, aus welcher Adressenliste die Adressdaten bezogen werden sollen. Die Daten der Adressenliste werden für den Adressblock benötigt." ;
@@ -97,7 +97,7 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
     };
     PushButton      PB_ADDRESSLIST
     {
-        Pos = MAP_APPFONT ( 12 , 43 ) ;
+        Pos = MAP_APPFONT ( 12 , 48 ) ;
         Size = MAP_APPFONT ( 100 , 14 ) ;
         Text [ de ] = "Adressenliste auswählen..." ;
         Text[ en-US ] = "Select A~ddress List...";
@@ -109,7 +109,7 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
     };
     FixedText   FI_CURRENTADDRESS
     {
-        Pos = MAP_APPFONT ( 12 , 60 ) ;
+        Pos = MAP_APPFONT ( 12 , 65 ) ;
         Size = MAP_APPFONT ( 242 , 8 ) ;
         Hide = TRUE;
         Text [ de ] = "Aktuelle Adressenliste: %1" ;
@@ -117,26 +117,27 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
     };
     FixedText       FI_SETTINGS   
     {
-        Pos = MAP_APPFONT ( 6 , 72 ) ;
+        Pos = MAP_APPFONT ( 6 , 77 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "2. Wählen Sie den Adressblock, der in das Dokument eingefügt werden soll." ;
         Text[ en-US ] = "2. Select the address block you want to inserted in the document";
     };
     CheckBox        CB_ADDRESS  
     {
-        Pos = MAP_APPFONT ( 12 , 84 ) ;
+        Pos = MAP_APPFONT ( 12 , 89 ) ;
         Size = MAP_APPFONT ( 242 , 10 ) ;
         Text [ de ] = "Dieses Dokument soll einen Adressblock enthalten" ;
         Text[ en-US ] = "~This document shall contain an address block";
     };
     Window          WIN_SETTINGS  
     {
-        Pos = MAP_APPFONT ( 12 , 98 ) ;
+        Border = TRUE;
+        Pos = MAP_APPFONT ( 12 , 103 ) ;
         Size = MAP_APPFONT ( 176 , 45 ) ;
     };
     PushButton      PB_SETTINGS   
     {
-        Pos = MAP_APPFONT ( 194 , 98 ) ;
+        Pos = MAP_APPFONT ( 194 , 103 ) ;
         Size = MAP_APPFONT ( 60 , 14 ) ;
         Group = FALSE;
         Text [ de ] = "Mehr..." ;
@@ -144,32 +145,33 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
     };
     FixedText       FI_PREVIEW    
     {
-        Pos = MAP_APPFONT ( 6 , 146 ) ;
+        Pos = MAP_APPFONT ( 6 , 151 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "3. Überprüfen Sie, ob alle Adressdaten verfügbar sind." ;
         Text[ en-US ] = "3. Check if the address data matches correctly.";
     };
     Window          WIN_PREVIEW   
     {
-        Pos = MAP_APPFONT ( 12 , 157 ) ;
+        Border = TRUE;
+        Pos = MAP_APPFONT ( 12 , 162 ) ;
         Size = MAP_APPFONT ( 176 , 46 ) ;
     };
     PushButton      PB_ASSIGN     
     {
-        Pos = MAP_APPFONT ( 194 , 157 ) ;
+        Pos = MAP_APPFONT ( 194 , 162 ) ;
         Size = MAP_APPFONT ( 60 , 14 ) ;
         Text [ de ] = "Felder zuordnen..." ;
         Text[ en-US ] = "Match ~Fields...";
     };
     FixedText       FI_DOCINDEX   
     {
-        Pos = MAP_APPFONT ( 111 , 205 ) ;
+        Pos = MAP_APPFONT ( 111 , 210 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
         Right = TRUE;
     };
     ImageButton     IB_PREVSET    
     {
-        Pos = MAP_APPFONT ( 167 , 204 ) ;
+        Pos = MAP_APPFONT ( 167 , 209 ) ;
         Size = MAP_APPFONT ( 10 , 10 ) ;
         SYMBOL = IMAGEBUTTON_PREV;
         QuickHelpText [ de ] = "Adressblock des vorigen Dokuments ansehen" ;
@@ -177,7 +179,7 @@ TabPage DLG_MM_ADDRESSBLOCK_PAGE
     };
     ImageButton     IB_NEXTSET    
     {
-        Pos = MAP_APPFONT ( 178 , 204 ) ;
+        Pos = MAP_APPFONT ( 178 , 209 ) ;
         Size = MAP_APPFONT ( 10 , 10 ) ;
         SYMBOL = IMAGEBUTTON_NEXT ;
         QuickHelpText [ de ] = "Adressblock des nächsten Dokuments ansehen" ;
@@ -201,7 +203,7 @@ ModalDialog DLG_MM_SELECTADDRESSBLOCK
     Size = MAP_APPFONT ( 260 , 219 ) ;
     Moveable = TRUE ;
     
-    Text [ de ] = "Addressblock wählen";
+    Text [ de ] = "Adressblock wählen";
     Text [ en-US ] = "Select Address Block";
 
     FixedText       FT_SELECT
@@ -213,6 +215,7 @@ ModalDialog DLG_MM_SELECTADDRESSBLOCK
     };
     Window WIN_PREVIEW
     {
+        Border = TRUE;
         Pos = MAP_APPFONT ( 6 , 14 ) ;
         Size = MAP_APPFONT ( 192 , 100 ) ;
         DialogControl = TRUE;
@@ -277,8 +280,8 @@ ModalDialog DLG_MM_SELECTADDRESSBLOCK
 
     FixedLine FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 6 , 188 ) ;
-        Size = MAP_APPFONT ( 248 , 8 ) ;
+        Pos = MAP_APPFONT ( 0 , 188 ) ;
+        Size = MAP_APPFONT ( 260 , 8 ) ;
     };
 
     OKButton        PB_OK
@@ -311,6 +314,12 @@ ModalDialog DLG_MM_CUSTOMIZEADDRESSBLOCK
     
     Text [ de ] = "Neuer Adressblock";
     Text [ en-US ] = "New Address Block";
+
+    String ST_TITLE_EDIT
+    {
+		Text [ de ] = "Adressblock bearbeiten";
+		Text [ en-US ] = "Edit Address Block";
+    };
     
     String ST_TITLE_MALE  
     {
@@ -338,12 +347,12 @@ ModalDialog DLG_MM_CUSTOMIZEADDRESSBLOCK
     {
         Pos = MAP_APPFONT ( 6 , 14 ) ;
         Size = MAP_APPFONT ( 68 , 121 ) ;
+        TabStop = TRUE;
         Border = TRUE;
-        DialogControl = TRUE;
     };
     ImageButton     IB_INSERTFIELD
     {
-        Pos = MAP_APPFONT ( 80 , 59 ) ;
+        Pos = MAP_APPFONT ( 80 , 29 ) ;
         Size = MAP_APPFONT ( 14 , 14 ) ;
         Symbol = IMAGEBUTTON_ARROW_RIGHT;
         QuickHelpText [ de ] = "In Adresse übernehmen" ;
@@ -356,7 +365,7 @@ ModalDialog DLG_MM_CUSTOMIZEADDRESSBLOCK
     };
     ImageButton     IB_REMOVEFIELD
     {
-        Pos = MAP_APPFONT ( 80 , 76 ) ;
+        Pos = MAP_APPFONT ( 80 , 46 ) ;
         Size = MAP_APPFONT ( 14 , 14 ) ;
         Symbol = IMAGEBUTTON_ARROW_LEFT;
         QuickHelpText [ de ] = "Aus Adresse entfernen" ;
@@ -448,8 +457,8 @@ ModalDialog DLG_MM_CUSTOMIZEADDRESSBLOCK
     };
     FixedLine       FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 6 , 145 ) ;
-        Size = MAP_APPFONT ( 308 , 8 ) ;
+        Pos = MAP_APPFONT ( 0 , 145 ) ;
+        Size = MAP_APPFONT ( 320 , 8 ) ;
     };
     OKButton        PB_OK
     {
@@ -547,7 +556,6 @@ ModalDialog DLG_MM_ASSIGNFIELDS
     Text [ de ] = "Felder zuordnen";
     Text [ en-US ] = "Match Fields";
     
-
     FixedText FI_MATCHING
     {
         Pos = MAP_APPFONT ( 6 , 3 ) ;
@@ -614,11 +622,12 @@ ModalDialog DLG_MM_ASSIGNFIELDS
     {
         Pos = MAP_APPFONT ( 6 , 163 ) ;
         Size = MAP_APPFONT ( 248 , 45 ) ;
+        Border = TRUE;
     };
     FixedLine       FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 6 , 214 ) ;
-        Size = MAP_APPFONT ( 248 , 8 ) ;
+        Pos = MAP_APPFONT ( 0 , 214 ) ;
+        Size = MAP_APPFONT ( 260 , 8 ) ;
     };
     OKButton        PB_OK
     {
Index: sw/source/ui/dbui/mmdocselectpage.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmdocselectpage.cxx,v
retrieving revision 1.4
retrieving revision 1.4.212.1
diff -u -p -u -p -r1.4 -r1.4.212.1
--- sw/source/ui/dbui/mmdocselectpage.cxx	29 Sep 2004 09:31:12 -0000	1.4
+++ sw/source/ui/dbui/mmdocselectpage.cxx	17 Jan 2005 15:10:03 -0000	1.4.212.1
@@ -237,10 +237,12 @@ IMPL_LINK(SwMailMergeDocSelectPage, File
             {
                 const String sWild = ((WildCard&)pFlt->GetWildcard()).GetWildCard();
                 xFltMgr->appendFilter( pFlt->GetUIName(), sWild );
+
+				// #i40125
+				if(pFlt->GetFilterFlags() & SFX_FILTER_DEFAULT)
+					xFltMgr->setCurrentFilter( pFlt->GetUIName() ) ;
             }
 
-            if( pFlt->GetUserData().EqualsAscii( GetFILTER_XML() ))
-                xFltMgr->setCurrentFilter( pFlt->GetUIName() ) ;
 
             pFlt = aIter.Next();
         }
Index: sw/source/ui/dbui/mmdocselectpage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmdocselectpage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.2
diff -u -p -u -p -r1.2 -r1.2.212.2
--- sw/source/ui/dbui/mmdocselectpage.src	20 Sep 2004 13:15:45 -0000	1.2
+++ sw/source/ui/dbui/mmdocselectpage.src	4 Feb 2005 15:01:24 -0000	1.2.212.2
@@ -64,75 +64,75 @@
 TabPage DLG_MM_DOCSELECT_PAGE
 {
     HelpID = HID_MM_DOCSELECTPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Wählen Sie das Ausgangsdokument des Serienbriefes";
         Text [ en-US ] = "Select starting document for the mail merge";
     };
     FixedText   FT_HOWTO
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Wählen Sie auf welchem Dokument der Serienbrief basieren soll";
         Text [ en-US ] = "Select the document upon which to base the mail merge document";
     };
     RadioButton RB_CURRENTDOC
     {
-        Pos = MAP_APPFONT ( 12 , 32 ) ;
+        Pos = MAP_APPFONT ( 12 , 48 ) ;
         Size = MAP_APPFONT ( 190 , 10 ) ;
         Text [ de ] = "Aktuelles Dokument verwenden" ;
         Text[ en-US ] = "Use the current ~document";
     };
     RadioButton RB_NEWDOC
     {
-        Pos = MAP_APPFONT ( 12 , 48 ) ;
+        Pos = MAP_APPFONT ( 12 , 66 ) ;
         Size = MAP_APPFONT ( 190 , 10 ) ;
         Text [ de ] = "Neues Dokument erstellen" ;
         Text[ en-US ] = "Create a ne~w document";
     };
     RadioButton RB_LOADDOC
     {
-        Pos = MAP_APPFONT ( 12 ,  64) ;
+        Pos = MAP_APPFONT ( 12 ,  84) ;
         Size = MAP_APPFONT ( 190 , 10 ) ;
         Text [ de ] = "Bestehendes Dokument verwenden";
         Text[ en-US ] = "Start from ~existing document";
     };
     PushButton  PB_LOADDOC
     {
-        Pos = MAP_APPFONT ( 204 ,  62) ;
+        Pos = MAP_APPFONT ( 204 ,  80) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Durchsuchen..." ;
         Text[ en-US ] = "B~rowse...";
     };
     RadioButton RB_LOADTEMPLATE
     {
-        Pos = MAP_APPFONT ( 12 , 80 ) ;
+        Pos = MAP_APPFONT ( 12 , 103 ) ;
         Size = MAP_APPFONT ( 190 , 10 ) ;
         Text [ de ] = "Vorlage verwenden" ;
         Text[ en-US ] = "Start from a t~emplate";
     };
     PushButton  PB_BROWSETEMPLATE
     {
-        Pos = MAP_APPFONT ( 204 , 78 ) ;
+        Pos = MAP_APPFONT ( 204 , 99 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Durchsuchen..." ;
         Text[ en-US ] = "B~rowse...";
     };
     RadioButton RB_RECENTDOC
     {
-        Pos = MAP_APPFONT ( 12 ,  96) ;
+        Pos = MAP_APPFONT ( 12 ,  120) ;
         Size = MAP_APPFONT ( 190 , 10 ) ;
         Text [ de ] = "Zuletzt gespeicherte Ausgangsdokumente" ;
         Text[ en-US ] = "Start fro~m a recently saved starting document";
     };
     ListBox     LB_RECENTDOC
     {
-        Pos = MAP_APPFONT ( 18 , 109 ) ;
+        Pos = MAP_APPFONT ( 20 , 134 ) ;
         Size = MAP_APPFONT ( 180 , 50 ) ;
         DropDown = TRUE;
         Border = TRUE;
Index: sw/source/ui/dbui/mmgreetingspage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmgreetingspage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.4
diff -u -p -u -p -r1.2 -r1.2.212.4
--- sw/source/ui/dbui/mmgreetingspage.src	20 Sep 2004 13:16:30 -0000	1.2
+++ sw/source/ui/dbui/mmgreetingspage.src	25 Feb 2005 13:22:07 -0000	1.2.212.4
@@ -66,7 +66,7 @@
     CheckBox CB_PERSONALIZED                                                    \
     {                                                                               \
         Pos = MAP_APPFONT ( 12 + LEFT_OFFSET , 17 + TOP_OFFSET ) ;                  \
-        Size = MAP_APPFONT ( 236 , 10 ) ;                                           \
+        Size = MAP_APPFONT ( 226 , 10 ) ;                                           \
         Text [ de ] = "Personalisierte Briefanrede einfügen" ;                              \
         Text[ en-US ] = "Insert personalized salutation";                    \
     };                                                                              \
@@ -114,21 +114,21 @@
     };                                                                              \
     FixedText   FI_FEMALE                                                       \
     {                                                                               \
-        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 63 + TOP_OFFSET ) ;                                             \
-        Size = MAP_APPFONT ( 230 , 8 ) ;                                            \
+        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 67 + TOP_OFFSET ) ;                                             \
+        Size = MAP_APPFONT ( 225 , 8 ) ;                                            \
         Text [ de ] = "Adresslistenwert für einen weiblichen Empfänger" ;                     \
         Text[ en-US ] = "Address list field indicating a female recipient";     \
     };                                                                              \
     FixedText   FT_FEMALECOLUMN                                                     \
     {                                                                               \
-        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 76 + TOP_OFFSET ) ;                  \
+        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 80 + TOP_OFFSET ) ;                  \
         Size = MAP_APPFONT ( 50 , 8 ) ;                                            \
         Text [ de ] = "Spaltentitel" ;                     \
         Text[ en-US ] = "Field name";           \
     };                                                                              \
     ListBox LB_FEMALECOLUMN                                                         \
     {                                                                               \
-        Pos = MAP_APPFONT ( 71 + LEFT_OFFSET , 74 + TOP_OFFSET ) ;                  \
+        Pos = MAP_APPFONT ( 71 + LEFT_OFFSET , 78 + TOP_OFFSET ) ;                  \
         Size = MAP_APPFONT ( 121 , 50 ) ;                                           \
         DropDown = TRUE;                                                            \
         Border = TRUE;                                                              \
@@ -143,28 +143,28 @@
     };                                                                              \
     FixedText   FT_FEMALEFIELD                                                       \
     {                                                                               \
-        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 91 + TOP_OFFSET ) ;                  \
+        Pos = MAP_APPFONT ( 18 + LEFT_OFFSET , 95 + TOP_OFFSET ) ;                  \
         Size = MAP_APPFONT ( 50 , 8 ) ;                                            \
         Text [ de ] = "Feldinhalt" ;                     \
         Text[ en-US ] = "Field value";           \
     };                                                                              \
     ComboBox CB_FEMALEFIELD                                                         \
     {                                                                               \
-        Pos = MAP_APPFONT ( 71 + LEFT_OFFSET , 89 + TOP_OFFSET ) ;                                             \
+        Pos = MAP_APPFONT ( 71 + LEFT_OFFSET , 93 + TOP_OFFSET ) ;                                             \
         Size = MAP_APPFONT ( 121 , 50 ) ;                                           \
         DropDown = TRUE;                                                            \
         Border = TRUE;                                                              \
     };                                                                              \
     FixedText   FT_NEUTRAL                                                       \
     {                                                                               \
-        Pos = MAP_APPFONT ( 12 + LEFT_OFFSET , 105 + TOP_OFFSET ) ;                                             \
+        Pos = MAP_APPFONT ( 12 + LEFT_OFFSET , 113 + TOP_OFFSET ) ;                                             \
         Size = MAP_APPFONT ( 180 , 8 ) ;                                            \
         Text [ de ] = "Allgemeine Briefanrede";                     \
         Text[ en-US ] = "General salutation";           \
     };                                                                              \
     ComboBox     CB_NEUTRAL                                                         \
     {                                                                               \
-        Pos = MAP_APPFONT ( 12 + LEFT_OFFSET , 116 + TOP_OFFSET ) ;                 \
+        Pos = MAP_APPFONT ( 12 + LEFT_OFFSET , 124 + TOP_OFFSET ) ;                 \
         Size = MAP_APPFONT ( 180 , 50 ) ;                                           \
         DropDown = TRUE;                                                            \
         Border = TRUE;                                                              \
@@ -174,22 +174,22 @@
 TabPage DLG_MM_GREETINGS_PAGE
 {
     HelpID = HID_MM_GREETINGSPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Briefanrede erstellen";
         Text [ en-US ] = "Create a salutation";
     };
-    #define TOP_OFFSET 20
+    #define TOP_OFFSET 24
     #define LEFT_OFFSET 6
 
     CheckBox    CB_GREETINGLINE                                                     \
     {                                                                               \
-        Pos = MAP_APPFONT ( 6 + LEFT_OFFSET , 3 + TOP_OFFSET ) ;                    \
+        Pos = MAP_APPFONT ( 12 , 27 ) ;                    \
         Size = MAP_APPFONT ( 242 , 10 ) ;                                           \
         Text [ de ] = "Eine Briefanrede in das Dokument einfügen" ;                        \
         Text[ en-US ] = "This document should contain a salutation";         \
@@ -199,32 +199,33 @@ TabPage DLG_MM_GREETINGS_PAGE
     #undef LEFT_OFFSET
     FixedText       FI_PREVIEW                                                      
     {                                                                               
-        Pos = MAP_APPFONT ( 12 , 160 ) ;
+        Pos = MAP_APPFONT ( 12 , 168 ) ;
         Size = MAP_APPFONT ( 242 , 8 ) ;                                            
         Text [ de ] = "Vorschau" ;                 
         Text[ en-US ] = "Preview";           
     };                                                                              
     Window          WIN_PREVIEW                                                     
     {                                                                               
-        Pos = MAP_APPFONT ( 12 , 171 );
+        Pos = MAP_APPFONT ( 12 , 179 );
         Size = MAP_APPFONT ( 186 , 21 ) ;                                           
+        Border = TRUE;
     };                                                                              
     PushButton      PB_ASSIGN                                                       
     {                                                                               
-        Pos = MAP_APPFONT ( 204 , 171 ) ;
+        Pos = MAP_APPFONT ( 204 , 179 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;                                            
         Text [ de ] = "Felder wählen..." ;                                                 
         Text[ en-US ] = "~Match fields...";                                     
     };                                                                              
     FixedText       FI_DOCINDEX   
     {
-        Pos = MAP_APPFONT ( 121 , 197 ) ;
+        Pos = MAP_APPFONT ( 121 , 206 ) ;
         Size = MAP_APPFONT (  50, 8 ) ;
         Right = TRUE;
     };
     ImageButton     IB_PREVSET    
     {
-        Pos = MAP_APPFONT ( 177 , 195 ) ;
+        Pos = MAP_APPFONT ( 177 , 204 ) ;
         Size = MAP_APPFONT ( 10 , 10 ) ;
         SYMBOL = IMAGEBUTTON_PREV;
         QuickHelpText [ de ] = "Vorige Briefanrede ansehen" ;
@@ -232,7 +233,7 @@ TabPage DLG_MM_GREETINGS_PAGE
     };
     ImageButton     IB_NEXTSET    
     {
-        Pos = MAP_APPFONT ( 188 , 195 ) ;
+        Pos = MAP_APPFONT ( 188 , 204 ) ;
         Size = MAP_APPFONT ( 10 , 10 ) ;
         SYMBOL = IMAGEBUTTON_NEXT ;
         QuickHelpText [ de ] = "Nächste Briefanrede ansehen" ;
@@ -248,7 +249,7 @@ TabPage DLG_MM_GREETINGS_PAGE
 ModalDialog DLG_MM_MAILBODY
 {
     HelpID = HID_MM_MAILBODY;
-    Size = MAP_APPFONT ( 254 , 225 ) ;
+    Size = MAP_APPFONT ( 254 , 238 ) ;
     OutputSize = TRUE ;
     SVLook = TRUE ;
     Moveable = TRUE ;
@@ -267,14 +268,14 @@ ModalDialog DLG_MM_MAILBODY
     GREETINGS_BODY
     FixedText           FT_BODY     
     {
-        Pos = MAP_APPFONT ( 12 , 132 ) ;
+        Pos = MAP_APPFONT ( 12 , 140 ) ;
         Size = MAP_APPFONT ( 174 , 8 ) ;
         Text [ de ] = "Schreiben Sie Ihre Nachricht hier" ;
         Text[ en-US ] = "Write your message here";
     };
     MultiLineEdit MLE_BODY    
     {
-        Pos = MAP_APPFONT ( 12,   143 ) ;
+        Pos = MAP_APPFONT ( 12,   151 ) ;
         Size = MAP_APPFONT ( 180 , 50 ) ;
         Border = TRUE;
         TabStop = TRUE ;
@@ -285,22 +286,22 @@ ModalDialog DLG_MM_MAILBODY
     };
     FixedLine           FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 0 , 199 ) ;
+        Pos = MAP_APPFONT ( 0 , 207 ) ;
         Size = MAP_APPFONT ( 254 , 8 ) ;
     };
     OKButton            PB_OK       
     {
-        Pos = MAP_APPFONT ( 89, 205 ) ;
+        Pos = MAP_APPFONT ( 89, 218 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
     };
     CancelButton        PB_CANCEL   
     {
-        Pos = MAP_APPFONT ( 142 , 205 ) ;
+        Pos = MAP_APPFONT ( 142 , 218 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
     };
     HelpButton          PB_HELP     
     {
-        Pos = MAP_APPFONT ( 198 , 205 ) ;
+        Pos = MAP_APPFONT ( 198 , 218 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
     };
 };
Index: sw/source/ui/dbui/mmlayoutpage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmlayoutpage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.2
diff -u -p -u -p -r1.2 -r1.2.212.2
--- sw/source/ui/dbui/mmlayoutpage.src	20 Sep 2004 13:17:15 -0000	1.2
+++ sw/source/ui/dbui/mmlayoutpage.src	4 Feb 2005 15:01:24 -0000	1.2.212.2
@@ -65,40 +65,40 @@
 TabPage DLG_MM_LAYOUT_PAGE
 {
     HelpID = HID_MM_LAYOUT_PAGE;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Layout des Adressblocks und der Briefanrede anpassen" ;
         Text[ en-US ] = "Adjust layout of address block and salutation";
     };
     FixedLine       FL_POSITION
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 118 , 8 ) ;
         Text [ de ] = "Adressblock-Position" ;
         Text[ en-US ] = "Address block position";
     };
     CheckBox CB_ALIGN 
     {
-        Pos = MAP_APPFONT ( 6 , 32 ) ;
+        Pos = MAP_APPFONT ( 6 , 40 ) ;
         Size = MAP_APPFONT ( 118 , 10 ) ;
         Text [ de ] = "Am Text ausrichten" ;
         Text[ en-US ] = "Align to text body";
     };
     FixedText       FT_LEFT
     {
-        Pos = MAP_APPFONT ( 12 , 46 ) ;
+        Pos = MAP_APPFONT ( 15 , 54 ) ;
         Size = MAP_APPFONT ( 63 , 8 ) ;
         Text [ de ] = "Von links" ;
         Text[ en-US ] = "From ~left";
     };
     MetricField     MF_LEFT
     {
-        Pos = MAP_APPFONT ( 78 , 44 ) ;
+        Pos = MAP_APPFONT ( 78 , 52 ) ;
         Size = MAP_APPFONT ( 40 , 12 ) ;
         Border = TRUE ;
         Left = TRUE ;
@@ -115,14 +115,14 @@ TabPage DLG_MM_LAYOUT_PAGE
     };
     FixedText       FT_TOP
     {
-        Pos = MAP_APPFONT ( 12 , 61 ) ;
+        Pos = MAP_APPFONT ( 15 , 69 ) ;
         Size = MAP_APPFONT ( 62 , 8 ) ;
         Text [ de ] = "Von oben" ;
         Text[ en-US ] = "~From top";
     };
     MetricField     MF_TOP
     {
-        Pos = MAP_APPFONT ( 78 , 59 ) ;
+        Pos = MAP_APPFONT ( 78 , 67 ) ;
         Size = MAP_APPFONT ( 40 , 12 ) ;
         Border = TRUE ;
         Left = TRUE ;
@@ -139,35 +139,35 @@ TabPage DLG_MM_LAYOUT_PAGE
     };
     FixedLine       FL_GREETINGLINE
     {
-        Pos = MAP_APPFONT ( 6 , 77 ) ;
+        Pos = MAP_APPFONT ( 6 , 85 ) ;
         Size = MAP_APPFONT ( 118 , 8 ) ;
         Text [ de ] = "Briefanrede-Position" ;
         Text[ en-US ] = "Salutation position";
     };
     FixedText       FT_UP
     {
-        Pos = MAP_APPFONT ( 12 , 90 ) ;
+        Pos = MAP_APPFONT ( 15 , 98 ) ;
         Size = MAP_APPFONT ( 45 , 8 ) ;
         Text [ de ] = "Nach" ;
         Text[ en-US ] = "Move";
     };
     PushButton      MF_UP
     {
-        Pos = MAP_APPFONT ( 68 , 88 ) ;
+        Pos = MAP_APPFONT ( 68 , 96 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Oben" ;
         Text[ en-US ] = "~Up";
     };
     FixedText       FT_DOWN
     {
-        Pos = MAP_APPFONT ( 12 , 107 ) ;
+        Pos = MAP_APPFONT ( 15 , 115 ) ;
         Size = MAP_APPFONT ( 45 , 8 ) ;
         Text [ de ] = "Nach" ;
         Text[ en-US ] = "Move";
     };
     PushButton      PB_DOWN
     {
-        Pos = MAP_APPFONT ( 68 , 105 ) ;
+        Pos = MAP_APPFONT ( 68 , 113 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Unten" ;
         Text[ en-US ] = "~Down";
Index: sw/source/ui/dbui/mmmergepage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmmergepage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.2
diff -u -p -u -p -r1.2 -r1.2.212.2
--- sw/source/ui/dbui/mmmergepage.src	20 Sep 2004 13:17:59 -0000	1.2
+++ sw/source/ui/dbui/mmmergepage.src	4 Feb 2005 15:01:24 -0000	1.2.212.2
@@ -65,19 +65,19 @@
 TabPage DLG_MM_MERGE_PAGE
 {
     HelpID = HID_MM_MERGEPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Personalisieren Sie die Serienbrief-Dokumente";
         Text [ en-US ] = "Personalize the mail merge documents";
     };
     FixedText  FI_EDIT
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 28 ) ;
         WordBreak = TRUE;
         Text [ de ] = "Sie können jetzt die Dokumente personalisieren. Ein Klick auf die Schaltfläche '%1' schließt vorübergehend den Assistenten. Durch Klicken der 'Zurück zum Seriendruck-Assistenten' Schaltfläche - sichtbar in einem kleinen Fenster - gelangen Sie zurück zum Assistenten.";
@@ -85,55 +85,55 @@ TabPage DLG_MM_MERGE_PAGE
     };
     PushButton PB_EDIT
     {
-        Pos = MAP_APPFONT ( 6 , 52 ) ;
+        Pos = MAP_APPFONT ( 70 , 67 ) ;
         Size = MAP_APPFONT ( 120 , 14 ) ;
         Text [ de ] = "Individuelles Dokument bearbeiten...";
         Text [ en-US ] = "~Edit individual document...";
     };
     FixedLine  FL_FIND
     {
-        Pos = MAP_APPFONT ( 6 , 72 ) ;
+        Pos = MAP_APPFONT ( 6 , 102 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Suche";
         Text [ en-US ] = "~Find";
     };
     FixedText  FT_FIND
     {
-        Pos = MAP_APPFONT ( 6 , 86 ) ;
+        Pos = MAP_APPFONT ( 16 ,116 ) ;
         Size = MAP_APPFONT ( 45 , 8 ) ;
         Text [ de ] = "Suchen ~nach:";
         Text [ en-US ] = "~Search for:";
     };
     Edit       ED_FIND
     {
-        Pos = MAP_APPFONT ( 55 , 84 ) ;
+        Pos = MAP_APPFONT ( 55 ,114 ) ;
         Size = MAP_APPFONT ( 140 , 12 ) ;
         Border = TRUE;
     };
     PushButton PB_FIND
     {
-        Pos = MAP_APPFONT ( 198 , 83 ) ;
+        Pos = MAP_APPFONT ( 198 ,113 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "~Suchen...";
         Text [ en-US ] = "~Find...";
     };
     CheckBox   CB_WHOLEWORDS
     {
-        Pos = MAP_APPFONT ( 55 , 101 ) ;
+        Pos = MAP_APPFONT ( 55 , 131 ) ;
         Size = MAP_APPFONT ( 180 , 10 ) ;
         Text [ de ] = "Nur ganzes ~Wort suchen";
         Text [ en-US ] = "Whole wor~ds only";
     };
     CheckBox   CB_BACKWARDS
     {
-        Pos = MAP_APPFONT ( 55 , 114 ) ;
+        Pos = MAP_APPFONT ( 55 , 144 ) ;
         Size = MAP_APPFONT ( 180 , 10 ) ;
         Text [ de ] = "Nach ~oben";
         Text [ en-US ] = "Back~wards";
     };
     CheckBox   CB_MATCHCASE
     {
-        Pos = MAP_APPFONT ( 55 , 127 ) ;
+        Pos = MAP_APPFONT ( 55 , 157 ) ;
         Size = MAP_APPFONT ( 180 , 10 ) ;
         Text [ de ] = "~Groß-/Kleinschreibung";
         Text [ en-US ] = "Ma~tch case";
Index: sw/source/ui/dbui/mmoutputpage.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmoutputpage.cxx,v
retrieving revision 1.5
retrieving revision 1.5.14.2
diff -u -p -u -p -r1.5 -r1.5.14.2
--- sw/source/ui/dbui/mmoutputpage.cxx	11 Jan 2005 12:39:56 -0000	1.5
+++ sw/source/ui/dbui/mmoutputpage.cxx	28 Feb 2005 14:32:40 -0000	1.5.14.2
@@ -190,7 +190,7 @@ String lcl_GetExtensionForDocType(ULONG 
     String sExtension;
     switch( nDocType )
     {        
-        case MM_DOCTYPE_OOO : sExtension = String::CreateFromAscii( "oxt" ); break;
+        case MM_DOCTYPE_OOO : sExtension = String::CreateFromAscii( "odt" ); break;
         case MM_DOCTYPE_PDF : sExtension = String::CreateFromAscii( "pdf" ); break;
         case MM_DOCTYPE_WORD: sExtension = String::CreateFromAscii( "doc" ); break;
         case MM_DOCTYPE_HTML: sExtension = String::CreateFromAscii( "html" ); break;
@@ -1227,7 +1227,7 @@ IMPL_LINK(SwMailMergeOutputPage, SendDoc
         ::rtl::OUString sEMail = lcl_GetColumnValueOf(sEMailColumn, xColAccess);
         SwMailDescriptor aDesc;
         aDesc.sEMail = sEMail;
-        String sBody;
+        rtl::OUString sBody;
         if(bAsBody)
         {
             {
@@ -1245,8 +1245,8 @@ IMPL_LINK(SwMailMergeOutputPage, SendDoc
                 sal_Bool bDone = pInStream->ReadLine( sLine );
                 while ( bDone )
                 {
-                    sBody += String(sLine, eEncoding);
-                    sBody += '\n';
+                    sBody += rtl::OUString(String(sLine, eEncoding));
+                    sBody += rtl::OUString('\n');
                     bDone = pInStream->ReadLine( sLine );
                 }
             }
@@ -1296,7 +1296,9 @@ IMPL_LINK(SwMailMergeOutputPage, SendDoc
 
                 }    
                 sGreeting += '\n';
-                sBody.Insert(sGreeting, 0);
+                ::rtl::OUString sTemp( sGreeting );
+                sTemp += sBody;
+                sBody = sTemp;
             }
         }
         aDesc.sBodyContent = sBody;
Index: sw/source/ui/dbui/mmoutputpage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmoutputpage.src,v
retrieving revision 1.3
retrieving revision 1.3.54.1
diff -u -p -u -p -r1.3 -r1.3.54.1
--- sw/source/ui/dbui/mmoutputpage.src	9 Dec 2004 16:41:18 -0000	1.3
+++ sw/source/ui/dbui/mmoutputpage.src	14 Jan 2005 16:34:19 -0000	1.3.54.1
@@ -65,88 +65,88 @@
 TabPage DLG_MM_OUTPUT_PAGE
 {
     HelpID = HID_MM_OUTPUTPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Speichern, drucken oder versenden Sie die Serienbriefe" ;
         Text[ en-US ] = "Save, print or send the document";
     };
     FixedText FI_OPTIONS
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Wählen Sie eine der Optionen:" ;
         Text[ en-US ] = "Select one of the options below:";
     };
     RadioButton RB_SAVESTARTDOC
     {
-        Pos = MAP_APPFONT ( 12 , 32 ) ;
+        Pos = MAP_APPFONT ( 45 , 40 ) ;
         Size = MAP_APPFONT ( 248 , 10 ) ;
         Text [ de ] = "Ausgangsdokument speichern" ;
         Text[ en-US ] = "~Save starting document";
     };
     RadioButton RB_SAVEMERGEDDOC
     {
-        Pos = MAP_APPFONT ( 12 , 45 ) ;
+        Pos = MAP_APPFONT ( 45 , 53 ) ;
         Size = MAP_APPFONT ( 240 , 10 ) ;
         Text [ de ] = "S~erienbriefdokument speichern" ;
         Text[ en-US ] = "Save ~merged document" ;
     };
     RadioButton RB_PRINT
     {
-        Pos = MAP_APPFONT ( 12 , 58 ) ;
+        Pos = MAP_APPFONT ( 45 , 66 ) ;
         Size = MAP_APPFONT ( 240 , 10 ) ;
         Text [ de ] = "Serienbriefdokument ~drucken" ;
         Text[ en-US ] = "~Print merged document";
     };
     RadioButton RB_SENDMAIL
     {
-        Pos = MAP_APPFONT ( 12 , 71 ) ;
+        Pos = MAP_APPFONT ( 45 , 79 ) ;
         Size = MAP_APPFONT ( 240 , 10 ) ;
         Text [ de ] = "Serienbriefdokument als E-Mail ~versenden" ;
         Text[ en-US ] = "Send merged document as ~E-Mail";
     };
     FixedLine   FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 6 , 87 ) ;
+        Pos = MAP_APPFONT ( 6 , 95 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
     };
     PushButton  PB_SAVESTARTDOC
     {
-        Pos = MAP_APPFONT ( 55 , 100 ) ;
+        Pos = MAP_APPFONT ( 55 , 108 ) ;
         Size = MAP_APPFONT ( 100 , 14 ) ;
         Text [ de ] = "Ausgansdokument ~speichern" ;
         Text[ en-US ] = "Save starting ~document";
     };
     RadioButton RB_SAVEASONE
     {
-        Pos = MAP_APPFONT ( 45 , 101 ) ;
+        Pos = MAP_APPFONT ( 45 , 109 ) ;
         Size = MAP_APPFONT ( 150 , 10 ) ;
         Text [ de ] = "Als ein Dokument speichern" ;
         Text[ en-US ] = "S~ave as single document";
     };
     RadioButton RB_SAVEINDIVIDUAL
     {
-        Pos = MAP_APPFONT (  45, 115 ) ;
+        Pos = MAP_APPFONT (  45, 123 ) ;
         Size = MAP_APPFONT ( 150 , 10 ) ;
         Text [ de ] = "Als einzelne Dokumente speichern" ;
         Text[ en-US ] = "Sa~ve as individual documents";
     };
     RadioButton RB_FROM
     {
-        Pos = MAP_APPFONT ( 45 , 129 ) ;
+        Pos = MAP_APPFONT ( 45 , 137 ) ;
         Size = MAP_APPFONT ( 30 , 10 ) ;
         Text [ de ] = "Von" ;
         Text[ en-US ] = "~From";
     };
     NumericField NF_FROM
     {
-        Pos = MAP_APPFONT ( 78 , 128 ) ;
-        Size = MAP_APPFONT ( 20 , 12 ) ;
+        Pos = MAP_APPFONT ( 78 , 136 ) ;
+        Size = MAP_APPFONT ( 20 , 10 ) ;
         Border = TRUE;
         Left = TRUE ;
         First = 1 ;
@@ -157,7 +157,7 @@ TabPage DLG_MM_OUTPUT_PAGE
     };
     FixedText   FT_TO
     {
-        Pos = MAP_APPFONT ( 101 , 130 ) ;
+        Pos = MAP_APPFONT ( 101 , 138 ) ;
         Size = MAP_APPFONT ( 20 , 8 ) ;
         Right = TRUE;
         Text [ de ] = "Bis" ;
@@ -165,7 +165,7 @@ TabPage DLG_MM_OUTPUT_PAGE
     };
     NumericField NF_TO
     {
-        Pos = MAP_APPFONT ( 124 , 128 ) ;
+        Pos = MAP_APPFONT ( 124 , 136 ) ;
         Size = MAP_APPFONT ( 20 , 10 ) ;
         Border = TRUE;
         Left = TRUE ;
@@ -177,42 +177,42 @@ TabPage DLG_MM_OUTPUT_PAGE
     };
     PushButton  PB_SAVENOW
     {
-        Pos = MAP_APPFONT ( 45 , 142 ) ;
+        Pos = MAP_APPFONT ( 45 , 150 ) ;
         Size = MAP_APPFONT ( 80 , 14 ) ;
         Text [ de ] = "Dokumente speichern" ;
         Text[ en-US ] = "Save Do~cuments";
     };
     FixedText   FT_PRINT
     {
-        Pos = MAP_APPFONT ( 12 , 103 ) ;
+        Pos = MAP_APPFONT ( 12 , 111 ) ;
         Size = MAP_APPFONT ( 30 , 8 ) ;
         Text [ de ] = "Drucker" ;
         Text[ en-US ] = "~Printer";
     };
     ListBox     LB_PRINT
     {
-        Pos = MAP_APPFONT ( 45 , 101 ) ;
+        Pos = MAP_APPFONT ( 45 , 109 ) ;
         Size = MAP_APPFONT ( 147 , 50 ) ;
         Border = TRUE;
         DropDown = TRUE;
     };
     PushButton  PB_PRINTERSETTINGS
     {
-        Pos = MAP_APPFONT ( 198 , 100 ) ;
+        Pos = MAP_APPFONT ( 198 , 108 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Eigenschaften..." ;
         Text[ en-US ] = "P~roperties...";
     };
     RadioButton RB_PRINTALL
     {
-        Pos = MAP_APPFONT ( 45 , 118 ) ;
+        Pos = MAP_APPFONT ( 45 , 126 ) ;
         Size = MAP_APPFONT ( 150 , 10 ) ;
         Text [ de ] = "Alle Dokumente drucken" ;
         Text[ en-US ] = "Print ~all documents";
     };
     PushButton  PB_PRINTNOW
     {
-        Pos = MAP_APPFONT ( 45 , 147 ) ;
+        Pos = MAP_APPFONT ( 45 , 155 ) ;
         Size = MAP_APPFONT ( 80 , 14 ) ;
         Text [ de ] = "Dokumente drucken" ;
         Text[ en-US ] = "Prin~t Documents";
@@ -220,48 +220,48 @@ TabPage DLG_MM_OUTPUT_PAGE
 
     FixedText        FT_MAILTO
     {
-        Pos = MAP_APPFONT ( 12 , 103 ) ;
+        Pos = MAP_APPFONT ( 12 , 111 ) ;
         Size = MAP_APPFONT ( 30 , 8 ) ;
         Text [ de ] = "An" ;
         Text[ en-US ] = "T~o";
     };
     ListBox          LB_MAILTO
     {
-        Pos = MAP_APPFONT ( 45 , 101 ) ;
+        Pos = MAP_APPFONT ( 45 , 109 ) ;
         Size = MAP_APPFONT ( 147 , 50 ) ;
         DropDown = TRUE;
         Border = TRUE;
     };
     PushButton       PB_COPYTO
     {
-        Pos = MAP_APPFONT ( 198 , 100 ) ;
+        Pos = MAP_APPFONT ( 198 , 108 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Kopie an..." ;
         Text[ en-US ] = "~Copy to...";
     };
     FixedText        FT_SUBJECT
     {
-        Pos = MAP_APPFONT ( 12 , 119 ) ;
+        Pos = MAP_APPFONT ( 12 , 127 ) ;
         Size = MAP_APPFONT ( 30 , 8 ) ;
         Text [ de ] = "Betreff" ;
         Text[ en-US ] = "S~ubject";
     };
     Edit             ED_SUBJECT
     {
-        Pos = MAP_APPFONT ( 45 , 117 ) ;
+        Pos = MAP_APPFONT ( 45 , 125 ) ;
         Size = MAP_APPFONT ( 147 , 12 ) ;
         Border = TRUE;
     };
     FixedText        FT_SENDAS
     {
-        Pos = MAP_APPFONT ( 12 , 135 ) ;
+        Pos = MAP_APPFONT ( 12 , 143 ) ;
         Size = MAP_APPFONT ( 30 , 8 ) ;
         Text [ de ] = "Senden als" ;
         Text[ en-US ] = "Sen~d as";
     };
     ListBox          LB_SENDAS
     {
-        Pos = MAP_APPFONT ( 45 , 133 ) ;
+        Pos = MAP_APPFONT ( 45 , 141 ) ;
         Size = MAP_APPFONT (147  , 70 ) ;
         DropDown = TRUE;
         Border = TRUE;
@@ -284,34 +284,34 @@ TabPage DLG_MM_OUTPUT_PAGE
     };
     PushButton       PB_SENDAS
     {
-        Pos = MAP_APPFONT ( 198 , 132 ) ;
+        Pos = MAP_APPFONT ( 198 , 140 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         Text [ de ] = "Eigenschaften..." ;
         Text[ en-US ] = "Pr~operties...";
     };
     FixedText        FT_ATTACHMENT
     {
-        Pos = MAP_APPFONT ( 45 , 149 ) ;
+        Pos = MAP_APPFONT ( 45 , 157 ) ;
         Size = MAP_APPFONT ( 147 , 8 ) ;
         Text [ de ] = "Name des Anhangs" ;
         Text[ en-US ] = "Name of the a~ttachment";
     };
     Edit ED_ATTACHMENT
     {
-        Pos = MAP_APPFONT ( 45 , 160 ) ;
+        Pos = MAP_APPFONT ( 45 , 168 ) ;
         Size = MAP_APPFONT ( 147 , 12 ) ;
         Border = TRUE;
     };
     RadioButton      RB_SENDALL
     {
-        Pos = MAP_APPFONT ( 45 , 176 ) ;
+        Pos = MAP_APPFONT ( 45 , 184 ) ;
         Size = MAP_APPFONT ( 153 , 10 ) ;
         Text [ de ] = "Alle Dokumente versenden" ;
         Text[ en-US ] = "S~end all documents";
     };
     PushButton       PB_SENDDOCUMENTS
     {
-        Pos = MAP_APPFONT ( 45 , 204 ) ;
+        Pos = MAP_APPFONT ( 45 , 212 ) ;
         Size = MAP_APPFONT ( 80 , 14 ) ;
         Text [ de ] = "Dokumente versenden" ;
         Text[ en-US ] = "Se~nd documents";
@@ -368,7 +368,7 @@ ModalDialog DLG_MM_COPYTO
     OutputSize = TRUE ;
     SVLook = TRUE ;
     HelpID = HID_MM_COPYTO;
-    Size = MAP_APPFONT ( 250 , 117 ) ;
+    Size = MAP_APPFONT ( 250 , 100 ) ;
     Moveable = TRUE ;
 
     Text [ de ] = "Kopie an";
@@ -417,23 +417,23 @@ ModalDialog DLG_MM_COPYTO
     };
     FixedLine FL_SEPARATOR
     {
-        Pos = MAP_APPFONT ( 0 , 73 ) ;
+        Pos = MAP_APPFONT ( 0 , 66 ) ;
         Size = MAP_APPFONT ( 250 , 8 ) ;
     };
     OKButton        PB_OK
     {
-        Pos = MAP_APPFONT ( 85 , 87 ) ;
+        Pos = MAP_APPFONT ( 85 , 80 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         DefButton = TRUE ;
     };
     CancelButton        PB_CANCEL
     {
-        Pos = MAP_APPFONT ( 138 , 87 ) ;
+        Pos = MAP_APPFONT ( 138 , 80 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
     };
     HelpButton      PB_HELP
     {
-        Pos = MAP_APPFONT ( 194 , 87 ) ;
+        Pos = MAP_APPFONT ( 194 , 80 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
     };
 };
Index: sw/source/ui/dbui/mmoutputtypepage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmoutputtypepage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.2
diff -u -p -u -p -r1.2 -r1.2.212.2
--- sw/source/ui/dbui/mmoutputtypepage.src	20 Sep 2004 13:19:29 -0000	1.2
+++ sw/source/ui/dbui/mmoutputtypepage.src	4 Feb 2005 15:01:24 -0000	1.2.212.2
@@ -65,45 +65,45 @@
 TabPage DLG_MM_OUTPUTTYPE_PAGE
 {
     HelpID = HID_MM_OUTPUTTYPEPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Bitte wählen Sie einen Dokumenttyp" ;
         Text[ en-US ] = "Select a document type";
     };
-    FixedText FT_TYPE  
+    FixedText FT_TYPE
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Was für ein Dokument möchten Sie erstellen?" ;
         Text[ en-US ] = "What type of document do you want to create?";
     };
     RadioButton RB_LETTER
     {
-        Pos = MAP_APPFONT ( 12 , 37 ) ;
+        Pos = MAP_APPFONT ( 12 , 43 ) ;
         Size = MAP_APPFONT ( 240 , 10 ) ;
         Text [ de ] = "Brief" ;
         Text[ en-US ] = "~Letter";
     };
-    RadioButton RB_MAIL  
+    RadioButton RB_MAIL
     {
-        Pos = MAP_APPFONT ( 12 , 51 ) ;
+        Pos = MAP_APPFONT ( 12 , 57 ) ;
         Size = MAP_APPFONT ( 240 , 10 ) ;
         Text [ de ] = "E-Mail-Nachricht" ;
         Text[ en-US ] = "~E-mail message";
     };
     FixedText FI_HINTHEADER
     {
-        Pos = MAP_APPFONT ( 12 ,  67) ;
+        Pos = MAP_APPFONT ( 12 ,  72) ;
         Size = MAP_APPFONT ( 242 , 8 ) ;
     };
     FixedText FI_HINT
     {
-        Pos = MAP_APPFONT ( 12 , 78 ) ;
+        Pos = MAP_APPFONT ( 12 , 83 ) ;
         Size = MAP_APPFONT ( 242 , 26 ) ;
         WordBreak = TRUE;
     };
@@ -129,7 +129,7 @@ TabPage DLG_MM_OUTPUTTYPE_PAGE
     };
     FixedText FT_NOMAILHINT
     {
-        Pos = MAP_APPFONT ( 12 , 108 ) ;
+        Pos = MAP_APPFONT ( 12 , 113 ) ;
         Size = MAP_APPFONT ( 242 , 26 ) ;
         WordBreak = TRUE;
         Hide = TRUE;
Index: sw/source/ui/dbui/mmpreparemergepage.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dbui/mmpreparemergepage.src,v
retrieving revision 1.2
retrieving revision 1.2.212.2
diff -u -p -u -p -r1.2 -r1.2.212.2
--- sw/source/ui/dbui/mmpreparemergepage.src	20 Sep 2004 13:20:15 -0000	1.2
+++ sw/source/ui/dbui/mmpreparemergepage.src	4 Feb 2005 15:01:25 -0000	1.2.212.2
@@ -65,12 +65,12 @@
 TabPage DLG_MM_PREPAREMERGE_PAGE
 {
     HelpID = HID_MM_PREPAREMERGEPAGE ;
-    Size = MAP_APPFONT ( 260 , 220 ) ;
+    Size = MAP_APPFONT ( 260 , 230 ) ;
     Hide = TRUE ;
 
     FixedText FI_HEADER
     {
-        Pos = MAP_APPFONT ( 6 , 3 ) ;
+        Pos = MAP_APPFONT ( 6 , 8 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Kontrollieren Sie das Dokument und ändern sie es falls notwendig" ;
         Text[ en-US ] = "Preview and edit the document";
@@ -78,7 +78,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
 
     FixedText   FI_PREVIEW
     {
-        Pos = MAP_APPFONT ( 6 , 20 ) ;
+        Pos = MAP_APPFONT ( 6 , 27 ) ;
         Size = MAP_APPFONT ( 248 , 28 ) ;
         WordBreak = TRUE;
         Text [ de ] = "Sie sehen jetzt eine Vorschau auf ein Serienbriefdokument. Um eine Vorschau auf weitere Dokumente zu sehen, klicken Sie auf die Pfeile." ;
@@ -86,7 +86,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     FixedText   FT_RECIPIENT
     {
-        Pos = MAP_APPFONT ( 6 , 53 ) ;
+        Pos = MAP_APPFONT ( 12 , 53 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
         Text [ de ] = "~Empfänger" ;
         Text[ en-US ] = "~Recipient";
@@ -94,7 +94,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
 
     PushButton  PB_FIRST
     {
-        Pos = MAP_APPFONT ( 60 , 50 ) ;
+        Pos = MAP_APPFONT ( 75 , 50 ) ;
         Size = MAP_APPFONT ( 20 , 14 ) ;
         Text = "|<" ;
         QuickHelpText [de] = "Erster";
@@ -102,7 +102,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     PushButton  PB_PREV
     {
-        Pos = MAP_APPFONT ( 83 , 50 ) ;
+        Pos = MAP_APPFONT ( 98 , 50 ) ;
         Size = MAP_APPFONT ( 20 , 14 ) ;
         Text = "<" ;
         QuickHelpText [de] = "Voriger";
@@ -110,7 +110,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     NumericField ED_RECORD
     {
-        Pos = MAP_APPFONT ( 106 , 51 ) ;
+        Pos = MAP_APPFONT ( 121 , 51 ) ;
         Size = MAP_APPFONT ( 20 , 12 ) ;
         Border = TRUE ;
         Left = TRUE ;
@@ -122,7 +122,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     PushButton  PB_NEXT
     {
-        Pos = MAP_APPFONT ( 129 , 50 ) ;
+        Pos = MAP_APPFONT ( 144 , 50 ) ;
         Size = MAP_APPFONT ( 20 , 14 ) ;
         Text = ">" ;
         QuickHelpText [de] = "Nächster";
@@ -130,7 +130,7 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     PushButton  PB_LAST
     {
-        Pos = MAP_APPFONT ( 152 , 50 ) ;
+        Pos = MAP_APPFONT ( 167 , 50 ) ;
         Size = MAP_APPFONT ( 20 , 14 ) ;
         Text = ">|" ;
         QuickHelpText [de] = "Letzter";
@@ -138,29 +138,29 @@ TabPage DLG_MM_PREPAREMERGE_PAGE
     };
     CheckBox CB_EXCLUDE
     {
-        Pos = MAP_APPFONT ( 6 , 72 ) ;
+        Pos = MAP_APPFONT ( 75, 72 ) ;
         Size = MAP_APPFONT ( 248 , 10 ) ;
         Text [ de ] = "Diesen Empfänger ausschließen" ;
         Text[ en-US ] = "E~xclude this recipient";
     };
     FixedLine   FL_NOTEHEADER
     {
-        Pos = MAP_APPFONT ( 6 , 88 ) ;
+        Pos = MAP_APPFONT ( 6 , 95 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ de ] = "Dokument bearbeiten" ;
         Text[ en-US ] = "Edit Document";
     };
     FixedText   FI_EDIT
     {
-        Pos = MAP_APPFONT ( 6 , 99 ) ;
+        Pos = MAP_APPFONT ( 12 , 117 ) ;
         Size = MAP_APPFONT ( 248 , 60 ) ;
         WordBreak = TRUE;
-        Text [ de ] = "Sie köönen jetzt das Dokument erstellen oder bearbeiten. Die Veränderungen wirken sich auf alle Serienbriefdokumente aus.\n\nEin Klick auf die Schaltfläche 'Dokument bearbeiten...' schließt vorübergehend den Assistenten. Durch Klicken der 'Zurück zum Seriendruck-Assistenten'-Schaltfläche - sichtbar in einem kleinen Fenster - gelangen Sie zurück zum Assistenten." ;
+        Text [ de ] = "Sie können jetzt das Dokument erstellen oder bearbeiten. Die Veränderungen wirken sich auf alle Serienbriefdokumente aus.\n\nEin Klick auf die Schaltfläche 'Dokument bearbeiten...' schließt vorübergehend den Assistenten. Durch Klicken der 'Zurück zum Seriendruck-Assistenten'-Schaltfläche - sichtbar in einem kleinen Fenster - gelangen Sie zurück zum Assistenten." ;
         Text[ en-US ] = "Write or edit your document now if you have not already done so. The changes will effect all merged documents.\n\nClicking 'Edit Document...' will temporarily reduce the wizard to a small window so you can edit the mail merge document. After editing the document, return to the wizard by clicking 'Return to Mail Merge Wizard' in the small window." ;
     };
     PushButton  PB_EDIT
     {
-        Pos = MAP_APPFONT ( 6 , 162 ) ;
+        Pos = MAP_APPFONT ( 90 , 180 ) ;
         Size = MAP_APPFONT ( 80 , 14 ) ;
         Text [ de ] = "Dokument bearbeiten..." ;
         Text[ en-US ] = "~Edit Document...";
Index: sw/source/ui/dialog/regionsw.src
===================================================================
RCS file: /cvs/sw/sw/source/ui/dialog/regionsw.src,v
retrieving revision 1.54
retrieving revision 1.54.54.2
diff -u -p -u -p -r1.54 -r1.54.54.2
--- sw/source/ui/dialog/regionsw.src	3 Dec 2004 14:10:09 -0000	1.54
+++ sw/source/ui/dialog/regionsw.src	14 Jan 2005 14:59:08 -0000	1.54.54.2
@@ -307,7 +307,7 @@ ModalDialog MD_EDIT_REGION
     TriStateBox CB_EDIT_IN_READONLY
     {
         Pos = MAP_APPFONT ( 98 , 170 ) ;
-        Size = MAP_APPFONT ( 100 , 10 ) ;
+        Size = MAP_APPFONT ( 156 , 10 ) ;
         TabStop = TRUE ;
         TriStateDisable = FALSE ;
         CB_EDIT_IN_READONLY_TEXT
@@ -623,7 +623,7 @@ TabPage TP_INSERT_SECTION
     CheckBox CB_EDIT_IN_READONLY
     {
         Pos = MAP_APPFONT ( 96 , 170 ) ;
-        Size = MAP_APPFONT ( 100 , 10 ) ;
+        Size = MAP_APPFONT ( 158 , 10 ) ;
         CB_EDIT_IN_READONLY_TEXT
     };
 
@@ -701,23 +701,23 @@ TabPage TP_SECTION_FTNENDNOTES
 	};
 	CheckBox CB_FTN_NUM
 	{
-		Pos = MAP_APPFONT ( 12 , 29 ) ;
-		Size = MAP_APPFONT ( 70 , 10 ) ;
+        Pos = MAP_APPFONT ( 18 , 29 ) ;
+        Size = MAP_APPFONT ( 100 , 10 ) ;
 		TabStop = TRUE ;
     	Text [ de ] = "~Nummer neu starten" ;
 		Text [ en-US ] = "~Restart numbering";
 	};
 	FixedText FT_FTN_OFFSET
 	{
-		Pos = MAP_APPFONT ( 85 , 29 ) ;
-        Size = MAP_APPFONT ( 49 , 8 ) ;
+        Pos = MAP_APPFONT ( 24 , 46 ) ;
+        Size = MAP_APPFONT ( 64 , 8 ) ;
 		Text [ de ] = "~Beginn bei" ;
 		Left = TRUE ;
 		Text [ en-US ] = "~Start at" ;
 	};
 	NumericField FLD_FTN_OFFSET
 	{
-		Pos = MAP_APPFONT ( 136 , 27 ) ;
+        Pos = MAP_APPFONT ( 90 , 44 ) ;
 		Size = MAP_APPFONT ( 30 , 12 ) ;
 		Spin = TRUE ;
 		Minimum = 1 ;
@@ -729,16 +729,16 @@ TabPage TP_SECTION_FTNENDNOTES
 	};
 	CheckBox CB_FTN_NUM_FMT
 	{
-		Pos = MAP_APPFONT ( 12 , 45 ) ;
-		Size = MAP_APPFONT ( 70 , 10 ) ;
+        Pos = MAP_APPFONT ( 24 , 61 ) ;
+        Size = MAP_APPFONT ( 100 , 10 ) ;
 		TabStop = TRUE ;
     	Text [ de ] = "eigenes ~Format" ;
 		Text [ en-US ] = "Custom ~format";
 	};
 	FixedText FT_FTN_PREFIX
 	{
-		Pos = MAP_APPFONT ( 85 , 45 ) ;
-        Size = MAP_APPFONT ( 25 , 8 ) ;
+        Pos = MAP_APPFONT ( 30 , 76 ) ;
+        Size = MAP_APPFONT ( 58 , 8 ) ;
 		Text [ de ] = "~Davor" ;
 		Text [ en-US ] = "Be~fore" ;
 		Left = TRUE ;
@@ -746,8 +746,8 @@ TabPage TP_SECTION_FTNENDNOTES
 	Edit ED_FTN_PREFIX
 	{
 		Border = TRUE ;
-		Pos = MAP_APPFONT ( 113 , 43 ) ;
-		Size = MAP_APPFONT ( 20 , 12 ) ;
+        Pos = MAP_APPFONT ( 90 , 74 ) ;
+        Size = MAP_APPFONT ( 30 , 12 ) ;
 		TabStop = TRUE ;
 		Left = TRUE ;
 		MaxTextLength = 50 ;
@@ -755,7 +755,7 @@ TabPage TP_SECTION_FTNENDNOTES
 	ListBox LB_FTN_NUMVIEW
 	{
 		Border = TRUE ;
- 		Pos = MAP_APPFONT ( 136 , 43 ) ;
+        Pos = MAP_APPFONT ( 123 , 74 ) ;
 		Size = MAP_APPFONT ( 62 , 50 ) ;
 		TabStop = TRUE ;
 		Group = TRUE ;
@@ -763,19 +763,19 @@ TabPage TP_SECTION_FTNENDNOTES
 	};
 	FixedText FT_FTN_SUFFIX
 	{
-		Pos = MAP_APPFONT ( 201 , 45 ) ;
+        Pos = MAP_APPFONT ( 191 , 76 ) ;
         Size = MAP_APPFONT ( 25 , 8 ) ;
 		Text [ de ] = "Dah~inter" ;
 		Text [ en-US ] = "Aft~er" ;
-		Left = TRUE ;
+        Right = TRUE ;
 	};
 	Edit ED_FTN_SUFFIX
 	{
 		Border = TRUE ;
-		Pos = MAP_APPFONT ( 229 , 43 ) ;
-		Size = MAP_APPFONT ( 20 , 12 ) ;
+        Pos = MAP_APPFONT ( 219 , 74 ) ;
+        Size = MAP_APPFONT ( 30 , 12 ) ;
 		TabStop = TRUE ;
-		Left = TRUE ;
+        Left = TRUE ;
 		MaxTextLength = 50 ;
 	};
 
@@ -783,38 +783,38 @@ TabPage TP_SECTION_FTNENDNOTES
     FixedLine FL_END
 	{
 		OutputSize = TRUE ;
-		Pos = MAP_APPFONT ( 6 , 61 ) ;
+        Pos = MAP_APPFONT ( 6 , 92 ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
 		Text [ de ] = "Endnoten" ;
 		Text [ en-US ] = "Endnotes";
 	};
 	CheckBox CB_END_AT_TXTEND
 	{
-		Pos = MAP_APPFONT ( 12 , 72 ) ;
-		Size = MAP_APPFONT ( 90 , 10 ) ;
+        Pos = MAP_APPFONT ( 12 , 103 ) ;
+        Size = MAP_APPFONT ( 100 , 10 ) ;
 		TabStop = TRUE ;
     	Text [ de ] = "~am Bereichsende sammeln" ;
 		Text [ en-US ] = "C~ollect at end of section";
 	};
 	CheckBox CB_END_NUM
 	{
-		Pos = MAP_APPFONT ( 12 , 88 ) ;
-		Size = MAP_APPFONT ( 70 , 10 ) ;
+        Pos = MAP_APPFONT ( 16 , 118 ) ;
+        Size = MAP_APPFONT ( 100 , 10 ) ;
 		TabStop = TRUE ;
     	Text [ de ] = "Nummer neu ~starten" ;
 		Text [ en-US ] = "~Restart numbering";
 	};
 	FixedText FT_END_OFFSET
 	{
-		Pos = MAP_APPFONT ( 85 , 88 ) ;
-        Size = MAP_APPFONT ( 49 , 8 ) ;
+        Pos = MAP_APPFONT ( 24 , 135 ) ;
+        Size = MAP_APPFONT ( 64 , 8 ) ;
 		Text [ de ] = "Be~ginn bei" ;
 		Left = TRUE ;
 		Text [ en-US ] = "~Start at" ;
 	};
 	NumericField FLD_END_OFFSET
 	{
-		Pos = MAP_APPFONT ( 136 , 86 ) ;
+        Pos = MAP_APPFONT ( 90 , 133 ) ;
 		Size = MAP_APPFONT ( 30 , 12 ) ;
 		Spin = TRUE ;
 		Minimum = 1 ;
@@ -826,8 +826,8 @@ TabPage TP_SECTION_FTNENDNOTES
 	};
 	CheckBox CB_END_NUM_FMT
 	{
-		Pos = MAP_APPFONT ( 12 , 104 ) ;
-		Size = MAP_APPFONT ( 70 , 10 ) ;
+        Pos = MAP_APPFONT ( 24 , 150 ) ;
+        Size = MAP_APPFONT ( 100 , 10 ) ;
 		TabStop = TRUE ;
     	Text [ de ] = "~eigenes Format" ;
 		Text [ en-US ] = "Custom format";
@@ -835,17 +835,17 @@ TabPage TP_SECTION_FTNENDNOTES
 
 	FixedText FT_END_PREFIX
 	{
-		Pos = MAP_APPFONT ( 85 , 104 ) ;
-        Size = MAP_APPFONT ( 25 , 8 ) ;
+        Pos = MAP_APPFONT ( 30 , 165 ) ;
+        Size = MAP_APPFONT ( 58 , 8 ) ;
 		Text [ de ] = "Da~vor" ;
 		Text [ en-US ] = "Be~fore" ;
-		Left = TRUE ;
+        Left = TRUE ;
 	};
 	Edit ED_END_PREFIX
 	{
 		Border = TRUE ;
-		Pos = MAP_APPFONT ( 113 , 102 ) ;
-		Size = MAP_APPFONT ( 20 , 12 ) ;
+        Pos = MAP_APPFONT ( 90 , 163 ) ;
+        Size = MAP_APPFONT ( 30 , 12 ) ;
 		TabStop = TRUE ;
 		Left = TRUE ;
 		MaxTextLength = 50 ;
@@ -853,7 +853,7 @@ TabPage TP_SECTION_FTNENDNOTES
 	ListBox LB_END_NUMVIEW
 	{
 		Border = TRUE ;
-		Pos = MAP_APPFONT ( 136 , 102 ) ;
+        Pos = MAP_APPFONT ( 123 , 163 ) ;
 		Size = MAP_APPFONT ( 62 , 50 ) ;
 		TabStop = TRUE ;
 		Group = TRUE ;
@@ -862,17 +862,17 @@ TabPage TP_SECTION_FTNENDNOTES
 	};
 	FixedText FT_END_SUFFIX
 	{
-		Pos = MAP_APPFONT ( 201 , 104 ) ;
+        Pos = MAP_APPFONT ( 191 , 165 ) ;
         Size = MAP_APPFONT ( 25 , 8 ) ;
 		Text [ de ] = "Dahinte~r" ;
 		Text [ en-US ] = "Aft~er" ;
-		Left = TRUE ;
+        Right = TRUE ;
 	};
 	Edit ED_END_SUFFIX
 	{
 		Border = TRUE ;
-		Pos = MAP_APPFONT ( 229 , 102 ) ;
-		Size = MAP_APPFONT ( 20 , 12 ) ;
+        Pos = MAP_APPFONT ( 219 , 163 ) ;
+        Size = MAP_APPFONT ( 30 , 12 ) ;
 		TabStop = TRUE ;
 		Left = TRUE ;
 		MaxTextLength = 50 ;
Index: sw/source/ui/inc/mailmergehelper.hxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/inc/mailmergehelper.hxx,v
retrieving revision 1.4
retrieving revision 1.4.14.1
diff -u -p -u -p -r1.4 -r1.4.14.1
--- sw/source/ui/inc/mailmergehelper.hxx	28 Jan 2005 15:31:31 -0000	1.4
+++ sw/source/ui/inc/mailmergehelper.hxx	28 Feb 2005 14:32:09 -0000	1.4.14.1
@@ -300,15 +300,15 @@ class SwMailTransferable : 
         public SwMutexBase, 
         public cppu::WeakComponentImplHelper1< ::com::sun::star::datatransfer::XTransferable >
 {
-    String  m_aMimeType;
-    String  m_sBody;
-    String  m_aURL;
-    String  m_aName;
-    bool    m_bIsBody;
+    rtl::OUString  m_aMimeType;
+    rtl::OUString  m_sBody;
+    rtl::OUString  m_aURL;
+    rtl::OUString  m_aName;
+    bool           m_bIsBody;
     
     public:
-    SwMailTransferable(const String& rURL, const String& rName, const String& rMimeType);
-    SwMailTransferable(const String& rBody, const String& rMimeType);
+    SwMailTransferable(const rtl::OUString& rURL, const rtl::OUString& rName, const rtl::OUString& rMimeType);
+    SwMailTransferable(const rtl::OUString& rBody, const rtl::OUString& rMimeType);
     ~SwMailTransferable();
     virtual ::com::sun::star::uno::Any SAL_CALL 
                         getTransferData( const ::com::sun::star::datatransfer::DataFlavor& aFlavor ) 
Index: sw/source/ui/inc/swmn_tmpl.hrc
===================================================================
RCS file: /cvs/sw/sw/source/ui/inc/swmn_tmpl.hrc,v
retrieving revision 1.7
retrieving revision 1.7.84.1
diff -u -p -u -p -r1.7 -r1.7.84.1
--- sw/source/ui/inc/swmn_tmpl.hrc	17 Nov 2004 08:42:03 -0000	1.7
+++ sw/source/ui/inc/swmn_tmpl.hrc	12 Jan 2005 14:32:34 -0000	1.7.84.1
@@ -298,10 +298,10 @@ location: <project>/uiconfig/[swriter|sw
 #define MN_RESET\
     MenuItem\
     {\
-        Text [ de ] = "Standar~d" ; \
         Identifier = FN_FORMAT_RESET ; \
         HelpID = FN_FORMAT_RESET ; \
-        Text [ en-US ] = "~Default" ; \
+        Text [ de ] = "Standardformatierung" ; \
+        Text [ en-US ] = "~Default Formatting" ; \
     };
 
 #define BASE_TEXT_POPUPMENU_BEGIN \
Index: svx/inc/optaccessibility.hrc
===================================================================
RCS file: /cvs/graphics/svx/inc/optaccessibility.hrc,v
retrieving revision 1.3
retrieving revision 1.3.400.1
diff -u -p -u -p -r1.3 -r1.3.400.1
--- svx/inc/optaccessibility.hrc	5 Jul 2004 09:26:42 -0000	1.3
+++ svx/inc/optaccessibility.hrc	10 Jan 2005 14:53:08 -0000	1.3.400.1
@@ -72,7 +72,7 @@
 #define COL0					6
 #define COL1					(COL0+6)
 #define COL2					(COL1+10)
-#define COL3					(COL1+(CB_WIDTH/2))
+#define COL3					(COL1+(CB_WIDTH * 2/3))
 #define COL4					(COL3+EDIT_WIDTH+RSC_SP_CTRL_DESC_X)
 
 #define UNIT_WIDTH				(CB_WIDTH-COL4)
Index: svx/source/dialog/cuitabarea.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/cuitabarea.hxx,v
retrieving revision 1.3
retrieving revision 1.2.614.2
diff -u -p -u -p -r1.3 -r1.2.614.2
--- svx/source/dialog/cuitabarea.hxx	21 Jan 2005 16:33:11 -0000	1.3
+++ svx/source/dialog/cuitabarea.hxx	7 Feb 2005 10:09:34 -0000	1.2.614.2
@@ -241,13 +241,8 @@ class SVX_DLLPUBLIC SvxAreaTabPage : pub
 {
 private:
     FixedLine           aFlProp;
-    RadioButton         aRbtNoFill;
-    RadioButton         aRbtColor;
-    RadioButton         aRbtGradient;
-    RadioButton         aRbtHatch;
-    RadioButton         aRbtBitmap;
+    ListBox             aTypeLB;
 
-//      ListBox             aDlgType;
 	ColorLB             aLbColor;
 	GradientLB          aLbGradient;
 	HatchingLB          aLbHatching;
@@ -315,7 +310,7 @@ private:
 	FieldUnit			eFUnit;
 
 #ifdef _SVX_TPAREA_CXX
-	DECL_LINK( SelectDialogType_Impl, void * );
+	DECL_LINK( SelectDialogTypeHdl_Impl, ListBox * );
 	DECL_LINK( ClickInvisibleHdl_Impl, void * );
 	DECL_LINK( ClickColorHdl_Impl, void * );
 	DECL_LINK( ModifyColorHdl_Impl, void * );
Index: svx/source/dialog/optgdlg.hrc
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optgdlg.hrc,v
retrieving revision 1.12
retrieving revision 1.12.160.1
diff -u -p -u -p -r1.12 -r1.12.160.1
--- svx/source/dialog/optgdlg.hrc	3 Nov 2004 08:19:02 -0000	1.12
+++ svx/source/dialog/optgdlg.hrc	13 Jan 2005 13:18:35 -0000	1.12.160.1
@@ -97,9 +97,10 @@
 //#define OFFS_PUSHBUTTON_FIXEDTEXT(base)	(base+(RSC_CD_PUSHBUTTON_HEIGHT-RSC_CD_FIXEDTEXT_HEIGHT)/2)
 
 #define ROW_MF_SCALING          (13)
-#define	ROW_LB_BIG				(ROW_MF_SCALING+RSC_CD_DROPDOWN_HEIGHT+ROWSPACE)
-#define ROW_CB_SYSTEM_FONT		(ROW_LB_BIG+RSC_CD_DROPDOWN_HEIGHT+ROWSPACE)
-#define ROW_CB_FONTANTIALIASING (ROW_CB_SYSTEM_FONT+RSC_CD_DROPDOWN_HEIGHT+ROWSPACE)
+#define ROW_FT_ICONSIZE         (ROW_MF_SCALING+RSC_CD_DROPDOWN_HEIGHT+ROWSPACE)
+#define ROW_LB_ICONSIZE         (ROW_FT_ICONSIZE+RSC_CD_FIXEDTEXT_HEIGHT+ROWSPACE)
+#define ROW_CB_SYSTEM_FONT      (ROW_LB_ICONSIZE+RSC_CD_DROPDOWN_HEIGHT+ROWSPACE)
+#define ROW_CB_FONTANTIALIASING (ROW_CB_SYSTEM_FONT+ (2 * RSC_CD_DROPDOWN_HEIGHT) +ROWSPACE)
 #define ROW_NF_AA_POINTLIMIT	(ROW_CB_FONTANTIALIASING+RSC_CD_FIXEDLINE_HEIGHT+ROWSPACE)
 
 #define ROW_FL_MENU             (ROW_NF_AA_POINTLIMIT+RSC_CD_DROPDOWN_HEIGHT+RSC_SP_FLGR_SPACE_X)
Index: svx/source/dialog/optgdlg.src
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optgdlg.src,v
retrieving revision 1.14
retrieving revision 1.14.182.2
diff -u -p -u -p -r1.14 -r1.14.182.2
--- svx/source/dialog/optgdlg.src	27 Oct 2004 16:12:03 -0000	1.14
+++ svx/source/dialog/optgdlg.src	17 Feb 2005 07:33:23 -0000	1.14.182.2
@@ -228,14 +228,14 @@ TabPage OFA_TP_VIEW
     FixedText FT_WINDOWSIZE
 	{
         Pos = MAP_APPFONT ( 12 , OFFS_TEXTBOX_FIXEDTEXT( ROW_MF_SCALING ) ) ;
-        Size = MAP_APPFONT ( 60 , 8 ) ;
+        Size = MAP_APPFONT ( 80 , 8 ) ;
         Text [ de ] = "~Skalierung" ;
         Text [ en-US ] = "Sc~aling" ;
     };
     MetricField MF_WINDOWSIZE
 	{
-        Pos = MAP_APPFONT ( 75 , ROW_MF_SCALING ) ;
-        Size = MAP_APPFONT ( 51 , 12 ) ;
+        Pos = MAP_APPFONT ( 95 , ROW_MF_SCALING ) ;
+        Size = MAP_APPFONT ( 31 , 12 ) ;
 		Border = TRUE ;
 		TabStop = TRUE ;
 		Left = TRUE ;
@@ -252,15 +252,15 @@ TabPage OFA_TP_VIEW
 	};
     FixedText FT_ICONSIZE
 	{
-        Pos = MAP_APPFONT ( 12 , OFFS_TEXTBOX_FIXEDTEXT( ROW_LB_BIG ) ) ;
-        Size = MAP_APPFONT ( 60 , 8 ) ;
+        Pos = MAP_APPFONT ( 12 , ROW_FT_ICONSIZE  ) ;
+        Size = MAP_APPFONT ( 114 , 8 ) ;
         Text [ de ] = "Symbolgröße" ;
-        Text [ en-US ] = "Toolbar icon size" ;
+        Text [ en-US ] = "Icon size" ;
     };
     ListBox LB_ICONSIZE
 	{
-        Pos = MAP_APPFONT ( 75 , ROW_LB_BIG ) ;
-        Size = MAP_APPFONT ( 51 , 60 ) ;
+        Pos = MAP_APPFONT ( 12 , ROW_LB_ICONSIZE ) ;
+        Size = MAP_APPFONT ( 114 , 60 ) ;
 		DropDown = TRUE ;
 		Border = TRUE ;
 		TabStop = TRUE ;
@@ -281,7 +281,8 @@ TabPage OFA_TP_VIEW
 	{
 		TabStop = TRUE ;
 		Pos = MAP_APPFONT( 12, ROW_CB_SYSTEM_FONT );
-		Size = MAP_APPFONT( 110, 12 );
+        Size = MAP_APPFONT( 110, 24 );
+        WordBreak = TRUE;
 		Text[ de ] = "~Systemschriftart für die Benutzeroberfläche verwenden" ;
 		Text[ en-US ] = "Use system ~font for user interface";
 	};
@@ -374,14 +375,14 @@ TabPage OFA_TP_VIEW
 	CheckBox BTN_DOCVIEW
 	{
         Pos = MAP_APPFONT ( 139 , 14 ) ;
-        Size = MAP_APPFONT ( 110 , 10 ) ;
+        Size = MAP_APPFONT ( 113 , 10 ) ;
         Text [ de ] = "~Bearbeitungsansicht" ;
 		Text [ en-US ] = "Editing view";
 	};
 	CheckBox BTN_OPENWIN
 	{
         Pos = MAP_APPFONT ( 139 , 27 ) ;
-        Size = MAP_APPFONT ( 110 , 10 ) ;
+        Size = MAP_APPFONT ( 113 , 10 ) ;
         Text [ de ] = "Ge~öffnete Fenster" ;
 		Text [ en-US ] = "Open ~windows" ;
 	};
@@ -395,7 +396,7 @@ TabPage OFA_TP_VIEW
 	CheckBox CB_3D_OPENGL
 	{
         Pos = MAP_APPFONT ( 139, 58 ) ;
-        Size = MAP_APPFONT ( 110 , 10 ) ;
+        Size = MAP_APPFONT ( 113 , 10 ) ;
 		Text [ de ] = "~OpenGL benutzen" ;
 		Text [ en-US ] = "Use ~OpenGL" ;
 	};
@@ -410,14 +411,14 @@ TabPage OFA_TP_VIEW
 	CheckBox CB_3D_DITHERING
 	{
         Pos = MAP_APPFONT ( 139 , 84 ) ;
-        Size = MAP_APPFONT ( 110 , 10 ) ;
+        Size = MAP_APPFONT ( 113 , 10 ) ;
 		Text [ de ] = "~Dithering benutzen" ;
 		Text [ en-US ] = "Use ~dithering" ;
 	};
 	CheckBox CB_3D_SHOWFULL
 	{
         Pos = MAP_APPFONT ( 139 , 97 ) ;
-        Size = MAP_APPFONT ( 110 , 10 ) ;
+        Size = MAP_APPFONT ( 113 , 10 ) ;
 		Text [ de ] = "~Volldarstellung bei Interaktion" ;
 		Text [ en-US ] = "Ob~ject refresh during interaction" ;
 	};
Index: svx/source/dialog/tabarea.hrc
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/tabarea.hrc,v
retrieving revision 1.7
retrieving revision 1.7.1184.1
diff -u -p -u -p -r1.7 -r1.7.1184.1
--- svx/source/dialog/tabarea.hrc	22 Nov 2002 14:47:01 -0000	1.7
+++ svx/source/dialog/tabarea.hrc	17 Jan 2005 12:31:36 -0000	1.7.1184.1
@@ -175,11 +175,7 @@
 #define FT_Y_OFFSET 2
 #define MTR_FLD_X_OFFSET 1
 #define MTR_FLD_Y_OFFSET 2
-#define RBT_FILL_OFF 1
-#define RBT_COLOR 2
-#define RBT_GRADIENT 3
-#define RBT_HATCH 4
-#define RBT_BITMAP 5
+#define LB_AREA_TYPE 19 
 #define RBT_ROW 6
 #define RBT_COLUMN 7
 #define MTR_FLD_OFFSET 3
Index: svx/source/dialog/tabarea.src
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/tabarea.src,v
retrieving revision 1.59
retrieving revision 1.59.236.1
diff -u -p -u -p -r1.59 -r1.59.236.1
--- svx/source/dialog/tabarea.src	12 Oct 2004 10:05:34 -0000	1.59
+++ svx/source/dialog/tabarea.src	17 Jan 2005 12:31:37 -0000	1.59.236.1
@@ -327,74 +327,61 @@ TabPage RID_SVXPAGE_AREA
     FixedLine FL_PROP
 	{
 		Pos = MAP_APPFONT ( 6 , 3  ) ;
-        Size = MAP_APPFONT ( 248, 8 ) ;
+        Size = MAP_APPFONT ( 120, 8 ) ;
         Text [ de ] = "Füllung" ;
 		Text [ en-US ] = "Fill";
 	};
-    RadioButton RBT_FILL_OFF
-	{
-		Pos = MAP_APPFONT ( 12 , 14  ) ;
-        Size = MAP_APPFONT ( 57 , 10 ) ;
-        Text [ de ] = "~Keine" ;
-        Text [ en-US ] = "None";
-	};
-    RadioButton RBT_COLOR
-    {
-        Pos = MAP_APPFONT ( 12 , 28  ) ;
-        Size = MAP_APPFONT ( 57 , 10 ) ;
-        Text [ de ] = "~Farbe" ;
-        Text [ en-US ] = "Color";
-		Text [ x-comment ] = " ";
-	};
-    RadioButton RBT_GRADIENT
-	{
-        Pos = MAP_APPFONT ( 12 , 42 ) ;
-        Size = MAP_APPFONT ( 57 , 10 ) ;
-        Text [ de ] = "Farb~verlauf" ;
-        Text [ en-US ] = "Gradient";
-		Text [ x-comment ] = " ";
-	};
-    RadioButton RBT_HATCH
+	ListBox LB_AREA_TYPE
     {
-        Pos = MAP_APPFONT ( 72 , 14  ) ;
-        Size = MAP_APPFONT ( 57 , 10 ) ;
-        Text [ de ] = "Schraff~ur" ;
-        Text [ en-US ] = "Hatching";
-	};
-    RadioButton RBT_BITMAP
-    {
-        Pos = MAP_APPFONT ( 72 , 28  ) ;
-        Size = MAP_APPFONT ( 57 , 10 ) ;
-        Text [ de ] = "~Bitmap" ;
-        Text [ en-US ] = "Bitmap";
-		Text [ x-comment ] = " ";
-	};
+		Pos = MAP_APPFONT ( 12 , 14  ) ;
+        Size = MAP_APPFONT ( 108 , 60 ) ;
+        DropDown = TRUE;
+        Border = TRUE;
+		StringList [ de ] =
+		{
+			< "Keine" ; Default ; > ;
+			< "Farbe" ; Default ; > ;
+			< "Farbverlauf" ; Default ; > ;
+			< "Schraffur" ; Default ; > ;
+			< "Bitmap" ; Default ; > ;
+		};
+		StringList [ en-US ] =
+		{
+			< "None" ; Default ; > ;
+			< "Color" ; Default ; > ;
+			< "Gradient" ; Default ; > ;
+			< "Hatching" ; Default ; > ;
+			< "Bitmap" ; Default ; > ;
+		};
+    };
+        
+    
 	ListBox LB_COLOR
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 12 , 61 ) ;
-        Size = MAP_APPFONT ( 108 , 118 ) ;
+        Pos = MAP_APPFONT ( 12 , 30 ) ;
+        Size = MAP_APPFONT ( 108 , 103 ) ;
 		TabStop = TRUE ;
 	};
 	ListBox LB_GRADIENT
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 12 , 61 ) ;
-        Size = MAP_APPFONT ( 108 , 118 ) ;
+        Pos = MAP_APPFONT ( 12 , 30 ) ;
+        Size = MAP_APPFONT ( 108 , 103 ) ;
 		TabStop = TRUE ;
 	};
 	ListBox LB_HATCHING
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 12 , 61 ) ;
-        Size = MAP_APPFONT ( 108 , 118 ) ;
+        Pos = MAP_APPFONT ( 12 , 30 ) ;
+        Size = MAP_APPFONT ( 108 , 103 ) ;
 		TabStop = TRUE ;
 	};
 	ListBox LB_BITMAP
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 12 , 61 ) ;
-        Size = MAP_APPFONT ( 108 , 118 ) ;
+        Pos = MAP_APPFONT ( 12 , 30 ) ;
+        Size = MAP_APPFONT ( 108 , 103 ) ;
 		TabStop = TRUE ;
 	};
 
@@ -403,13 +390,13 @@ TabPage RID_SVXPAGE_AREA
 	Control CTL_COLOR_PREVIEW
 	{
         Border = TRUE;
-        Pos = MAP_APPFONT ( 138 , 14  ) ;
+        Pos = MAP_APPFONT ( 12 , 137  ) ;
         Size = MAP_APPFONT ( 110 , 42 ) ;
 	};
 	Control CTL_BITMAP_PREVIEW
 	{
         Border = TRUE;
-        Pos = MAP_APPFONT ( 138 , 14  ) ;
+        Pos = MAP_APPFONT ( 12 , 137  ) ;
         Size = MAP_APPFONT ( 110 , 42 ) ;
 		Hide = TRUE ;
 	};
@@ -418,7 +405,7 @@ TabPage RID_SVXPAGE_AREA
 
     FixedLine FL_STEPCOUNT
 	{
-        Pos = MAP_APPFONT ( 132 , 61 ) ;
+        Pos = MAP_APPFONT ( 132 , 3 ) ;
         Size = MAP_APPFONT ( 122 , 8 ) ;
         Text [ de ] = "Schrittweite" ;
 		Text [ en-US ] = "Increments" ;
@@ -426,7 +413,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	TriStateBox TSB_STEPCOUNT
 	{
-        Pos = MAP_APPFONT ( 138 , 75 ) ;
+        Pos = MAP_APPFONT ( 138 , 15 ) ;
         Size = MAP_APPFONT ( 68 , 10 ) ;
         Text [ de ] = "~Automatisch" ;
 		TabStop = TRUE ;
@@ -436,7 +423,7 @@ TabPage RID_SVXPAGE_AREA
 	NumericField NUM_FLD_STEPCOUNT
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 208 , 73 ) ;
+        Pos = MAP_APPFONT ( 208 , 14 ) ;
         Size = MAP_APPFONT ( 40 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
@@ -452,7 +439,7 @@ TabPage RID_SVXPAGE_AREA
 
 	CheckBox CB_HATCHBCKGRD
 	{
-        Pos = MAP_APPFONT ( 132 , 61 ) ;
+        Pos = MAP_APPFONT ( 132 , 3 ) ;
         Size = MAP_APPFONT ( 122 , 10 ) ;
 		TabStop = TRUE ;
         Text [ de ] = "H~intergrundfarbe" ;
@@ -462,7 +449,7 @@ TabPage RID_SVXPAGE_AREA
 	ListBox LB_HATCHBCKGRDCOLOR
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 141 , 74 ) ;
+        Pos = MAP_APPFONT ( 141 , 16 ) ;
         Size = MAP_APPFONT ( 70 , 100 ) ;
 		TabStop = TRUE ;
 		DropDown = TRUE ;
@@ -473,7 +460,7 @@ TabPage RID_SVXPAGE_AREA
 
     FixedLine FL_SIZE
 	{
-        Pos = MAP_APPFONT ( 132 , 61  ) ;
+        Pos = MAP_APPFONT ( 132 , 3  ) ;
         Size = MAP_APPFONT ( 122 , 8 ) ;
 		Text [ de ] = "Größe" ;
 		Text [ en-US ] = "Size" ;
@@ -481,7 +468,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	TriStateBox TSB_ORIGINAL
 	{
-        Pos = MAP_APPFONT ( 138 , 73 ) ;
+        Pos = MAP_APPFONT ( 138 , 15 ) ;
 		Size = MAP_APPFONT ( 48 , 10 ) ;
 		Text [ de ] = "~Original" ;
 		TabStop = TRUE ;
@@ -490,7 +477,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	TriStateBox TSB_SCALE
 	{
-        Pos = MAP_APPFONT ( 138 , 88 ) ;
+        Pos = MAP_APPFONT ( 138 , 30 ) ;
 		Size = MAP_APPFONT ( 48 , 10 ) ;
         Text [ de ] = "Re~lativ" ;
 		TabStop = TRUE ;
@@ -499,7 +486,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	FixedText FT_X_SIZE
 	{
-        Pos = MAP_APPFONT ( 187 , 73 ) ;
+        Pos = MAP_APPFONT ( 187 , 15 ) ;
 		Size = MAP_APPFONT ( 24 , 8 ) ;
 		Text [ de ] = "B~reite" ;
 		Text [ en-US ] = "Wi~dth" ;
@@ -508,7 +495,7 @@ TabPage RID_SVXPAGE_AREA
 	MetricField MTR_FLD_X_SIZE
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 212 , 71 ) ;
+        Pos = MAP_APPFONT ( 212 , 14 ) ;
 		Size = MAP_APPFONT ( 36 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
@@ -525,7 +512,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	FixedText FT_Y_SIZE
 	{
-        Pos = MAP_APPFONT ( 187 , 88  ) ;
+        Pos = MAP_APPFONT ( 187 , 31  ) ;
 		Size = MAP_APPFONT ( 24 , 8 ) ;
 		Text [ de ] = "H~öhe" ;
 		Text [ en-US ] = "H~eight" ;
@@ -534,7 +521,7 @@ TabPage RID_SVXPAGE_AREA
 	MetricField MTR_FLD_Y_SIZE
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 212 , 86  ) ;
+        Pos = MAP_APPFONT ( 212 , 29  ) ;
 		Size = MAP_APPFONT ( 36 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
@@ -552,7 +539,7 @@ TabPage RID_SVXPAGE_AREA
 	};
     FixedLine FL_POSITION
 	{
-        Pos = MAP_APPFONT ( 132 , 104 ) ;
+        Pos = MAP_APPFONT ( 132 , 47 ) ;
         Size = MAP_APPFONT ( 122 , 8 ) ;
 		Text [ de ] = "Position" ;
 		Text [ en-US ] = "Position" ;
@@ -562,13 +549,13 @@ TabPage RID_SVXPAGE_AREA
 	Control CTL_POSITION
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 138 , 114 ) ;
-		Size = MAP_APPFONT ( 37 , 27 ) ;
+        Pos = MAP_APPFONT ( 138 , 57 ) ;
+		Size = MAP_APPFONT ( 40 , 27 ) ;
 		TabStop = TRUE ;
 	};
 	FixedText FT_X_OFFSET
 	{
-        Pos = MAP_APPFONT ( 179 , 116  ) ;
+        Pos = MAP_APPFONT ( 138 , 89  ) ;
 		Size = MAP_APPFONT ( 39 , 8 ) ;
 		Text [ de ] = "~X-Offset" ;
 		Text [ en-US ] = "~X Offset" ;
@@ -576,8 +563,8 @@ TabPage RID_SVXPAGE_AREA
 	};
 	FixedText FT_Y_OFFSET
 	{
-        Pos = MAP_APPFONT ( 179 , 131 ) ;
-		Size = MAP_APPFONT ( 39 , 8 ) ;
+        Pos = MAP_APPFONT ( 139 , 104 ) ;
+		Size = MAP_APPFONT ( 78 , 8 ) ;
 		Text [ de ] = "~Y-Offset" ;
 		Text [ en-US ] = "~Y Offset" ;
 		Text [ x-comment ] = " ";
@@ -585,7 +572,7 @@ TabPage RID_SVXPAGE_AREA
 	MetricField MTR_FLD_X_OFFSET
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 219 , 114 ) ;
+        Pos = MAP_APPFONT ( 219 , 87 ) ;
 		Size = MAP_APPFONT ( 29 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
@@ -600,7 +587,7 @@ TabPage RID_SVXPAGE_AREA
 	MetricField MTR_FLD_Y_OFFSET
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 219 , 129 ) ;
+        Pos = MAP_APPFONT ( 219 , 102 ) ;
 		Size = MAP_APPFONT ( 29 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
@@ -614,7 +601,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	TriStateBox TSB_TILE
 	{
-        Pos = MAP_APPFONT ( 138 , 144  ) ;
+        Pos = MAP_APPFONT ( 138 , 117  ) ;
 		Size = MAP_APPFONT ( 54 , 10 ) ;
         Text [ de ] = "Ka~cheln" ;
 		TabStop = TRUE ;
@@ -623,7 +610,7 @@ TabPage RID_SVXPAGE_AREA
 	};
 	TriStateBox TSB_STRETCH
 	{
-        Pos = MAP_APPFONT ( 194 , 144  ) ;
+        Pos = MAP_APPFONT ( 194 , 117  ) ;
 		Size = MAP_APPFONT ( 54 , 10 ) ;
 		Text [ de ] = "A~npassen" ;
 		TabStop = TRUE ;
@@ -632,7 +619,7 @@ TabPage RID_SVXPAGE_AREA
 	};
     FixedLine FL_OFFSET
 	{
-        Pos = MAP_APPFONT ( 132 , 158  ) ;
+        Pos = MAP_APPFONT ( 132 , 133  ) ;
         Size = MAP_APPFONT ( 122 , 8 ) ;
 		Text [ de ] = "Verschiebung" ;
 		Text [ en-US ] = "Offset" ;
@@ -640,16 +627,16 @@ TabPage RID_SVXPAGE_AREA
 	};
     RadioButton RBT_ROW
 	{
-        Pos = MAP_APPFONT ( 138 , 170  ) ;
-		Size = MAP_APPFONT ( 39 , 10 ) ;
+        Pos = MAP_APPFONT ( 138 , 144  ) ;
+		Size = MAP_APPFONT ( 75 , 10 ) ;
         Text [ de ] = "~Zeile" ;
         Text [ en-US ] = "Ro~w" ;
 		Text [ x-comment ] = " ";
 	};
 	RadioButton RBT_COLUMN
 	{
-        Pos = MAP_APPFONT ( 178 , 170 ) ;
-		Size = MAP_APPFONT ( 40 , 10 ) ;
+        Pos = MAP_APPFONT ( 138 , 158 ) ;
+		Size = MAP_APPFONT ( 75 , 10 ) ;
 		Text [ de ] = "S~palte" ;
 		Text [ en-US ] = "Colu~mn" ;
 		Text [ x-comment ] = " ";
@@ -657,7 +644,7 @@ TabPage RID_SVXPAGE_AREA
 	MetricField MTR_FLD_OFFSET
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 219 , 168 ) ;
+        Pos = MAP_APPFONT ( 219 , 157 ) ;
 		Size = MAP_APPFONT ( 29 , 12 ) ;
 		TabStop = TRUE ;
 		Repeat = TRUE ;
Index: svx/source/dialog/tparea.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/tparea.cxx,v
retrieving revision 1.17
retrieving revision 1.17.62.1
diff -u -p -u -p -r1.17 -r1.17.62.1
--- svx/source/dialog/tparea.cxx	13 Dec 2004 12:16:26 -0000	1.17
+++ svx/source/dialog/tparea.cxx	17 Jan 2005 12:31:37 -0000	1.17.62.1
@@ -674,11 +674,7 @@ SvxAreaTabPage::SvxAreaTabPage( Window* 
 	rXFSet				( aXFillAttr.GetItemSet() ),
 
     aFlProp             ( this, ResId( FL_PROP ) ),
-    aRbtNoFill          ( this, ResId( RBT_FILL_OFF ) ),
-    aRbtColor           ( this, ResId( RBT_COLOR ) ),
-    aRbtGradient        ( this, ResId( RBT_GRADIENT ) ),
-    aRbtHatch           ( this, ResId( RBT_HATCH ) ),
-    aRbtBitmap          ( this, ResId( RBT_BITMAP ) ),
+    aTypeLB             ( this, ResId( LB_AREA_TYPE ) ),
 
 	aLbColor			( this, ResId( LB_COLOR ) ),
 	aLbGradient			( this, ResId( LB_GRADIENT ) ),
@@ -818,11 +814,7 @@ SvxAreaTabPage::SvxAreaTabPage( Window* 
 	aMtrFldYOffset.SetModifyHdl( aLink );
 	aTsbScale.SetClickHdl( LINK( this, SvxAreaTabPage, ClickScaleHdl_Impl ) );
 
-    aRbtNoFill.SetClickHdl( LINK( this, SvxAreaTabPage, ClickInvisibleHdl_Impl ) );
-    aRbtColor.SetClickHdl( LINK( this, SvxAreaTabPage, ClickColorHdl_Impl ) );
-    aRbtGradient.SetClickHdl( LINK( this, SvxAreaTabPage, ClickGradientHdl_Impl ) );
-    aRbtHatch.SetClickHdl( LINK( this, SvxAreaTabPage, ClickHatchingHdl_Impl ) );
-    aRbtBitmap.SetClickHdl( LINK( this, SvxAreaTabPage, ClickBitmapHdl_Impl ) );
+    aTypeLB.SetSelectHdl( LINK( this, SvxAreaTabPage, SelectDialogTypeHdl_Impl ) );
 
 	pColorTab = NULL;
 	pGradientList = NULL;
@@ -961,30 +953,30 @@ void SvxAreaTabPage::ActivatePage( const
 			}
 
 			// evaluate if any other Tabpage set another filltype
-            if( ! aRbtNoFill.IsChecked() )
+            if( aTypeLB.GetSelectEntryPos() > XFILL_NONE) 
             {
 				switch( nPageType )//CHINA001 switch( *pPageType )
 				{
 					case PT_GRADIENT:
-                        aRbtGradient.Check();
+					    aTypeLB.SelectEntryPos( XFILL_GRADIENT );
 						aLbGradient.SelectEntryPos( nPos );//CHINA001 aLbGradient.SelectEntryPos( *pPos );
                         ClickGradientHdl_Impl( this );
 					break;
 
 					case PT_HATCH:
-                        aRbtHatch.Check();
+					    aTypeLB.SelectEntryPos( XFILL_HATCH );
 						aLbHatching.SelectEntryPos( nPos );//CHINA001 aLbHatching.SelectEntryPos( *pPos );
                         ClickHatchingHdl_Impl( this );
 					break;
 
 					case PT_BITMAP:
-                        aRbtBitmap.Check();
+					    aTypeLB.SelectEntryPos( XFILL_BITMAP );
 						aLbBitmap.SelectEntryPos( nPos );//CHINA001 aLbBitmap.SelectEntryPos( *pPos );
                         ClickBitmapHdl_Impl( this );
 					break;
 
 					case PT_COLOR:
-                        aRbtColor.Check();
+					    aTypeLB.SelectEntryPos( XFILL_SOLID );
 						aLbColor.SelectEntryPos( nPos );//CHINA001 aLbColor.SelectEntryPos( *pPos );
 						aLbHatchBckgrdColor.SelectEntryPos( nPos ); //CHINA001 aLbHatchBckgrdColor.SelectEntryPos( *pPos );
                         ClickColorHdl_Impl( this );
@@ -1002,22 +994,33 @@ int SvxAreaTabPage::DeactivatePage( SfxI
 {
 	if( nDlgType == 0 ) // Flaechen-Dialog//CHINA001 if( *pDlgType == 0 ) // Flaechen-Dialog
 	{
-        if ( aRbtGradient.IsChecked() )
+        XFillStyle eStyle = (XFillStyle) aTypeLB.GetSelectEntryPos();
+        switch( eStyle )
         {
-            nPageType = PT_GRADIENT;//CHINA001 *pPageType = PT_GRADIENT;
-            nPos = aLbGradient.GetSelectEntryPos();//CHINA001 *pPos = aLbGradient.GetSelectEntryPos();
-        } else if ( aRbtHatch.IsChecked() )
-        {
-            nPageType = PT_HATCH;//CHINA001 *pPageType = PT_HATCH;
-            nPos = aLbHatching.GetSelectEntryPos();//CHINA001 *pPos = aLbHatching.GetSelectEntryPos();
-        } else if ( aRbtBitmap.IsChecked() )
-        {
-            nPageType = PT_BITMAP;//CHINA001 *pPageType = PT_BITMAP;
-            nPos = aLbBitmap.GetSelectEntryPos();//CHINA001 *pPos = aLbBitmap.GetSelectEntryPos();
-        } else if ( aRbtColor.IsChecked() )
-        {
-            nPageType = PT_COLOR;//CHINA001 *pPageType = PT_COLOR;
-            nPos = aLbColor.GetSelectEntryPos();//CHINA001 *pPos = aLbColor.GetSelectEntryPos();
+            case XFILL_GRADIENT:
+            {
+                        nPageType = PT_GRADIENT;//CHINA001 *pPageType = PT_GRADIENT;
+                        nPos = aLbGradient.GetSelectEntryPos();//CHINA001 *pPos = aLbGradient.GetSelectEntryPos();
+            }
+            break; 
+            case XFILL_HATCH: 
+            {
+                nPageType = PT_HATCH;//CHINA001 *pPageType = PT_HATCH;
+                nPos = aLbHatching.GetSelectEntryPos();//CHINA001 *pPos = aLbHatching.GetSelectEntryPos();
+            } 
+            break; 
+            case XFILL_BITMAP: 
+            {
+                nPageType = PT_BITMAP;//CHINA001 *pPageType = PT_BITMAP;
+                nPos = aLbBitmap.GetSelectEntryPos();//CHINA001 *pPos = aLbBitmap.GetSelectEntryPos();
+            } 
+            break; 
+            case XFILL_SOLID: 
+            {
+                nPageType = PT_COLOR;//CHINA001 *pPageType = PT_COLOR;
+                nPos = aLbColor.GetSelectEntryPos();//CHINA001 *pPos = aLbColor.GetSelectEntryPos();
+            }
+            break; 
         }
 	}
 
@@ -1037,149 +1040,162 @@ BOOL SvxAreaTabPage::FillItemSet( SfxIte
 
 	if( nDlgType != 0 || *pbAreaTP )//CHINA001 if( *pDlgType != 0 || *pbAreaTP )
 	{
-        if ( aRbtNoFill.IsChecked() )
+        XFillStyle eStyle = (XFillStyle) aTypeLB.GetSelectEntryPos();
+        XFillStyle eSavedStyle = (XFillStyle) aTypeLB.GetSavedValue(); 
+        switch( eStyle )
         {
-            if( ! aRbtNoFill.GetSavedValue() )
+            case XFILL_NONE: 
             {
-                XFillStyleItem aStyleItem( XFILL_NONE );
-                pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
-                if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                if(  eSavedStyle != eStyle )
                 {
-                    rAttrs.Put( aStyleItem );
-                    bModified = TRUE;
+                    XFillStyleItem aStyleItem( XFILL_NONE );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
+                    if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                    {
+                        rAttrs.Put( aStyleItem );
+                        bModified = TRUE;
+                    }
                 }
             }
-        }
-        else if ( aRbtColor.IsChecked() )
-        {
-            nPos = aLbColor.GetSelectEntryPos();
-            if( nPos != LISTBOX_ENTRY_NOTFOUND &&
-                nPos != aLbColor.GetSavedValue() )
+            break; 
+            case XFILL_SOLID:
             {
-                XFillColorItem aItem( aLbColor.GetSelectEntry(),
-                                      aLbColor.GetSelectEntryColor() );
-                pOld = GetOldItem( rAttrs, XATTR_FILLCOLOR );
-                if ( !pOld || !( *(const XFillColorItem*)pOld == aItem ) )
-                {
-                    rAttrs.Put( aItem );
-                    bModified = TRUE;
-                }
-            }
-            // NEU
-            if( ! aRbtColor.GetSavedValue() &&
-                ( bModified ||
-                  SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLCOLOR ), TRUE ) ) )
+                 nPos = aLbColor.GetSelectEntryPos();
+                 if( nPos != LISTBOX_ENTRY_NOTFOUND &&
+                     nPos != aLbColor.GetSavedValue() )
+                 {
+                     XFillColorItem aItem( aLbColor.GetSelectEntry(),
+                                           aLbColor.GetSelectEntryColor() );
+                     pOld = GetOldItem( rAttrs, XATTR_FILLCOLOR );
+                     if ( !pOld || !( *(const XFillColorItem*)pOld == aItem ) )
+                     {
+                         rAttrs.Put( aItem );
+                         bModified = TRUE;
+                     }
+                 }
+                 // NEU
+                 if( (eSavedStyle != eStyle) &&
+                     ( bModified ||
+                       SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLCOLOR ), TRUE ) ) )
+                 {
+                     XFillStyleItem aStyleItem( XFILL_SOLID );
+                     pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
+                     if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                     {
+                         rAttrs.Put( aStyleItem );
+                         bModified = TRUE;
+                     }
+                 }
+            } 
+            break; 
+            case XFILL_GRADIENT: 
             {
-                XFillStyleItem aStyleItem( XFILL_SOLID );
-                pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
-                if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                nPos = aLbGradient.GetSelectEntryPos();
+                if( nPos != LISTBOX_ENTRY_NOTFOUND &&
+                    (eSavedStyle != eStyle) )
                 {
-                    rAttrs.Put( aStyleItem );
-                    bModified = TRUE;
+                    XGradient aGradient = pGradientList->Get( nPos )->GetGradient();
+                    String aString = aLbGradient.GetSelectEntry();
+                    XFillGradientItem aItem( aString, aGradient );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLGRADIENT );
+                    if ( !pOld || !( *(const XFillGradientItem*)pOld == aItem ) )
+                    {
+                        rAttrs.Put( aItem );
+                        bModified = TRUE;
+                    }
                 }
-            }
-        } else if ( aRbtGradient.IsChecked() )
-        {
-            nPos = aLbGradient.GetSelectEntryPos();
-            if( nPos != LISTBOX_ENTRY_NOTFOUND &&
-                nPos != aLbGradient.GetSavedValue() )
-            {
-                XGradient aGradient = pGradientList->Get( nPos )->GetGradient();
-                String aString = aLbGradient.GetSelectEntry();
-                XFillGradientItem aItem( aString, aGradient );
-                pOld = GetOldItem( rAttrs, XATTR_FILLGRADIENT );
-                if ( !pOld || !( *(const XFillGradientItem*)pOld == aItem ) )
+                // NEU
+                if( (eSavedStyle != eStyle) &&
+                    ( bModified ||
+                      SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLGRADIENT ), TRUE ) ) )
                 {
-                    rAttrs.Put( aItem );
-                    bModified = TRUE;
+                    XFillStyleItem aStyleItem( XFILL_GRADIENT );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
+                    if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                    {
+                        rAttrs.Put( aStyleItem );
+                        bModified = TRUE;
+                    }
                 }
             }
-            // NEU
-            if( ! aRbtGradient.GetSavedValue() &&
-                ( bModified ||
-                  SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLGRADIENT ), TRUE ) ) )
+            break; 
+            case XFILL_HATCH: 
             {
-                XFillStyleItem aStyleItem( XFILL_GRADIENT );
-                pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
-                if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                nPos = aLbHatching.GetSelectEntryPos();
+                if( nPos != LISTBOX_ENTRY_NOTFOUND &&
+                   nPos != aLbHatching.GetSavedValue() )
                 {
-                    rAttrs.Put( aStyleItem );
-                    bModified = TRUE;
+                    XHatch aHatching = pHatchingList->Get( nPos )->GetHatch();
+                    String aString = aLbHatching.GetSelectEntry();
+                    XFillHatchItem aItem( aString, aHatching );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLHATCH );
+                    if ( !pOld || !( *(const XFillHatchItem*)pOld == aItem ) )
+                    {
+                        rAttrs.Put( aItem );
+                        bModified = TRUE;
+                    }
                 }
-            }
-        } else if ( aRbtHatch.IsChecked() )
-        {
-            nPos = aLbHatching.GetSelectEntryPos();
-            if( nPos != LISTBOX_ENTRY_NOTFOUND &&
-               nPos != aLbHatching.GetSavedValue() )
-            {
-                XHatch aHatching = pHatchingList->Get( nPos )->GetHatch();
-                String aString = aLbHatching.GetSelectEntry();
-                XFillHatchItem aItem( aString, aHatching );
-                pOld = GetOldItem( rAttrs, XATTR_FILLHATCH );
-                if ( !pOld || !( *(const XFillHatchItem*)pOld == aItem ) )
-                {
-                    rAttrs.Put( aItem );
-                    bModified = TRUE;
-                }
-            }
-            XFillBackgroundItem aItem ( aCbxHatchBckgrd.IsChecked() );
-            rAttrs.Put( aItem );
-            nPos = aLbHatchBckgrdColor.GetSelectEntryPos();
-            if( nPos != LISTBOX_ENTRY_NOTFOUND &&
-                 nPos != aLbHatchBckgrdColor.GetSavedValue() )
-            {
-                XFillColorItem aItem( aLbHatchBckgrdColor.GetSelectEntry(),
-                                      aLbHatchBckgrdColor.GetSelectEntryColor() );
-                pOld = GetOldItem( rAttrs, XATTR_FILLCOLOR );
-                if ( !pOld || !( *(const XFillColorItem*)pOld == aItem ) )
+                XFillBackgroundItem aItem ( aCbxHatchBckgrd.IsChecked() );
+                rAttrs.Put( aItem );
+                nPos = aLbHatchBckgrdColor.GetSelectEntryPos();
+                if( nPos != LISTBOX_ENTRY_NOTFOUND &&
+                     nPos != aLbHatchBckgrdColor.GetSavedValue() )
                 {
-                    rAttrs.Put( aItem );
-                    bModified = TRUE;
+                    XFillColorItem aItem( aLbHatchBckgrdColor.GetSelectEntry(),
+                                          aLbHatchBckgrdColor.GetSelectEntryColor() );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLCOLOR );
+                    if ( !pOld || !( *(const XFillColorItem*)pOld == aItem ) )
+                    {
+                        rAttrs.Put( aItem );
+                        bModified = TRUE;
+                    }
                 }
-            }
-            // NEU
-            if( ! aRbtHatch.GetSavedValue() &&
-                ( bModified ||
-                  SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLHATCH ), TRUE ) ) )
-            {
-                XFillStyleItem aStyleItem( XFILL_HATCH );
-                pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
-                if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                // NEU
+                if( (eSavedStyle != eStyle) &&
+                    ( bModified ||
+                      SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLHATCH ), TRUE ) ) )
                 {
-                    rAttrs.Put( aStyleItem );
-                    bModified = TRUE;
+                    XFillStyleItem aStyleItem( XFILL_HATCH );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
+                    if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                    {
+                        rAttrs.Put( aStyleItem );
+                        bModified = TRUE;
+                    }
                 }
             }
-        } else if ( aRbtBitmap.IsChecked() )
-        {
-            nPos = aLbBitmap.GetSelectEntryPos();
-            if( nPos != LISTBOX_ENTRY_NOTFOUND &&
-                nPos != aLbBitmap.GetSavedValue() )
+            break; 
+            case XFILL_BITMAP:
             {
-                XOBitmap aXOBitmap = pBitmapList->Get( nPos )->GetXBitmap();
-                String aString = aLbBitmap.GetSelectEntry();
-                XFillBitmapItem aItem( aString, aXOBitmap );
-                pOld = GetOldItem( rAttrs, XATTR_FILLBITMAP );
-                if ( !pOld || !( *(const XFillBitmapItem*)pOld == aItem ) )
+                nPos = aLbBitmap.GetSelectEntryPos();
+                if( nPos != LISTBOX_ENTRY_NOTFOUND &&
+                    nPos != aLbBitmap.GetSavedValue() )
                 {
-                    rAttrs.Put( aItem );
-                    bModified = TRUE;
+                    XOBitmap aXOBitmap = pBitmapList->Get( nPos )->GetXBitmap();
+                    String aString = aLbBitmap.GetSelectEntry();
+                    XFillBitmapItem aItem( aString, aXOBitmap );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLBITMAP );
+                    if ( !pOld || !( *(const XFillBitmapItem*)pOld == aItem ) )
+                    {
+                        rAttrs.Put( aItem );
+                        bModified = TRUE;
+                    }
                 }
-            }
-            // NEU
-            if( ! aRbtBitmap.GetSavedValue() &&
-                ( bModified ||
-                  SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLBITMAP ), TRUE ) ) )
-            {
-                XFillStyleItem aStyleItem( XFILL_BITMAP );
-                pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
-                if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                // NEU
+                if( (eSavedStyle != eStyle) &&
+                    ( bModified ||
+                      SFX_ITEM_SET == rOutAttrs.GetItemState( GetWhich( XATTR_FILLBITMAP ), TRUE ) ) )
                 {
-                    rAttrs.Put( aStyleItem );
-                    bModified = TRUE;
-                }
+                    XFillStyleItem aStyleItem( XFILL_BITMAP );
+                    pOld = GetOldItem( rAttrs, XATTR_FILLSTYLE );
+                    if ( !pOld || !( *(const XFillStyleItem*)pOld == aStyleItem ) )
+                    {
+                        rAttrs.Put( aStyleItem );
+                        bModified = TRUE;
+                    }
+               }
            }
+           break;
        }
 
 		// Schrittweite
@@ -1464,15 +1480,14 @@ void SvxAreaTabPage::Reset( const SfxIte
 	{
 		eXFS = (XFillStyle) ( ( ( const XFillStyleItem& ) rAttrs.
 								Get( GetWhich( XATTR_FILLSTYLE ) ) ).GetValue() );
+	    aTypeLB.SelectEntryPos( eXFS );
 		switch( eXFS )
 		{
 			case XFILL_NONE:
-                aRbtNoFill.Check();
                 ClickInvisibleHdl_Impl( this );
 			break;
 
 			case XFILL_SOLID:
-                aRbtColor.Check();
 				//if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( GetWhich( XATTR_FILLCOLOR ), TRUE, &pPoolItem ) )
 				if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( XATTR_FILLCOLOR ) )
 				{
@@ -1487,7 +1502,6 @@ void SvxAreaTabPage::Reset( const SfxIte
 			break;
 
 			case XFILL_GRADIENT:
-                aRbtGradient.Check();
 				//if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( GetWhich( XATTR_FILLGRADIENT ), TRUE, &pPoolItem ) )
 				if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( XATTR_FILLGRADIENT ) )
 				{
@@ -1502,7 +1516,6 @@ void SvxAreaTabPage::Reset( const SfxIte
 			break;
 
 			case XFILL_HATCH:
-                aRbtHatch.Check();
 				//if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( GetWhich( XATTR_FILLHATCH ), TRUE, &pPoolItem ) )
 				if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( XATTR_FILLHATCH ) )
 				{
@@ -1528,8 +1541,6 @@ void SvxAreaTabPage::Reset( const SfxIte
 
 			case XFILL_BITMAP:
 			{
-                aRbtBitmap.Check();
-
 				if( SFX_ITEM_DONTCARE != rAttrs.GetItemState( XATTR_FILLBITMAP ) )
 				{
 					XFillBitmapItem aBitmapItem( ( const XFillBitmapItem& )
@@ -1560,11 +1571,7 @@ void SvxAreaTabPage::Reset( const SfxIte
 		aLbColor.Show();
 
 		// Damit Reset() auch mit Zurueck richtig funktioniert
-        aRbtNoFill.Check( FALSE );
-        aRbtColor.Check( FALSE );
-        aRbtGradient.Check( FALSE );
-        aRbtHatch.Check( FALSE );
-        aRbtBitmap.Check( FALSE );
+		aTypeLB.SetNoSelection();
 	}
 
 	// Schrittweite
@@ -1754,15 +1761,11 @@ void SvxAreaTabPage::Reset( const SfxIte
 		aMtrFldYOffset.SetText( String() );
 
 	// Erst hier, damit Tile und Stretch mit beruecksichtigt wird
-    if( aRbtBitmap.IsChecked() )
+    if( aTypeLB.GetSelectEntryPos() == XFILL_BITMAP )
 		ClickBitmapHdl_Impl( NULL );
 
 	// Werte sichern
-    aRbtNoFill.SaveValue();
-    aRbtColor.SaveValue();
-    aRbtGradient.SaveValue();
-    aRbtHatch.SaveValue();
-    aRbtBitmap.SaveValue();
+    aTypeLB.SaveValue();
 	aLbColor.SaveValue();
 	aLbGradient.SaveValue();
 	aLbHatching.SaveValue();
@@ -1772,7 +1775,7 @@ void SvxAreaTabPage::Reset( const SfxIte
 //	aLbTransparent.SaveValue();
 	aTsbStepCount.SaveValue();
 	aNumFldStepCount.SaveValue();
-	aTsbTile.SaveValue();
+	aTsbTile.SaveValue();           
 	aTsbStretch.SaveValue();
 	aTsbScale.SaveValue();
 	aRbtRow.SaveValue();
@@ -1800,6 +1803,19 @@ USHORT*	SvxAreaTabPage::GetRanges()
 }
 
 //------------------------------------------------------------------------
+IMPL_LINK( SvxAreaTabPage, SelectDialogTypeHdl_Impl, ListBox *, EMPTYARG )
+{
+    switch( (XFillStyle)aTypeLB.GetSelectEntryPos() )
+    {
+        case XFILL_NONE: ClickInvisibleHdl_Impl( this ); break;
+        case XFILL_SOLID: ClickColorHdl_Impl( this ); break;
+        case XFILL_GRADIENT: ClickGradientHdl_Impl( this ); break; 
+        case XFILL_HATCH: ClickHatchingHdl_Impl( this ); break;
+        case XFILL_BITMAP: ClickBitmapHdl_Impl( this ); break;
+    }
+    
+    return 0;
+}
 
 IMPL_LINK( SvxAreaTabPage, ClickInvisibleHdl_Impl, void *, EMPTYARG )
 {
Index: svx/source/options/optgrid.src
===================================================================
RCS file: /cvs/graphics/svx/source/options/optgrid.src,v
retrieving revision 1.52
retrieving revision 1.52.404.1
diff -u -p -u -p -r1.52 -r1.52.404.1
--- svx/source/options/optgrid.src	25 Jun 2004 12:15:46 -0000	1.52
+++ svx/source/options/optgrid.src	18 Jan 2005 08:36:36 -0000	1.52.404.1
@@ -281,7 +281,7 @@ TabPage RID_SVXPAGE_GRID
 	FixedText FT_SNAP_AREA
 	{
         Pos = MAP_APPFONT ( 12 , 169  ) ;
-		Size = MAP_APPFONT ( 54 , 10 ) ;
+        Size = MAP_APPFONT ( 64 , 10 ) ;
         Hide = TRUE;
         Text [ de ] = "Fang~bereich" ;
 		Text [ en-US ] = "~Snap range" ;
@@ -290,8 +290,8 @@ TabPage RID_SVXPAGE_GRID
 	MetricField MTR_FLD_SNAP_AREA
 	{
 		Border = TRUE ;
-        Pos = MAP_APPFONT ( 70 , 167  ) ;
-		Size = MAP_APPFONT ( 48 , 12 ) ;
+        Pos = MAP_APPFONT ( 80 , 167  ) ;
+        Size = MAP_APPFONT ( 38 , 12 ) ;
         Hide = TRUE;
         TabStop = TRUE ;
 		Repeat = TRUE ;
Index: sfx2/source/doc/objxtor.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/objxtor.cxx,v
retrieving revision 1.53
retrieving revision 1.50.54.3
diff -u -p -u -p -r1.53 -r1.50.54.3
--- sfx2/source/doc/objxtor.cxx	18 Jan 2005 16:12:41 -0000	1.53
+++ sfx2/source/doc/objxtor.cxx	7 Feb 2005 11:05:27 -0000	1.50.54.3
@@ -292,7 +292,7 @@ SfxObjectShell::~SfxObjectShell()
 //REMOVE	        HandsOff();
 
     // don't call GetStorage() here, in case of Load Failure it's possible that a storage was never assigned!
-    if ( pMedium->HasStorage_Impl() && pMedium->GetStorage() == pImp->m_xDocStorage )
+    if ( pMedium && pMedium->HasStorage_Impl() && pMedium->GetStorage() == pImp->m_xDocStorage )
         pMedium->CanDisposeStorage_Impl( sal_False );
 
     DELETEX( pMedium );
